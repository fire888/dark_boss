{"version":3,"sources":["_CORE/pipeLines/initPipeLine.js","chapter02/src/constants/constants_elements.js","_CORE/helpers/helper_LoadAssets.js","_CORE/helpers/helper_Emitter.js","_CORE/helpers/helper_translate.js","_CORE/ui/containersReact/Info.js","_CORE/constants/default_voc.js","_CORE/ui/containersReact/PlayerControls.js","_CORE/ui/containersReact/App.js","_CORE/ui/store/defaultUiData.js","_CORE/ui/UI.js","_CORE/ui/store/createStore.js","chapter02/src/ui/DialogPallete.js","chapter02/src/constants/constants_replicies.js","chapter02/src/actions/AdderActions.js","chapter02/src/ui/CustomReactComponent.js","chapter02/src/constants/translate.js","chapter02/src/ui/createStore.js","_CORE/shaders/saturate.js","_CORE/entities/createStudio.js","_CORE/helpers/helper_KeyBoard.js","_CORE/entities/createPlayer.js","_CORE/systems/SystemCollisionsItems.js","_CORE/helpers/helper_MaterialsLib.js","assets/chapter02/skybox/px.jpg","assets/chapter02/skybox/nx.jpg","assets/chapter02/skybox/py.jpg","assets/chapter02/skybox/ny.jpg","assets/chapter02/skybox/pz.jpg","assets/chapter02/skybox/nz.jpg","assets/chapter02/level.obj","chapter02/src/systems/system_Level.js","assets/chapter02/terminal.glb","chapter02/src/entities/Terminal.js","_CORE/helpers/helper_GLTFcopy.js","chapter02/src/systems/system_Terminals.js","_CORE/systems/SystemCheckerNearItem.js","chapter02/src/entities/BridgeMesh.js","chapter02/src/entities/Bridge.js","chapter02/src/constants/constants_modules.js","chapter02/src/ui/Ui.js","_CORE/helpers/helper_DeviceResizer.js","_CORE/helpers/helper_FrameUpater.js","_CORE/helpers/helper_TweenUpdater.js","chapter02/src/systems/system_Platforms.js","chapter02/src/systems/system_DialogsWithTerminals.js","chapter02/src/systems/system_Brige.js","chapter02/src/index.js"],"names":["gameModules","CONSTANTS","a","initModulesByState","root","loaderAssets","dataToLoad","getAssetsFromModulesData","loadAssets","assets","state","modulesData","i","length","key","constr","initStateKey","arr","assetsToLoad","j","push","PI","Math","CURRENT_CHAPTER","MATERIALS_CONFIG","mat","props","side","THREE","color","emissive","bumpScale","shininess","studioConfig","canId","rendererCon","antialias","amb","strength","clearColor","sceneEnvironment","fogNear","fogFar","backgroundImgKey","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","backObjPos","lightDataOne","R","PLATFORMS_CONFIG","r","angle","y","w1","w2","h","TERMINALS_CONFIG","terminalKey","angleZ","angleY","LAST_TERMINAL_CONFIG","BRIDGE_START_STATE","time","count","twist","strengthTwist","radius","height","rotate","width","floor","x","z","PROGRAMS","createLoaders","objLoader","textureLoader","gltfLoader","cubeTextureLoader","path","type","Promise","resolve","OBJLoader","GLTFLoader","getterLoader","load","LoaderAssets","this","resources","_load","data","iterate","index","EventEmitter","_storage","id","getOrCreateArrFromObj","forEach","action","callback","filter","item","s","console","log","obj","lang","createTranslater","vocab","word","t","connect","controls","infoPanelData","className","onClick","dispatch","title","topText","chapters","map","href","target","text","currentChapterIndex","bottomText","afterWords","aText","isInfo","isShowControls","useState","isShowFullScreenButt","changeShowFullScreenButt","useEffect","gameContext","emitter","subscribe","val","onMouseDown","emit","onTouchStart","onMouseUp","onTouchEnd","dispatcher","CustomReactComponent","startDefaultStoreData","loader","document","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","setTimeout","style","marginLeft","UI","_root","store","customStore","rootReducer","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","thunk","prepareStore","ReactDOM","render","getElementById","startButtons","progressWrapper","hideStartScreen","e","l","dataset","display","addEventListener","LIBA","replicies","dialogs","blockPhrases","currentTerminalKey","currentPhraseIndex","message","q","txt","isShow","ind","actionKey","dataAction","phraseIndex","toggleOpenDialog","isToOpen","is","isButtonDialog","isCloseisButtonDialog","isShowPalleteDialog","DialogPallete","storeStartState","idChangerState","keyProgramBridge","currentLanguage","Saturate","uniforms","value","vertexShader","fragmentShader","Studio","canvas","_renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","_scene","background","fog","_lightA","add","_camera","_composer","EffectComposer","resize","size","aspect","updateProjectionMatrix","addToScene","bind","_backgroundImgKey","cam","addPass","RenderPass","composerAddPass","ShaderPass","_changeFog","_changeBackground","startData","endData","TWEEN","to","onUpdate","start","KeyBoard","keys","keysEnabled","keyUpdate","keyCode","isDown","event","Player","studio","isButtonsDisabled","_isBlocked","_isCanMove","_mainObj","position","fromArray","rotation","userData","bottomObj","frontObj","backObj","strenth","light","systemCollisionFloor","checkCollisions","isBlockedByItem","offset","point","systemCollisionItems","translateZ","dir","isOpen","setCamera","set","SystemCollisionWithItems","_arrMeshes","_vecStart","_vecDir","_rayCaster","mesh","itemKeyEmitCollision","isStopUnits","objFrom","objTo","d","getWorldPosition","sub","intersects","intersectObjects","distance","object","type2","createMaterials","wrapS","wrapT","mapsKeys","materials","keyMap","SystemLevel","_topLevel","traverse","child","name","includes","geometry","wall","setItemToCollision","easyMaterial","dist","createModelTerminal","model","config","copy","gltf","clone","animations","scene","skinnedMeshes","node","isSkinnedMesh","cloneBones","cloneSkinnedMeshes","isBone","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","boneInverses","matrixWorld","GLTFCopy","children","mixer","timeScale","mixerUpdate","update","delta","openAction","clipAction","loop","sin","cos","startOpen","stopUpdate","reset","play","paused","startClose","SystemTerminals","terminals","createTerminal","terminal","inScene","visible","SystemCheckerNearItem","_itemWorldPos","_mainCheckerWorldPos","_arr","mainMesh","distanceTo","updateMesh","dispose","createGeom","needsUpdate","pointsCarcass","points","w","p","twistPoint","xW","zW","createPointsCarcass","phase","createPointsPath","createGeomFromPoints","vertices","Float32Array","setAttribute","computeVertexNormals","computeBoundingSphere","createBridge","material","currentState","bridge","geom","changeMesh","params","createBridgeMesh","setPose","startProgram","program","doMarathonAnimations","then","newState","arrStates","doNextAnimation","gsap","duration","ease","middleState","onComplete","GAME_MODULES","appWrapper","openTerminal","closeTerminal","player","toggleBlocked","addTopZone","addLastTerminal","JSON","parse","stringify","splice","createCustomStore","ui","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fontSize","max","min","fullscreenElement","emitFrameUpdate","oldTime","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","levelSrc","pxjpg","nxjpg","pyjpg","nyjpg","pzjpg","nzjpg","terminalSrc","checkerNear","setItemToCheck","keyTerminalNear","checkNear","isNear","_PROGRAMS","_bridge","_inProgram","showStartButton","pipeLineForInit"],"mappings":"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","file":"static/js/main.f34bd1fa.chunk.js","sourcesContent":["export async function pipeLineForInit (gameModules, CONSTANTS) {\r\n    const root = { CONSTANTS }\r\n\r\n    initModulesByState('pageLoaded', gameModules, root)\r\n\r\n    const { loaderAssets } = root\r\n\r\n    const dataToLoad = getAssetsFromModulesData(gameModules)\r\n    root.assets = await loaderAssets.loadAssets(dataToLoad)\r\n\r\n    initModulesByState('beforeStartPlay', gameModules, root)\r\n}\r\n\r\n\r\nconst initModulesByState = (state, modulesData, root) => {\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        const {  key, constr, initStateKey } = modulesData[i]\r\n        initStateKey === state && (root[key] = new constr(root))\r\n    }\r\n}\r\n\r\nconst getAssetsFromModulesData = modulesData => {\r\n    const arr = []\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        if (modulesData[i].assetsToLoad && modulesData[i].assetsToLoad.length) {\r\n            for (let j = 0; j < modulesData[i].assetsToLoad.length; ++j) {\r\n                arr.push(modulesData[i].assetsToLoad[j])\r\n            }\r\n        }\r\n    }\r\n    return arr\r\n}","import * as THREE from 'three'\r\nconst PI = Math.PI\r\nconst hPI = PI / 2\r\n\r\n\r\nexport const CURRENT_CHAPTER = 1\r\n\r\nexport const MATERIALS_CONFIG = {\r\n    'wall': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            side: THREE.DoubleSide,\r\n            color: '#00c7ea',\r\n            emissive: '#6205b0',\r\n            bumpScale: 0.2,\r\n            shininess: 100,\r\n        },\r\n    },\r\n}\r\n\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    amb: {\r\n        color: 0xffffff,\r\n        strength: 0.8,\r\n    },\r\n    clearColor: 0x0e2535,\r\n    sceneEnvironment: {\r\n        fogNear: 40,\r\n        fogFar: 300,\r\n        color: 0x0e2535, \r\n        backgroundImgKey: 'envTexture',\r\n    },\r\n}\r\n\r\n\r\nconst speedDown = -0.45\r\nexport const playerConfig = {\r\n    //speed: 0.35,\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown,\r\n    //offsetFromFloor: 5.0,\r\n    offsetFromFloor: 7.0,\r\n    offsetFromFloorFactor: speedDown * (-1) + .1,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    startPos: [0, 0, 190],\r\n        // positions on platforms for debugging\r\n    //startPos: [-5.614908553125407, -50.81650161743164, -54.48311129133365],\r\n    //startPos: [2.354103517969214, 6.5, -107.29721568841998],\r\n    //startPos: [-24.948354188041503, 72.5, 93.69116998603509 ],\r\n    //startPos: [18.357669772732198, 72.5, -104.50015863788533],\r\n    //startPos: [110.99286970990862, 123.5, 19.3252595736 ],\r\n    //startPos: [34.17306840733142, 156.5, 109.1814716364231],\r\n    //startPos: [40.80743861657082, 249.7961832162714, 96.36024171879704 ],\r\n    //startPos: [-170.75892530136252, 282.5404968261719, -313.3819071475127],\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 1000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    backObjPos: [0, 0, 1],\r\n    lightDataOne: {\r\n        color: 0xccccff, \r\n        strength: 0.3,\r\n        pos: [0, 50, 0],\r\n    },\r\n}\r\n\r\nconst R = 100\r\nexport const PLATFORMS_CONFIG = [\r\n    { r: R, angle: PI + 0.1, y: -5, w1: 70, w2: 40, h: 7, },\r\n    { r: R, angle: 0, y: 61, w1: 70, w2: 40, h: 7, },\r\n    { r: R, angle: PI - 0.1, y: 61, w1: 70, w2: 40, h: 7, },\r\n    { r: R + 20, angle: PI/2, y: 112, w1: 70, w2: 40, h: 7, },\r\n    { r: R + 20, angle: 0.35, y: 145, w1: 70, w2: 40, h: 7, },\r\n    { r: R + 20, angle: 0.35 - 0.2, y: 237, w1: 70, w2: 40, h: 7, },\r\n]\r\n\r\n\r\nexport const TERMINALS_CONFIG = [\r\n    { terminalKey: 'TERMINAL_Z01', r: 20, angle: PI - 0.3, y: -57, angleZ: PI / 2, angleY: 0.1 },\r\n    { terminalKey: 'TERMINAL_Z', r: 50, angle: PI, y: -57, },\r\n    { terminalKey: 'TERMINAL_00', r: R + 20, angle: 0, y: 2, },\r\n    { terminalKey: 'TERMINAL_01', r: R - 5, angle: PI + 0.3, y: 1, },\r\n    { terminalKey: 'TERMINAL_02', r: R - 5, angle: -0.2, y: 67, },\r\n    { terminalKey: 'TERMINAL_03', r: R - 5, angle: PI - 0.2, y: 67, },\r\n    { terminalKey: 'TERMINAL_04', r: R + 10, angle: PI/2 - 0.2, y: 118, },\r\n    { terminalKey: 'TERMINAL_05', r: R + 10, angle: 0.25, y: 151, },\r\n    { terminalKey: 'TERMINAL_06', r: R + 10, angle: 0.1, y: 243, },\r\n]\r\nexport const LAST_TERMINAL_CONFIG = { terminalKey: 'TERMINAL_LAST', r: 350, angle: PI + 0.5, y: 277 }\r\n\r\n\r\nexport const BRIDGE_START_STATE =\r\n{time: 3000,count: 34,twist: 3.141592653589793,strengthTwist: 1,radius: 0,height: 0,rotate: 3.05840734641021,width: 0,floor: 0,x: 0,y: 0,z: 58,}\r\n// states bridge for debugging\r\n//{time: '3000', count: 60,twist: 11.6840734641021,strengthTwist: 1,radius: 10,height: 78,rotate: 0.858407346410207,width: 0,floor: 0,x: 0,y: -15,z: 0,}\r\n//{time: '3000', count: 100, twist: 1.53407346410207, strengthTwist: 0, radius: 100, height: 2, rotate: 0, width: 10, floor: 17, x: 0, y: 0, z: 0,}\r\n//{time: 1000, count: 100, twist: 0,strengthTwist: 0,radius: 85,height: -73,rotate: PI * 2 + 0.25,width: 12,floor: 30,x: 0,y: 67,z: 0,}\r\n//{time: 3000, count: 100, twist: -2.81592653589793, strengthTwist: 1, radius: 96, height: 0, rotate: -0.341592653589793, width: 8, floor: 18, x: 0, y: 65, z: 0, }\r\n//{ time: 3000,count: 100, twist: 13.7340734641021, strengthTwist: 0.351, radius: 126, height: 52, rotate: -2.84159265358979, width: 10, floor: 17, x: 42, y: 69, z: 0, }\r\n//{ time: 3000,count: 100, twist: -7.21592653589793, strengthTwist: 1, radius: 114, height: 40, rotate: 1.25840734641021, width: 10, floor: 17, x: 0, y: 113, z: 0, }\r\n//{ time: 1500,count: 192, twist: -18.3159265358979, strengthTwist: 1, radius: 40, height: 98, rotate: 0, width: 9, floor: 16.2, x: 8, y: 146, z: 73, }\r\n//{ time: 1000,count: 100, twist: 3.14, strengthTwist: 0.424, radius: 200, height: 40, rotate: 0.6584, width: 7, floor: 90, x: -75, y: 240, z: -10, }\r\n\r\nexport const PROGRAMS = {\r\n    'PROGRAM_NONE': [\r\n        { time: 1000,count: 148, twist: 12.4340734641021, strengthTwist: 0.84, radius: 24, height: 40, rotate: -0.041592653589793, width: 0, floor: 0, x: 0, y: 0, z: 0, },\r\n        { time: 3000,count: 148, twist: 12.4340734641021, strengthTwist: 0.84, radius: -34, height: 40, rotate: -20, width: 5, floor: 0, x: 0, y: 0, z: 0, },\r\n        { time: 3000,count: 70, twist: 20.4340734641021, strengthTwist: 0.84, radius: -40, height: 80, rotate: -40, width: 5, floor: 12, x: 0, y: -20, z: 0, },\r\n        { time: 3000,count: 50, twist: 12, strengthTwist: -0.84, radius: -5, height: -40, rotate: -40, width: 5, floor: 12, x: 0, y: 20, z: 0, },\r\n        { time: 3000,count: 70, twist: 12, strengthTwist: -0.84, radius: 20, height: -40, rotate: -20, width: 10, floor: 12, x: 0, y: 20, z: 0, },\r\n        { time: 3000,count: 100, twist: 20, strengthTwist: 1, radius: 20, height: 40, rotate: 0, width: 5, floor: 0, x: 10, y: 20, z: 0, },\r\n        { time: 3000,count: 148, twist: 20, strengthTwist: 1, radius: 20, height: 80, rotate: 20, width: 0, floor: 0, x: 0, y: -20, z: 0, },\r\n        {time: 20,count: 34,twist: 3.141592653589793,strengthTwist: 1,radius: 0,height: 0,rotate: 3.05840734641021,width: 0,floor: 0,x: 0,y: 0,z: 58,}\r\n    ],\r\n    'PROGRAM_Z': [\r\n        {time: 1500,count: 100,twist: 15.141592653589793,strengthTwist: 1,radius: 50, height: -70, rotate: -10, width: 5, floor: 0,x: 0, y: 30, z: 28,},\r\n        {time: 3000,count: 100,twist: -15.141592653589793,strengthTwist: 1,radius: 20, height: 70, rotate: 3.05, width: 5, floor: 0,x: 0, y: -30, z: 58,},\r\n        {time: 1500,count: 34,twist: 3.141592653589793,strengthTwist: 0,radius: 48,height: 70,rotate: 3.05840734641021,width: 20,floor: 0,x: 0,y: -60,z: 58,}\r\n    ],\r\n    'PROGRAM_00': [\r\n        {time: 700, count: 60, twist: 14.1340734641021, strengthTwist: 1, radius: 30, height: 78, rotate: -Math.PI, width: 7, floor: 0, x: 0, y: -15, z: 0,},\r\n        {time: 700, count: 172, twist: 14.1340734641021, strengthTwist: 0.383, radius: 40, height: 78, rotate: 0.858407346410207, width: 7, floor: 13.3, x: 0, y: -15, z: 0,},\r\n        {time: 2000, count: 172, twist: -18.1659265358979, strengthTwist: 0.486, radius: 40, height: 62, rotate: -Math.PI, width: 7, floor: 20, x: 0, y: -15, z: 0,},\r\n        {time: 3000, count: 300, twist: -18.1659265358979, strengthTwist: 0.922, radius: 64, height: 30, rotate: 0.858407346410207, width: 4, floor: 5.3, x: 0, y: 40, z: 0,},\r\n        {time: 3000, count: 100, twist: 1.53407346410207, strengthTwist: 0, radius: 110, height: 2, rotate: 0, width: 10, floor: 17, x: 0, y: 0, z: 0,},\r\n        {time: 1000, count: 100, twist: 1.53407346410207, strengthTwist: 0, radius: 110, height: 2, rotate: 0, width: 7, floor: 25, x: 0, y: 0, z: 0,},\r\n    ],\r\n    'PROGRAM_01': [\r\n        {time: 3000, count: 160, twist: -10,strengthTwist: 1,radius: 22,height: -40,rotate: PI,width: 3,floor: 17,x: 0,y: 70,z: 0,},\r\n        {time: 3000, count: 100, twist: 0,strengthTwist: 0,radius: 60,height: -78,rotate: PI * 1.5,width: 30,floor: 5,x: 0,y: 70,z: 0,},\r\n        {time: 1000, count: 100, twist: 0,strengthTwist: 0,radius: 85,height: -73,rotate: PI * 2 + 0.25,width: 12,floor: 10,x: 0,y: 67,z: 0,},\r\n        {time: 1000, count: 100, twist: 0,strengthTwist: 0,radius: 85,height: -73,rotate: PI * 2 + 0.25,width: 7,floor: 30,x: 0,y: 67,z: 0,},\r\n    ],\r\n    'PROGRAM_02': [\r\n        {time: 3000, count: 50, twist: -4, strengthTwist: 1, radius: 7, height: 80, rotate: 1.5, width: 5, floor: 7, x: 0, y: 65, z: 0, },    \r\n        {time: 3000, count: 70, twist: 6, strengthTwist: 1, radius: 40, height: -80, rotate: -1.5, width: 8, floor: 7, x: 0, y: 110, z: 0, },    \r\n        {time: 1500, count: 100, twist: -2.81592653589793, strengthTwist: 1, radius: 96, height: 0, rotate: -0.341592653589793, width: 15, floor: 7, x: 0, y: 65, z: 0, },\r\n        {time: 1000, count: 100, twist: -2.81592653589793, strengthTwist: 1, radius: 96, height: 0, rotate: -0.341592653589793, width: 7, floor: 30, x: 0, y: 65, z: 0, },\r\n    ],\r\n    'PROGRAM_03': [\r\n        { time: 3000,count: 300, twist: 13, strengthTwist: 1, radius: 30, height: 52, rotate: 7, width: 7, floor: 5, x: 0, y: 69, z: 0, },\r\n        { time: 1000,count: 300, twist: 13, strengthTwist: 1, radius: -30, height: 52, rotate: 7, width: 7, floor: 5, x: 0, y: 69, z: 0, },\r\n        { time: 3000,count: 300, twist: -13, strengthTwist: 1, radius: 10, height: 52, rotate: 7, width: 5, floor: 5, x: 0, y: 69, z: 0, },\r\n        { time: 3000,count: 100, twist: 13.7340734641021, strengthTwist: 0.351, radius: 126, height: 52, rotate: -2.84159265358979, width: 10, floor: 17, x: 42, y: 69, z: 0, },\r\n        { time: 1000,count: 300, twist: 13.7340734641021, strengthTwist: 0.351, radius: 126, height: 52, rotate: -2.84159265358979, width: 7, floor: 30, x: 42, y: 69, z: 0, },\r\n    ],\r\n    'PROGRAM_04': [\r\n        { time: 1000,count: 300, twist: 13.7340734641021, strengthTwist: 0, radius: 126, height: 0, rotate: -2.84159265358979, width: 7, floor: 30, x: 42, y: 70, z: 0, },\r\n        { time: 3000,count: 300, twist: 13, strengthTwist: 1, radius: 30, height: 52, rotate: 7, width: 7, floor: 5, x: 0, y: 90, z: 0, },\r\n        { time: 1000,count: 300, twist: 13, strengthTwist: 1, radius: -30, height: 52, rotate: 7, width: 7, floor: 5, x: 0, y: 90, z: 0, },\r\n        { time: 3000,count: 300, twist: -13, strengthTwist: 1, radius: 10, height: 52, rotate: 7, width: 5, floor: 5, x: 0, y: 90, z: 0, },\r\n        { time: 3000,count: 100, twist: -7.21592653589793, strengthTwist: 1, radius: 90, height: 40, rotate: 1.25840734641021, width: 10, floor: 17, x: 0, y: 113, z: 0, },\r\n        { time: 1000,count: 100, twist: -7.21592653589793, strengthTwist: 1, radius: 114, height: 40, rotate: 1.25840734641021, width: 10, floor: 17, x: 0, y: 113, z: 0, },\r\n    ],\r\n    'PROGRAM_05': [\r\n        { time: 1500,count: 200, twist: -5, strengthTwist: 1, radius: 10, height: 7, rotate: PI, width: 9, floor: 30, x: 0, y: 133, z: 0, },\r\n        { time: 3000,count: 70, twist: -10, strengthTwist: 1, radius: 30, height: -98, rotate: -5 * PI, width: 5, floor: 0, x: 0, y: 240, z: 0, },\r\n        { time: 3000,count: 50, twist: -10, strengthTwist: 1, radius: -60, height: 98, rotate: -PI, width: -9, floor: 19.2, x: 0, y: 146, z: 0, },\r\n        { time: 1500,count: 192, twist: -18.3159265358979, strengthTwist: 1, radius: 40, height: 98, rotate: 0, width: 9, floor: 16.2, x: 8, y: 146, z: 73, },\r\n    ],\r\n    'PROGRAM_06': [\r\n        { time: 1500,count: 192, twist: -12, strengthTwist: 1, radius: 20, height: 70, rotate: 5, width: 3, floor: 3, x: -75, y: 200, z: 0, },\r\n        { time: 3000,count: 100, twist: 3.14, strengthTwist: 0.424, radius: 200, height: 40, rotate: 0.6584, width: 20, floor: 7, x: -75, y: 240, z: -10, },\r\n        { time: 1000,count: 100, twist: 3.14, strengthTwist: 0.424, radius: 200, height: 40, rotate: 0.6584, width: 7, floor: 90, x: -75, y: 240, z: -10, },\r\n    ],\r\n    'PROGRAM_LAST': [\r\n        {time: 3000, count: 300, twist: 10,strengthTwist: 1, radius: 80,height: 190,rotate: -5,width: 10,floor: 11.5,x: -40,y: 249,z: -30,},\r\n        {time: 3000, count: 200, twist: 31.38, strengthTwist: 1,radius: 24,height: 190,rotate: 0.158407346410207,width: 10,floor: 11.5,x: -20,y: 249,z: -192,},\r\n        {time: 3000, count: 600, twist: 31.38, strengthTwist: 1,radius: -130,height: 190,rotate: -20,width: 10,floor: 20,x: -20,y: 239,z: -192,},\r\n        {time: 3000, count: 200, twist: 6, strengthTwist: 2,radius: -60,height: 190,rotate: -30,width: 10,floor: 20,x: -20,y: 29,z: -182,},\r\n        {time: 3000, count: 200, twist: -16, strengthTwist: 1,radius: -50,height: 190,rotate: -40,width: 10,floor: 0,x: -20,y: 249,z: -182,},\r\n        {time: 1500, count: 200, twist: -30, strengthTwist: 1,radius: -40,height: 190,rotate: -50,width: 0,floor: 0,x: -20,y: 249,z: -192,},\r\n    ],\r\n}","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\n\r\nconst createLoaders = () => {\r\n    let objLoader = null,\r\n        textureLoader = null,\r\n        gltfLoader = null,\r\n        cubeTextureLoader = null\r\n\r\n    const getterLoader = type => {\r\n        if (type === 'obj')\r\n            return objLoader = (objLoader || new OBJLoader())\r\n        if (type === 'glb' || type === 'gltf')\r\n            return gltfLoader = (gltfLoader || new GLTFLoader())\r\n        if (type === 'img')\r\n            return textureLoader = (textureLoader || new THREE.TextureLoader())\r\n        if (type === 'cubeTextures')\r\n            return cubeTextureLoader = (cubeTextureLoader || new THREE.CubeTextureLoader())\r\n    }\r\n\r\n    return (path, type) => new Promise(resolve => getterLoader(type).load(path, resolve))\r\n}\r\n\r\n\r\n\r\n\r\nexport class LoaderAssets {\r\n\r\n    constructor () {\r\n        this.resources = {}\r\n        this._load = createLoaders()\r\n    }\r\n\r\n    loadAssets (data) {\r\n        return new Promise(resolve => {\r\n\r\n            const load = this._load\r\n            const resources = this.resources\r\n\r\n            async function iterate (index) {\r\n                if (data[index]) {\r\n                    const { key, path, type } = data[index]\r\n                    resources[key] = await load(path, type)\r\n                }\r\n\r\n                ++index\r\n                !data[index]\r\n                    ? resolve(resources)\r\n                    : await iterate(index)\r\n            }\r\n\r\n           void iterate(0)\r\n        })\r\n    }\r\n}\r\n","export class EventEmitter {\r\n    constructor() {\r\n        this._storage = {}\r\n    }\r\n\r\n    emit (id) {\r\n        return data => getOrCreateArrFromObj(this._storage)(id).forEach(action => action(data))\r\n    }\r\n\r\n    subscribe (id) {\r\n        return callback => {\r\n            getOrCreateArrFromObj(this._storage)(id).push(callback)\r\n            return () => this._storage[id] = this._storage[id].filter(item => item !== callback)\r\n        }\r\n    }\r\n\r\n    showAll () {\r\n        const s = {}\r\n        for (let key in this._storage) {\r\n            s[key] = this._storage[key].length\r\n        }\r\n        console.log(s)\r\n    }\r\n}\r\n\r\n\r\n\r\n// const createEmitter = () => {\r\n//     const storage = {}\r\n//     return {\r\n//         emit: id => data => getOrCreateArrFromObj(storage)(id).forEach(action => action(data)),\r\n//         subscribe: id => callback => {\r\n//             getOrCreateArrFromObj(storage)(id).push(callback)\r\n//             return () => storage[id] = storage[id].filter(item => item !== callback)\r\n//         },\r\n//         showAll () {\r\n//             const s = {}\r\n//             for (let key in storage) {\r\n//                 s[key] = storage[key].length\r\n//             }\r\n//             console.log(s)\r\n//         },\r\n//     }\r\n// }\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\n\r\n\r\n\r\n\r\n\r\n","let lang = 'en'\r\nexport const changeLang = l => lang = l \r\nexport const createTranslater = vocab => word => (vocab[lang] && vocab[lang][word]) || word\r\n","import { connect } from \"react-redux\";\r\nimport '../stylesheets/Info.css'\r\nimport { createTranslater } from '../../helpers/helper_translate'\r\nimport { INFO_VOC } from '../../constants/default_voc'\r\n\r\n\r\nconst t = createTranslater(INFO_VOC)\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        ...state.controls.infoPanelData,\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(function(props) {\r\n    return ( \r\n        <div className=\"info\">\r\n            <button\r\n                className=\"control butt-infoClose\"\r\n                onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                x\r\n            </button>\r\n            <div className=\"info-inner\">\r\n                <p>{t(props.title)}</p>\r\n                <p>{t(props.topText)}</p>\r\n                <ul>{props.chapters.map((item, index) => \r\n                    <li key={index}>\r\n                        {index + 1}.&nbsp;\r\n                        {item.href \r\n                            ? <span><a href={item.href} target=\"blank\">{t(item.text)}</a></span>\r\n                            : <span>{t(item.text)}</span>}\r\n                        {index === props.currentChapterIndex && t(' (current)')}\r\n                    </li>)\r\n                }</ul>\r\n                <p>{props.bottomText}</p>\r\n                <ul>{props.afterWords.map((item, index) => \r\n                    <li key={index}>\r\n                        {t(item.text)} \r\n                        <a href={item.href} target=\"blank\">{t(item.aText)}</a>\r\n                    </li>)\r\n                }</ul>\r\n            </div>      \r\n        </div>)\r\n})\r\n\r\n","export const INFO_VOC = {\r\n    'ru': {\r\n        'Discovery of small android': ' ',\r\n        'Factory': '',\r\n        'Brige': '',\r\n        'Cube': '',\r\n        'in production': '..',\r\n        ' (current)': ' ()',\r\n        'Author: ': ': ',\r\n        'Github: ': ': '\r\n    }\r\n} ","import { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Info from './Info'\r\nimport '../stylesheets/PlayerControls.css'\r\n\r\n\r\n\r\n\r\n\r\nexport default connect(\r\n    state => ({\r\n            isInfo: state.controls.isInfo,\r\n            isShowControls: state.controls.isShowControls, \r\n    })\r\n)(\r\n    function(props) {\r\n    const [isShowFullScreenButt, changeShowFullScreenButt] = useState(true)\r\n\r\n    useEffect(() =>\r\n        props.gameContext.emitter.subscribe('screenMode')(val => {\r\n            val === 'exitFullScreen' && changeShowFullScreenButt(true) })\r\n    )\r\n\r\n\r\n    return (\r\n        <div className='ui-controls'>\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-left control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n            >\r\n                &#9668;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-right control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n            >\r\n                &#9658;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-front control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n            >\r\n                &#9650;\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-back control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n            >\r\n                &#x25BC;\r\n            </button>}\r\n\r\n\r\n\r\n            {props.isShowControls && isShowFullScreenButt && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        props.gameContext.emitter.emit('mouseDown')('butt-fullscreen')\r\n                        changeShowFullScreenButt(false)\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n            {!props.isInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n            {props.isInfo && <Info />}\r\n        </div>\r\n    )\r\n})\r\n\r\n","import { connect } from 'react-redux'\r\nimport PlayerControls from './PlayerControls'\r\n\r\nconst mapStateToProps = state => ({ \r\n    isShowControls: state.controls.isShowControls,\r\n    isInfo: state.controls.isInfo,\r\n})\r\n\r\nfunction App(props) {\r\n    !dispatcher.dispatch && (dispatcher.dispatch = props.dispatch)\r\n    return (\r\n        <div className=\"ui\">\r\n            {!props.isInfo && props.gameContext.CustomReactComponent && <props.gameContext.CustomReactComponent gameContext={props.gameContext}/>}\r\n            {<PlayerControls gameContext={props.gameContext} />}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport const dispatcher = { dispatch: null }\r\nexport default connect(mapStateToProps)(App);\r\n","export const startDefaultStoreData = {\r\n    isShowControls: true,\r\n    isInfo: false,\r\n    infoPanelData: {\r\n        title: 'Discovery of small android',\r\n        topText: '',\r\n        chapters: [\r\n            { text: 'Factory', href: 'http://js.otrisovano.ru/factory/' },\r\n            { text: 'Brige', href: 'http://js.otrisovano.ru/bridge/' },\r\n            { text: 'Cube', href: 'http://js.otrisovano.ru/levels/' },\r\n            { text: 'in production' },\r\n        ],\r\n        currentChapterIndex: null,\r\n        bottomText: '',\r\n        afterWords: [\r\n            { text: 'Author: ',  aText: 'www.otrisovano.ru', href: 'http://otrisovano.ru' },\r\n            { text: 'Github: ',  aText: 'https://github.com/fire888/dark_boss', href: 'https://github.com/fire888/dark_boss' },\r\n        ],\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport App, { dispatcher } from './containersReact/App';\r\nimport { prepareStore } from './store/createStore'\r\nimport { changeLang } from \"../helpers/helper_translate\";\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n    if (!isAnimateLoader) return;\r\n\r\n    setTimeout(() => {\r\n        offsetLoader ++;\r\n        offsetLoader === 0 && (offsetLoader -= 100)\r\n        loader.style.marginLeft = offsetLoader + '%'\r\n        loaderTimeOut()\r\n    }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport class UI {\r\n    constructor(root) {\r\n        root.dispatcher = dispatcher\r\n        this._root = root\r\n        const store = prepareStore(root)\r\n\r\n\r\n        store && ReactDOM.render(\r\n            <Provider store={store}>\r\n                <App gameContext={root}/>\r\n            </Provider>,\r\n            document.getElementById('root')\r\n        )\r\n    }\r\n\r\n    showStartButton(onClick) {\r\n        const startButtons = document.querySelector('.startbuttons-wrapper')\r\n        const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n        const hideStartScreen = e => {\r\n            e.target.dataset && e.target.dataset.lang && changeLang(e.target.dataset.lang)\r\n            document.querySelector('.start-screen').style.display = 'none'\r\n        }\r\n\r\n        isAnimateLoader = false\r\n        startButtons.style.display = 'flex'\r\n        startButtons.addEventListener('click', e => {\r\n            onClick()\r\n            hideStartScreen(e)\r\n        })\r\n        progressWrapper.style.display = 'none'\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { createStore, applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\n\r\nimport { startDefaultStoreData } from './defaultUiData'\r\n\r\nexport function prepareStore(root) {\r\n    if (!root.customStore) root.customStore = {}\r\n\r\n    const controls = function(state = startDefaultStoreData, action) {\r\n        if (action.type === 'TOGGLE_INFO') {\r\n            return ({\r\n                ...state,\r\n                isShowControls: !!state.isInfo,\r\n                isInfo: !state.isInfo,\r\n            })\r\n        }\r\n        if (action.type === 'CHANGE_INFO_CHAPTER') {\r\n            return ({\r\n                ...state,\r\n                infoPanelData: {\r\n                    ...state.infoPanelData,\r\n                    currentChapterIndex: action.currentChapterIndex,\r\n                }\r\n            })\r\n        }\r\n        return ({ ...state })\r\n    }\r\n    \r\n    const rootReducer = combineReducers({ controls, ...root.customStore })\r\n    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n    return createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n}  \r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { TRANSLATE_WORLDS } from \"../constants/constants_replicies\";\r\nimport * as LIBA from '../../../_CORE/'\r\nconst t = LIBA.createTranslater(TRANSLATE_WORLDS)\r\n\r\n\r\nexport default connect(\r\n    state => { \r\n        return ({\r\n            replicies: state.dialogs.replicies,\r\n            blockPhrases: state.dialogs.replicies[state.dialogs.currentTerminalKey][state.dialogs.currentPhraseIndex],\r\n            currentTerminalKey: state.dialogs.currentTerminalKey,\r\n            currentPhraseIndex: state.dialogs.currentPhraseIndex,\r\n    }) }\r\n)(\r\n    function (props) {\r\n        const message = t(props.blockPhrases.q.txt)\r\n        const filteredAnswers = props.blockPhrases.a.filter(item => item.isShow)\r\n        const replicies = filteredAnswers.map((item, ind) =>\r\n                <button\r\n                    key={ind}\r\n                    onClick={()=>props.dispatch({\r\n                            type: 'CLICK_ON_PLAYER_PHRASE',\r\n                            currentTerminalKey: props.currentTerminalKey,\r\n                            actionKey: item.action,\r\n                            dataAction: item.dataAction || null, \r\n                            phraseIndex: ind, \r\n                        })\r\n                    }>\r\n                    {t(item.txt)}\r\n                </button>)\r\n\r\n        // const arrM = messages.map((item, ind)=> {\r\n        //     if (!item.isDone) return <div key={ind}></div>\r\n        //\r\n        //     return (\r\n        //         <div\r\n        //             key={ind}\r\n        //             className='marTop-small'>\r\n        //             <p className='player'>{t(item.player)}</p>\r\n        //             <p>{t(item.nps)}</p>\r\n        //         </div>)\r\n        // })\r\n        //\r\n        //\r\n        // const arrR = messages.map((item, ind)=> {\r\n        //     if (item.isDone) return <div key={ind}></div>\r\n        //\r\n        //     return (\r\n        //         <button\r\n        //             key={ind}\r\n        //             onClick={()=>props.dispatch({ type: 'CLICK_ON_PLAYER_PHRASE', currentBotKey: props.currentBotKey, phraseIndex: ind, })}>\r\n        //             {t(item.player)}\r\n        //         </button>)\r\n        // })\r\n\r\n\r\n        return (\r\n                <div className=\"messages-wrapper\">\r\n                    <div className=\"messages\">\r\n                        {message}\r\n                    </div>\r\n                    <div className=\"replicies\">\r\n                        {replicies}\r\n                    </div>\r\n                </div>\r\n        )\r\n    }\r\n)","export const REPLICIES_CONFIG = {\r\n    'START_MESS': [{\r\n        q: { txt: 'After a long wandering in the desert...' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'close', },\r\n        ],\r\n    }],\r\n    'TERMINAL_Z01': [{\r\n        q: { txt: 'Stranger, I threw you a terminal with a pass phrase. Remember:' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'And blood-black nothingness began to spin...' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'A system of cells interlinked within cells interlinked within cells interlinked within one stem...' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'And dreadfully distinct against the dark, a tall white fountain played.' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'close', dataAction: { idChangerState: 'openPhrasePROGRAM_00' } },\r\n        ],\r\n    },],\r\n    'TERMINAL_Z': [{\r\n        q: { txt: '' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_Z' } },\r\n        ]\r\n    },],\r\n    'TERMINAL_00': [{\r\n        q: { txt: 'Officer K-D-six-dash-three-dot-seven, let\\'s begin. Ready?' },\r\n        a: [\r\n            { txt: 'Yes, sir.',  isShow: true, action: 'next', },\r\n            { txt: 'No.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_NONE', } },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Recite your baseline.' },\r\n        a: [\r\n            { txt: 'I do not remember.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_NONE', } },\r\n            { txt: 'I\\'ll come back later.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_NONE', } },\r\n            { txt: 'And blood-black nothingness began to spin...', isShow: false, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Cells.' },\r\n        a: [\r\n            { txt: 'Cells.', isShow: true, action: 'startBridge',  dataAction: { keyProgramBridge: 'PROGRAM_00', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_01': [{\r\n        q: { txt: 'Have you ever been in an institution? Cells.' },\r\n        a: [\r\n            { txt: 'Cells.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Do they keep you in a cell? Cells.' },\r\n        a: [\r\n            { txt: 'Cells.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_01', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_02': [{\r\n        q: { txt: 'When you\\'re not performing your duties do they keep you in a little box? Cells.' },\r\n        a: [\r\n            { txt: 'Cells.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_02', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_03': [{\r\n        q: { txt: 'What\\'s it like to hold the hand of someone you love? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'next', idChangerState: null },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Did they teach you how to feel finger to finger? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_03', }},\r\n        ],\r\n    },],\r\n    'TERMINAL_04': [{\r\n        q: { txt: 'Do you long for having your heart interlinked? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Do you dream about being interlinked? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'startBridge',  dataAction: { keyProgramBridge: 'PROGRAM_04', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_05': [{\r\n        q: { txt: 'What\\'s it like to hold your child in your arms? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Do you feel that there\\'s a part of you that\\'s missing? Interlinked.' },\r\n        a: [\r\n            { txt: 'Interlinked.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_05', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_06': [{\r\n        q: { txt: 'Within cells interlinked.' },\r\n        a: [\r\n            { txt: 'Within cells interlinked.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'Why don\\'t you say that three times: Within cells interlinked.' },\r\n        a: [\r\n            { txt: 'Within cells interlinked.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: '' },\r\n        a: [\r\n            { txt: 'Within cells interlinked.', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: '' },\r\n        a: [\r\n            { txt: 'Within cells interlinked.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_06', } },\r\n        ],\r\n    },],\r\n    'TERMINAL_LAST' : [{\r\n        q: { txt: 'We\\'re done... Constant K, you can pick up your bonus.' },\r\n        a: [\r\n            { txt: 'Thank you, sir.', isShow: true, action: 'startBridge', dataAction: { keyProgramBridge: 'PROGRAM_LAST', idChangerState: 'resetAllAfterEnd' }},\r\n            { txt: 'Hey...', isShow: false, action: 'close', },\r\n        ],\r\n    },{\r\n        q: { txt: '...' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'next', },\r\n        ],\r\n    },{\r\n        q: { txt: '... ... ...' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'next', },\r\n        ],\r\n    },{\r\n        q: { txt: '...If you read it, you find dropped terminal and got top level of desert. Welcome...' },\r\n        a: [\r\n            { txt: 'Who are you?', isShow: true, action: 'next', },\r\n        ],\r\n    }, {\r\n        q: { txt: 'It does not matter. Later. May be..' },\r\n        a: [\r\n            { txt: '', isShow: true, action: 'close', dataAction: { idChangerState: 'clearMessagesAfterLastEnd' }},\r\n        ],\r\n    },]\r\n}\r\n\r\n\r\n\r\n\r\nexport const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'After a long wandering in the desert...': '    ...',\r\n        'Stranger, I threw you a terminal with a pass phrase. Remember:': ',       . :',\r\n        'And blood-black nothingness began to spin...': '-     ,',\r\n        'A system of cells interlinked within cells interlinked within cells interlinked within one stem...' : ' , ,  ,      ,',\r\n        'And dreadfully distinct against the dark, a tall white fountain played.': '        .',\r\n        'Officer K-D-six-dash-three-dot-seven, let\\'s begin. Ready?': '   6.3.7. . ?',\r\n        'Yes, sir.': '',\r\n        'No.': ' ',\r\n        'Recite your baseline.': '  .',\r\n        'I do not remember.': ' .',\r\n        'I\\'ll come back later.': '  .',\r\n        'Cells.': '.',\r\n        'Have you ever been in an institution? Cells.': '     ? .',\r\n        'Do they keep you in a cell? Cells.': '   ? .',\r\n        'When you\\'re not performing your duties do they keep you in a little box? Cells.': '    ,    ? .',\r\n        'Interlinked.': '.',\r\n        'What\\'s it like to hold the hand of someone you love? Interlinked.': '        ? .',\r\n        'Did they teach you how to feel finger to finger? Interlinked.': '     ? .',\r\n        'Do you long for having your heart interlinked? Interlinked.': '    - ? .',\r\n        'Do you dream about being interlinked? Interlinked.': '    -? .',\r\n        'What\\'s it like to hold your child in your arms? Interlinked.': '  ,     ? .',\r\n        'Do you feel that there\\'s a part of you that\\'s missing? Interlinked.': ' ,   -  ? .',\r\n        'Within cells interlinked.': '  .',\r\n        'Why don\\'t you say that three times: Within cells interlinked.': '   \"  ',\r\n        'We\\'re done... Constant K, you can pick up your bonus.': '  .  ,    .',\r\n        'Thank you, sir.': ', .',\r\n        '...If you read it, you find dropped terminal and got top level of desert. Welcome...': '...   ,          .',\r\n        'Who are you?': ' ?',\r\n        'It does not matter. Later. May be..': ' . .  ..',\r\n        'Hey...': '...',\r\n    }\r\n}","import { CURRENT_CHAPTER } from '../constants/constants_elements'\r\n\r\nexport const toggleOpenDialog = (dispatch, isToOpen) => {\r\n    const time = isToOpen ? 1300 : 0\r\n    dispatch({\r\n        type: 'TOGGLE_TERMINAL_ANIMATION',\r\n        is: isToOpen\r\n    })\r\n    setTimeout(() => {\r\n        dispatch({\r\n            type: 'SHOW_PALLETE_DIALOG',\r\n            is: isToOpen\r\n        })\r\n    }, time)\r\n}\r\n\r\nexport class AdderActions {\r\n    constructor (_root) {\r\n        const { player, ui, dispatcher, emitter } = _root\r\n\r\n        dispatcher.dispatch({ type: 'CHANGE_INFO_CHAPTER', currentChapterIndex: CURRENT_CHAPTER })\r\n        ui.showStartButton(() => player.toggleBlocked(false))\r\n\r\n        // emitter.subscribe('nearTerminal')(({ isNearTerminal, terminalKey }) => {\r\n        //     dispatcher.dispatch({ type: 'BUTTON_DIALOG_TOGGLE', isButtonDialog: isNearBot, currentBotKey: terminalKey })\r\n        // })\r\n    }\r\n}\r\n","import { connect } from 'react-redux'\r\nimport DialogPallete from \"./DialogPallete\"\r\nimport './stylesheets/CustomReactComponent.css'\r\nimport { VOC } from '../constants/translate'\r\nimport { toggleOpenDialog } from \"../actions/AdderActions\";\r\n\r\nimport { createTranslater } from \"../../../_CORE/helpers/helper_translate\";\r\nconst t = createTranslater(VOC)\r\n\r\n\r\n\r\nconst mapStateToProps = state => {\r\n    return ({\r\n        isButtonDialog: state.dialogs.isButtonDialog,\r\n        isCloseisButtonDialog: state.dialogs.isCloseisButtonDialog,\r\n        isShowPalleteDialog: state.dialogs.isShowPalleteDialog,\r\n    })\r\n}\r\n\r\n\r\n\r\nfunction CustomReactComponent(props) {\r\n    if (!(props.isButtonDialog || props.isShowPalleteDialog)) { \r\n      return <div></div>\r\n    }\r\n\r\n    return (\r\n      <div className=\"dialog-wrapper\">\r\n          <div className=\"dialog-content\">           \r\n            {props.isShowPalleteDialog && <DialogPallete />}\r\n            {(props.isButtonDialog || props.isShowPalleteDialog) && \r\n                  <button \r\n                      className=\"dialog-button-toggle\" \r\n                      onClick={() =>\r\n                          toggleOpenDialog(\r\n                              props.dispatch,\r\n                              (props.isButtonDialog && true) || (props.isShowPalleteDialog && false))\r\n                      }\r\n                      style={{ \"display\": props.display }}>\r\n                      {\r\n                        (props.isButtonDialog && t('open')) ||\r\n                        (props.isShowPalleteDialog && t('close'))\r\n                      }       \r\n                  </button>}\r\n           </div>     \r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(CustomReactComponent)\r\n","export const VOC = {\r\n    'ru': {\r\n        'I ...?': ' ...?', \r\n        'You ...?': ' ...?', \r\n        'MM ...?': ' ...?', \r\n        'You is new droid.': '  .',\r\n        'I am mechanic. I create your body.': '.   .',\r\n        'Go. Door is unblocked.... Beeeb.': ',  .... .',\r\n        'Once .... Beeeb.. I set basic program in your memory.': ' .... ..    .',\r\n        'I am programmer.': ' .',\r\n        'Go. Once... Beeeb.. Door to laboratory unblocked.': '     . ..  .',\r\n        'Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767': '... .   .',\r\n        'I am engineer. I test new droids.': ',   .',\r\n        'Go.': '  .',\r\n        'Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.': '... . ,  ...    _17543-06767-6767.',\r\n        'I am scientist. I check your abilities. ... garbage.': '.   . ',\r\n        'Go to store. Doors unblocked.': '  .  .',\r\n        'I dont know anything, go to the boss. ... Beeeb. You have the accesses.': '   ,   ... . :  .',\r\n        'You want see Boss. He is absent.': ' ,  .',\r\n        'I am guard. I give you a secret mission.':  '.     .',\r\n        'You must see all around base, and return. Doors unblocked.': '        . .',\r\n        'Droid_Id: 17543-06767-6767 with secret mission. I know.': '     .',\r\n        'I am gateman. Beeeb... Door is opened! Good bye!': '   . ...    .',\r\n        'It does not matter.': '   .',\r\n        'I am scout. Crazy factory create droids and close gates. You alone in this desert.': '.    ,      .',\r\n        'This is the end.': ' . The end.',\r\n\r\n        'open': '',\r\n        'close': '',\r\n    },\r\n}\r\n\r\n","import { REPLICIES_CONFIG } from '../constants/constants_replicies'\r\nimport { toggleOpenDialog } from '../actions/AdderActions'\r\n\r\nconst storeStartState = {\r\n    replicies: REPLICIES_CONFIG,\r\n    isCloseisButtonDialog: false,\r\n    isButtonDialog: false,\r\n    isShowPalleteDialog: false,\r\n    currentTerminalKey: null,\r\n    currentPhraseIndex: 0,\r\n    currentLanguage: 'en',\r\n}\r\n\r\n\r\nexport const createCustomStore = root => {\r\n    \r\n    const dialogs = (store = storeStartState, action) => {\r\n        if (action.type === 'BUTTON_DIALOG_TOGGLE') {\r\n            const {  isButtonDialog, currentTerminalKey } = action\r\n            return {\r\n                ...store,\r\n                isButtonDialog,\r\n                currentTerminalKey,\r\n            }\r\n        }\r\n\r\n        if (action.type === 'TOGGLE_TERMINAL_ANIMATION') {\r\n            action.is\r\n                ? root.terminals.openTerminal(store.currentTerminalKey)\r\n                : root.terminals.closeTerminal(store.currentTerminalKey)\r\n        }\r\n\r\n        if (action.type === 'SHOW_PALLETE_DIALOG') {\r\n            root.player.toggleBlocked(action.is)\r\n            return {\r\n                ...store,\r\n                isButtonDialog: !action.is,\r\n                isShowPalleteDialog: action.is,\r\n            }\r\n        }\r\n\r\n        if (action.type === 'CLICK_ON_PLAYER_PHRASE') {\r\n            if (action.actionKey === 'next') {\r\n                return {\r\n                    ...store,\r\n                    currentPhraseIndex: ++store.currentPhraseIndex,\r\n                }\r\n            }\r\n\r\n            if (action.actionKey === 'startBridge') {\r\n                setTimeout(() => toggleOpenDialog(root.dispatcher.dispatch, false))\r\n                if (action.dataAction) {\r\n                    if (action.dataAction.keyProgramBridge) {\r\n                        root.bridge.startProgram(action.dataAction.keyProgramBridge)\r\n                    }  \r\n                    \r\n                    if (action.dataAction.keyProgramBridge === 'PROGRAM_06') {\r\n                        root.level.addTopZone()\r\n                        root.terminals.addLastTerminal()\r\n                    }\r\n\r\n                    if (action.dataAction.idChangerState) { \r\n                        if (action.dataAction.idChangerState === 'resetAllAfterEnd') {\r\n                            const replicies = JSON.parse(JSON.stringify(store.replicies))\r\n                            replicies['TERMINAL_LAST'].splice(0, 1)\r\n                            return ({\r\n                                ...store,\r\n                                replicies,\r\n                                currentPhraseIndex: 0,\r\n                            })    \r\n                        }\r\n                    }\r\n                }\r\n                return {\r\n                    ...store,\r\n                    currentPhraseIndex: 0,\r\n                }\r\n            }\r\n\r\n            if (action.actionKey === 'close') {\r\n                setTimeout(() => toggleOpenDialog(root.dispatcher.dispatch, false))\r\n\r\n                if (action.dataAction && action.dataAction.idChangerState) {\r\n                    if (action.dataAction.idChangerState === 'openPhrasePROGRAM_00') {\r\n                        const replicies = JSON.parse(JSON.stringify(store.replicies))\r\n                        replicies['TERMINAL_00'][1]['a'][2].isShow = true \r\n                        return {\r\n                            ...store,\r\n                            replicies,\r\n                            currentPhraseIndex: 0,\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return {\r\n                    ...store,\r\n                    currentPhraseIndex: 0,\r\n                }\r\n            }\r\n            //const replicies = JSON.parse(JSON.stringify(store.replicies))\r\n\r\n            //replicies[action.currentTerminalKey]\r\n            //\r\n            // /** emit event */\r\n            // if (replicies[action.currentBotKey].messages[action.phraseIndex].event) {\r\n            //     const { type, data } = replicies[action.currentBotKey].messages[action.phraseIndex].event\r\n            //     root.emitter.emit(type)(data)\r\n            // }\r\n            //\r\n            // let isBotDone = true\r\n            // for (let i = 0; i < replicies[action.currentBotKey].messages.length; ++i) {\r\n            //     replicies[action.currentBotKey].messages[i].isDone === false && (isBotDone = false)\r\n            // }\r\n            // replicies[action.currentBotKey].isDone = isBotDone\r\n            \r\n            return ({\r\n                ...store,\r\n            })\r\n        }\r\n\r\n        // if (action.type === 'CLICK_ON_PLAYER_PHRASE') {\r\n        //     const replicies = JSON.parse(JSON.stringify(store.replicies))\r\n        //     replicies[action.currentBotKey].messages[action.phraseIndex].isDone = true\r\n        //\r\n        //     /** emit event */\r\n        //     if (replicies[action.currentBotKey].messages[action.phraseIndex].event) {\r\n        //         const { type, data } = replicies[action.currentBotKey].messages[action.phraseIndex].event\r\n        //         root.emitter.emit(type)(data)\r\n        //     }\r\n        //\r\n        //     let isBotDone = true\r\n        //     for (let i = 0; i < replicies[action.currentBotKey].messages.length; ++i) {\r\n        //         replicies[action.currentBotKey].messages[i].isDone === false && (isBotDone = false)\r\n        //     }\r\n        //     replicies[action.currentBotKey].isDone = isBotDone\r\n        //\r\n        //     return ({\r\n        //         ...store,\r\n        //         replicies,\r\n        //         isCloseisButtonDialog: isBotDone,\r\n        //     })\r\n        // }\r\n\r\n        return store\r\n    }\r\n\r\n\r\n    return { \r\n        dialogs \r\n    }\r\n}\r\n\r\n\r\n\r\n/*\r\nconst storeStartState = {\r\n    replicies: {\r\n        mechanic: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'You is new droid.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am mechanic. I create your body.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'Go. Door is unblocked.... Beeeb.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['factory'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        programmer: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'Once .... Beeeb.. I set basic program in your memory.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am programmer.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'Go. Once... Beeeb.. Door to laboratory unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromLaboratory001'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        engineer: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am engineer. I test new droids.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'Go.',\r\n                isDone: false,\r\n            }]\r\n        },\r\n        scientist: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am scientist. I check your abilities. ... garbage.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'Go to store. Doors unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromFactoryCorpus', 'toLab', 'toGarage'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        master: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'I dont know anything, go to the boss. ... Beeeb. You have the accesses.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['toBoss'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        guard_Super_02: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'You want see Boss. He is absent.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am guard. I give you a secret mission.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'You must see all around base, and return. Doors unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromStore', 'fromSecurity', 'toArsenal',],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        guard_01: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'Droid_Id: 17543-06767-6767 with secret mission. I know.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am gateman. Beeeb... Door is opened! Good bye!',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['toWorld',],\r\n                    }\r\n                }\r\n            },]\r\n        },\r\n        scout: {\r\n            isDone: false,\r\n            messages: [{\r\n                player: 'I ...?',\r\n                nps: 'It does not matter.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'blockDoor',\r\n                    data: {\r\n                        idDoor: ['toWorld',],\r\n                    }\r\n                }\r\n            },{\r\n                player: 'You ...?',\r\n                nps: 'I am scout. Crazy factory create droids and close gates. You alone in this desert.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?',\r\n                nps: 'This is the end.',\r\n                isDone: false,\r\n            },]\r\n        },\r\n    },\r\n    isCloseisButtonDialog: false,\r\n    isButtonDialog: false,\r\n    isShowPalleteDialog: false,\r\n    currentBotKey: null,\r\n    currentLanguage: 'en',\r\n}\r\n\r\n*/\r\n\r\n\r\n\r\n","export const Saturate = {\r\nuniforms: {\r\n\"tDiffuse\": { value: null },\r\n},\r\n\r\n\r\nvertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\nfragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\n\r\n\r\n\r\nexport class Studio {\r\n    constructor(root) {\r\n        this._root = root\r\n        const { assets, emitter, } = root\r\n        const { canId, rendererCon, clearColor, amb } = root.CONSTANTS.studioConfig\r\n\r\n        rendererCon.canvas = document.getElementById(canId)\r\n\r\n        this._renderer = new THREE.WebGLRenderer(rendererCon)\r\n        this._renderer.setClearColor(clearColor)\r\n        this._renderer.setPixelRatio(window.devicePixelRatio)\r\n        this._renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        this._scene = new THREE.Scene()\r\n\r\n        {\r\n            const { color, fogNear, fogFar, backgroundImgKey } = root.CONSTANTS.studioConfig.sceneEnvironment\r\n            this._scene.background = assets[backgroundImgKey] || null\r\n            this._scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n        }\r\n\r\n\r\n        this._lightA = null\r\n        {\r\n            const { color, strength } = amb\r\n            this._lightA = new THREE.AmbientLight( color, strength )\r\n            this._scene.add( this._lightA )\r\n        }\r\n\r\n        this._camera = null\r\n\r\n\r\n        this._composer = new EffectComposer(this._renderer)\r\n        //this._composer.addPass(new RenderPass(this._scene, this._camera))\r\n\r\n\r\n\r\n        const resize = () => {\r\n            const size = { width: window.innerWidth, height: window.innerHeight }\r\n            this._renderer.setSize(size.width, size.height)\r\n            this._composer.setSize(size.width, size.height)\r\n            if (this._camera) {\r\n                this._camera.aspect = size.width/size.height\r\n                this._camera.updateProjectionMatrix()\r\n            }\r\n        }\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n\r\n\r\n\r\n\r\n        this.addToScene = this._scene.add.bind(this._scene)\r\n        const drawFrame = () => this._camera && this._composer.render(this._scene, this._camera)\r\n        emitter.subscribe('frameUpdate')(drawFrame)\r\n\r\n\r\n\r\n        this._backgroundImgKey = root.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey\r\n\r\n\r\n\r\n        emitter.subscribe('changeSceneEnvironment')(sceneEnvironment => {\r\n            console.log('deprecated!!', 'studio', 'changeSceneEnvironment', sceneEnvironment)\r\n        })\r\n    \r\n    }\r\n\r\n\r\n    /** PUBLIC ****************************************/\r\n\r\n    setCamera (cam) {\r\n        this._camera = cam\r\n        this._composer.addPass(new RenderPass(this._scene, this._camera))\r\n        \r\n        if (!this._root.CONSTANTS.studioConfig.composerAddPass) return; \r\n        \r\n        if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate') {\r\n            this._composer.addPass(new ShaderPass(Saturate))\r\n        }  \r\n    }\r\n\r\n    changeEnvironment (sceneEnvironment) {\r\n        this._changeFog(sceneEnvironment)\r\n        this._changeBackground(sceneEnvironment)\r\n    }\r\n\r\n\r\n    /** INTERNAL ****************************************/\r\n\r\n    _changeFog (sceneEnvironment) {\r\n        const { fogNear, fogFar, color } = sceneEnvironment\r\n        if (\r\n            this._scene.fog.near !== fogNear ||\r\n            this._scene.fog.far !== fogFar ||\r\n            this._scene.fog.color !== fogFar\r\n        ) {\r\n            const startData = {\r\n                color: this._scene.fog.color,\r\n                near: this._scene.fog.near,\r\n                far: this._scene.fog.far,\r\n            }\r\n            const endData = {\r\n                color: new THREE.Color(color),\r\n                near: fogNear,\r\n                far: fogFar,\r\n            }\r\n\r\n            new TWEEN.Tween(startData)\r\n                .to(endData, 3000)\r\n                .onUpdate(() => {\r\n                    this._scene.fog.color = startData.color\r\n                    this._scene.fog.near = startData.near\r\n                    this._scene.fog.far = startData.far\r\n                    this._lightA.color = startData.color\r\n                    this._renderer.setClearColor(startData.color)\r\n                })\r\n                .start()\r\n        }\r\n\r\n    }\r\n\r\n\r\n    _changeBackground (sceneEnvironment) {\r\n        const { backgroundImgKey } = sceneEnvironment\r\n\r\n        if (backgroundImgKey !== this._backgroundImgKey) {\r\n            this._backgroundImgKey = backgroundImgKey\r\n            this._scene.background = this._root.assets[backgroundImgKey] || null\r\n        }\r\n    }\r\n}\r\n\r\n","\r\nexport class KeyBoard {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const keys = {\r\n            'up': false,\r\n            'down': false,\r\n            'left': false,\r\n            'right': false,\r\n        }\r\n\r\n        const keysEnabled = {\r\n            'up': true,\r\n            'down': true,\r\n            'left': true,\r\n            'right': true,\r\n        }\r\n\r\n        this.keysEnabled = keysEnabled\r\n        this.keys = keys\r\n\r\n\r\n        const keyUpdate = function ( keyCode, isDown ) {\r\n            switch( keyCode ) {\r\n                case 38:\r\n                case 87:\r\n                    keysEnabled['up'] && (keys['up'] = isDown)\r\n                    break\r\n                case 40:\r\n                case 83:\r\n                    keysEnabled['down'] && (keys['down'] = isDown)\r\n                    break\r\n                case 37:\r\n                case 65:\r\n                    keys['left'] = isDown\r\n                    break\r\n                case 39:\r\n                case 68:\r\n                    keys['right'] = isDown\r\n                    break\r\n                default:\r\n                    break\r\n\r\n            }\r\n            emitter.emit('keyEvent')(keys)\r\n        }\r\n\r\n\r\n\r\n        document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n        document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, true)\r\n            if (key === 'butt-right') keyUpdate(39, true)\r\n            if (key === 'butt-front') keyUpdate(38, true)\r\n            if (key === 'butt-back') keyUpdate(40, true)\r\n        })\r\n        emitter.subscribe('mouseUp')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, false)\r\n            if (key === 'butt-right') keyUpdate(39, false)\r\n            if (key === 'butt-front') keyUpdate(38, false)\r\n            if (key === 'butt-back') keyUpdate(40, false)\r\n        })\r\n    }\r\n\r\n    toggleEnableKeys (key, is) {\r\n        this.keysEnabled[key] = is\r\n        !is && (this.keys[key] = false)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\nexport class Player {\r\n    constructor (root) {\r\n        this._root = root\r\n\r\n        const { emitter, studio, CONSTANTS } = root\r\n\r\n        const {\r\n            startPos,\r\n            startRot,\r\n            cameraData,\r\n            frontObjPos,\r\n            backObjPos,\r\n            lightDataOne,\r\n            speed,\r\n            offsetFromFloor,\r\n            offsetFromFloorFactor,\r\n            offsetWallCollision,\r\n            speedDown,\r\n            speedRot,\r\n        } = CONSTANTS.playerConfig\r\n\r\n\r\n        this._camera = null\r\n        let keys = {}\r\n        let isButtonsDisabled = false\r\n        this._isBlocked = true\r\n        this._isCanMove = {\r\n            'up': true,\r\n            'down': true,\r\n        }\r\n\r\n        this._mainObj = new THREE.Object3D()\r\n        this._mainObj.position.fromArray(startPos)\r\n        this._mainObj.rotation.fromArray(startRot)\r\n        this._mainObj.userData.type = 'player'\r\n\r\n        const bottomObj = new THREE.Object3D() \r\n        bottomObj.position.fromArray([0, -.05, 0])\r\n        this._mainObj.add(bottomObj)\r\n\r\n        const frontObj = new THREE.Object3D()\r\n        frontObj.position.fromArray(frontObjPos)\r\n        this._mainObj.add(frontObj)\r\n        this.frontObj = frontObj\r\n\r\n        const backObj = new THREE.Object3D()\r\n        backObj.position.fromArray(backObjPos)\r\n        this._mainObj.add(backObj)\r\n        this.backObj = backObj\r\n\r\n        {\r\n            const { fov, ratio, near, far, pos } = cameraData\r\n            this._camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n            this._camera.position.fromArray(pos)\r\n            this._mainObj.add(this._camera)\r\n        }\r\n\r\n        {\r\n            const { color, strenth, pos } = lightDataOne\r\n            const light = new THREE.PointLight(color, strenth)\r\n            light.position.fromArray(pos)\r\n            this._mainObj.add(light)\r\n        }\r\n\r\n\r\n        const update = data => {\r\n            if (isButtonsDisabled) return;\r\n\r\n            keys['left'] && (this._mainObj.rotation.y += (speedRot * data.count))\r\n            keys['right'] && (this._mainObj.rotation.y -= (speedRot * data.count))\r\n\r\n\r\n            if (this._isBlocked) return;\r\n\r\n            /** check bottom floors */\r\n            if (this._root.systemCollisionFloor) {\r\n                const [\r\n                    isBlockedByItem, \r\n                    offset,\r\n                    point, \r\n                ] = this._root.systemCollisionFloor.checkCollisions(this._mainObj, bottomObj, offsetFromFloor)\r\n                \r\n                if (!isBlockedByItem) {\r\n                    this._mainObj.position.y += speedDown\r\n                } else {\r\n                    if (offset < (offsetFromFloor - offsetFromFloorFactor))  {\r\n                        this._mainObj.position.y = point.y + offsetFromFloor\r\n                    }                        \r\n                }\r\n            }\r\n\r\n\r\n            if (!keys) return;\r\n\r\n            if (keys['up']) {\r\n                if (!this._isCanMove['up']) return;\r\n\r\n                if (this._root.systemCollisionItems) {\r\n                    const [ isBlockedByItem ] \r\n                        = this._root.systemCollisionItems.checkCollisions(this._mainObj, frontObj, offsetWallCollision)\r\n                    if (isBlockedByItem) return;\r\n                }\r\n\r\n                this._mainObj.translateZ(-speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'up' })\r\n            }\r\n\r\n            if (keys['down']) {\r\n                if (!this._isCanMove['down']) return;\r\n\r\n                if (this._root.systemCollisionItems) {\r\n                    const [ isBlockedByItem ] \r\n                        = this._root.systemCollisionItems.checkCollisions(this._mainObj, backObj, offsetWallCollision)\r\n                    if (isBlockedByItem) return;\r\n                }\r\n\r\n                this._mainObj.translateZ(speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'down' })\r\n            }\r\n        }\r\n\r\n\r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        emitter.subscribe('frameUpdate')(update)\r\n        emitter.subscribe('toggleDialog')(val => isButtonsDisabled = val.isOpen)\r\n\r\n\r\n        studio.setCamera(this._camera)\r\n        studio.addToScene(this._mainObj)\r\n    }\r\n\r\n    toggleBlocked (val) {\r\n        this._isBlocked = val\r\n    }\r\n\r\n    toggleCanMove(key, val) {\r\n        this._isCanMove[key] = val\r\n    }\r\n\r\n    getObj () {\r\n        return this._mainObj\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n    \r\n    setToPos (x, y, z) {\r\n        this._mainObj.position.set(x, y, z)\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\n\r\nexport class SystemCollisionWithItems {\r\n    constructor(root) {\r\n        this._root = root\r\n        this._arrMeshes = []\r\n\r\n\r\n        this._vecStart = new THREE.Vector3()\r\n        this._vecDir = new THREE.Vector3()\r\n        this._rayCaster = new THREE.Raycaster(this._vecStart, this._vecDir)\r\n    }\r\n\r\n    setItemToCollision ({\r\n        mesh,\r\n        itemKeyEmitCollision = null,\r\n        isStopUnits = true\r\n    }) {\r\n        mesh.userData.itemKeyEmitCollision = itemKeyEmitCollision\r\n        mesh.userData.isStopUnits = isStopUnits\r\n        this._arrMeshes.push(mesh)\r\n    }\r\n\r\n\r\n    removeItemFromCollision(mesh) {\r\n        this._arrMeshes = this._arrMeshes.filter(item => item !== mesh)\r\n    }\r\n\r\n\r\n    checkCollisions (objFrom, objTo, d) {\r\n        objFrom.getWorldPosition(this._vecStart)\r\n        objTo.getWorldPosition(this._vecDir)\r\n\r\n        this._vecDir.sub(this._vecStart)\r\n\r\n        const intersects = this._rayCaster.intersectObjects(this._arrMeshes)\r\n\r\n        if (intersects[0]) {\r\n            if (intersects[0].distance < d) {\r\n                if (intersects[0].object.userData.itemKeyEmitCollision) {\r\n                    this._root.emitter.emit('collision')({ \r\n                        ...intersects[0].object.userData.itemKeyEmitCollision, \r\n                        type2: objFrom.userData.type \r\n                    })\r\n                }\r\n\r\n                if (intersects[0].object.userData.isStopUnits) {\r\n                    return [ true, intersects[0].distance, intersects[0].point ]\r\n                }\r\n            }\r\n        }\r\n\r\n        return [ false, null ]\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nexport class Helper_MaterialsLib {\r\n    constructor (gameContext) {\r\n        const { assets, CONSTANTS } = gameContext\r\n\r\n        gameContext.materials = createMaterials(assets, CONSTANTS.MATERIALS_CONFIG)\r\n    }\r\n}\r\n\r\n\r\nconst createMaterials = (assets, MATERIALS_CONFIG) => {\r\n    for (let key in assets)\r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}","export default __webpack_public_path__ + \"static/media/px.f5c4aa0c.jpg\";","export default __webpack_public_path__ + \"static/media/nx.121dfe88.jpg\";","export default __webpack_public_path__ + \"static/media/py.bf62827d.jpg\";","export default __webpack_public_path__ + \"static/media/ny.c0e82362.jpg\";","export default __webpack_public_path__ + \"static/media/pz.4045bfc4.jpg\";","export default __webpack_public_path__ + \"static/media/nz.8051e1ef.jpg\";","export default __webpack_public_path__ + \"static/media/level.1777a63d.obj\";","import * as THREE from \"three\";\r\n\r\nexport class SystemLevel {\r\n    constructor (root) {\r\n        this.root = root\r\n\r\n        const { \r\n            assets, \r\n            materials, \r\n            studio, \r\n            systemCollisionItems,\r\n            systemCollisionFloor,\r\n        } = root\r\n\r\n        const {\r\n            offsetFromFloor,\r\n        } = root.CONSTANTS.playerConfig\r\n\r\n    \r\n    \r\n        this._topLevel = null\r\n        \r\n        assets['level-rooms'].traverse(child => {\r\n            if (child.name.includes(\"room_\")) {\r\n                studio.addToScene(new THREE.Mesh(child.geometry, materials.wall))\r\n            }\r\n\r\n            if (child.name.includes(\"topworld_\")) {\r\n                this._topLevel = new THREE.Mesh(child.geometry, materials.wall)\r\n            }\r\n        })\r\n\r\n\r\n        assets['level-rooms'].traverse(child => {\r\n            child.name === \"wall_collision\" \r\n                && systemCollisionItems\r\n                    && systemCollisionItems.setItemToCollision({\r\n                            mesh: new THREE.Mesh(child.geometry, materials.easyMaterial),\r\n                            dist: 5,\r\n                            isStopUnits: true\r\n                        })\r\n            child.name === \"room_\"\r\n                && systemCollisionFloor     \r\n                    && systemCollisionFloor.setItemToCollision({ \r\n                        mesh: new THREE.Mesh(child.geometry, materials.easyMaterial), \r\n                        dist: offsetFromFloor,\r\n                        isStopUnits: true,\r\n                    })\r\n\r\n            if (child.name.includes(\"topworld_\")) {\r\n                systemCollisionFloor     \r\n                    && systemCollisionFloor.setItemToCollision({ \r\n                        mesh: new THREE.Mesh(child.geometry, materials.easyMaterial), \r\n                        dist: offsetFromFloor,\r\n                        isStopUnits: true,\r\n                    })\r\n            }        \r\n        })\r\n    }\r\n\r\n\r\n    addTopZone () {\r\n        console.log('ADD TOP ZONE')\r\n        this.root.studio.addToScene(this._topLevel)\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/terminal.38a626b1.glb\";","import * as THREE from 'three'\r\nimport { GLTFCopy } from '../../../_CORE/helpers/helper_GLTFcopy'\r\n\r\n\r\n\r\nexport const createModelTerminal = (model, config, emitter) => {\r\n    const copy = GLTFCopy(model)\r\n    const mesh = copy.scene.children[0]\r\n    const animations = copy.animations\r\n    const mixer = new THREE.AnimationMixer(mesh)\r\n    mixer.timeScale = 1.7\r\n    const mixerUpdate = data => mixer.update(data.delta)\r\n    const openAction = mixer.clipAction(animations[0])\r\n    openAction.loop = THREE.LoopOnce\r\n\r\n    const { r, angle, angleZ, angleY, y, terminalKey } = config\r\n    mesh.position.set(Math.sin(angle) * r, y, Math.cos(angle) *  r)\r\n    mesh.rotation.set(0, angleY || angle, angleZ || 0)\r\n    mesh.userData.terminalKey = terminalKey\r\n\r\n\r\n    const startOpen = () => {\r\n        const stopUpdate = emitter.subscribe('frameUpdate')(mixerUpdate)\r\n\r\n        openAction.reset()\r\n        mixer.timeScale = 1.7\r\n        openAction.play()\r\n\r\n        return new Promise(resolve => {\r\n            setTimeout(() => {\r\n                stopUpdate()\r\n                openAction.paused = true\r\n                resolve()\r\n            }, 1100)\r\n        })\r\n    }\r\n\r\n\r\n    const startClose = () => {\r\n        const stopUpdate = emitter.subscribe('frameUpdate')(mixerUpdate)\r\n\r\n        mixer.timeScale = -1.7\r\n        openAction.paused = false\r\n\r\n        return new Promise(resolve => {\r\n            setTimeout(() => {\r\n                stopUpdate()\r\n                resolve()\r\n            }, 1100)\r\n        })\r\n    }\r\n\r\n\r\n    return {\r\n        startOpen,\r\n        startClose,\r\n        mesh,\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport const GLTFCopy = gltf => {\r\n    const clone = {\r\n          animations: gltf.animations,\r\n          scene: gltf.scene.clone(true)\r\n    };\r\n  \r\n    const skinnedMeshes = {};\r\n  \r\n    gltf.scene.traverse(node => {\r\n        if (node.isSkinnedMesh) {\r\n            skinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    const cloneBones = {};\r\n    const cloneSkinnedMeshes = {};\r\n  \r\n    clone.scene.traverse(node => {\r\n        if (node.isBone) {\r\n            cloneBones[node.name] = node;\r\n        }\r\n  \r\n        if (node.isSkinnedMesh) {\r\n            cloneSkinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    for (let name in skinnedMeshes) {\r\n        const skinnedMesh = skinnedMeshes[name];\r\n        const skeleton = skinnedMesh.skeleton;\r\n        const cloneSkinnedMesh = cloneSkinnedMeshes[name];\r\n  \r\n        const orderedCloneBones = [];\r\n  \r\n        for (let i = 0; i < skeleton.bones.length; ++i) {\r\n            const cloneBone = cloneBones[skeleton.bones[i].name];\r\n            orderedCloneBones.push(cloneBone);\r\n        }\r\n  \r\n        cloneSkinnedMesh.bind(\r\n            new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses),\r\n            cloneSkinnedMesh.matrixWorld);\r\n    }\r\n  \r\n    return clone;\r\n}","import * as THREE from \"three\";\r\nimport { createModelTerminal } from '../entities/Terminal'\r\n\r\nexport class SystemTerminals {\r\n    constructor (root) {\r\n        const {\r\n            //materials,\r\n            assets,\r\n            studio,\r\n            emitter,\r\n        } = root\r\n\r\n        const {\r\n            LAST_TERMINAL_CONFIG,\r\n            TERMINALS_CONFIG,\r\n        } = root.CONSTANTS\r\n\r\n        this.terminals = {}\r\n\r\n        const createTerminal = config => {\r\n            const terminal = createModelTerminal(assets['terminal'], config, emitter)\r\n            terminal.mesh.userData.inScene = true\r\n            terminal.mesh.userData.key = config.terminalKey\r\n            studio.addToScene(terminal.mesh)\r\n            this.terminals[config.terminalKey] = terminal\r\n        }\r\n\r\n        for (let i = 0; i < TERMINALS_CONFIG.length; i ++) createTerminal(TERMINALS_CONFIG[i])\r\n        \r\n        createTerminal(LAST_TERMINAL_CONFIG)\r\n        this.terminals['TERMINAL_LAST'].mesh.visible = false\r\n\r\n        //emitter.subscribe('toggleTerminal')(data => {\r\n            // if (!this.terminals[data.terminalKey]) return;\r\n            //\r\n            // data.isOpen\r\n            //     ? this.terminals[data.terminalKey].startOpen()\r\n            //     : this.terminals[data.terminalKey].startClose()\r\n\r\n            //data.terminalKey === 'TERMINAL_06' && !data.isOpen && createTerminal(LAST_TERMINAL_CONFIG)\r\n        //})\r\n    }\r\n\r\n    openTerminal (key) {\r\n        this.terminals[key].startOpen()\r\n    }\r\n\r\n    closeTerminal (key) {\r\n        this.terminals[key].startClose()\r\n    }\r\n\r\n    addLastTerminal () {\r\n        this.terminals['TERMINAL_LAST'].mesh.visible = true\r\n    }\r\n}\r\n\r\n// import { createModelTerminal } from './component_modelTerminal'\r\n// import { TERMINALS_CONFIG, LAST_TERMINAL_CONFIG } from './constants_elements'\r\n//\r\n//\r\n//\r\n// export function createSystemTerminals (model, emitter, addToScene, addItemToNearChecker) {\r\n//     const terminals = {}\r\n//\r\n//     const createTerminal = config => {\r\n//         const terminal = createModelTerminal(model, config, emitter)\r\n//         terminals[config.terminalKey] = terminal\r\n//         addToScene(terminal.mesh)\r\n//         addItemToNearChecker(terminal.mesh)\r\n//     }\r\n//\r\n//     for (let i = 0; i < TERMINALS_CONFIG.length; i ++) createTerminal(TERMINALS_CONFIG[i])\r\n//\r\n//     emitter.subscribe('toggleTerminal')(data => {\r\n//         if (!terminals[data.terminalKey]) return;\r\n//\r\n//         data.isOpen\r\n//             ? terminals[data.terminalKey].startOpen()\r\n//             : terminals[data.terminalKey].startClose()\r\n//\r\n//         data.terminalKey === 'TERMINAL_06' && !data.isOpen && createTerminal(LAST_TERMINAL_CONFIG)\r\n//     })\r\n// }\r\n\r\n","import * as THREE from \"three\";\r\n\r\n\r\nexport class SystemCheckerNearItem {\r\n    constructor() {\r\n        this._itemWorldPos = new THREE.Vector3()\r\n        this._mainCheckerWorldPos = new THREE.Vector3()\r\n\r\n        this._arr = []\r\n    }\r\n\r\n\r\n    setItemToCheck (mesh) {\r\n        this._arr.push(mesh)\r\n    }\r\n\r\n    checkNear (mainMesh, dist) {\r\n        mainMesh.getWorldPosition(this._mainCheckerWorldPos)\r\n\r\n        for (let i = 0; i < this._arr.length; ++i) {\r\n            if (!this._arr[i].userData.inScene) continue;\r\n\r\n            this._arr[i].getWorldPosition(this._itemWorldPos)\r\n            const distance = this._itemWorldPos.distanceTo(this._mainCheckerWorldPos)\r\n            if (distance < dist) {\r\n                return [true, this._arr[i].userData]\r\n            }\r\n        }\r\n\r\n        return [ false, null ]\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\nexport function createBridgeMesh (material) {\r\n    const geom = new THREE.BoxGeometry(3, 2, 3)\r\n    const mesh = new THREE.Mesh(geom, material)\r\n    mesh.name = 'roomBridge'\r\n\r\n    const changeMesh = params => updateMesh(params, mesh)\r\n\r\n    return {\r\n        changeMesh,\r\n        mesh,\r\n    }\r\n}\r\n\r\n\r\n\r\nconst updateMesh = (data, mesh) => {\r\n    mesh.geometry.dispose()\r\n    mesh.geometry = createGeom(data)\r\n    mesh.geometry.needsUpdate = true\r\n\r\n    mesh.position.set(data.x, data.y, data.z)\r\n    mesh.rotation.y = data.rotate + (Math.PI/2 * (1 - data.strengthTwist))\r\n}\r\n\r\n\r\n\r\nconst createGeom = data => {\r\n    const pointsPath = createPointsPath(data)\r\n    const pointsCarcass = createPointsCarcass(pointsPath, data)\r\n    return createGeomFromPoints(pointsCarcass)\r\n}\r\n\r\n\r\n\r\n/**\r\n *         *\r\n *         |\r\n *         |\r\n *         *\r\n *         |\r\n *         |\r\n *         *\r\n */\r\nfunction createPointsPath (data) {\r\n    const {\r\n        count,\r\n        twist,\r\n        radius,\r\n        height,\r\n        strengthTwist,\r\n    } = data\r\n\r\n    const points = []\r\n    for (let i = 0; i < count; i ++) {\r\n        const phase = i / count\r\n\r\n        const d = (radius * 2) * phase * (1 - strengthTwist)\r\n        const twistPoint = twist * phase * strengthTwist\r\n\r\n        const x = Math.sin(twistPoint) * radius + d - (radius * (1 - strengthTwist))\r\n        const y = phase * height\r\n        const z = Math.cos(twistPoint) * radius - (radius * (1 - strengthTwist))\r\n\r\n        points.push({ x, y, z, twistPoint })\r\n    }\r\n    return points\r\n}\r\n\r\n\r\n\r\n/**\r\n *           *--------*\r\n *          /        /\r\n *         *---*----*\r\n *             |\r\n *           *-|-----*\r\n *          /  |    /\r\n *         *---*---*\r\n *             |\r\n *           *-|------*\r\n *          /  |    /\r\n *         *---*---*\r\n */\r\nfunction createPointsCarcass (points, data) {\r\n    const h = data['floor']\r\n    const w = data['width']\r\n\r\n    const p = []\r\n    for (let i = 0; i < points.length; i ++) {\r\n        const { x, y , z, twistPoint } = points[i]\r\n\r\n        const xW = Math.sin(twistPoint) * w\r\n        const zW = Math.cos(twistPoint) * w\r\n\r\n        p.push([\r\n            [x + xW, y, z + zW],\r\n            [x + xW, y + h, z + zW],\r\n            [x - xW, y + h, z - zW],\r\n            [x - xW, y, z - zW],\r\n        ])\r\n    }\r\n    return p\r\n}\r\n\r\n\r\n\r\n/**\r\n *       p[i-2][2]                 p[i-1][2]         p[i][2]\r\n *            *--------------------*------------ *\r\n *           /|                  / |            /|\r\n * p[i-2][1]/ |      p[i-1][1]  /  |   p[i][2] / |\r\n *         *-------------------*--------------*  |\r\n *         |  * ---------------|---*----------|-* p[i][3]\r\n *         | / p[i-2][3]       |  /           | /\r\n *         |/                  | /            |/\r\n *         *-------------------*--------------*\r\n *     p[i-2][0]               p[i-1][0]       p[i][0]\r\n */\r\nconst createGeomFromPoints = data => {\r\n    const points = data\r\n    \r\n    const vertices = [] \r\n    for (let i = 1; i < points.length - 1; i += 2) {\r\n        vertices.push(\r\n\r\n            /** bottom first */\r\n            points[i-1][0][0], points[i-1][0][1], points[i-1][0][2],\r\n            points[i][0][0], points[i][0][1], points[i][0][2],\r\n            points[i][3][0], points[i][3][1], points[i][3][2],\r\n\r\n            points[i-1][0][0], points[i-1][0][1], points[i-1][0][2],\r\n            points[i][3][0], points[i][3][1], points[i][3][2],\r\n            points[i-1][3][0], points[i-1][3][1], points[i-1][3][2],\r\n\r\n            /** left */\r\n\r\n            points[i-1][0][0], points[i-1][0][1], points[i-1][0][2],\r\n            points[i][0][0], points[i][0][1], points[i][0][2],\r\n            points[i][1][0], points[i][1][1], points[i][1][2],\r\n\r\n            points[i-1][0][0], points[i-1][0][1], points[i-1][0][2],\r\n            points[i][1][0], points[i][1][1], points[i][1][2],\r\n            points[i-1][1][0], points[i-1][1][1], points[i-1][1][2],\r\n\r\n\r\n            /** right */\r\n\r\n            points[i][3][0], points[i][3][1], points[i][3][2],\r\n            points[i-1][3][0], points[i-1][3][1], points[i-1][3][2],\r\n            points[i-1][2][0], points[i-1][2][1], points[i-1][2][2],\r\n\r\n            points[i][3][0], points[i][3][1], points[i][3][2],\r\n            points[i-1][2][0], points[i-1][2][1], points[i-1][2][2],\r\n            points[i][2][0], points[i][2][1], points[i][2][2],\r\n\r\n\r\n            /** top */\r\n\r\n            points[i-1][1][0], points[i-1][1][1], points[i-1][1][2],\r\n            points[i][1][0], points[i][1][1], points[i][1][2],\r\n            points[i][2][0], points[i][2][1], points[i][2][2],\r\n\r\n            points[i-1][1][0], points[i-1][1][1], points[i-1][1][2],\r\n            points[i][2][0], points[i][2][1], points[i][2][2],\r\n            points[i-1][2][0], points[i-1][2][1], points[i-1][2][2],\r\n\r\n\r\n            /** bottom second */\r\n\r\n            points[i][0][0], points[i][0][1], points[i][0][2],\r\n            points[i+1][0][0], points[i+1][0][1], points[i+1][0][2],\r\n            points[i+1][3][0], points[i+1][3][1], points[i+1][3][2],\r\n\r\n            points[i][0][0], points[i][0][1], points[i][0][2],\r\n            points[i+1][3][0], points[i+1][3][1], points[i+1][3][2],\r\n            points[i][3][0], points[i][3][1], points[i][3][2],\r\n\r\n\r\n        )\r\n    }    \r\n\r\n    const arr = new Float32Array(vertices)\r\n    const geometry = new THREE.BufferGeometry()\r\n    geometry.setAttribute( 'position', new THREE.BufferAttribute( arr, 3 ) );\r\n    geometry.computeVertexNormals()\r\n    geometry.computeBoundingSphere();\r\n\r\n    return geometry\r\n}","import { createBridgeMesh } from './BridgeMesh'\r\nimport gsap from 'gsap'\r\n\r\n\r\n\r\nexport function createBridge (material) {\r\n    const setPose = state => {\r\n        currentState = state\r\n        bridge.changeMesh(state)\r\n    }\r\n\r\n\r\n    const startProgram = program => {\r\n        return new Promise(resolve => {\r\n            doMarathonAnimations(currentState, program, bridge.changeMesh)\r\n                .then(newState => {\r\n                    currentState = newState\r\n                    resolve()\r\n                })\r\n        })\r\n    }\r\n\r\n\r\n    let currentState = null\r\n    const bridge = createBridgeMesh(material)\r\n\r\n\r\n    return {\r\n        mesh: bridge.mesh,\r\n        setPose,\r\n        startProgram,\r\n    }\r\n}\r\n\r\n\r\n\r\nconst doMarathonAnimations = (currentState, arrStates, action) => {\r\n    return new Promise(resolve => {\r\n        const doNextAnimation = index => {\r\n            const newState = arrStates[index]\r\n\r\n            const obj = { val: 0 }\r\n\r\n            const onUpdate = () => {\r\n                const middleState = {}\r\n                for (let key in currentState)\r\n                    middleState[key] = currentState[key] + (newState[key] - currentState[key]) * obj.val\r\n\r\n                action(middleState)\r\n            }\r\n\r\n            const onComplete = () => {\r\n                currentState = newState\r\n                index ++\r\n                arrStates[index] ? doNextAnimation(index) : resolve(currentState)\r\n            }\r\n\r\n            gsap.to( obj, { duration: newState.time * 0.001, val: 1, ease: \"none\", onUpdate, onComplete })\r\n        }\r\n\r\n        doNextAnimation(0)\r\n    })\r\n}","import { LoaderAssets } from '../../../_CORE/helpers/helper_LoadAssets'\r\nimport { EventEmitter } from \"../../../_CORE/helpers/helper_Emitter\"\r\nimport { CustomUi } from '../ui/Ui'\r\nimport { DeviceResizer } from \"../../../_CORE/helpers/helper_DeviceResizer\"\r\nimport { FrameUpdater } from \"../../../_CORE/helpers/helper_FrameUpater\"\r\nimport { Helper_TweenUpdater } from \"../../../_CORE/helpers/helper_TweenUpdater\"\r\nimport { Studio } from '../../../_CORE/entities/createStudio'\r\nimport { KeyBoard } from \"../../../_CORE/helpers/helper_KeyBoard\"\r\nimport { Player } from '../../../_CORE/entities/createPlayer'\r\nimport { SystemCollisionWithItems } from '../../../_CORE/systems/SystemCollisionsItems'\r\nimport { Helper_MaterialsLib } from '../../../_CORE/helpers/helper_MaterialsLib'\r\n\r\nimport pxjpg from '../../../assets/chapter02/skybox/px.jpg'\r\nimport nxjpg from '../../../assets/chapter02/skybox/nx.jpg'\r\nimport pyjpg from '../../../assets/chapter02/skybox/py.jpg'\r\nimport nyjpg from '../../../assets/chapter02/skybox/ny.jpg'\r\nimport pzjpg from '../../../assets/chapter02/skybox/pz.jpg'\r\nimport nzjpg from '../../../assets/chapter02/skybox/nz.jpg'\r\nimport levelSrc from '../../../assets/chapter02/level.obj'\r\nimport { SystemLevel } from '../systems/system_Level'\r\n\r\nimport { SystemPlatforms } from '../systems/system_Platforms'\r\n\r\nimport terminalSrc from '../../../assets/chapter02/terminal.glb'\r\nimport { SystemTerminals } from '../systems/system_Terminals'\r\n\r\nimport { CheckerDialogWithTerminals } from '../systems/system_DialogsWithTerminals'\r\n\r\nimport { SystemBridge } from '../systems/system_Brige'\r\n\r\n\r\n\r\nimport { AdderActions } from \"../actions/AdderActions\"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const GAME_MODULES = [\r\n    {\r\n        key: 'emitter',\r\n        constr: EventEmitter,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'customUi',\r\n        constr: CustomUi,\r\n        initStateKey: 'pageLoaded',  \r\n    },\r\n    {\r\n         key: 'deviceResizer',\r\n         constr: DeviceResizer,\r\n         initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'loaderAssets',\r\n        constr: LoaderAssets,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n\r\n    // /////////////////////////////////////////\r\n\r\n    {\r\n         key: 'frameUpdater',\r\n         constr: FrameUpdater,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'tweenUpdater',\r\n         constr: Helper_TweenUpdater,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'studio',\r\n         constr: Studio,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'keyBoard',\r\n         constr: KeyBoard,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'player',\r\n         constr: Player,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'systemCollisionItems',\r\n        constr: SystemCollisionWithItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'systemCollisionFloor',\r\n        constr: SystemCollisionWithItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'materialsLib',\r\n         constr: Helper_MaterialsLib,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'level',\r\n        constr: SystemLevel,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: levelSrc, key: 'level-rooms' },\r\n            { type: 'cubeTextures', path: [ pxjpg, nxjpg ,pyjpg, nyjpg, pzjpg, nzjpg ], key: 'envTexture' },\r\n        ],\r\n    },\r\n    {\r\n        key: 'platforms',\r\n        constr: SystemPlatforms,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'terminals',\r\n        constr: SystemTerminals,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'glb', path: terminalSrc, key: 'terminal' },\r\n        ]\r\n    },\r\n    {\r\n        key: 'checkerDialogsWithTerminals',\r\n        constr: CheckerDialogWithTerminals,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'bridge',\r\n        constr: SystemBridge,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    // {\r\n    //     key: 'doors',\r\n    //     constr: SystemDoors,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    //     assetsToLoad: [\r\n    //         { type: 'img', path: doorTextureSrc, key: 'doorTexture', wrap: false },\r\n    //     ]\r\n    // },\r\n    // {\r\n    //     key: 'bots',\r\n    //     constr: SystemBots ,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    //     assetsToLoad: [\r\n    //         { type: 'glb', path: botSrc, key: 'bot' },\r\n    //         { type: 'img', path: botMap, key: 'monster-skin' },\r\n    //     ]\r\n    // },\r\n    // {\r\n    //     key: 'playerNearBot',\r\n    //     constr: CheckerDialogWithBot,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    // },\r\n    {\r\n        key: 'adderActions',\r\n        constr: AdderActions,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n]\r\n\r\n","import { UI } from '../../../_CORE/ui/UI'\r\nimport CustomReactComponent from \"./CustomReactComponent\";\r\nimport { createCustomStore  } from \"./createStore\";\r\n\r\nexport class CustomUi {\r\n    constructor(root) {\r\n\r\n        root.appWrapper = document.querySelector('.app-wrapper')\r\n        root.CustomReactComponent = CustomReactComponent\r\n        root.customStore = createCustomStore(root)\r\n\r\n        root.ui = new UI(root)\r\n    } \r\n} \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport class DeviceResizer {\r\n    constructor (gameContext) {\r\n        let { emitter, appWrapper } = gameContext\r\n\r\n        !appWrapper && (appWrapper = document.querySelector('.app-wrapper')) \r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n        })\r\n\r\n        /** fullscreen */\r\n        const openAppFullScreenIfMobile = () => {\r\n            if (appWrapper.requestFullscreen) {\r\n                appWrapper.requestFullscreen()\r\n            } else if (appWrapper.mozRequestFullScreen) {\r\n                appWrapper.mozRequestFullScreen()\r\n            } else if (appWrapper.webkitRequestFullscreen) {\r\n                appWrapper.webkitRequestFullscreen()\r\n            } else if (appWrapper.msRequestFullscreen) {\r\n                appWrapper.msRequestFullscreen()\r\n            }\r\n        }\r\n\r\n        /** resize */\r\n        const resize = e => {\r\n            appWrapper.style.width = window.innerWidth + 'px'\r\n            appWrapper.style.height = window.innerHeight + 'px'\r\n            appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n            if (!document.fullscreenElement) {\r\n                emitter.emit('screenMode')('exitFullScreen')\r\n            }\r\n\r\n        }\r\n\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n    }\r\n}\r\n","import * as R from 'ramda'\r\n\r\n\r\nexport class FrameUpdater {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const emitFrameUpdate = emitter.emit('frameUpdate')\r\n\r\n        let data = {\r\n            time: 0,\r\n            delta: 0,\r\n            count: 0,\r\n            oldTime: 0\r\n        }\r\n\r\n        const getDataFromGlobalVar = () => data\r\n\r\n        const updateTime = data => {\r\n            data.time = Date.now()\r\n            return data\r\n        }\r\n\r\n        const updateDelta = data => {\r\n            data.delta = (data.time - data.oldTime) * 0.001\r\n            if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n                data.delta = 1000/60 * 0.001;\r\n            }\r\n            return data\r\n        }\r\n\r\n        const updateCount = data => {\r\n            data.count = data.delta / (1/60)\r\n            return data\r\n        }\r\n\r\n        const emit = data => {\r\n            emitFrameUpdate(data)\r\n            return data\r\n        }\r\n\r\n        const updateOldTime = data => {\r\n            data.oldTime = data.time\r\n            return data\r\n        }\r\n\r\n        const saveDataInGlobalVar = dataFromChine => {\r\n            data = dataFromChine\r\n            return data\r\n        }\r\n\r\n        const update = R.pipe(\r\n            getDataFromGlobalVar,\r\n            updateTime,\r\n            updateDelta,\r\n            updateCount,\r\n            emit,\r\n            updateOldTime,\r\n            saveDataInGlobalVar\r\n        )\r\n\r\n        const animate = () => {\r\n            requestAnimationFrame(animate)\r\n            update(data)\r\n        }\r\n\r\n        animate()\r\n\r\n    }\r\n}","import * as TWEEN from '@tweenjs/tween.js'\r\n\r\n\r\nexport class Helper_TweenUpdater {\r\n    constructor (gameContext) {\r\n        gameContext['emitter'].subscribe('frameUpdate')(() => TWEEN.update())\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport class SystemPlatforms {\r\n    constructor (root) {\r\n        const {\r\n            materials,\r\n            studio,\r\n            systemCollisionFloor,\r\n        } = root\r\n\r\n        const {\r\n            PLATFORMS_CONFIG,\r\n        } = root.CONSTANTS\r\n\r\n        for (let i = 0; i < PLATFORMS_CONFIG.length; ++i) {\r\n            const { w1, w2, h, r, angle, y } = PLATFORMS_CONFIG[i]\r\n\r\n            const mesh = new THREE.Mesh(\r\n                new THREE.BoxGeometry(w1, h, w2),\r\n                materials.wall\r\n            )\r\n            mesh.position.set(Math.sin(angle) *  r, y, Math.cos(angle) *  r)\r\n            mesh.rotation.set(0, angle, 0)\r\n            systemCollisionFloor.setItemToCollision({ mesh })\r\n            studio.addToScene(mesh)\r\n        }\r\n    }\r\n}","import { SystemCheckerNearItem } from \"../../../_CORE/systems/SystemCheckerNearItem\";\r\n\r\n\r\nexport class CheckerDialogWithTerminals {\r\n    constructor(root) {\r\n        const { player, terminals, emitter, dispatcher } = root\r\n\r\n        const checkerNear = new SystemCheckerNearItem()\r\n        for (let key in terminals.terminals) {\r\n            checkerNear.setItemToCheck(terminals.terminals[key].mesh)\r\n        }\r\n        const mesh = {\r\n            'up': player.frontObj,\r\n            'down': player.backObj,\r\n        }\r\n        let keyTerminalNear = null\r\n\r\n        emitter.subscribe('playerMove')(({ dir }) => {\r\n            /** check dialog */\r\n            {\r\n\r\n                const [ isNear, data ] = checkerNear.checkNear(mesh[dir], 12)\r\n\r\n                if (!isNear) {\r\n                    if (keyTerminalNear) {\r\n                        keyTerminalNear = null\r\n                        dispatcher.dispatch({ type: 'BUTTON_DIALOG_TOGGLE', isButtonDialog: false, currentTerminalKey: null })\r\n                    }\r\n                } else {\r\n                    if (!keyTerminalNear) {\r\n                        keyTerminalNear = data.key\r\n                        dispatcher.dispatch({ type: 'BUTTON_DIALOG_TOGGLE', isButtonDialog: true, currentTerminalKey: keyTerminalNear })\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","import { createBridge } from '../entities/Bridge'\r\n\r\n\r\nexport class SystemBridge {\r\n    constructor (root) {\r\n        const {\r\n            emitter,\r\n            materials,\r\n            studio,\r\n            systemCollisionFloor,\r\n            CONSTANTS,\r\n        } = root\r\n\r\n        const {\r\n            BRIDGE_START_STATE,\r\n            PROGRAMS,\r\n            playerConfig,\r\n        } = CONSTANTS\r\n\r\n        this._PROGRAMS = PROGRAMS\r\n\r\n        this._bridge = createBridge(materials.wall)\r\n        studio.addToScene(this._bridge.mesh)\r\n        this._bridge.setPose(BRIDGE_START_STATE)\r\n\r\n\r\n        systemCollisionFloor     \r\n            && systemCollisionFloor.setItemToCollision({ \r\n                mesh: this._bridge.mesh, \r\n                dist: playerConfig.offsetFromFloor,\r\n                isStopUnits: true,\r\n            })\r\n\r\n        this._inProgram = false\r\n    }\r\n\r\n    startProgram(key) {\r\n        this._inProgram = true\r\n        this._bridge.startProgram(this._PROGRAMS[key])\r\n            .then(() => this._inProgram = false)\r\n    }\r\n}\r\n\r\n// export function createSystemBridge (emitter, material) {\r\n//     const bridge = createBridge(material)\r\n//     bridge.setPose(START_STATE)\r\n\r\n//     // TODO: remove.\r\n//     emitter.subscribe('updateBridge')(data => bridge.setPose(getValuesFromData(data)))\r\n\r\n//     let inProgram = false\r\n//     emitter.subscribe('startBridgeProgram')(data=> {\r\n//         if (inProgram) return;\r\n//         if (!PROGRAMS[data.keyProgram]) return;\r\n\r\n//         inProgram = true\r\n//         bridge.startProgram(PROGRAMS[data.keyProgram])\r\n//             .then(() => inProgram = false)\r\n//     })\r\n\r\n//     return {\r\n//         mesh: bridge.mesh\r\n//     }\r\n// }\r\n\r\n\r\n\r\n// const getValuesFromData = data => {\r\n//     const newData = {}\r\n//     for (let key in data) newData[key] = data[key].val\r\n//     return newData\r\n// }","import { pipeLineForInit } from '../../_CORE/pipeLines/initPipeLine'\r\nimport * as CONSTANTS from './constants/constants_elements'\r\nimport { GAME_MODULES } from \"./constants/constants_modules\"\r\n\r\n\r\nwindow.addEventListener('load', () => pipeLineForInit(GAME_MODULES, CONSTANTS))\r\n"],"sourceRoot":""}