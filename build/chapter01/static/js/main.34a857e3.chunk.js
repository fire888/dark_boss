(this.webpackJsonplevels=this.webpackJsonplevels||[]).push([[0],{37:function(e,t,o){},39:function(e,t,o){},40:function(e,t,o){},42:function(e,t,o){"use strict";o.r(t);var n={};o.r(n),o.d(n,"CURRENT_CHAPTER",(function(){return d})),o.d(n,"MATERIALS_CONFIG",(function(){return p})),o.d(n,"studioConfig",(function(){return f})),o.d(n,"playerConfig",(function(){return b})),o.d(n,"BOT",(function(){return h})),o.d(n,"BOTS",(function(){return y}));var r=o(10),s=o.n(r),i=o(11);function a(){return(a=Object(i.a)(s.a.mark((function e(t,o){var n,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("pageLoaded",t,n={CONSTANTS:o}),r=n.loaderAssets,i=l(t),e.next=6,r.loadAssets(i);case 6:n.assets=e.sent,c("beforeStartPlay",t,n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var c=function(e,t,o){for(var n=0;n<t.length;++n){var r=t[n],s=r.key,i=r.constr;r.initStateKey===e&&(o[s]=new i(o))}},l=function(e){for(var t=[],o=0;o<e.length;++o)if(e[o].assetsToLoad&&e[o].assetsToLoad.length)for(var n=0;n<e[o].assetsToLoad.length;++n)t.push(e[o].assetsToLoad[n]);return t},u=Math.PI,m=u/2,d=0,p={easyMaterial:{mat:"MeshBasicMaterial",props:{}},wall:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:0,map:"wallTexture",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5,specular:2236962}},door:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:0,map:"doorTexture",bumpMap:"doorTexture",bumpScale:1,envMap:"skyBox",reflectivity:.5,specular:2236962}},bot:{mat:"MeshPhongMaterial",props:{color:10990770,map:"monster-skin",emissive:1645624,bumpMap:"monster-skin",bumpScale:.2,shininess:500,specular:16777215,skinning:!0}}},f={canId:"webgl-canvas",rendererCon:{antialias:!0},amb:{color:13421823,strength:.6},clearColor:927029,sceneEnvironment:{fogNear:10,fogFar:80,color:927029,backgroundImgKey:null}},b={speed:.8,speedRot:.02,speedDown:-.45,offsetFromFloor:5,offsetFromFloorFactor:.5,offsetWallCollision:3.5,level:-13,startRot:[0,0,0],startPos:[48,28,10],cameraData:{fov:90,ratio:window.innerWidth/window.innerHeight,near:.1,far:1e3,pos:[0,2,-.5]},frontObjPos:[0,0,-1],backObjPos:[0,0,1],lightDataOne:{color:13421823,strength:.3,pos:[0,50,0]}},h={offsetWallCollision:5},y=[{name:"guard_01",pos:[-53,26.316999435,27],rot:0,keyWallToWalkCollisions:"collision_bot_guardsmall"},{name:"guard_Super_02",pos:[-39,45.317001,-112],rot:0,keyWallToWalkCollisions:"collision_bot_guardsuper"},{name:"master",pos:[-91,26.316999435,35],rot:m-1,keyWallToWalkCollisions:"collision_bot_lab"},{name:"scientist",pos:[31,64.3152008,-48],rot:m,keyWallToWalkCollisions:"collision_bot_sciensist"},{name:"engineer",pos:[-1,25.3152,-69],rot:u,keyWallToWalkCollisions:"collision_bot_engeneer"},{name:"programmer",pos:[25,64.3152008,-4],rot:0,keyWallToWalkCollisions:"collision_bot_programmer"},{name:"mechanic",pos:[11,25.3152,-8],rot:m,keyWallToWalkCollisions:"collision_bot_start"},{name:"scout",pos:[-49,26.316999435,172],rot:m,keyWallToWalkCollisions:"collision_bot_scout"}],g=o(1),v=o(2),j=o(0),_=o(19),O=o(20),k=function(){var e=null,t=null,o=null,n=null;return function(r,s){return new Promise((function(i){return function(r){return"obj"===r?e=e||new _.a:"glb"===r||"gltf"===r?o=o||new O.a:"img"===r?t=t||new j.TextureLoader:"cubeTextures"===r?n=n||new j.CubeTextureLoader:void 0}(s).load(r,i)}))}},w=function(){function e(){Object(g.a)(this,e),this.resources={},this._load=k()}return Object(v.a)(e,[{key:"loadAssets",value:function(e){var t=this;return new Promise((function(o){var n=t._load,r=t.resources;function a(e){return c.apply(this,arguments)}function c(){return(c=Object(i.a)(s.a.mark((function t(i){var c,l,u,m;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e[i]){t.next=5;break}return c=e[i],l=c.key,u=c.path,m=c.type,t.next=4,n(u,m);case 4:r[l]=t.sent;case 5:if(++i,e[i]){t.next=10;break}o(r),t.next=12;break;case 10:return t.next=12,a(i);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}a(0)}))}}]),e}(),C=function(){function e(){Object(g.a)(this,e),this._storage={}}return Object(v.a)(e,[{key:"emit",value:function(e){var t=this;return function(o){return D(t._storage)(e).forEach((function(e){return e(o)}))}}},{key:"subscribe",value:function(e){var t=this;return function(o){return D(t._storage)(e).push(o),function(){return t._storage[e]=t._storage[e].filter((function(e){return e!==o}))}}}},{key:"showAll",value:function(){var e={};for(var t in this._storage)e[t]=this._storage[t].length;console.log(e)}}]),e}(),D=function(e){return function(t){return e[t]=e[t]||[]}},S=o(4),x=o(15),I=o.n(x),T=o(7),B=o(8),M=o(6),P=(o(37),"en"),N=function(e){return function(t){return e[P]&&e[P][t]||t}},E=o(3),W=N({ru:{"Discovery of small android":"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f \u0434\u0440\u043e\u0438\u0434\u0430",Factory:"\u0424\u0430\u0431\u0440\u0438\u043a\u0430",Brige:"\u041c\u043e\u0441\u0442",Cube:"\u041a\u0443\u0431","in production":"\u0441\u043a\u043e\u0440\u043e.."," (current)":" (\u0442\u0443\u0442)","Author: ":"\u043e\u0442: ","Github: ":"\u0413\u0438\u0442\u0445\u0430\u0431: "}}),A=Object(T.b)((function(e){return Object(M.a)({},e.controls.infoPanelData)}))((function(e){return Object(E.jsxs)("div",{className:"info",children:[Object(E.jsx)("button",{className:"control butt-infoClose",onClick:function(){return e.dispatch({type:"TOGGLE_INFO"})},children:"x"}),Object(E.jsxs)("div",{className:"info-inner",children:[Object(E.jsx)("p",{children:W(e.title)}),Object(E.jsx)("p",{children:W(e.topText)}),Object(E.jsx)("ul",{children:e.chapters.map((function(t,o){return Object(E.jsxs)("li",{children:[o+1,".\xa0",t.href?Object(E.jsx)("span",{children:Object(E.jsx)("a",{href:t.href,target:"blank",children:W(t.text)})}):Object(E.jsx)("span",{children:W(t.text)}),o===e.currentChapterIndex&&W(" (current)")]},o)}))}),Object(E.jsx)("p",{children:e.bottomText}),Object(E.jsx)("ul",{children:e.afterWords.map((function(e,t){return Object(E.jsxs)("li",{children:[W(e.text),Object(E.jsx)("a",{href:e.href,target:"blank",children:W(e.aText)})]},t)}))})]})]})})),K=(o(39),Object(T.b)((function(e){return{isInfo:e.controls.isInfo,isShowControls:e.controls.isShowControls}}))((function(e){var t=Object(S.useState)(!0),o=Object(B.a)(t,2),n=o[0],r=o[1];return Object(S.useEffect)((function(){return e.gameContext.emitter.subscribe("screenMode")((function(e){"exitFullScreen"===e&&r(!0)}))})),Object(E.jsxs)("div",{className:"ui-controls",children:[e.isShowControls&&Object(E.jsx)("button",{className:"butt-left control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-left")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-left")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-left")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-left")},children:"\u25c4"}),e.isShowControls&&Object(E.jsx)("button",{className:"butt-right control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-right")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-right")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-right")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-right")},children:"\u25ba"}),e.isShowControls&&Object(E.jsx)("button",{className:"butt-front control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-front")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-front")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-front")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-front")},children:"\u25b2"}),e.isShowControls&&Object(E.jsx)("button",{className:"butt-back control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-back")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-back")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-back")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-back")},children:"\u25bc"}),e.isShowControls&&n&&Object(E.jsx)("button",{className:"butt-fullscreen control",onClick:function(){e.gameContext.emitter.emit("mouseDown")("butt-fullscreen"),r(!1)},children:"\u2752"}),!e.isInfo&&Object(E.jsx)("button",{className:"butt-info control",onClick:function(){return e.dispatch({type:"TOGGLE_INFO"})},children:"i"}),e.isInfo&&Object(E.jsx)(A,{})]})})));var L={dispatch:null},F=Object(T.b)((function(e){return{isShowControls:e.controls.isShowControls,isInfo:e.controls.isInfo}}))((function(e){return!L.dispatch&&(L.dispatch=e.dispatch),Object(E.jsxs)("div",{className:"ui",children:[!e.isInfo&&e.gameContext.CustomReactComponent&&Object(E.jsx)(e.gameContext.CustomReactComponent,{gameContext:e.gameContext}),Object(E.jsx)(K,{gameContext:e.gameContext})]})})),U=o(13),G=o(22),R={isShowControls:!0,isInfo:!1,infoPanelData:{title:"Discovery of small android",topText:"",chapters:[{text:"Factory",href:"http://js.otrisovano.ru/factory/"},{text:"Brige",href:"http://js.otrisovano.ru/bridge/"},{text:"Cube",href:"http://js.otrisovano.ru/levels/"},{text:"in production"}],currentChapterIndex:null,bottomText:"",afterWords:[{text:"Author: ",aText:"www.otrisovano.ru",href:"http://otrisovano.ru"},{text:"Github: ",aText:"https://github.com/fire888/dark_boss",href:"https://github.com/fire888/dark_boss"}]}};var Y=document.querySelector(".progress"),H=-100,q=!0;!function e(){q&&setTimeout((function(){0===++H&&(H-=100),Y.style.marginLeft=H+"%",e()}),30)}();var z=function(){function e(t){Object(g.a)(this,e),t.dispatcher=L,this._root=t;var o=function(e){e.customStore||(e.customStore={});var t=Object(U.b)(Object(M.a)({controls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;return"TOGGLE_INFO"===t.type?Object(M.a)(Object(M.a)({},e),{},{isShowControls:!!e.isInfo,isInfo:!e.isInfo}):"CHANGE_INFO_CHAPTER"===t.type?Object(M.a)(Object(M.a)({},e),{},{infoPanelData:Object(M.a)(Object(M.a)({},e.infoPanelData),{},{currentChapterIndex:t.currentChapterIndex})}):Object(M.a)({},e)}},e.customStore)),o=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||U.c;return Object(U.d)(t,o(Object(U.a)(G.a)))}(t);o&&I.a.render(Object(E.jsx)(T.a,{store:o,children:Object(E.jsx)(F,{gameContext:t})}),document.getElementById("root"))}return Object(v.a)(e,[{key:"showStartButton",value:function(e){var t=document.querySelector(".startbuttons-wrapper"),o=document.querySelector(".progress-wrapper"),n=function(e){var t;e.target.dataset&&e.target.dataset.lang&&(t=e.target.dataset.lang,P=t),document.querySelector(".start-screen").style.display="none"};q=!1,t.style.display="flex",t.addEventListener("click",(function(t){e(),n(t)})),o.style.display="none"}}]),e}(),V={ru:{"I ...?":"\u042f ...?","You ...?":"\u0422\u044b ...?","MM ...?":"\u041c ...?","You is new droid.":"\u0422\u044b \u043d\u043e\u0432\u044b\u0439 \u0434\u0440\u043e\u0438\u0434.","I am mechanic. I create your body.":"\u041c\u0435\u0445\u0430\u043d\u0438\u043a. \u0414\u0435\u043b\u0430\u044e \u043a\u043e\u0440\u043f\u0443\u0441\u044b \u0434\u0440\u043e\u0438\u0434\u043e\u0432.","Go. Door is unblocked.... Beeeb.":"\u0418\u0434\u0438, \u0434\u0432\u0435\u0440\u044c \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u0430.... \u0411\u0438\u0438\u0431.","Once .... Beeeb.. I set basic program in your memory.":"\u0421\u0435\u043a\u0443\u043d\u0434\u0443 .... \u0411\u0438\u0438\u0431.. \u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430 \u0432 \u043f\u0430\u043c\u044f\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430.","I am programmer.":"\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u0443\u044e \u0434\u0440\u043e\u0438\u0434\u043e\u0432.","Go. Once... Beeeb.. Door to laboratory unblocked.":"\u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u0434\u0442\u0438 \u0432 \u043e\u0442\u0434\u0435\u043b \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f. \u0411\u0438\u0438\u0431.. \u0414\u043e\u0441\u0442\u0443\u043f \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d.","Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767":"\u0421\u0435\u043a\u0443\u043d\u0434\u0443... \u0411\u0438\u0438\u0431. \u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0448\u043b\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u043e.","I am engineer. I test new droids.":"\u0422\u0435\u0441\u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0449\u0438\u043a, \u0442\u0435\u0441\u0442\u0438\u0440\u0443\u044e \u043d\u043e\u0432\u044b\u0445 \u0434\u0440\u043e\u0438\u0434\u043e\u0432.","Go.":"\u0418\u0434\u0438 \u043d\u0430 \u043f\u0440\u0438\u0435\u043c\u043a\u0443.","Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.":"\u0421\u0435\u043a\u0443\u043d\u0434\u0443... \u0411\u0438\u0438\u0431. \u0425\u0430\u043b\u0442\u0443\u0440\u0430, \u0431\u0440\u0430\u043a ... \u041b\u0430\u0434\u043d\u043e \u0442\u044b \u0442\u0435\u043f\u0435\u0440\u044c \u0434\u0440\u043e\u0438\u0434_17543-06767-6767.","I am scientist. I check your abilities. ... garbage.":"\u041f\u0440\u0438\u0435\u043c\u0449\u0438\u043a. \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u044e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0431\u043e\u0440\u043a\u0438. ","Go to store. Doors unblocked.":"\u0418\u0434\u0438 \u043d\u0430 \u0441\u043a\u043b\u0430\u0434. \u0414\u043e\u0441\u0442\u0443\u043f \u0434\u0430\u043d.","I don\u2019t know anything, go to the boss. ... Beeeb. You have the accesses.":"\u041d\u0438\u0447\u0435\u0433\u043e \u0434\u043b\u044f \u0442\u0435\u0431\u044f \u043d\u0435\u0442, \u0438\u0434\u0438 \u0432 \u0448\u0442\u0430\u0431... \u0411\u0438\u0438\u0431. \u0421\u0442\u0430\u0442\u0443\u0441: \u043c\u043e\u0434\u0435\u043b\u044c \u0443\u043a\u043e\u043c\u043b\u0435\u043a\u0442\u043e\u0432\u0430\u043d\u0430.","You want see Boss. He is absent.":"\u0418\u0449\u0435\u0448\u044c \u0431\u043e\u0441\u0441\u0430, \u0435\u0433\u043e \u043d\u0435\u0442.","I am guard. I give you a secret mission.":"\u041f\u043e\u043c\u043e\u0448\u043d\u0438\u043a. \u042f \u0434\u0430\u044e \u0442\u0435\u0431\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u0443\u044e \u043c\u0438\u0441\u0441\u0438\u044e.","You must see all around base, and return. Doors unblocked.":"\u0422\u044b \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u0445\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u0440\u0430\u0437\u0432\u0435\u0434\u043a\u0443 \u0432\u043e\u043a\u0440\u0443\u0433 \u0431\u0430\u0437\u044b \u0438 \u0434\u043e\u043b\u043e\u0436\u0438\u0442\u044c. \u0412\u043f\u0435\u0440\u0435\u0434.","Droid_Id: 17543-06767-6767 with secret mission. I know.":"\u0422\u044b \u0434\u0440\u043e\u0438\u0434 \u0441 \u0432\u0430\u0436\u043d\u043e\u0439 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u043e\u0439 \u043c\u0438\u0441\u0441\u0438\u0435\u0439.","I am gateman. Beeeb... Door is opened! Good bye!":"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0437\u0430 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 \u043f\u0435\u0440\u0438\u043c\u0435\u0442\u0440. \u0411\u0438\u0438\u0431... \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0432\u043e\u0440\u043e\u0442\u0430\u043c \u0434\u0430\u043d.","It does not matter.":"\u042d\u0442\u043e \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f.","I am scout. Crazy factory create droids and close gates. You alone in this desert.":"\u0414\u0440\u043e\u0438\u0434. \u0421\u0443\u043c\u043c\u0430\u0441\u0448\u0435\u0434\u0448\u0430\u044f \u0444\u0430\u0431\u0440\u0438\u043a\u0430 \u043a\u043b\u0435\u043f\u0430\u0435\u0442 \u0434\u0440\u043e\u0438\u0434\u043e\u0432, \u0434\u0430\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u0438\u043d\u044b\u0435 \u043c\u0438\u0441\u0441\u0438\u0438 \u0438 \u0437\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0432\u043e\u0440\u043e\u0442\u0430.","This is the end.":"\u042d\u0442\u043e \u0432\u0441\u0435. The end.",open:"\u0434\u0438\u0430\u043b\u043e\u0433",close:"\u0437\u0430\u043a\u0440\u044b\u0442\u044c"}},J=N(V),Z=Object(T.b)((function(e){return{replicies:e.dialogs.replicies,currentBotKey:e.dialogs.currentBotKey}}))((function(e){var t=e.replicies[e.currentBotKey].messages,o=t.map((function(e,t){return e.isDone?Object(E.jsxs)("div",{className:"marTop-small",children:[Object(E.jsx)("p",{className:"player",children:J(e.player)}),Object(E.jsx)("p",{children:J(e.nps)})]},t):Object(E.jsx)("div",{},t)})),n=t.map((function(t,o){return t.isDone?Object(E.jsx)("div",{},o):Object(E.jsx)("button",{onClick:function(){return e.dispatch({type:"CLICK_ON_PLAYER_PHRASE",currentBotKey:e.currentBotKey,phraseIndex:o})},children:J(t.player)},o)}));return Object(E.jsxs)("div",{className:"messages-wrapper",children:[Object(E.jsx)("div",{className:"messages",children:o}),Object(E.jsx)("div",{className:"replicies",children:n})]})})),X=(o(40),N(V));var Q=Object(T.b)((function(e){return{isButtonDialog:e.dialogs.isButtonDialog,isCloseisButtonDialog:e.dialogs.isCloseisButtonDialog,isShowPalleteDialog:e.dialogs.isShowPalleteDialog}}))((function(e){return e.isButtonDialog||e.isShowPalleteDialog?Object(E.jsx)("div",{className:"dialog-wrapper",children:Object(E.jsxs)("div",{className:"dialog-content",children:[e.isShowPalleteDialog&&Object(E.jsx)(Z,{}),(e.isButtonDialog||e.isShowPalleteDialog)&&Object(E.jsx)("button",{className:"dialog-button-toggle",onClick:function(){return e.dispatch({type:"SHOW_PALLETE_DIALOG",is:!!e.isButtonDialog||e.isShowPalleteDialog&&!1})},style:{display:e.display},children:e.isButtonDialog&&X("open")||e.isShowPalleteDialog&&X("close")})]})}):Object(E.jsx)("div",{})})),$={replicies:{mechanic:{isDone:!1,messages:[{player:"I ...?",nps:"You is new droid.",isDone:!1},{player:"You ...?",nps:"I am mechanic. I create your body.",isDone:!1},{player:"MM ...?",nps:"Go. Door is unblocked.... Beeeb.",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["factory"]}}}]},programmer:{isDone:!1,messages:[{player:"I ...?",nps:"Once .... Beeeb.. I set basic program in your memory.",isDone:!1},{player:"You ...?",nps:"I am programmer.",isDone:!1},{player:"MM ...?",nps:"Go. Once... Beeeb.. Door to laboratory unblocked.",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["fromLaboratory001"]}}}]},engineer:{isDone:!1,messages:[{player:"I ...?",nps:"Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767",isDone:!1},{player:"You ...?",nps:"I am engineer. I test new droids.",isDone:!1},{player:"MM ...?",nps:"Go.",isDone:!1}]},scientist:{isDone:!1,messages:[{player:"I ...?",nps:"Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.",isDone:!1},{player:"You ...?",nps:"I am scientist. I check your abilities. ... garbage.",isDone:!1},{player:"MM ...?",nps:"Go to store. Doors unblocked.",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["fromFactoryCorpus","toLab","toGarage"]}}}]},master:{isDone:!1,messages:[{player:"I ...?",nps:"I don\u2019t know anything, go to the boss. ... Beeeb. You have the accesses.",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["toBoss"]}}}]},guard_Super_02:{isDone:!1,messages:[{player:"I ...?",nps:"You want see Boss. He is absent.",isDone:!1},{player:"You ...?",nps:"I am guard. I give you a secret mission.",isDone:!1},{player:"MM ...?",nps:"You must see all around base, and return. Doors unblocked.",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["fromStore","fromSecurity","toArsenal"]}}}]},guard_01:{isDone:!1,messages:[{player:"I ...?",nps:"Droid_Id: 17543-06767-6767 with secret mission. I know.",isDone:!1},{player:"You ...?",nps:"I am gateman. Beeeb... Door is opened! Good bye!",isDone:!1,event:{type:"unblockDoor",data:{idDoor:["toWorld"]}}}]},scout:{isDone:!1,messages:[{player:"I ...?",nps:"It does not matter.",isDone:!1,event:{type:"blockDoor",data:{idDoor:["toWorld"]}}},{player:"You ...?",nps:"I am scout. Crazy factory create droids and close gates. You alone in this desert.",isDone:!1},{player:"MM ...?",nps:"This is the end.",isDone:!1}]}},isCloseisButtonDialog:!1,isButtonDialog:!1,isShowPalleteDialog:!1,currentBotKey:null,currentLanguage:"en"},ee=o(44),te=o(16),oe=o(24),ne=o(23),re=function(){function e(t){var o=this;Object(g.a)(this,e);var n=t.assets,r=t.emitter,s=t.CONSTANTS.studioConfig,i=s.canId,a=s.rendererCon,c=s.clearColor,l=s.amb;a.canvas=document.getElementById(i);var u=new j.WebGLRenderer(a);u.setClearColor(c),u.setPixelRatio(window.devicePixelRatio),u.setSize(window.innerWidth,window.innerHeight),this._scene=new j.Scene;var m,d=t.CONSTANTS.studioConfig.sceneEnvironment,p=d.color,f=d.fogNear,b=d.fogFar,h=d.backgroundImgKey;this._scene.background=n[h]||null,this._scene.fog=new j.Fog(p,f,b);var y=l.color,v=l.strength;m=new j.AmbientLight(y,v),this._scene.add(m),this._camera=null,this._composer=new oe.a(u);var _=function(){var e={width:window.innerWidth,height:window.innerHeight};u.setSize(e.width,e.height),o._composer.setSize(e.width,e.height),o._camera&&(o._camera.aspect=e.width/e.height,o._camera.updateProjectionMatrix())};window.addEventListener("resize",_),_(),this.addToScene=this._scene.add.bind(this._scene);r.subscribe("frameUpdate")((function(){return o._camera&&o._composer.render(o._scene,o._camera)}));var O=this._scene.fog.near,k=this._scene.fog.far,w=this._scene.fog.color,C=t.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey;r.subscribe("changeSceneEnvironment")((function(e){var t=e.fogNear,r=e.fogFar,s=e.color,i=e.backgroundImgKey;if(t!==O||r!==k||s!==w){var a={color:o._scene.fog.color,near:o._scene.fog.near,far:o._scene.fog.far},c={color:new j.Color(s),near:t,far:r};O=t,k=r,w=s,new te.a(a).to(c,3e3).onUpdate((function(){o._scene.fog.color=a.color,o._scene.fog.near=a.near,o._scene.fog.far=a.far,m.color=a.color,u.setClearColor(a.color)})).start()}i!==C&&(C=i,o._scene.background=n[i]||null)}))}return Object(v.a)(e,[{key:"setCamera",value:function(e){this._camera=e,this._composer.addPass(new ne.a(this._scene,this._camera))}}]),e}(),se=function(){function e(t){Object(g.a)(this,e);var o=t.emitter,n={up:!1,down:!1,left:!1,right:!1},r={up:!0,down:!0,left:!0,right:!0};this.keysEnabled=r,this.keys=n;var s=function(e,t){switch(e){case 38:case 87:r.up&&(n.up=t);break;case 40:case 83:r.down&&(n.down=t);break;case 37:case 65:n.left=t;break;case 39:case 68:n.right=t}o.emit("keyEvent")(n)};document.addEventListener("keydown",(function(e){return s(e.keyCode,!0)})),document.addEventListener("keyup",(function(e){return s(e.keyCode,!1)})),o.subscribe("mouseDown")((function(e){"butt-left"===e&&s(37,!0),"butt-right"===e&&s(39,!0),"butt-front"===e&&s(38,!0),"butt-back"===e&&s(40,!0)})),o.subscribe("mouseUp")((function(e){"butt-left"===e&&s(37,!1),"butt-right"===e&&s(39,!1),"butt-front"===e&&s(38,!1),"butt-back"===e&&s(40,!1)}))}return Object(v.a)(e,[{key:"toggleEnableKeys",value:function(e,t){this.keysEnabled[e]=t,!t&&(this.keys[e]=!1)}}]),e}(),ie=function(){function e(t){var o=this;Object(g.a)(this,e),this._root=t;var n=t.emitter,r=t.studio,s=t.CONSTANTS.playerConfig,i=s.startPos,a=s.startRot,c=s.cameraData,l=s.frontObjPos,u=s.backObjPos,m=s.lightDataOne,d=s.speed,p=s.offsetFromFloor,f=s.offsetFromFloorFactor,b=s.offsetWallCollision,h=s.speedDown,y=s.speedRot;this._camera=null;var v={},_=!1;this._isBlocked=!0,this._isCanMove={up:!0,down:!0},this._mainObj=new j.Object3D,this._mainObj.position.fromArray(i),this._mainObj.rotation.fromArray(a),this._mainObj.userData.type="player";var O=new j.Object3D;O.position.fromArray([0,-3,0]),this._mainObj.add(O);var k=new j.Object3D;k.position.fromArray(l),this._mainObj.add(k),this.frontObj=k;var w=new j.Object3D;w.position.fromArray(u),this._mainObj.add(w),this.backObj=w;var C=c.fov,D=c.ratio,S=c.near,x=c.far,I=c.pos;this._camera=new j.PerspectiveCamera(C,D,S,x),this._camera.position.fromArray(I),this._mainObj.add(this._camera);var T=m.color,M=m.strenth,P=m.pos,N=new j.PointLight(T,M);N.position.fromArray(P),this._mainObj.add(N);n.subscribe("keyEvent")((function(e){return v=e})),n.subscribe("frameUpdate")((function(e){if(!_&&(v.left&&(o._mainObj.rotation.y+=y*e.count),v.right&&(o._mainObj.rotation.y-=y*e.count),!o._isBlocked)){if(o._root.systemCollisionFloor){var t=o._root.systemCollisionFloor.checkCollisions(o._mainObj,O,p),r=Object(B.a)(t,2),s=r[0],i=r[1];s?i<p-f&&(o._mainObj.position.y+=p-i):o._mainObj.position.y+=h}if(v){if(v.up){if(!o._isCanMove.up)return;if(o._root.systemCollisionItems){var a=o._root.systemCollisionItems.checkCollisions(o._mainObj,k,b);if(Object(B.a)(a,1)[0])return}o._mainObj.translateZ(-d*e.count),n.emit("playerMove")({pos:o._mainObj.position,dir:"up"})}if(v.down){if(!o._isCanMove.down)return;if(o._root.systemCollisionItems){var c=o._root.systemCollisionItems.checkCollisions(o._mainObj,w,b);if(Object(B.a)(c,1)[0])return}o._mainObj.translateZ(d*e.count),n.emit("playerMove")({pos:o._mainObj.position,dir:"down"})}}}})),n.subscribe("toggleDialog")((function(e){return _=e.isOpen})),r.setCamera(this._camera),r.addToScene(this._mainObj)}return Object(v.a)(e,[{key:"toggleBlocked",value:function(e){this._isBlocked=e}},{key:"toggleCanMove",value:function(e,t){this._isCanMove[e]=t}},{key:"getObj",value:function(){return this._mainObj}},{key:"getCamera",value:function(){return this._camera}},{key:"setToPos",value:function(e,t,o){this._mainObj.position.set(e,t,o)}}]),e}(),ae=function(){function e(t){Object(g.a)(this,e),this._root=t,this._arrMeshes=[],this._vecStart=new j.Vector3,this._vecDir=new j.Vector3,this._rayCaster=new j.Raycaster(this._vecStart,this._vecDir)}return Object(v.a)(e,[{key:"setItemToCollision",value:function(e){var t=e.mesh,o=e.itemKeyEmitCollision,n=void 0===o?null:o,r=e.isStopUnits,s=void 0===r||r;t.userData.itemKeyEmitCollision=n,t.userData.isStopUnits=s,this._arrMeshes.push(t)}},{key:"checkCollisions",value:function(e,t,o){e.getWorldPosition(this._vecStart),t.getWorldPosition(this._vecDir),this._vecDir.sub(this._vecStart);var n=this._rayCaster.intersectObjects(this._arrMeshes);return n[0]&&n[0].distance<o&&(n[0].object.userData.itemKeyEmitCollision&&this._root.emitter.emit("collision")(Object(M.a)(Object(M.a)({},n[0].object.userData.itemKeyEmitCollision),{},{type2:e.userData.type})),n[0].object.userData.isStopUnits)?[!0,n[0].distance]:[!1,null]}}]),e}(),ce=function(e,t){for(var o in e)e[o].wrapS&&(e[o].wrapS=e[o].wrapT=j.RepeatWrapping);var n=["bumpMap","envMap","map","normalMap","lightMap","aoMap"],r={},s=function(o){r[o]=new j[t[o].mat](Object(M.a)({},t[o].props)),n.map((function(n){return t[o].props[n]&&(r[o][n]=e[t[o].props[n]])}))};for(var i in t)s(i);return r},le=o.p+"static/media/level_01.bcfccfd8.obj",ue=o.p+"static/media/wall.ccfc1f44.jpg",me=o.p+"static/media/level-ray.2b82bfff.obj",de=function(e,t){return setTimeout(t,e)},pe=function(e,t,o,n,r,s){var i=16.666,a=r/i,c=(n-o)/a,l=0;!function o(){if(++l>a)return e[t]=n,void s();e[t]+=c,setTimeout(o,i)}()},fe=o(25),be=function(e){return he(e.map((function(e){return function(t){return function(){return e[0].apply(e,Object(fe.a)(e[1]).concat([t]))}}})))},he=function(e){!function t(o){return e[o]&&e[o]((function(){return t(++o)}))()}(0)};var ye=function(){function e(t){var o=this;Object(g.a)(this,e);var n=t.assets,r=t.materials,s=t.studio,i=t.emitter,a=t.systemCollisionItems;for(var c in this._doors={},n["level-rooms"].traverse((function(e){if(e.name.includes("doormesh_")){var t=e.name.split("_")[1];!o._doors[t]&&(o._doors[t]={}),o._doors[t].mesh=new j.Mesh(e.geometry,r.door),o._doors[t].state="closed",o._doors[t].access="denied",o._doors[t].mesh.userData={part:"mesh",type:"door",id:t}}})),this._doors)s.addToScene(this._doors[c].mesh),a&&a.setItemToCollision({mesh:this._doors[c].mesh,dist:7,itemKeyEmitCollision:{key:c,type:"door"},isStopUnits:!0});i.subscribe("collision")((function(e){"door"===e.type&&e.type2&&"player"===e.type2&&"confirm"===o._doors[e.key].access&&"closed"===o._doors[e.key].state&&o._openDoor(e.key)})),i.subscribe("unblockDoor")((function(e){for(var t=0;t<e.idDoor.length;t++)o._doors[e.idDoor[t]].access="confirm"})),i.subscribe("blockDoor")((function(e){for(var t=0;t<e.idDoor.length;t++)o._doors[e.idDoor[t]].access="denied"}))}return Object(v.a)(e,[{key:"_openDoor",value:function(e){var t=this;this._doors[e].state="opened",function(e){var t=e.prop,o=e.key,n=e.fromVal,r=e.offset,s=e.time,i=void 0===s?1e3:s,a=e.pause;be([[pe,[t,o,n,n+r,i]],[de,[void 0===a?2e3:a]],[pe,[t,o,n+r,n,i]],[arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},[]]])}({prop:this._doors[e].mesh.position,key:"y",fromVal:this._doors[e].mesh.position.y,offset:15,time:500,pause:2e3},(function(){return t._doors[e].state="closed"}))}}]),e}(),ge=o.p+"static/media/door.edd859db.jpg";var ve=Math.random,je=function(e){var t=(ve()*Math.PI*1.5+1)*ve()<.5?1:-1,o=t/40,n=0;return function(){return e.rotation.y+=o,++n<40}},_e=function(e){var t=300*ve(),o=0;return function(){return e.translateZ(.11),++o<t}};function Oe(e,t,o,n){var r=n.CONSTANTS.BOT.offsetWallCollision,s=new j.Group,i=e.scene.children[1];i.position.set(0,-8,0);var a,c,l=i.children[1],u=new j.Object3D;u.position.set(0,0,1),s.add(u),l.material=t,s.add(i),a=e.animations;var m=(c=new j.AnimationMixer(l)).clipAction(a[2]),d=c.clipAction(a[0]);c.timeScale=.7,m.play();var p="walk",f=null;o.keyWallToWalkCollisions&&(f=function(e,t,o,n,r){for(var s=new ae(r),i=0;i<n.length;++i)s.setItemToCollision({mesh:n[i]});var a={rotate:je,go:_e},c="rotate",l=null,u=function(t){t||("rotate"===c&&(t="go"),"go"===c&&(t="rotate")),c=t,l=a[t](e)};return u(c),{update:function(){if("go"===c){var n=s.checkCollisions(e,t,o);Object(B.a)(n,1)[0]&&u("rotate")}!l()&&u()}}}(s,u,r,[n.botsCustomWallsCollisions[o.keyWallToWalkCollisions]],n));var b=new j.Mesh(new j.BoxGeometry(6,6,6),new j.MeshBasicMaterial);return b.position.y=-5,b.visible=!1,s.add(b),n.systemCollisionItems.setItemToCollision({mesh:b}),{mesh:s,isUpdate:!1,update:function(e){"walk"===p&&f&&f.update(e),c.update(e.delta)},stay:function(e){if("stay"!==p){p="stay";var t=new j.Vector3;t.copy(e),t.y=s.position.y,s.lookAt(t),m.stop(),d.play(),c.timeScale=.3}},walk:function(){"walk"!==p&&(p="walk",d.stop(),m.play(),c.timeScale=.7)},startUpdate:function(){this.isUpdate||(this.isUpdate=!0,m.play(),c.timeScale=.7)},stopUpdate:function(){this.isUpdate&&(this.isUpdate=!1,m.stop(),d.play(),d.stop())}}}var ke=o.p+"static/media/monster-animate3.f32b90f6.glb",we=o.p+"static/media/monster-skin.64f3a049.jpg",Ce=function(){function e(){Object(g.a)(this,e),this._itemWorldPos=new j.Vector3,this._mainCheckerWorldPos=new j.Vector3,this._arr=[]}return Object(v.a)(e,[{key:"setItemToCheck",value:function(e){this._arr.push(e)}},{key:"checkNear",value:function(e,t){e.getWorldPosition(this._mainCheckerWorldPos);for(var o=0;o<this._arr.length;o++){if(this._arr[o].userData.inScene)if(this._arr[o].getWorldPosition(this._itemWorldPos),this._itemWorldPos.distanceTo(this._mainCheckerWorldPos)<t)return[!0,this._arr[o].userData]}return[!1,null]}}]),e}(),De=[{key:"emitter",constr:C,initStateKey:"pageLoaded"},{key:"customUi",constr:function e(t){Object(g.a)(this,e),t.appWrapper=document.querySelector(".app-wrapper"),t.CustomReactComponent=Q,t.customStore=function(e){return{dialogs:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,o=arguments.length>1?arguments[1]:void 0;if("BUTTON_DIALOG_TOGGLE"===o.type){var n=o.isButtonDialog,r=o.currentBotKey;return Object(M.a)(Object(M.a)({},t),{},{isButtonDialog:n,currentBotKey:r})}if("SHOW_PALLETE_DIALOG"===o.type)return e.player.toggleBlocked(o.is),Object(M.a)(Object(M.a)({},t),{},{isButtonDialog:!o.is,isShowPalleteDialog:o.is});if("CLICK_ON_PLAYER_PHRASE"===o.type){var s=JSON.parse(JSON.stringify(t.replicies));if(s[o.currentBotKey].messages[o.phraseIndex].isDone=!0,s[o.currentBotKey].messages[o.phraseIndex].event){var i=s[o.currentBotKey].messages[o.phraseIndex].event,a=i.type,c=i.data;e.emitter.emit(a)(c)}for(var l=!0,u=0;u<s[o.currentBotKey].messages.length;++u)!1===s[o.currentBotKey].messages[u].isDone&&(l=!1);return s[o.currentBotKey].isDone=l,Object(M.a)(Object(M.a)({},t),{},{replicies:s,isCloseisButtonDialog:l})}return t}}}(t),t.ui=new z(t)},initStateKey:"pageLoaded"},{key:"deviceResizer",constr:function e(t){Object(g.a)(this,e);var o=t.emitter,n=t.appWrapper;!n&&(n=document.querySelector(".app-wrapper")),o.subscribe("mouseDown")((function(e){"butt-fullscreen"===e&&r()}));var r=function(){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()},s=function(e){n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",n.style.fontSize=Math.max(Math.min(Math.min(window.innerWidth,window.innerHeight),400),350)/50+"px",document.fullscreenElement||o.emit("screenMode")("exitFullScreen")};window.addEventListener("resize",s),s()},initStateKey:"pageLoaded"},{key:"loaderAssets",constr:w,initStateKey:"pageLoaded"},{key:"frameUpdater",constr:function e(t){Object(g.a)(this,e);var o=t.emitter.emit("frameUpdate"),n={time:0,delta:0,count:0,oldTime:0},r=ee.a((function(){return n}),(function(e){return e.time=Date.now(),e}),(function(e){return e.delta=.001*(e.time-e.oldTime),(isNaN(e.delta)||e.delta>1e3||0===e.delta)&&(e.delta=1e3/60*.001),e}),(function(e){return e.count=e.delta/(1/60),e}),(function(e){return o(e),e}),(function(e){return e.oldTime=e.time,e}),(function(e){return n=e}));!function e(){requestAnimationFrame(e),r(n)}()},initStateKey:"beforeStartPlay"},{key:"tweenUpdater",constr:function e(t){Object(g.a)(this,e),t.emitter.subscribe("frameUpdate")((function(){return te.b()}))},initStateKey:"beforeStartPlay"},{key:"studio",constr:re,initStateKey:"beforeStartPlay"},{key:"keyBoard",constr:se,initStateKey:"beforeStartPlay"},{key:"player",constr:ie,initStateKey:"beforeStartPlay"},{key:"systemCollisionItems",constr:ae,initStateKey:"beforeStartPlay"},{key:"systemCollisionFloor",constr:ae,initStateKey:"beforeStartPlay"},{key:"materialsLib",constr:function e(t){Object(g.a)(this,e);var o=t.assets,n=t.CONSTANTS;t.materials=ce(o,n.MATERIALS_CONFIG)},initStateKey:"beforeStartPlay"},{key:"level",constr:function e(t){Object(g.a)(this,e);var o=t.assets,n=t.materials,r=t.studio,s=t.systemCollisionItems,i=t.systemCollisionFloor,a=t.CONSTANTS.playerConfig.offsetFromFloor,c={};o["level-rooms"].traverse((function(e){e.name.includes("room_")&&r.addToScene(new j.Mesh(e.geometry,n.wall)),e.name.includes("collision_bot")&&(c[e.name]=e)})),t.botsCustomWallsCollisions=c,o.levelCollisions.traverse((function(e){"wall_collision"===e.name&&s&&s.setItemToCollision({mesh:new j.Mesh(e.geometry,n.easyMaterial),dist:5,isStopUnits:!0}),"floor_collision"===e.name&&i&&i.setItemToCollision({mesh:new j.Mesh(e.geometry,n.easyMaterial),dist:a,isStopUnits:!0})}))},initStateKey:"beforeStartPlay",assetsToLoad:[{type:"obj",path:le,key:"level-rooms"},{type:"obj",path:me,key:"levelCollisions"},{type:"img",path:ue,key:"wallTexture",wrap:!0}]},{key:"doors",constr:ye,initStateKey:"beforeStartPlay",assetsToLoad:[{type:"img",path:ge,key:"doorTexture",wrap:!1}]},{key:"bots",constr:function e(t){var o=this;Object(g.a)(this,e);var n=t.assets,r=t.materials,s=t.studio,i=t.emitter;this.bots={},t.CONSTANTS.BOTS.forEach((function(e){var i=Oe(function(e){var t={animations:e.animations,scene:e.scene.clone(!0)},o={};e.scene.traverse((function(e){e.isSkinnedMesh&&(o[e.name]=e)}));var n={},r={};for(var s in t.scene.traverse((function(e){e.isBone&&(n[e.name]=e),e.isSkinnedMesh&&(r[e.name]=e)})),o){for(var i=o[s].skeleton,a=r[s],c=[],l=0;l<i.bones.length;++l){var u=n[i.bones[l].name];c.push(u)}a.bind(new j.Skeleton(c,i.boneInverses),a.matrixWorld)}return t}(n.bot),r.bot,e,t);i.mesh.position.set(e.pos[0],e.pos[1],e.pos[2]),i.mesh.rotation.y=e.rot,i.name=e.name,s.addToScene(i.mesh),i.mesh.userData.inScene=!0,i.mesh.userData.key=e.name,o.bots[e.name]=i})),i.subscribe("frameUpdate")((function(e){for(var t in o.bots)o.bots[t].update(e)}))},initStateKey:"beforeStartPlay",assetsToLoad:[{type:"glb",path:ke,key:"bot"},{type:"img",path:we,key:"monster-skin"}]},{key:"playerNearBot",constr:function e(t){Object(g.a)(this,e);var o=t.player,n=t.bots,r=t.emitter,s=new Ce,i=new Ce;for(var a in n.bots)s.setItemToCheck(n.bots[a].mesh),i.setItemToCheck(n.bots[a].mesh);var c={up:o.frontObj,down:o.backObj},l=null;r.subscribe("playerMove")((function(e){var t=e.dir,i=s.checkNear(c[t],20),a=Object(B.a)(i,2),u=a[0],m=a[1];u?l||(l=m.key,n.bots[l].stay(o._mainObj.position),r.emit("nearBot")({isNearBot:!0,botKey:l})):l&&(n.bots[l].walk(o._mainObj.position),l=null,r.emit("nearBot")({isNearBot:!1,botKey:l}))}))},initStateKey:"beforeStartPlay"},{key:"adderActions",constr:function e(t){Object(g.a)(this,e);var o=t.player,n=t.ui,r=t.dispatcher,s=t.emitter;r.dispatch({type:"CHANGE_INFO_CHAPTER",currentChapterIndex:0}),n.showStartButton((function(){return o.toggleBlocked(!1)})),s.subscribe("nearBot")((function(e){var t=e.isNearBot,o=e.botKey;r.dispatch({type:"BUTTON_DIALOG_TOGGLE",isButtonDialog:t,currentBotKey:o})}))},initStateKey:"beforeStartPlay"}];window.addEventListener("load",(function(){return function(e,t){return a.apply(this,arguments)}(De,n)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.34a857e3.chunk.js.map