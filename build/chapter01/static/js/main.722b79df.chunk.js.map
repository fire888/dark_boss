{"version":3,"sources":["_CORE/pipeLines/initPipeLine.js","chapter01/src/constants/constants_elements.js","_CORE/helpers/helper_LoadAssets.js","_CORE/helpers/helper_Emitter.js","_CORE/helpers/helper_translate.js","_CORE/ui/containersReact/Info.js","_CORE/constants/default_voc.js","_CORE/ui/containersReact/PlayerControls.js","_CORE/ui/containersReact/App.js","_CORE/ui/store/defaultUiData.js","_CORE/ui/UI.js","_CORE/ui/store/createStore.js","chapter01/src/constants/translate.js","chapter01/src/ui/DialogPallete.js","chapter01/src/ui/CustomReactComponent.js","chapter01/src/ui/createStore.js","_CORE/shaders/saturate.js","_CORE/entities/createStudio.js","_CORE/helpers/helper_KeyBoard.js","_CORE/entities/createPlayer.js","_CORE/systems/SystemCollisionsItems.js","_CORE/helpers/helper_MaterialsLib.js","assets/chapter01/level_01.obj","assets/chapter01/wall.jpg","assets/chapter01/level-ray.obj","_CORE/components/funcs/transformProp.js","_CORE/utils/iterate.js","chapter01/src/systems/system_Doors.js","_CORE/components/componentTweenProp.js","assets/chapter01/door.jpg","chapter01/src/entities/Bot.js","assets/chapter01/monster-animate3.glb","assets/chapter01/monster-skin.jpg","_CORE/systems/SystemCheckerNearItem.js","chapter01/src/constants/constants_modules.js","chapter01/src/ui/Ui.js","_CORE/helpers/helper_DeviceResizer.js","_CORE/helpers/helper_FrameUpater.js","_CORE/helpers/helper_TweenUpdater.js","chapter01/src/systems/system_Level.js","chapter01/src/systems/system_Bots.js","_CORE/helpers/helper_GLTFcopy.js","chapter01/src/systems/system_CheckerDialogWithBot.js","chapter01/src/actions/AdderActions.js","chapter01/src/index.js"],"names":["gameModules","CONSTANTS","a","initModulesByState","root","loaderAssets","dataToLoad","getAssetsFromModulesData","loadAssets","assets","state","modulesData","i","length","key","constr","initStateKey","arr","assetsToLoad","j","push","PI","Math","hPI","CURRENT_CHAPTER","MATERIALS_CONFIG","mat","props","color","emissive","map","bumpMap","bumpScale","envMap","reflectivity","specular","shininess","skinning","END_ENV","fogNear","fogFar","backgroundImgKey","studioConfig","canId","rendererCon","antialias","amb","strength","clearColor","sceneEnvironment","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","backObjPos","lightDataOne","BOT","BOTS","name","rot","keyWallToWalkCollisions","createLoaders","objLoader","textureLoader","gltfLoader","cubeTextureLoader","soundLoader","path","type","Promise","resolve","OBJLoader","GLTFLoader","THREE","getterLoader","load","LoaderAssets","this","resources","_load","data","iterate","index","EventEmitter","_storage","id","getOrCreateArrFromObj","forEach","action","callback","filter","item","s","console","log","obj","lang","createTranslater","vocab","word","t","connect","controls","infoPanelData","className","onClick","dispatch","title","topText","chapters","href","target","text","currentChapterIndex","bottomText","afterWords","aText","isInfo","isShowControls","isShowControlSound","isMute","useState","isShowFullScreenButt","changeShowFullScreenButt","useEffect","gameContext","emitter","subscribe","val","onMouseUp","emit","is","onTouchEnd","onMouseDown","onTouchStart","dispatcher","CustomReactComponent","startDefaultStoreData","loader","document","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","setTimeout","style","marginLeft","UI","_root","store","customStore","rootReducer","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","thunk","prepareStore","ReactDOM","render","getElementById","startButtons","progressWrapper","hideStartScreen","e","l","dataset","display","addEventListener","VOC","LIBA","replicies","dialogs","currentBotKey","messages","arrM","ind","isDone","player","nps","arrR","phraseIndex","isButtonDialog","isCloseisButtonDialog","isShowPalleteDialog","isShowFinalMessage","DialogPallete","location","replace","storeStartState","mechanic","event","idDoor","programmer","engineer","scientist","master","guard_Super_02","guard_01","scout","currentLanguage","Saturate","uniforms","value","vertexShader","fragmentShader","Studio","canvas","_renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","_scene","background","fog","_lightA","add","_playerCamera","_controlsCamera","position","set","OrbitControls","domElement","update","_composer","EffectComposer","_renderPass","RenderPass","addPass","composerAddPass","ShaderPass","vec3","isPlayerView","saveFogData","camera","getWorldPosition","x","y","z","resize","size","width","height","aspect","updateProjectionMatrix","addToScene","bind","removeFromScene","remove","_backgroundImgKey","cam","conf","_changeFog","_changeBackground","startData","endData","TWEEN","to","time","onUpdate","updateAmb","start","KeyBoard","keys","keysEnabled","keyUpdate","keyCode","isDown","Player","studio","_camera","isButtonsDisabled","_isBlocked","_isCanMove","_mainObj","fromArray","rotation","userData","bottomObj","frontObj","backObj","strenth","light","count","systemCollisionFloor","checkCollisions","isBlockedByItem","offset","translateY","systemCollisionItems","translateZ","dir","isOpen","setCamera","SystemCollisionWithItems","_arrMeshes","_vecStart","_vecDir","_rayCaster","mesh","itemKeyEmitCollision","isStopUnits","objFrom","objTo","d","sub","intersects","intersectObjects","distance","object","type2","point","createMaterials","wrapS","wrapT","mapsKeys","materials","keyMap","timer","on","tween","prop","fromVal","toVal","timerStep","currentCount","step","iterateArrF","arrF","SystemDoors","_doors","traverse","child","includes","split","geometry","door","part","setItemToCollision","dist","_openDoor","pause","animateToOffsetAndReturn","ran","random","createAnimations","monsterModel","animations","mixer","scene","children","dialog","clipAction","timeScale","walk","play","actions","currentAction","stopAllAction","startRotate","angleRot","countRotation","startGo","numsMove","min","countMove","createFreeWalk","meshFrontObj","wallOffset","isUpdate","collisions","createCollisionWithItems","toggleAction","max","stop","removeItemFromCollision","clearCollisions","arrMeshes","vecStart","vecDir","rayCaster","SystemCheckerNearItem","_itemWorldPos","_mainCheckerWorldPos","_arr","mainMesh","inScene","distanceTo","GAME_MODULES","appWrapper","toggleBlocked","JSON","parse","stringify","changeEnvironment","isBotDone","createCustomStore","ui","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fontSize","fullscreenElement","emitFrameUpdate","delta","oldTime","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","botsCustomWallsCollisions","wall","easyMaterial","levelSrc","levelCollisionSrc","wallTextureSrc","wrap","doorTextureSrc","bots","unit","monsterMat","botData","group","material","objRay","freeWalk","boxCollisionWithPlayer","visible","stay","playerPos","copy","lookAt","startUpdate","stopUpdate","createBot","gltf","clone","skinnedMeshes","node","isSkinnedMesh","cloneBones","cloneSkinnedMeshes","isBone","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","boneInverses","matrixWorld","GLTFCopy","bot","botSrc","botMap","checkerNear","checkerNearBlock","setItemToCheck","keyBotNear","checkNear","isNear","isNearBot","botKey","showStartButton","pipeLineForInit"],"mappings":"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","file":"static/js/main.722b79df.chunk.js","sourcesContent":["export async function pipeLineForInit (gameModules, CONSTANTS) {\r\n    const root = { CONSTANTS }\r\n\r\n    initModulesByState('pageLoaded', gameModules, root)\r\n\r\n    const { loaderAssets } = root\r\n\r\n    const dataToLoad = getAssetsFromModulesData(gameModules)\r\n    root.assets = await loaderAssets.loadAssets(dataToLoad)\r\n\r\n    initModulesByState('beforeStartPlay', gameModules, root)\r\n}\r\n\r\n\r\nconst initModulesByState = (state, modulesData, root) => {\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        const {  key, constr, initStateKey } = modulesData[i]\r\n        initStateKey === state && (root[key] = new constr(root))\r\n    }\r\n}\r\n\r\nconst getAssetsFromModulesData = modulesData => {\r\n    const arr = []\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        if (modulesData[i].assetsToLoad && modulesData[i].assetsToLoad.length) {\r\n            for (let j = 0; j < modulesData[i].assetsToLoad.length; ++j) {\r\n                arr.push(modulesData[i].assetsToLoad[j])\r\n            }\r\n        }\r\n    }\r\n    return arr\r\n}","const PI = Math.PI\r\nconst hPI = PI / 2\r\n\r\n\r\nexport const CURRENT_CHAPTER = 0\r\n\r\nexport const MATERIALS_CONFIG = {\r\n    'easyMaterial': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {},\r\n    },\r\n\r\n    'wall': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x000000,\r\n            map: 'wallTexture',\r\n            bumpMap: 'mapFloorOuter',    \r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n            specular: 0x222222,\r\n        },\r\n    },\r\n\r\n    'door': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x000000,\r\n            map: 'doorTexture',\r\n            bumpMap: 'doorTexture',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n            specular: 0x222222,\r\n        },\r\n    },\r\n\r\n    'bot': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: { \r\n            color: 0xa7b4b2,\r\n            map: 'monster-skin',\r\n            emissive: 0x191c38,\r\n            bumpMap: 'monster-skin',\r\n            bumpScale: 0.2,\r\n            shininess: 500,\r\n            specular: 0xffffff,\r\n            skinning: true,\r\n        }, \r\n    }\r\n}\r\n\r\n\r\nexport const END_ENV = { fogNear: -10, fogFar: 0, color: 0x0e2535, backgroundImgKey: null }\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    amb: {\r\n        color: 0xccccff,\r\n        strength: 0.6,\r\n    },\r\n    clearColor: 0x0e2535,\r\n    sceneEnvironment: {\r\n        fogNear: 10,\r\n        fogFar: 80,\r\n        color: 0x0e2535, \r\n        backgroundImgKey: null, \r\n    },\r\n}\r\n\r\n\r\nexport const playerConfig = {\r\n    //speed: 0.35,\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 5.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    //startPos: [-42.580326256838035, 22.917001342773393, 143.03375162223674 ],\r\n    startPos: [48, 28, 10],\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 1000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    backObjPos: [0, 0, 1],\r\n    lightDataOne: {\r\n        color: 0xccccff, \r\n        strength: 0.3,\r\n        pos: [0, 50, 0],\r\n    },\r\n}\r\n\r\nexport const BOT = {\r\n    offsetWallCollision: 5,\r\n}\r\n\r\nexport const BOTS = [\r\n    {\r\n        name: 'guard_01',\r\n        pos: [-53, 26.316999435, 27],\r\n        rot: 0,\r\n        keyWallToWalkCollisions: 'collision_bot_guardsmall',\r\n    },\r\n    {\r\n        name: 'guard_Super_02',\r\n        pos: [-39, 45.317001, -112],\r\n        rot: 0,\r\n        keyWallToWalkCollisions: 'collision_bot_guardsuper',\r\n    },\r\n    {\r\n        name: 'master',\r\n        pos: [-91, 26.316999435, 35],\r\n        rot: hPI - 1,\r\n        keyWallToWalkCollisions: 'collision_bot_lab',\r\n    },\r\n    {\r\n        name: 'scientist',\r\n        pos: [31, 64.3152008, -48],\r\n        rot: hPI,\r\n        keyWallToWalkCollisions: 'collision_bot_sciensist',\r\n    },\r\n    {\r\n        name: 'engineer',\r\n        pos: [-1, 25.31520, -69],\r\n        rot: PI,\r\n        keyWallToWalkCollisions: 'collision_bot_engeneer',\r\n    },\r\n    {\r\n        name: 'programmer',\r\n        pos: [25, 64.3152008, -4],\r\n        rot: 0,\r\n        keyWallToWalkCollisions: 'collision_bot_programmer', \r\n    },\r\n    {\r\n        name: 'mechanic',\r\n        pos: [11, 25.31520, -8],\r\n        rot: hPI,\r\n        keyWallToWalkCollisions: 'collision_bot_start', \r\n    },\r\n    {\r\n        name: 'scout',\r\n        pos: [-49, 26.316999435, 172],\r\n        rot: hPI,\r\n        keyWallToWalkCollisions: 'collision_bot_scout',\r\n    }\r\n]\r\n\r\n","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\n\r\nconst createLoaders = () => {\r\n    let objLoader = null,\r\n        textureLoader = null,\r\n        gltfLoader = null,\r\n        cubeTextureLoader = null,\r\n        soundLoader = null\r\n\r\n\r\n    const getterLoader = type => {\r\n        if (type === 'obj')\r\n            return objLoader = (objLoader || new OBJLoader())\r\n        if (type === 'glb' || type === 'gltf')\r\n            return gltfLoader = (gltfLoader || new GLTFLoader())\r\n        if (type === 'img')\r\n            return textureLoader = (textureLoader || new THREE.TextureLoader())\r\n        if (type === 'cubeTextures') {\r\n            return cubeTextureLoader = (cubeTextureLoader || new THREE.CubeTextureLoader())\r\n        }\r\n        if (type === 'soundMp3') {\r\n            return soundLoader = (soundLoader || new THREE.AudioLoader())\r\n        }\r\n\r\n    }\r\n\r\n    return (path, type) => new Promise(resolve => {\r\n        getterLoader(type).load(path, resolve)\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\nexport class LoaderAssets {\r\n\r\n    constructor () {\r\n        this.resources = {}\r\n        this._load = createLoaders()\r\n    }\r\n\r\n    loadAssets (data) {\r\n        return new Promise(resolve => {\r\n\r\n            const load = this._load\r\n            const resources = this.resources\r\n\r\n            async function iterate (index) {\r\n                if (data[index]) {\r\n                    const { key, path, type } = data[index]\r\n                    resources[key] = await load(path, type)\r\n                }\r\n\r\n                ++index\r\n                !data[index]\r\n                    ? resolve(resources)\r\n                    : await iterate(index)\r\n            }\r\n\r\n           void iterate(0)\r\n        })\r\n    }\r\n}\r\n","export class EventEmitter {\r\n    constructor() {\r\n        this._storage = {}\r\n    }\r\n\r\n    emit (id) {\r\n        return data => getOrCreateArrFromObj(this._storage)(id).forEach(action => action(data))\r\n    }\r\n\r\n    subscribe (id) {\r\n        return callback => {\r\n            getOrCreateArrFromObj(this._storage)(id).push(callback)\r\n            return () => this._storage[id] = this._storage[id].filter(item => item !== callback)\r\n        }\r\n    }\r\n\r\n    showAll () {\r\n        const s = {}\r\n        for (let key in this._storage) {\r\n            s[key] = this._storage[key].length\r\n        }\r\n        console.log(s)\r\n    }\r\n}\r\n\r\n\r\n\r\n// const createEmitter = () => {\r\n//     const storage = {}\r\n//     return {\r\n//         emit: id => data => getOrCreateArrFromObj(storage)(id).forEach(action => action(data)),\r\n//         subscribe: id => callback => {\r\n//             getOrCreateArrFromObj(storage)(id).push(callback)\r\n//             return () => storage[id] = storage[id].filter(item => item !== callback)\r\n//         },\r\n//         showAll () {\r\n//             const s = {}\r\n//             for (let key in storage) {\r\n//                 s[key] = storage[key].length\r\n//             }\r\n//             console.log(s)\r\n//         },\r\n//     }\r\n// }\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\n\r\n\r\n\r\n\r\n\r\n","let lang = 'en'\r\nexport const changeLang = l => lang = l \r\nexport const createTranslater = vocab => word => (vocab[lang] && vocab[lang][word]) || word\r\n","import { connect } from \"react-redux\";\r\nimport '../stylesheets/Info.css'\r\nimport { createTranslater } from '../../helpers/helper_translate'\r\nimport { INFO_VOC } from '../../constants/default_voc'\r\n\r\n\r\nconst t = createTranslater(INFO_VOC)\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        ...state.controls.infoPanelData,\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(function(props) {\r\n    return ( \r\n        <div className=\"info\">\r\n            <button\r\n                className=\"control butt-infoClose\"\r\n                onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                x\r\n            </button>\r\n            <div className=\"info-inner\">\r\n                <p>{t(props.title)}</p>\r\n                <p>{t(props.topText)}</p>\r\n                <ul>{props.chapters.map((item, index) => \r\n                    <li key={index}>\r\n                        {index + 1}.&nbsp;\r\n                        {item.href \r\n                            ? <span><a href={item.href} target=\"blank\">{t(item.text)}</a></span>\r\n                            : <span>{t(item.text)}</span>}\r\n                        {index === props.currentChapterIndex && t(' (current)')}\r\n                    </li>)\r\n                }</ul>\r\n                <p>{props.bottomText}</p>\r\n                <ul>{props.afterWords.map((item, index) => \r\n                    <li key={index}>\r\n                        {t(item.text)} \r\n                        <a href={item.href} target=\"blank\">{t(item.aText)}</a>\r\n                    </li>)\r\n                }</ul>\r\n            </div>      \r\n        </div>)\r\n})\r\n\r\n","export const INFO_VOC = {\r\n    'ru': {\r\n        'Discovery of small android': ' ',\r\n        'Factory': '',\r\n        'Brige': '',\r\n        'Cube': '',\r\n        'Endways': '',\r\n        'in production': '..',\r\n        ' (current)': ' ()',\r\n        'Author: ': ': ',\r\n        'Github: ': ': '\r\n    }\r\n} ","import { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Info from './Info'\r\nimport '../stylesheets/PlayerControls.css'\r\n\r\n\r\n\r\n\r\n\r\nexport default connect(\r\n    state => ({\r\n            isInfo: state.controls.isInfo,\r\n            isShowControls: state.controls.isShowControls, \r\n            isShowControlSound: state.controls.isShowControlSound,\r\n            isMute: state.controls.isMute,\r\n    })\r\n)(\r\n    function(props) {\r\n    const [isShowFullScreenButt, changeShowFullScreenButt] = useState(true)\r\n\r\n    useEffect(() =>\r\n        props.gameContext.emitter.subscribe('screenMode')(val => {\r\n            val === 'exitFullScreen' && changeShowFullScreenButt(true) })\r\n    )\r\n\r\n\r\n    return (\r\n        <div className='ui-controls'>\r\n            {props.isShowControls && props.isShowControlSound && <button\r\n                className=\"butt-sound control\"\r\n                onMouseUp={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n                onTouchEnd={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n            >\r\n                {props.isMute ? <>&#10236;</> : <>&#10239;</>}\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-left control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n            >\r\n                &#9668;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-right control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n            >\r\n                &#9658;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-front control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n            >\r\n                &#9650;\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-back control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n            >\r\n                &#x25BC;\r\n            </button>}\r\n\r\n\r\n\r\n            {props.isShowControls && isShowFullScreenButt && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        props.gameContext.emitter.emit('mouseDown')('butt-fullscreen')\r\n                        changeShowFullScreenButt(false)\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n            {!props.isInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n            {props.isInfo && <Info />}\r\n        </div>\r\n    )\r\n})\r\n\r\n","import { connect } from 'react-redux'\r\nimport PlayerControls from './PlayerControls'\r\n\r\nconst mapStateToProps = state => ({ \r\n    isShowControls: state.controls.isShowControls,\r\n    isInfo: state.controls.isInfo,\r\n})\r\n\r\nfunction App(props) {\r\n    !dispatcher.dispatch && (dispatcher.dispatch = props.dispatch)\r\n    return (\r\n        <div className=\"ui\">\r\n            {!props.isInfo && props.gameContext.CustomReactComponent && <props.gameContext.CustomReactComponent gameContext={props.gameContext}/>}\r\n            {<PlayerControls gameContext={props.gameContext} />}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport const dispatcher = { dispatch: null }\r\nexport default connect(mapStateToProps)(App);\r\n","export const startDefaultStoreData = {\r\n    isShowControls: true,\r\n    isShowControlSound: false,\r\n    isMute: false, \r\n    isInfo: false,\r\n    infoPanelData: {\r\n        title: 'Discovery of small android',\r\n        topText: '',\r\n        chapters: [\r\n            // { text: 'Factory', href: 'http://js.otrisovano.ru/factory/' },\r\n            // { text: 'Brige', href: 'http://js.otrisovano.ru/bridge/' },\r\n            // { text: 'Cube', href: 'http://js.otrisovano.ru/levels/' },\r\n            // { text: 'Endways', href: 'http://js.otrisovano.ru/endways/' },\r\n\r\n            { text: 'Factory', href: './../chapter01' },\r\n            { text: 'Brige', href: './../chapter02' },\r\n            { text: 'Cube', href: './../chapter03' },\r\n            { text: 'Endways', href: './../chapter04' },\r\n            { text: 'in production' },\r\n        ],\r\n        currentChapterIndex: null,\r\n        bottomText: '',\r\n        afterWords: [\r\n            { text: 'Author: ',  aText: 'www.otrisovano.ru', href: 'http://otrisovano.ru' },\r\n            { text: 'Github: ',  aText: 'https://github.com/fire888/dark_boss', href: 'https://github.com/fire888/dark_boss' },\r\n        ],\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport App, { dispatcher } from './containersReact/App';\r\nimport { prepareStore } from './store/createStore'\r\nimport { changeLang } from \"../helpers/helper_translate\";\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n    if (!isAnimateLoader) return;\r\n\r\n    setTimeout(() => {\r\n        offsetLoader ++;\r\n        offsetLoader === 0 && (offsetLoader -= 100)\r\n        loader.style.marginLeft = offsetLoader + '%'\r\n        loaderTimeOut()\r\n    }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport class UI {\r\n    constructor(root) {\r\n        root.dispatcher = dispatcher\r\n        this._root = root\r\n        const store = prepareStore(root)\r\n\r\n\r\n        store && ReactDOM.render(\r\n            <Provider store={store}>\r\n                <App gameContext={root}/>\r\n            </Provider>,\r\n            document.getElementById('root')\r\n        )\r\n    }\r\n\r\n    showStartButton(onClick) {\r\n        const startButtons = document.querySelector('.startbuttons-wrapper')\r\n        const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n        const hideStartScreen = e => {\r\n            e.target.dataset && e.target.dataset.lang && changeLang(e.target.dataset.lang)\r\n            document.querySelector('.start-screen').style.display = 'none'\r\n        }\r\n\r\n        isAnimateLoader = false\r\n        startButtons.style.display = 'flex'\r\n        startButtons.addEventListener('click', e => {\r\n            onClick()\r\n            hideStartScreen(e)\r\n        })\r\n        progressWrapper.style.display = 'none'\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { createStore, applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\n\r\nimport { startDefaultStoreData } from './defaultUiData'\r\n\r\nexport function prepareStore(root) {\r\n    if (!root.customStore) root.customStore = {}\r\n\r\n    const controls = function(state = startDefaultStoreData, action) {\r\n        if (action.type === 'TOGGLE_INFO') {\r\n            return ({\r\n                ...state,\r\n                isShowControls: !!state.isInfo,\r\n                isInfo: !state.isInfo,\r\n            })\r\n        }\r\n        if (action.type === 'CHANGE_INFO_CHAPTER') {\r\n            return ({\r\n                ...state,\r\n                infoPanelData: {\r\n                    ...state.infoPanelData,\r\n                    currentChapterIndex: action.currentChapterIndex,\r\n                }\r\n            })\r\n        }\r\n        if (action.type === \"TOGGLE_CONTROLS\") {\r\n            return ({\r\n                ...state,\r\n                isShowControls: action.is,\r\n            })\r\n        }\r\n        if (action.type === 'ENABLE_CONTROL_SOUND') {\r\n            return ({\r\n                ...state,\r\n                isShowControlSound: true,\r\n            })\r\n        }\r\n        if (action.type === 'TOGGLE_MUTE') {\r\n            return ({\r\n                ...state,\r\n                isMute: action.is,\r\n            })\r\n        }\r\n        return ({ ...state })\r\n    }\r\n    \r\n    const rootReducer = combineReducers({ controls, ...root.customStore })\r\n    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n    return createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n}  \r\n","export const VOC = {\r\n    'ru': {\r\n        'I ...?': ' ...?', \r\n        'You ...?': ' ...?', \r\n        'MM ...?': ' ...?', \r\n        'You is new droid.': '  .',\r\n        'I am mechanic. I create your body.': '.   .',\r\n        'Go. Door is unblocked.... Beeeb.': ',  .... .',\r\n        'Once .... Beeeb.. I set basic program in your memory.': ' .... ..    .',\r\n        'I am programmer.': ' .',\r\n        'Go. Once... Beeeb.. Door to laboratory unblocked.': '     . ..  .',\r\n        'Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767': '... .   .',\r\n        'I am engineer. I test new droids.': ',   .',\r\n        'Go.': '  .',\r\n        'Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.': '... . ,  ...    _17543-06767-6767.',\r\n        'I am scientist. I check your abilities. ... garbage.': '.   . ',\r\n        'Go to store. Doors unblocked.': '  .  .',\r\n        'I dont know anything, go to the boss. ... Beeeb. You have the accesses.': '   ,   ... . :  .',\r\n        'You want see Boss. He is absent.': ' ,  .',\r\n        'I am guard. I give you a secret mission.':  '.     .',\r\n        'You must see all around base, and return. Doors unblocked.': '        . .',\r\n        'Droid_Id: 17543-06767-6767 with secret mission. I know.': '     .',\r\n        'I am gateman. Beeeb... Door is opened! Good bye!': '   . ...    .',\r\n        'It does not matter.': '   .',\r\n        'I am scout. Crazy factory create droids and close gates. You alone in this desert.': '.    ,      .',\r\n        'This is the end.': ' . The end.',\r\n\r\n        'open': '',\r\n        'close': '',\r\n    },\r\n}\r\n\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { VOC } from \"../constants/translate\";\r\nimport * as LIBA from '../../../_CORE/'\r\nconst t = LIBA.createTranslater(VOC)\r\n\r\n\r\nexport default connect(\r\n    state => { \r\n        return ({\r\n        replicies: state.dialogs.replicies,\r\n        currentBotKey: state.dialogs.currentBotKey, \r\n    }) }\r\n)(\r\n    function (props) {\r\n        const { messages } = props.replicies[props.currentBotKey]\r\n\r\n        const arrM = messages.map((item, ind)=> {\r\n            if (!item.isDone) return <div key={ind}></div>\r\n\r\n            return (\r\n                <div \r\n                    key={ind}\r\n                    className='marTop-small'>\r\n                    <p className='player'>{t(item.player)}</p>\r\n                    <p>{t(item.nps)}</p>\r\n                </div>)\r\n        })\r\n\r\n\r\n        const arrR = messages.map((item, ind)=> {\r\n            if (item.isDone) return <div key={ind}></div>\r\n\r\n            return (\r\n                <button\r\n                    key={ind}\r\n                    onClick={()=>props.dispatch({ type: 'CLICK_ON_PLAYER_PHRASE', currentBotKey: props.currentBotKey, phraseIndex: ind, })}>\r\n                    {t(item.player)}\r\n                </button>)\r\n        })\r\n\r\n\r\n        return (\r\n                <div className=\"messages-wrapper\">\r\n                    <div className=\"messages\">\r\n                        {arrM}\r\n                    </div>\r\n                    <div className=\"replicies\">\r\n                        {arrR}\r\n                    </div>\r\n                </div>\r\n        )\r\n    }\r\n)","import { connect } from 'react-redux'\r\nimport DialogPallete from \"./DialogPallete\"\r\nimport './stylesheets/CustomReactComponent.css'\r\nimport { VOC } from '../constants/translate'\r\nimport { createTranslater } from \"../../../_CORE/helpers/helper_translate\";\r\nconst t = createTranslater(VOC)\r\n\r\nconst mapStateToProps = state => {\r\n    return ({\r\n        isButtonDialog: state.dialogs.isButtonDialog,\r\n        isCloseisButtonDialog: state.dialogs.isCloseisButtonDialog,\r\n        isShowPalleteDialog: state.dialogs.isShowPalleteDialog,\r\n        isShowFinalMessage: state.dialogs.isShowFinalMessage,\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\nfunction CustomReactComponent(props) {\r\n    // if (!(props.isButtonDialog || props.isShowPalleteDialog)) { \r\n    //   return <div></div>\r\n    // }\r\n\r\n    return (\r\n      <>\r\n         {(!props.isShowFinalMessage && props.isButtonDialog || props.isShowPalleteDialog) && (\r\n          <div className=\"dialog-wrapper\">\r\n              <div className=\"dialog-content\">           \r\n                {props.isShowPalleteDialog && <DialogPallete />}\r\n                {(props.isButtonDialog || props.isShowPalleteDialog) && \r\n                      <button \r\n                          className=\"dialog-button-toggle\" \r\n                          onClick={() => props.dispatch({ \r\n                                      type: 'SHOW_PALLETE_DIALOG', \r\n                                      is:  (props.isButtonDialog && true) || \r\n                                        (props.isShowPalleteDialog && false)\r\n                                    })}            \r\n                          style={{ \"display\": props.display }}>\r\n                          {\r\n                            (props.isButtonDialog && t('open')) ||\r\n                            (props.isShowPalleteDialog && t('close'))\r\n                          }       \r\n                      </button>}\r\n              </div>     \r\n            </div>\r\n        )}\r\n\r\n        {props.isShowFinalMessage && (\r\n          <div className='final-mess'>\r\n            <button\r\n              onClick={() => {\r\n                window.location.replace('./../chapter02')\r\n              }}>\r\n              {t('Continue')}\r\n            </button>\r\n          </div>\r\n        )}\r\n      </>  \r\n    )\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(CustomReactComponent)\r\n","import { END_ENV } from '../constants/constants_elements'\r\n\r\nconst storeStartState = {\r\n    replicies: {\r\n        mechanic: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'You is new droid.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am mechanic. I create your body.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'Go. Door is unblocked.... Beeeb.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['factory'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        programmer: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'Once .... Beeeb.. I set basic program in your memory.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am programmer.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'Go. Once... Beeeb.. Door to laboratory unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromLaboratory001'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        engineer: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'Once .. Beeeb! I give name to you. Droid_Id: 17543-06767-6767',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am engineer. I test new droids.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'Go.',\r\n                isDone: false,\r\n            }]\r\n        },\r\n        scientist: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'Droid_Id: 17543-06767-6767, Hmm.., marriage. crap.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am scientist. I check your abilities. ... garbage.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'Go to store. Doors unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromFactoryCorpus', 'toLab', 'toGarage'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        master: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'I dont know anything, go to the boss. ... Beeeb. You have the accesses.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['toBoss'],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        guard_Super_02: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'You want see Boss. He is absent.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am guard. I give you a secret mission.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'You must see all around base, and return. Doors unblocked.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['fromStore', 'fromSecurity', 'toArsenal',],\r\n                    }\r\n                }\r\n            }]\r\n        },\r\n        guard_01: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'Droid_Id: 17543-06767-6767 with secret mission. I know.',\r\n                isDone: false,\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am gateman. Beeeb... Door is opened! Good bye!',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'unblockDoor',\r\n                    data: {\r\n                        idDoor: ['toWorld',],\r\n                    }\r\n                }\r\n            },]\r\n        },\r\n        scout: {\r\n            isDone: false,\r\n            messages: [{ \r\n                player: 'I ...?', \r\n                nps: 'It does not matter.',\r\n                isDone: false,\r\n                event: {\r\n                    type: 'blockDoor',\r\n                    data: {\r\n                        idDoor: ['toWorld',],\r\n                    }\r\n                }\r\n            },{\r\n                player: 'You ...?', \r\n                nps: 'I am scout. Crazy factory create droids and close gates. You alone in this desert.',\r\n                isDone: false,\r\n            },{\r\n                player: 'MM ...?', \r\n                nps: 'This is the end.',\r\n                isDone: false,\r\n            },]\r\n        },\r\n    },\r\n    isCloseisButtonDialog: false,\r\n    isButtonDialog: false,\r\n    isShowPalleteDialog: false,\r\n    isShowFinalMessage: false,\r\n    currentBotKey: null,\r\n    currentLanguage: 'en',\r\n} \r\n\r\n\r\nexport const createCustomStore = root => {\r\n    \r\n    const dialogs = (store = storeStartState, action) => {\r\n        if (action.type === 'BUTTON_DIALOG_TOGGLE') {\r\n            const {  isButtonDialog, currentBotKey } = action\r\n            return {\r\n                ...store,\r\n                isButtonDialog,\r\n                currentBotKey,\r\n            }\r\n        }\r\n\r\n        if (action.type === 'SHOW_PALLETE_DIALOG') {\r\n            root.player.toggleBlocked(action.is)\r\n            return {\r\n                ...store,\r\n                isButtonDialog: !action.is,\r\n                isShowPalleteDialog: action.is,\r\n            }\r\n        }\r\n\r\n        if (action.type === 'CLICK_ON_PLAYER_PHRASE') {\r\n            const replicies = JSON.parse(JSON.stringify(store.replicies))\r\n            replicies[action.currentBotKey].messages[action.phraseIndex].isDone = true\r\n\r\n            /** emit event */\r\n            if (replicies[action.currentBotKey].messages[action.phraseIndex].event) {\r\n                const { type, data } = replicies[action.currentBotKey].messages[action.phraseIndex].event\r\n                console.log(type, data)\r\n\r\n                if (type === 'blockDoor' && data.idDoor && data.idDoor.length && data.idDoor[0] ===  \"toWorld\") {\r\n                    setTimeout(() => {\r\n                        root.player.toggleBlocked(true)\r\n                        root.studio.changeEnvironment(END_ENV, { updateAmb: false, time: 1500 }) \r\n\r\n                        setTimeout(() => root.dispatcher.dispatch({ type: 'SHOW_FINAL_MESSAGE' }), 3000)\r\n                    }, 20000)\r\n                }    \r\n\r\n                root.emitter.emit(type)(data) \r\n            }\r\n\r\n            let isBotDone = true\r\n            for (let i = 0; i < replicies[action.currentBotKey].messages.length; ++i) {\r\n                replicies[action.currentBotKey].messages[i].isDone === false && (isBotDone = false)\r\n            }\r\n            replicies[action.currentBotKey].isDone = isBotDone\r\n            \r\n            return ({\r\n                ...store,\r\n                replicies,\r\n                isCloseisButtonDialog: isBotDone,\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'SHOW_FINAL_MESSAGE') {\r\n            return ({\r\n                ...store,\r\n                isShowFinalMessage: true,\r\n            })\r\n        }\r\n\r\n\r\n        return store\r\n    }\r\n\r\n\r\n    return { \r\n        dialogs \r\n    }\r\n}\r\n\r\n\r\n\r\n","export const Saturate = {\r\nuniforms: {\r\n\"tDiffuse\": { value: null },\r\n},\r\n\r\n\r\nvertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\nfragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\n\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\n\r\n\r\n\r\nexport class Studio {\r\n    constructor(root) {\r\n        this._root = root\r\n        const { assets, emitter, } = root\r\n        const { canId, rendererCon, clearColor, amb } = root.CONSTANTS.studioConfig\r\n\r\n        rendererCon.canvas = document.getElementById(canId)\r\n\r\n        this._renderer = new THREE.WebGLRenderer(rendererCon)\r\n        this._renderer.setClearColor(clearColor)\r\n        this._renderer.setPixelRatio(window.devicePixelRatio)\r\n        this._renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        this._scene = new THREE.Scene()\r\n\r\n        {\r\n            const { color, fogNear, fogFar, backgroundImgKey } = root.CONSTANTS.studioConfig.sceneEnvironment\r\n\r\n\r\n            this._scene.background = assets[backgroundImgKey] || null\r\n            this._scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n        }\r\n\r\n\r\n        this._lightA = null\r\n        {\r\n            const { color, strength } = amb\r\n            this._lightA = new THREE.AmbientLight( color, strength )\r\n            this._scene.add( this._lightA )\r\n        }\r\n\r\n        this._playerCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n\r\n\r\n        this._controlsCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n        this._controlsCamera.position.set(0, 0, 20)\r\n        const controls = new OrbitControls(this._controlsCamera, this._renderer.domElement)\r\n        controls.target.set(0, 0, 0)\r\n        controls.update();\r\n\r\n\r\n        this._composer = new EffectComposer(this._renderer)\r\n        this._renderPass = new RenderPass(this._scene, this._controlsCamera)\r\n        this._composer.addPass(this._renderPass)\r\n        if (this._root.CONSTANTS.studioConfig.composerAddPass) {\r\n            if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate') {\r\n                this._composer.addPass(new ShaderPass(Saturate))\r\n            }  \r\n        } \r\n\r\n\r\n\r\n        /** toggle view camera to debug by orbitControls */\r\n        const vec3 = new THREE.Vector3()\r\n        let isPlayerView = true \r\n        let saveFogData = null\r\n        emitter.subscribe('keyEvent')(data => {\r\n            if (!data['o']) {\r\n                return;\r\n            }\r\n\r\n            if (isPlayerView) {\r\n                saveFogData = { ...this._scene.fog }\r\n                this._scene.fog.near = 1000\r\n                this._scene.fog.far = 2000\r\n                isPlayerView = false\r\n                this._renderPass.camera = this._controlsCamera\r\n                this._playerCamera.getWorldPosition(vec3)\r\n                this._controlsCamera.position.x = vec3.x + 100\r\n                this._controlsCamera.position.y = vec3.y + 100\r\n                this._controlsCamera.position.z = vec3.z\r\n                controls.target.set(vec3.x, vec3.y, vec3.z)\r\n                controls.update()\r\n            } else {\r\n                this._scene.fog.near = saveFogData.near\r\n                this._scene.fog.far = saveFogData.far\r\n                isPlayerView = true \r\n                this._renderPass.camera = this._playerCamera\r\n            }\r\n        })\r\n    \r\n        \r\n\r\n        const resize = () => {\r\n            const size = { width: window.innerWidth, height: window.innerHeight }\r\n            this._renderer.setSize(size.width, size.height)\r\n            this._composer.setSize(size.width, size.height)\r\n            if (this._controlsCamera) {\r\n                this._controlsCamera.aspect = size.width/size.height\r\n                this._controlsCamera.updateProjectionMatrix()\r\n            }\r\n            if (this._playerCamera) {\r\n                this._playerCamera.aspect = size.width/size.height\r\n                this._playerCamera.updateProjectionMatrix()\r\n            }\r\n        }\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n\r\n\r\n\r\n\r\n        this.addToScene = this._scene.add.bind(this._scene)\r\n        this.removeFromScene = this._scene.remove.bind(this._scene)\r\n\r\n\r\n\r\n        const drawFrame = () => {\r\n            this._composer.render(this._scene, this._controlsCamera)\r\n        }\r\n        emitter.subscribe('frameUpdate')(drawFrame)\r\n\r\n\r\n\r\n        this._backgroundImgKey = root.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey\r\n        emitter.subscribe('changeSceneEnvironment')(sceneEnvironment => {\r\n            console.log('deprecated!!', 'studio', 'changeSceneEnvironment', sceneEnvironment)\r\n        })\r\n    }\r\n\r\n\r\n    /** PUBLIC ****************************************/\r\n\r\n    setCamera (cam) {\r\n        this._playerCamera = cam\r\n        this._renderPass.camera = this._playerCamera\r\n    }\r\n\r\n\r\n    changeEnvironment (sceneEnvironment, conf = null) {\r\n        this._changeFog(sceneEnvironment, conf)\r\n        this._changeBackground(sceneEnvironment, conf)\r\n    }\r\n\r\n\r\n    /** INTERNAL ****************************************/\r\n\r\n    _changeFog (sceneEnvironment, conf) {\r\n        const { fogNear, fogFar, color } = sceneEnvironment\r\n        if (\r\n            this._scene.fog.near !== fogNear ||\r\n            this._scene.fog.far !== fogFar ||\r\n            this._scene.fog.color !== fogFar\r\n        ) {\r\n            const startData = {\r\n                color: this._scene.fog.color,\r\n                near: this._scene.fog.near,\r\n                far: this._scene.fog.far,\r\n            }\r\n            const endData = {\r\n                color: new THREE.Color(color),\r\n                near: fogNear,\r\n                far: fogFar,\r\n            }\r\n\r\n            new TWEEN.Tween(startData)\r\n                .to(endData, (conf && conf.time) || 3000)\r\n                .onUpdate(() => {\r\n                    this._scene.fog.color = startData.color\r\n                    this._scene.fog.near = startData.near\r\n                    this._scene.fog.far = startData.far\r\n                    if (conf) { \r\n                        if (conf.updateAmb) this._lightA.color = startData.color\r\n                    } else {\r\n                        this._lightA.color = startData.color\r\n                    }\r\n                    this._renderer.setClearColor(startData.color)\r\n                })\r\n                .start()\r\n        }\r\n\r\n    }\r\n\r\n\r\n    _changeBackground (sceneEnvironment) {\r\n        const { backgroundImgKey } = sceneEnvironment\r\n\r\n        if (backgroundImgKey !== this._backgroundImgKey) {\r\n            this._backgroundImgKey = backgroundImgKey\r\n            this._scene.background = this._root.assets[backgroundImgKey] || null\r\n        }\r\n    }\r\n}\r\n\r\n","\r\nexport class KeyBoard {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const keys = {\r\n            'up': false,\r\n            'down': false,\r\n            'left': false,\r\n            'right': false,\r\n            'p': false,\r\n        }\r\n\r\n        const keysEnabled = {\r\n            'up': true,\r\n            'down': true,\r\n            'left': true,\r\n            'right': true,\r\n        }\r\n\r\n        this.keysEnabled = keysEnabled\r\n        this.keys = keys\r\n\r\n\r\n        const keyUpdate = function ( keyCode, isDown ) {\r\n            switch( keyCode ) {\r\n                case 38:\r\n                case 87:\r\n                    keysEnabled['up'] && (keys['up'] = isDown)\r\n                    break;\r\n                case 40:\r\n                case 83:\r\n                    keysEnabled['down'] && (keys['down'] = isDown)\r\n                    break;\r\n                case 37:\r\n                case 65:\r\n                    keys['left'] = isDown\r\n                    break;\r\n                case 39:\r\n                case 68:\r\n                    keys['right'] = isDown\r\n                    break;\r\n                case 79: \r\n                    keys['o'] = isDown\r\n                    break;                \r\n                case 80: \r\n                    keys['p'] = isDown\r\n                default:\r\n                    break;\r\n\r\n            }\r\n            emitter.emit('keyEvent')(keys)\r\n        }\r\n\r\n\r\n\r\n        document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n        document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, true)\r\n            if (key === 'butt-right') keyUpdate(39, true)\r\n            if (key === 'butt-front') keyUpdate(38, true)\r\n            if (key === 'butt-back') keyUpdate(40, true)\r\n        })\r\n        emitter.subscribe('mouseUp')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, false)\r\n            if (key === 'butt-right') keyUpdate(39, false)\r\n            if (key === 'butt-front') keyUpdate(38, false)\r\n            if (key === 'butt-back') keyUpdate(40, false)\r\n        })\r\n    }\r\n\r\n    toggleEnableKeys (key, is) {\r\n        this.keysEnabled[key] = is\r\n        !is && (this.keys[key] = false)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\nexport class Player {\r\n    constructor (root) {\r\n        this._root = root\r\n\r\n        const { emitter, studio, CONSTANTS } = root\r\n\r\n        const {\r\n            startPos,\r\n            startRot,\r\n            cameraData,\r\n            frontObjPos,\r\n            backObjPos,\r\n            lightDataOne,\r\n            speed,\r\n            offsetFromFloor,\r\n            offsetFromFloorFactor,\r\n            offsetWallCollision,\r\n            speedDown,\r\n            speedRot,\r\n        } = CONSTANTS.playerConfig\r\n\r\n\r\n        this._camera = null\r\n        let keys = {}\r\n        let isButtonsDisabled = false\r\n        this._isBlocked = true\r\n        this._isCanMove = {\r\n            'up': true,\r\n            'down': true,\r\n        }\r\n\r\n        this._mainObj = new THREE.Object3D()\r\n        this._mainObj.position.fromArray(startPos)\r\n        this._mainObj.rotation.fromArray(startRot)\r\n        this._mainObj.userData.type = 'player'\r\n\r\n        const bottomObj = new THREE.Object3D() \r\n        bottomObj.position.fromArray([0, -.05, 0])\r\n        this._mainObj.add(bottomObj)\r\n\r\n        const frontObj = new THREE.Object3D()\r\n        frontObj.position.fromArray(frontObjPos)\r\n        this._mainObj.add(frontObj)\r\n        this.frontObj = frontObj\r\n\r\n        const backObj = new THREE.Object3D()\r\n        backObj.position.fromArray(backObjPos)\r\n        this._mainObj.add(backObj)\r\n        this.backObj = backObj\r\n\r\n        {\r\n            const { fov, ratio, near, far, pos } = cameraData\r\n            this._camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n            this._camera.position.fromArray(pos)\r\n            this._mainObj.add(this._camera)\r\n        }\r\n\r\n        {\r\n            const { color, strenth, pos } = lightDataOne\r\n            const light = new THREE.PointLight(color, strenth)\r\n            light.position.fromArray(pos)\r\n            this._mainObj.add(light)\r\n        }\r\n\r\n\r\n        const update = data => {\r\n            if (isButtonsDisabled) return;\r\n\r\n            keys['left'] && (this._mainObj.rotation.y += (speedRot * data.count))\r\n            keys['right'] && (this._mainObj.rotation.y -= (speedRot * data.count))\r\n\r\n\r\n            if (this._isBlocked) return;\r\n\r\n            /** check bottom floors */\r\n            if (this._root.systemCollisionFloor) {\r\n                const [\r\n                    isBlockedByItem, \r\n                    offset,\r\n                    point, \r\n                ] = this._root.systemCollisionFloor.checkCollisions(this._mainObj, bottomObj, offsetFromFloor)\r\n                \r\n                if (!isBlockedByItem) {\r\n                    this._mainObj.position.y += speedDown\r\n                } else {\r\n                    if (offset < (offsetFromFloor - 1))  {\r\n                        this._mainObj.translateY(offsetFromFloor - offsetFromFloorFactor - offset)\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            if (!keys) return;\r\n\r\n            if (keys['up']) {\r\n                if (!this._isCanMove['up']) return;\r\n\r\n                if (this._root.systemCollisionItems) {\r\n                    const [ isBlockedByItem ] \r\n                        = this._root.systemCollisionItems.checkCollisions(this._mainObj, frontObj, offsetWallCollision)\r\n                   \r\n                        \r\n\r\n                    if (isBlockedByItem) return;\r\n                }\r\n\r\n                this._mainObj.translateZ(-speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'up' })\r\n            }\r\n\r\n            if (keys['down']) {\r\n                if (!this._isCanMove['down']) return;\r\n\r\n                if (this._root.systemCollisionItems) {\r\n                    const [ isBlockedByItem ] \r\n                        = this._root.systemCollisionItems.checkCollisions(this._mainObj, backObj, offsetWallCollision)\r\n                    if (isBlockedByItem) return;\r\n                }\r\n\r\n                this._mainObj.translateZ(speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'down' })\r\n            }\r\n\r\n            if (keys['p']) {\r\n                console.log(this._mainObj.position)\r\n            }\r\n        }\r\n\r\n\r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        emitter.subscribe('frameUpdate')(update)\r\n        emitter.subscribe('toggleDialog')(val => isButtonsDisabled = val.isOpen)\r\n\r\n\r\n        studio.setCamera(this._camera)\r\n        studio.addToScene(this._mainObj)\r\n    }\r\n\r\n    toggleBlocked (val) {\r\n        this._isBlocked = val\r\n    }\r\n\r\n    toggleCanMove(key, val) {\r\n        this._isCanMove[key] = val\r\n    }\r\n\r\n    getObj () {\r\n        return this._mainObj\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n    \r\n    setToPos (x, y, z) {\r\n        this._mainObj.position.set(x, y, z)\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\n\r\nexport class SystemCollisionWithItems {\r\n    constructor(root) {\r\n        this._root = root\r\n        this._arrMeshes = []\r\n\r\n\r\n        this._vecStart = new THREE.Vector3()\r\n        this._vecDir = new THREE.Vector3()\r\n        this._rayCaster = new THREE.Raycaster(this._vecStart, this._vecDir)\r\n    }\r\n\r\n    setItemToCollision ({\r\n        mesh,\r\n        itemKeyEmitCollision = null,\r\n        isStopUnits = true\r\n    }) {\r\n        mesh.userData.itemKeyEmitCollision = itemKeyEmitCollision\r\n        mesh.userData.isStopUnits = isStopUnits\r\n        this._arrMeshes.push(mesh)\r\n    }\r\n\r\n\r\n    removeItemFromCollision(mesh) {\r\n        this._arrMeshes = this._arrMeshes.filter(item => item !== mesh)\r\n    }\r\n\r\n\r\n    checkCollisions (objFrom, objTo, d) {\r\n        objFrom.getWorldPosition(this._vecStart)\r\n        objTo.getWorldPosition(this._vecDir)\r\n\r\n        this._vecDir.sub(this._vecStart)\r\n\r\n        const intersects = this._rayCaster.intersectObjects(this._arrMeshes)\r\n\r\n        if (intersects[0]) {\r\n            if (intersects[0].distance < d) {\r\n                if (intersects[0].object.userData.itemKeyEmitCollision) {\r\n                    this._root.emitter.emit('collision')({ \r\n                        ...intersects[0].object.userData.itemKeyEmitCollision, \r\n                        type2: objFrom.userData.type \r\n                    })\r\n                }\r\n\r\n                if (intersects[0].object.userData.isStopUnits) {\r\n                    return [ true, intersects[0].distance, intersects[0].point ]\r\n                }\r\n            }\r\n        }\r\n\r\n        return [ false, null ]\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nexport class Helper_MaterialsLib {\r\n    constructor (gameContext) {\r\n        const { assets, CONSTANTS } = gameContext\r\n\r\n        gameContext.materials = createMaterials(assets, CONSTANTS.MATERIALS_CONFIG)\r\n    }\r\n}\r\n\r\n\r\nconst createMaterials = (assets, MATERIALS_CONFIG) => {\r\n    for (let key in assets)\r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}","export default __webpack_public_path__ + \"static/media/level_01.bcfccfd8.obj\";","export default __webpack_public_path__ + \"static/media/wall.ccfc1f44.jpg\";","export default __webpack_public_path__ + \"static/media/level-ray.2b82bfff.obj\";","/**\r\n * Functions call callback after execution\r\n */\r\n\r\n\r\nexport const timer = (t, on) => setTimeout(on, t)\r\nexport const tween = (prop, key, fromVal, toVal, time, callback) => {\r\n    const timerStep = 16.666\r\n    const count = time / timerStep\r\n    const speed = (toVal - fromVal) / count\r\n\r\n    let currentCount = 0\r\n\r\n    const step = () => {\r\n        ++currentCount\r\n\r\n        if (currentCount > count) {\r\n            prop[key] = toVal\r\n            return void callback()\r\n        }\r\n\r\n        prop[key] += speed\r\n        setTimeout(step, timerStep)\r\n    }\r\n    step()\r\n}","/**\r\n * Function 'start' get arr of arr with func and its arguments\r\n * arr = [\r\n *   [func, [arg1, arg2, ...]], \r\n *   [func, [arg1, arg2, ...]], \r\n *    ...\r\n * ]\r\n * And execute as pipline one after anoter. \r\n * All functions must call its callbacks \r\n */\r\n\r\n\r\nexport const start = arr => iterateArrF(arr.map(data => on => () => data[0](...data[1], on)))\r\n\r\nconst iterateArrF = arrF => {\r\n    const iterate = i => arrF[i] && arrF[i](() => iterate(++i))()\r\n    iterate(0)\r\n}","import * as THREE from \"three\"\r\nimport { animateToOffsetAndReturn } from '../../../_CORE/components/componentTweenProp'\r\n\r\nconst OFFSET_PLAYER_FROM_DOOR = 7\r\n\r\nexport class SystemDoors {\r\n    constructor (root) {\r\n        const {\r\n            assets,\r\n            materials,\r\n            studio,\r\n            emitter,\r\n            systemCollisionItems,\r\n        } = root\r\n\r\n        this._doors = {}\r\n\r\n        assets['level-rooms'].traverse(child => {\r\n            if (child.name.includes(\"doormesh_\")) {\r\n                const key = child.name.split('_')[1]\r\n                !this._doors[key] && (this._doors[key] = {})\r\n                this._doors[key]['mesh'] = new THREE.Mesh(child.geometry, materials.door)\r\n                this._doors[key]['state'] = 'closed'\r\n                this._doors[key]['access'] = 'denied' //'confirm' // ||'denied' || 'confirm'\r\n                //this._doors[key]['access'] = 'confirm'\r\n                this._doors[key]['mesh']['userData'] = {\r\n                    part: 'mesh',\r\n                    type: 'door',\r\n                    id: key,\r\n                }\r\n            }\r\n        })\r\n\r\n\r\n        for (let key in this._doors) {\r\n            studio.addToScene(this._doors[key]['mesh'])\r\n            systemCollisionItems && systemCollisionItems.setItemToCollision({\r\n                mesh: this._doors[key]['mesh'],\r\n                dist: OFFSET_PLAYER_FROM_DOOR,\r\n                itemKeyEmitCollision: { key, type: 'door' },\r\n                isStopUnits: true\r\n            })\r\n        }\r\n\r\n\r\n        emitter.subscribe('collision')(data => {\r\n            data.type === 'door' \r\n                && data.type2 \r\n                    && data.type2 === 'player'\r\n                        && this._doors[data.key]['access'] === 'confirm'\r\n                            && this._doors[data.key].state === 'closed'\r\n                                && this._openDoor(data.key)\r\n            }\r\n        )\r\n\r\n        emitter.subscribe('unblockDoor')(data => { \r\n            for (let i = 0; i < data.idDoor.length; i++) {\r\n                this._doors[data.idDoor[i]]['access'] = 'confirm'\r\n            } \r\n        }) \r\n\r\n\r\n        emitter.subscribe('blockDoor')(data => { \r\n            for (let i = 0; i < data.idDoor.length; i++) {\r\n                this._doors[data.idDoor[i]]['access'] = 'denied'\r\n            } \r\n        }) \r\n    }\r\n\r\n\r\n\r\n    _openDoor (key) {\r\n        this._doors[key].state = 'opened'\r\n\r\n        const data = {\r\n            prop: this._doors[key]['mesh'].position,\r\n            key: 'y',\r\n            fromVal: this._doors[key]['mesh'].position.y,\r\n            offset: 15,\r\n            time: 500,\r\n            pause: 2000,\r\n        }\r\n        animateToOffsetAndReturn(data, () => this._doors[key].state = 'closed')\r\n    }\r\n}","/** \r\n * Small scenarious to change one prop of object \r\n */\r\n\r\n \r\nimport { timer, tween } from \"./funcs/transformProp\";\r\nimport { start } from \"../utils/iterate\";\r\n\r\n\r\nexport function animateToOffsetAndReturn (\r\n    { prop, key, fromVal, offset, time = 1000, pause = 2000 },\r\n    onAllComplete = () => {},\r\n) {\r\n    const\r\n        animateToOffset = [tween, [prop, key, fromVal, fromVal + offset, time]], \r\n        wait = [timer, [pause]],\r\n        animateFromOffsetToStart = [tween, [prop, key, fromVal + offset, fromVal, time]],\r\n        onComplete = [onAllComplete, []]\r\n\r\n    start([\r\n        animateToOffset, \r\n        wait, \r\n        animateFromOffsetToStart, \r\n        onComplete,\r\n    ])\r\n}\r\n\r\n","export default __webpack_public_path__ + \"static/media/door.edd859db.jpg\";","import * as THREE from 'three'\r\n\r\n\r\nconst ran = Math.random\r\n\r\n\r\n\r\nexport function createBot (monsterModel, monsterMat, botData, root) {\r\n    const {\r\n        emitter,\r\n    } = root\r\n\r\n\r\n    const group = new THREE.Group()\r\n\r\n\r\n    const animations = createAnimations(monsterModel)\r\n    animations.play('walk')\r\n\r\n\r\n    const obj = monsterModel.scene.children[1]\r\n    obj.children[1].material = monsterMat\r\n    obj.position.set(0, -8, 0)\r\n\r\n\r\n    const objRay = new THREE.Object3D()\r\n    objRay.position.set(0, 0, 1)\r\n    group.add(objRay)\r\n\r\n\r\n    group.add(obj)\r\n\r\n\r\n    let isUpdate = false\r\n\r\n\r\n    const freeWalk = createFreeWalk(group, objRay, 20, emitter)\r\n    freeWalk.setItemToCollision(root.botsCustomWallsCollisions[botData.keyWallToWalkCollisions])\r\n    freeWalk.start()\r\n    \r\n\r\n    const boxCollisionWithPlayer = new THREE.Mesh(\r\n       new THREE.BoxGeometry(6, 6, 6),\r\n       new THREE.MeshBasicMaterial()\r\n    )\r\n    boxCollisionWithPlayer.position.y = -5\r\n    boxCollisionWithPlayer.visible = false\r\n    group.add(boxCollisionWithPlayer)\r\n    root.systemCollisionItems.setItemToCollision({ mesh: boxCollisionWithPlayer })\r\n\r\n\r\n\r\n    return ({ \r\n        mesh: group,\r\n        isUpdate,\r\n        update (data) {\r\n            if (isUpdate) {\r\n                return;\r\n            }\r\n            \r\n            animations.update(data.delta)\r\n        },\r\n        stay (playerPos) { \r\n            freeWalk.stop()\r\n            animations.play('dialog')\r\n\r\n            const vec3 = new THREE.Vector3()\r\n            vec3.copy(playerPos)\r\n            vec3.y = group.position.y\r\n            group.lookAt(vec3)\r\n        },\r\n        walk () { \r\n            freeWalk.start()\r\n            animations.play('walk')\r\n        },\r\n        startUpdate () {\r\n            if (isUpdate) return;\r\n            isUpdate = true\r\n            freeWalk.play()\r\n            animations.play('walk')\r\n        },\r\n        stopUpdate () {\r\n            if (!isUpdate) return;\r\n            isUpdate = false\r\n            freeWalk.stop()\r\n        },\r\n    })\r\n}\r\n\r\n\r\n\r\n/** ANIMATION MANAGER ****************************************/\r\n\r\nconst createAnimations = monsterModel => {\r\n    const animations = monsterModel.animations\r\n    const mixer = new THREE.AnimationMixer(monsterModel.scene.children[1].children[1])\r\n\r\n    const dialog = mixer.clipAction(animations[0])\r\n    dialog.timeScale = 0.3\r\n    const walk = mixer.clipAction(animations[2])\r\n    walk.timeScale = 0.7\r\n\r\n    walk.play()\r\n\r\n\r\n    const actions = { dialog, walk }\r\n    let currentAction = null\r\n\r\n    return {\r\n        update: d => { \r\n            mixer.update(d)\r\n        },\r\n        play: key => {\r\n            if (currentAction === key) return;\r\n\r\n            currentAction = key\r\n\r\n            mixer.stopAllAction()\r\n            actions[key].play()\r\n        },\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/** WALKING ***************************************************/\r\n\r\n\r\nconst startRotate = mesh => {\r\n    const angleRot = (ran() * Math.PI * 1.5 + 1.3) * ran() < 0.5 ? 1 : -1\r\n    const numRotations = 40\r\n    const speed = angleRot / numRotations\r\n\r\n    let countRotation = 0\r\n\r\n    return () => {\r\n        mesh.rotation.y += speed\r\n        return ++countRotation < numRotations\r\n    }\r\n}\r\n\r\n\r\n\r\nconst startGo = (mesh, dist)  => {\r\n    const speed = 0.15\r\n    const numsMove = dist\r\n        ? Math.min(dist / speed, ran() * 800 + 300)\r\n        : null\r\n\r\n    let countMove = 0\r\n\r\n    return () => {\r\n        if (!dist) {\r\n            return false;\r\n        }\r\n        mesh.translateZ(speed)\r\n        return ++countMove < numsMove\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst createFreeWalk = (mesh, meshFrontObj, wallOffset, emitter) => {\r\n    let isUpdate = false\r\n    const collisions = createCollisionWithItems()\r\n\r\n    const actions = {\r\n        'rotate': startRotate,\r\n        'go': startGo,\r\n    }\r\n\r\n    let state = 'rotate' // || 'go'\r\n    let currentAction = null\r\n\r\n\r\n    const toggleAction = key => {\r\n        if (!key) {\r\n            state === 'rotate' && (key = 'go')\r\n            state === 'go' && (key = 'rotate')\r\n        }\r\n\r\n        state = key\r\n        const d = collisions.checkCollisions(mesh, meshFrontObj)\r\n        currentAction = actions[key](mesh, Math.max(d - 20, 0))\r\n    }\r\n\r\n\r\n    toggleAction(state)\r\n\r\n\r\n    emitter.subscribe('frameUpdate')(() => {\r\n        if (!isUpdate) {\r\n            return;\r\n        }\r\n        !currentAction() && toggleAction()\r\n    })\r\n\r\n\r\n    return {\r\n        start: () => {\r\n            toggleAction('rotate')\r\n            isUpdate = true\r\n        },\r\n        stop: () => isUpdate = false,\r\n        setItemToCollision: collisions.setItemToCollision,\r\n        removeItemFromCollision: collisions.removeItemFromCollision,\r\n        clearCollisions: collisions.clearCollisions,\r\n    }\r\n}\r\n\r\n\r\n\r\n/** COLLISIONS *************************************************/\r\n\r\nconst createCollisionWithItems = () => {\r\n        let arrMeshes = []\r\n\r\n        const vecStart = new THREE.Vector3()\r\n        const vecDir = new THREE.Vector3()\r\n        const rayCaster = new THREE.Raycaster(vecStart, vecDir)\r\n\r\n\r\n    return {\r\n        setItemToCollision (mesh) {\r\n            arrMeshes.push(mesh)\r\n        },\r\n        removeItemFromCollision (mesh) {\r\n            arrMeshes = arrMeshes.filter(item => item !== mesh)\r\n        },\r\n        clearCollisions () {\r\n            arrMeshes = []\r\n        },\r\n        checkCollisions (objFrom, objTo) {\r\n            objFrom.getWorldPosition(vecStart)\r\n            objTo.getWorldPosition(vecDir)\r\n\r\n            vecDir.sub(vecStart)\r\n\r\n            const intersects = rayCaster.intersectObjects(arrMeshes, true)\r\n\r\n            if (intersects[0]) {\r\n                return intersects[0].distance\r\n            }\r\n\r\n            return false\r\n        }\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/monster-animate3.f32b90f6.glb\";","export default __webpack_public_path__ + \"static/media/monster-skin.64f3a049.jpg\";","import * as THREE from \"three\";\r\n\r\n\r\nexport class SystemCheckerNearItem {\r\n    constructor() {\r\n        this._itemWorldPos = new THREE.Vector3()\r\n        this._mainCheckerWorldPos = new THREE.Vector3()\r\n\r\n        this._arr = []\r\n    }\r\n\r\n\r\n    setItemToCheck (mesh) {\r\n        this._arr.push(mesh)\r\n    }\r\n\r\n    checkNear (mainMesh, dist) {\r\n        mainMesh.getWorldPosition(this._mainCheckerWorldPos)\r\n\r\n        for (let i = 0; i < this._arr.length; ++i) {\r\n            if (!this._arr[i].userData.inScene) continue;\r\n\r\n            this._arr[i].getWorldPosition(this._itemWorldPos)\r\n            const distance = this._itemWorldPos.distanceTo(this._mainCheckerWorldPos)\r\n            if (distance < dist) {\r\n                return [true, this._arr[i].userData]\r\n            }\r\n        }\r\n\r\n        return [ false, null ]\r\n    }\r\n}\r\n\r\n","import { LoaderAssets } from '../../../_CORE/helpers/helper_LoadAssets'\r\nimport { EventEmitter } from \"../../../_CORE/helpers/helper_Emitter\"\r\nimport { CustomUi } from '../ui/Ui'\r\nimport { DeviceResizer } from \"../../../_CORE/helpers/helper_DeviceResizer\"\r\nimport { FrameUpdater } from \"../../../_CORE/helpers/helper_FrameUpater\"\r\nimport { Helper_TweenUpdater } from \"../../../_CORE/helpers/helper_TweenUpdater\"\r\nimport { Studio } from '../../../_CORE/entities/createStudio'\r\nimport { KeyBoard } from \"../../../_CORE/helpers/helper_KeyBoard\"\r\nimport { Player } from '../../../_CORE/entities/createPlayer'\r\nimport { SystemCollisionWithItems } from '../../../_CORE/systems/SystemCollisionsItems'\r\nimport { Helper_MaterialsLib } from '../../../_CORE/helpers/helper_MaterialsLib'\r\n\r\n\r\nimport { SystemLevel } from '../systems/system_Level'\r\nimport levelSrc from '../../../assets/chapter01/level_01.obj'\r\nimport wallTextureSrc from '../../../assets/chapter01/wall.jpg' \r\nimport levelCollisionSrc from '../../../assets/chapter01/level-ray.obj'\r\n\r\n\r\nimport { SystemDoors } from '../systems/system_Doors'\r\nimport doorTextureSrc from '../../../assets/chapter01/door.jpg'\r\n\r\n\r\nimport { SystemBots } from \"../systems/system_Bots\"\r\nimport botSrc from '../../../assets/chapter01/monster-animate3.glb'\r\nimport botMap from \"../../../assets/chapter01/monster-skin.jpg\";\r\nimport { CheckerDialogWithBot } from \"../systems/system_CheckerDialogWithBot\";\r\n\r\n\r\nimport { AdderActions } from \"../actions/AdderActions\"\r\n\r\n\r\n\r\n\r\nexport const GAME_MODULES = [\r\n    {\r\n        key: 'emitter',\r\n        constr: EventEmitter,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'customUi',\r\n        constr: CustomUi,\r\n        initStateKey: 'pageLoaded',  \r\n    },\r\n    {\r\n         key: 'deviceResizer',\r\n         constr: DeviceResizer,\r\n         initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'loaderAssets',\r\n        constr: LoaderAssets,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n\r\n    // /////////////////////////////////////////\r\n\r\n    {\r\n         key: 'frameUpdater',\r\n         constr: FrameUpdater,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'tweenUpdater',\r\n         constr: Helper_TweenUpdater,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'studio',\r\n         constr: Studio,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'keyBoard',\r\n         constr: KeyBoard,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'player',\r\n         constr: Player,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'systemCollisionItems',\r\n        constr: SystemCollisionWithItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'systemCollisionFloor',\r\n        constr: SystemCollisionWithItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n         key: 'materialsLib',\r\n         constr: Helper_MaterialsLib,\r\n         initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'level',\r\n        constr: SystemLevel,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: levelSrc, key: 'level-rooms' },\r\n            { type: 'obj', path: levelCollisionSrc, key: 'levelCollisions' },\r\n            { type: 'img', path: wallTextureSrc, key: 'wallTexture', wrap: true },\r\n        ],\r\n    },\r\n    {\r\n        key: 'doors',\r\n        constr: SystemDoors,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'img', path: doorTextureSrc, key: 'doorTexture', wrap: false }, \r\n        ] \r\n    },\r\n    {\r\n        key: 'bots',\r\n        constr: SystemBots ,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'glb', path: botSrc, key: 'bot' },\r\n            { type: 'img', path: botMap, key: 'monster-skin' },\r\n        ]\r\n    },\r\n    {\r\n        key: 'playerNearBot',\r\n        constr: CheckerDialogWithBot,\r\n        initStateKey: 'beforeStartPlay',   \r\n    },\r\n    {\r\n        key: 'adderActions',\r\n        constr: AdderActions,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n]\r\n\r\n","import { UI } from '../../../_CORE/ui/UI'\r\nimport CustomReactComponent from \"./CustomReactComponent\";\r\nimport { createCustomStore  } from \"./createStore\";\r\n\r\nexport class CustomUi {\r\n    constructor(root) {\r\n\r\n        root.appWrapper = document.querySelector('.app-wrapper')\r\n        root.CustomReactComponent = CustomReactComponent\r\n        root.customStore = createCustomStore(root)\r\n\r\n        root.ui = new UI(root)\r\n    } \r\n} \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport class DeviceResizer {\r\n    constructor (gameContext) {\r\n        let { emitter, appWrapper } = gameContext\r\n\r\n        !appWrapper && (appWrapper = document.querySelector('.app-wrapper')) \r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n        })\r\n\r\n        /** fullscreen */\r\n        const openAppFullScreenIfMobile = () => {\r\n            if (appWrapper.requestFullscreen) {\r\n                appWrapper.requestFullscreen()\r\n            } else if (appWrapper.mozRequestFullScreen) {\r\n                appWrapper.mozRequestFullScreen()\r\n            } else if (appWrapper.webkitRequestFullscreen) {\r\n                appWrapper.webkitRequestFullscreen()\r\n            } else if (appWrapper.msRequestFullscreen) {\r\n                appWrapper.msRequestFullscreen()\r\n            }\r\n        }\r\n\r\n        /** resize */\r\n        const resize = e => {\r\n            appWrapper.style.width = window.innerWidth + 'px'\r\n            appWrapper.style.height = window.innerHeight + 'px'\r\n            appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n            if (!document.fullscreenElement) {\r\n                emitter.emit('screenMode')('exitFullScreen')\r\n            }\r\n\r\n        }\r\n\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n    }\r\n}\r\n","import * as R from 'ramda'\r\n\r\n\r\nexport class FrameUpdater {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const emitFrameUpdate = emitter.emit('frameUpdate')\r\n\r\n        let data = {\r\n            time: 0,\r\n            delta: 0,\r\n            count: 0,\r\n            oldTime: 0\r\n        }\r\n\r\n        const getDataFromGlobalVar = () => data\r\n\r\n        const updateTime = data => {\r\n            data.time = Date.now()\r\n            return data\r\n        }\r\n\r\n        const updateDelta = data => {\r\n            data.delta = (data.time - data.oldTime) * 0.001\r\n            if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n                data.delta = 1000/60 * 0.001;\r\n            }\r\n            return data\r\n        }\r\n\r\n        const updateCount = data => {\r\n            data.count = data.delta / (1/60)\r\n            return data\r\n        }\r\n\r\n        const emit = data => {\r\n            emitFrameUpdate(data)\r\n            return data\r\n        }\r\n\r\n        const updateOldTime = data => {\r\n            data.oldTime = data.time\r\n            return data\r\n        }\r\n\r\n        const saveDataInGlobalVar = dataFromChine => {\r\n            data = dataFromChine\r\n            return data\r\n        }\r\n\r\n        const update = R.pipe(\r\n            getDataFromGlobalVar,\r\n            updateTime,\r\n            updateDelta,\r\n            updateCount,\r\n            emit,\r\n            updateOldTime,\r\n            saveDataInGlobalVar\r\n        )\r\n\r\n        const animate = () => {\r\n            requestAnimationFrame(animate)\r\n            update(data)\r\n        }\r\n\r\n        animate()\r\n\r\n    }\r\n}","import * as TWEEN from '@tweenjs/tween.js'\r\n\r\n\r\nexport class Helper_TweenUpdater {\r\n    constructor (gameContext) {\r\n        gameContext['emitter'].subscribe('frameUpdate')(() => TWEEN.update())\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport class SystemLevel {\r\n    constructor (root) {\r\n        const { \r\n            assets, \r\n            materials, \r\n            studio, \r\n            systemCollisionItems,\r\n            systemCollisionFloor,\r\n        } = root\r\n\r\n        const {\r\n            offsetFromFloor,\r\n        } = root.CONSTANTS.playerConfig\r\n\r\n\r\n        const botsCustomWallsCollisions = {}\r\n\r\n        assets['level-rooms'].traverse(child => {\r\n            child.name.includes(\"room_\") \r\n                && studio.addToScene(new THREE.Mesh(child.geometry, materials.wall))\r\n                \r\n                \r\n            if (child.name.includes(\"collision_bot\")) {\r\n                botsCustomWallsCollisions[child.name] = child \r\n            }    \r\n        })\r\n\r\n        root.botsCustomWallsCollisions = botsCustomWallsCollisions\r\n\r\n\r\n\r\n        assets['levelCollisions'].traverse(child => {\r\n            child.name === \"wall_collision\" \r\n                && systemCollisionItems\r\n                    && systemCollisionItems.setItemToCollision({\r\n                            mesh: new THREE.Mesh(child.geometry, materials.easyMaterial),\r\n                            dist: 5,\r\n                            isStopUnits: true\r\n                        })\r\n            child.name === \"floor_collision\" \r\n                && systemCollisionFloor     \r\n                    && systemCollisionFloor.setItemToCollision({ \r\n                        mesh: new THREE.Mesh(child.geometry, materials.easyMaterial), \r\n                        dist: offsetFromFloor,\r\n                        isStopUnits: true,\r\n                    })\r\n        })\r\n    }\r\n}","import { createBot } from '../entities/Bot'\r\nimport { GLTFCopy } from '../../../_CORE/helpers/helper_GLTFcopy' \r\n\r\n\r\nexport class SystemBots {\r\n    constructor (root) {\r\n        const { \r\n            assets, \r\n            materials, \r\n            studio, \r\n            emitter,\r\n        } = root\r\n    \r\n        this.bots = {}\r\n\r\n        root.CONSTANTS.BOTS.forEach(item => {\r\n            const unit = createBot(\r\n                GLTFCopy(assets.bot), \r\n                materials.bot, \r\n                item,\r\n                root,\r\n            )\r\n            unit.mesh.position.set(item.pos[0], item.pos[1], item.pos[2])\r\n            unit.mesh.rotation.y = item.rot\r\n            unit.name = item.name\r\n            studio.addToScene(unit.mesh)\r\n            unit.mesh.userData.inScene = true\r\n            unit.mesh.userData.key = item.name\r\n            this.bots[item.name] = unit\r\n        })\r\n\r\n\r\n        emitter.subscribe('frameUpdate')(data => {\r\n            for (let key in this.bots) {\r\n                this.bots[key].update(data)\r\n            }\r\n        })\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport const GLTFCopy = gltf => {\r\n    const clone = {\r\n          animations: gltf.animations,\r\n          scene: gltf.scene.clone(true)\r\n    };\r\n  \r\n    const skinnedMeshes = {};\r\n  \r\n    gltf.scene.traverse(node => {\r\n        if (node.isSkinnedMesh) {\r\n            skinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    const cloneBones = {};\r\n    const cloneSkinnedMeshes = {};\r\n  \r\n    clone.scene.traverse(node => {\r\n        if (node.isBone) {\r\n            cloneBones[node.name] = node;\r\n        }\r\n  \r\n        if (node.isSkinnedMesh) {\r\n            cloneSkinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    for (let name in skinnedMeshes) {\r\n        const skinnedMesh = skinnedMeshes[name];\r\n        const skeleton = skinnedMesh.skeleton;\r\n        const cloneSkinnedMesh = cloneSkinnedMeshes[name];\r\n  \r\n        const orderedCloneBones = [];\r\n  \r\n        for (let i = 0; i < skeleton.bones.length; ++i) {\r\n            const cloneBone = cloneBones[skeleton.bones[i].name];\r\n            orderedCloneBones.push(cloneBone);\r\n        }\r\n  \r\n        cloneSkinnedMesh.bind(\r\n            new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses),\r\n            cloneSkinnedMesh.matrixWorld);\r\n    }\r\n  \r\n    return clone;\r\n}","import { SystemCheckerNearItem } from \"../../../_CORE/systems/SystemCheckerNearItem\";\r\n\r\n\r\nexport class CheckerDialogWithBot {\r\n    constructor(root) {\r\n        const { player, bots, emitter } = root\r\n\r\n        const checkerNear = new SystemCheckerNearItem()\r\n        const checkerNearBlock = new SystemCheckerNearItem()\r\n        for (let key in bots.bots) {\r\n            checkerNear.setItemToCheck(bots.bots[key].mesh)\r\n            checkerNearBlock.setItemToCheck(bots.bots[key].mesh)\r\n        }\r\n\r\n\r\n        const mesh = {\r\n            'up': player.frontObj,\r\n            'down': player.backObj,\r\n        }\r\n\r\n        let keyBotNear = null\r\n\r\n        emitter.subscribe('playerMove')(({ dir }) => {\r\n            /** check dialog */\r\n            {\r\n                const [ isNear, data ] = checkerNear.checkNear(mesh[dir], 20)\r\n\r\n                if (!isNear) {\r\n                    if (keyBotNear) {\r\n                        bots.bots[keyBotNear].walk(player._mainObj.position)\r\n                        keyBotNear = null\r\n                        emitter.emit('nearBot')({ isNearBot: false, botKey: keyBotNear })\r\n                    }\r\n                } else {\r\n                    if (!keyBotNear) {\r\n                        keyBotNear = data.key\r\n                        bots.bots[keyBotNear].stay(player._mainObj.position)\r\n                        emitter.emit('nearBot')({ isNearBot: true, botKey: keyBotNear })\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}","\r\n\r\nexport class AdderActions {\r\n    constructor (_root) {\r\n        const { player, ui, dispatcher, emitter } = _root\r\n\r\n        dispatcher.dispatch({ type: 'CHANGE_INFO_CHAPTER', currentChapterIndex: 0 })\r\n        ui.showStartButton(() => player.toggleBlocked(false))\r\n\r\n        emitter.subscribe('nearBot')(({ isNearBot, botKey }) => {\r\n            dispatcher.dispatch({ type: 'BUTTON_DIALOG_TOGGLE', isButtonDialog: isNearBot, currentBotKey: botKey })\r\n        })\r\n    }\r\n}\r\n","import { pipeLineForInit } from '../../_CORE/pipeLines/initPipeLine'\r\nimport * as CONSTANTS from './constants/constants_elements'\r\nimport { GAME_MODULES } from \"./constants/constants_modules\"\r\n\r\n\r\nwindow.addEventListener('load', () => pipeLineForInit(GAME_MODULES, CONSTANTS))\r\n"],"sourceRoot":""}