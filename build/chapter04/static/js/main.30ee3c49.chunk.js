(this.webpackJsonplevels=this.webpackJsonplevels||[]).push([[0],{39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"MATERIALS_CONFIG",(function(){return u})),n.d(o,"START_ENV_CONFIG",(function(){return h})),n.d(o,"START_ENV_CONFIG_2",(function(){return d})),n.d(o,"START_ENV_CONFIG_3",(function(){return m})),n.d(o,"studioConfig",(function(){return f})),n.d(o,"playerConfig",(function(){return p}));var a=n(9),r=n.n(a),i=n(11);function s(){return(s=Object(i.a)(r.a.mark((function e(t,n){var o,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c("pageLoaded",t,o={CONSTANTS:n}),a=o.loaderAssets,i=l(t),e.next=6,a.loadAssets(i);case 6:o.assets=e.sent,c("beforeStartPlay",t,o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var c=function(e,t,n){for(var o=0;o<t.length;++o){var a=t[o],r=a.key,i=a.constr;a.initStateKey===e&&(n[r]=new i(n))}},l=function(e){for(var t=[],n=0;n<e.length;++n)if(e[n].assetsToLoad&&e[n].assetsToLoad.length)for(var o=0;o<e[n].assetsToLoad.length;++o)t.push(e[n].assetsToLoad[o]);return t},u={wall:{mat:"MeshPhongMaterial",props:{color:3377271,emissive:161052535,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.3,shininess:60,specular:2236962}},groundTop:{mat:"MeshPhongMaterial",props:{color:11167334,emissive:11167334,map:"mapTop",bumpMap:"mapTop",bumpScale:1,envMap:"skyBox2",reflectivity:.5,specular:2236962}},road:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:6710886,map:"mapFloorOuter2",bumpMap:"mapFloorOuter2",bumpScale:1,envMap:"skyBox",reflectivity:.3}},skin:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:5592405,specular:16777215,shininess:12,bumpMap:"skin",bumpScale:.8,envMap:"skyBox",reflectivity:.5,map:"skin",skinning:!0}}},h={fogNear:-10,fogFar:20,color:4852293,backgroundImgKey:"skyBox2"},d={fogNear:-10,fogFar:0,color:4852293,backgroundImgKey:"skyBox2"},m={fogNear:20,fogFar:500,color:4852293,backgroundImgKey:"skyBox2"},f={canId:"webgl-canvas",rendererCon:{antialias:!0},amb:{color:10874053,strength:.8},sceneEnvironment:{fogNear:-20,fogFar:0,color:4852293,backgroundImgKey:"skyBox2"},composerAddPass:"Saturate"},p={speed:.8,speedRot:.02,speedDown:-.45,offsetFromFloor:10,offsetFromFloorFactor:.5,offsetWallCollision:3.5,level:-13,startRot:[0,0,0],startPos:[0,5,0],cameraData:{fov:90,ratio:window.innerWidth/window.innerHeight,near:.1,far:1e3,pos:[0,2,-.5]},frontObjPos:[0,0,-1],backObjPos:[0,0,1],lightDataOne:{color:5592405,strength:0,pos:[0,400,5]}},b=n(1),g=n(2),y=n(0),v=n(20),j=n(21),w=function(){var e=null,t=null,n=null,o=null;return function(a,r){return new Promise((function(i){(function(a){return"obj"===a?e=e||new v.a:"glb"===a||"gltf"===a?n=n||new j.a:"img"===a?t=t||new y.TextureLoader:"cubeTextures"===a?o=o||new y.CubeTextureLoader:void 0})(r).load(a,i)}))}},O=function(){function e(){Object(b.a)(this,e),this.resources={},this._load=w()}return Object(g.a)(e,[{key:"loadAssets",value:function(e){var t=this;return new Promise((function(n){var o=t._load,a=t.resources;function s(e){return c.apply(this,arguments)}function c(){return(c=Object(i.a)(r.a.mark((function t(i){var c,l,u,h;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e[i]){t.next=5;break}return c=e[i],l=c.key,u=c.path,h=c.type,t.next=4,o(u,h);case 4:a[l]=t.sent;case 5:if(++i,e[i]){t.next=10;break}n(a),t.next=12;break;case 10:return t.next=12,s(i);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}s(0)}))}}]),e}(),_=function(){function e(){Object(b.a)(this,e),this._storage={}}return Object(g.a)(e,[{key:"emit",value:function(e){var t=this;return function(n){return k(t._storage)(e).forEach((function(e){return e(n)}))}}},{key:"subscribe",value:function(e){var t=this;return function(n){return k(t._storage)(e).push(n),function(){return t._storage[e]=t._storage[e].filter((function(e){return e!==n}))}}}},{key:"showAll",value:function(){var e={};for(var t in this._storage)e[t]=this._storage[t].length;console.log(e)}}]),e}(),k=function(e){return function(t){return e[t]=e[t]||[]}},C=n(5),x=n(16),S=n.n(x),T=n(7),D=n(10),I=n(6),A=(n(39),"en"),M=function(e){return function(t){return e[A]&&e[A][t]||t}},P=n(4),E=M({ru:{"Discovery of small android":"\u041f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f \u0434\u0440\u043e\u0438\u0434\u0430",Factory:"\u0424\u0430\u0431\u0440\u0438\u043a\u0430",Brige:"\u041c\u043e\u0441\u0442",Cube:"\u041a\u0443\u0431",Endways:"\u041d\u0430\u043f\u0440\u044f\u043c\u0438\u043a","in production":"\u0441\u043a\u043e\u0440\u043e.."," (current)":" (\u0442\u0443\u0442)","Author: ":"\u043e\u0442: ","Github: ":"\u0413\u0438\u0442\u0445\u0430\u0431: "}}),N=Object(T.b)((function(e){return Object(I.a)({},e.controls.infoPanelData)}))((function(e){return Object(P.jsxs)("div",{className:"info",children:[Object(P.jsx)("button",{className:"control butt-infoClose",onClick:function(){return e.dispatch({type:"TOGGLE_INFO"})},children:"x"}),Object(P.jsxs)("div",{className:"info-inner",children:[Object(P.jsx)("p",{children:E(e.title)}),Object(P.jsx)("p",{children:E(e.topText)}),Object(P.jsx)("ul",{children:e.chapters.map((function(t,n){return Object(P.jsxs)("li",{children:[n+1,".\xa0",t.href?Object(P.jsx)("span",{children:Object(P.jsx)("a",{href:t.href,target:"blank",children:E(t.text)})}):Object(P.jsx)("span",{children:E(t.text)}),n===e.currentChapterIndex&&E(" (current)")]},n)}))}),Object(P.jsx)("p",{children:e.bottomText}),Object(P.jsx)("ul",{children:e.afterWords.map((function(e,t){return Object(P.jsxs)("li",{children:[E(e.text),Object(P.jsx)("a",{href:e.href,target:"blank",children:E(e.aText)})]},t)}))})]})]})})),F=(n(41),Object(T.b)((function(e){return{isInfo:e.controls.isInfo,isShowControls:e.controls.isShowControls}}))((function(e){var t=Object(C.useState)(!0),n=Object(D.a)(t,2),o=n[0],a=n[1];return Object(C.useEffect)((function(){return e.gameContext.emitter.subscribe("screenMode")((function(e){"exitFullScreen"===e&&a(!0)}))})),Object(P.jsxs)("div",{className:"ui-controls",children:[e.isShowControls&&Object(P.jsx)("button",{className:"butt-left control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-left")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-left")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-left")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-left")},children:"\u25c4"}),e.isShowControls&&Object(P.jsx)("button",{className:"butt-right control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-right")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-right")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-right")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-right")},children:"\u25ba"}),e.isShowControls&&Object(P.jsx)("button",{className:"butt-front control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-front")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-front")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-front")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-front")},children:"\u25b2"}),e.isShowControls&&Object(P.jsx)("button",{className:"butt-back control",onMouseDown:function(){return e.gameContext.emitter.emit("mouseDown")("butt-back")},onTouchStart:function(){return e.gameContext.emitter.emit("mouseDown")("butt-back")},onMouseUp:function(){return e.gameContext.emitter.emit("mouseUp")("butt-back")},onTouchEnd:function(){return e.gameContext.emitter.emit("mouseUp")("butt-back")},children:"\u25bc"}),e.isShowControls&&o&&Object(P.jsx)("button",{className:"butt-fullscreen control",onClick:function(){e.gameContext.emitter.emit("mouseDown")("butt-fullscreen"),a(!1)},children:"\u2752"}),!e.isInfo&&Object(P.jsx)("button",{className:"butt-info control",onClick:function(){return e.dispatch({type:"TOGGLE_INFO"})},children:"i"}),e.isInfo&&Object(P.jsx)(N,{})]})})));var B={dispatch:null},W=Object(T.b)((function(e){return{isShowControls:e.controls.isShowControls,isInfo:e.controls.isInfo}}))((function(e){return!B.dispatch&&(B.dispatch=e.dispatch),Object(P.jsxs)("div",{className:"ui",children:[!e.isInfo&&e.gameContext.CustomReactComponent&&Object(P.jsx)(e.gameContext.CustomReactComponent,{gameContext:e.gameContext}),Object(P.jsx)(F,{gameContext:e.gameContext})]})})),L=n(13),R=n(23),G={isShowControls:!0,isInfo:!1,infoPanelData:{title:"Discovery of small android",topText:"",chapters:[{text:"Factory",href:"http://js.otrisovano.ru/factory/"},{text:"Brige",href:"http://js.otrisovano.ru/bridge/"},{text:"Cube",href:"http://js.otrisovano.ru/levels/"},{text:"Endways",href:"http://js.otrisovano.ru/endways/"},{text:"in production"}],currentChapterIndex:null,bottomText:"",afterWords:[{text:"Author: ",aText:"www.otrisovano.ru",href:"http://otrisovano.ru"},{text:"Github: ",aText:"https://github.com/fire888/dark_boss",href:"https://github.com/fire888/dark_boss"}]}};var U=document.querySelector(".progress"),q=-100,K=!0;!function e(){K&&setTimeout((function(){0===++q&&(q-=100),U.style.marginLeft=q+"%",e()}),30)}();var H,z=function(){function e(t){Object(b.a)(this,e),t.dispatcher=B,this._root=t;var n=function(e){e.customStore||(e.customStore={});var t=Object(L.b)(Object(I.a)({controls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;return"TOGGLE_INFO"===t.type?Object(I.a)(Object(I.a)({},e),{},{isShowControls:!!e.isInfo,isInfo:!e.isInfo}):"CHANGE_INFO_CHAPTER"===t.type?Object(I.a)(Object(I.a)({},e),{},{infoPanelData:Object(I.a)(Object(I.a)({},e.infoPanelData),{},{currentChapterIndex:t.currentChapterIndex})}):Object(I.a)({},e)}},e.customStore)),n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||L.c;return Object(L.d)(t,n(Object(L.a)(R.a)))}(t);n&&S.a.render(Object(P.jsx)(T.a,{store:n,children:Object(P.jsx)(W,{gameContext:t})}),document.getElementById("root"))}return Object(g.a)(e,[{key:"showStartButton",value:function(e){var t=document.querySelector(".startbuttons-wrapper"),n=document.querySelector(".progress-wrapper"),o=function(e){var t;e.target.dataset&&e.target.dataset.lang&&(t=e.target.dataset.lang,A=t),document.querySelector(".start-screen").style.display="none"};K=!1,t.style.display="flex",t.addEventListener("click",(function(t){e(),o(t)})),n.style.display="none"}}]),e}(),V=n(46),Y=n(17),Q=n(27),X=n(25),Z=n(15),J={uniforms:{tDiffuse:{value:null}},vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n  vec4 texel = texture2D( tDiffuse, vUv );\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\n}"},$=n(24),ee=function(){function e(t){var n=this;Object(b.a)(this,e),this._root=t;var o=t.assets,a=t.emitter,r=t.CONSTANTS.studioConfig,i=r.canId,s=r.rendererCon,c=r.clearColor,l=r.amb;s.canvas=document.getElementById(i),this._renderer=new y.WebGLRenderer(s),this._renderer.setClearColor(c),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(window.innerWidth,window.innerHeight),this._scene=new y.Scene;var u=t.CONSTANTS.studioConfig.sceneEnvironment,h=u.color,d=u.fogNear,m=u.fogFar,f=u.backgroundImgKey;this._scene.background=o[f]||null,this._scene.fog=new y.Fog(h,d,m),this._lightA=null;var p=l.color,g=l.strength;this._lightA=new y.AmbientLight(p,g),this._scene.add(this._lightA),this._playerCamera=new y.PerspectiveCamera(90,window.innerWidth/window.innerHeight,.1,5e3),this._controlsCamera=new y.PerspectiveCamera(90,window.innerWidth/window.innerHeight,.1,5e3),this._controlsCamera.position.set(0,0,20);var v=new $.a(this._controlsCamera,this._renderer.domElement);v.target.set(0,0,0),v.update(),this._composer=new Q.a(this._renderer),this._renderPass=new X.a(this._scene,this._controlsCamera),this._composer.addPass(this._renderPass),this._root.CONSTANTS.studioConfig.composerAddPass&&"Saturate"===this._root.CONSTANTS.studioConfig.composerAddPass&&this._composer.addPass(new Z.a(J));var j=new y.Vector3,w=!0;a.subscribe("keyEvent")((function(e){e.o&&(w?(w=!1,n._renderPass.camera=n._controlsCamera,n._playerCamera.getWorldPosition(j),n._controlsCamera.position.x=j.x+100,n._controlsCamera.position.y=j.y+100,n._controlsCamera.position.z=j.z,v.target.set(j.x,j.y,j.z),v.update()):(w=!0,n._renderPass.camera=n._playerCamera))}));var O=function(){var e={width:window.innerWidth,height:window.innerHeight};n._renderer.setSize(e.width,e.height),n._composer.setSize(e.width,e.height),n._controlsCamera&&(n._controlsCamera.aspect=e.width/e.height,n._controlsCamera.updateProjectionMatrix()),n._playerCamera&&(n._playerCamera.aspect=e.width/e.height,n._playerCamera.updateProjectionMatrix())};window.addEventListener("resize",O),O(),this.addToScene=this._scene.add.bind(this._scene),this.removeFromScene=this._scene.remove.bind(this._scene);a.subscribe("frameUpdate")((function(){n._composer.render(n._scene,n._controlsCamera)})),this._backgroundImgKey=t.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey,a.subscribe("changeSceneEnvironment")((function(e){console.log("deprecated!!","studio","changeSceneEnvironment",e)}))}return Object(g.a)(e,[{key:"setCamera",value:function(e){this._playerCamera=e,this._renderPass.camera=this._playerCamera}},{key:"changeEnvironment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._changeFog(e,t),this._changeBackground(e,t)}},{key:"_changeFog",value:function(e,t){var n=this,o=e.fogNear,a=e.fogFar,r=e.color;if(this._scene.fog.near!==o||this._scene.fog.far!==a||this._scene.fog.color!==a){var i={color:this._scene.fog.color,near:this._scene.fog.near,far:this._scene.fog.far},s={color:new y.Color(r),near:o,far:a};new Y.a(i).to(s,t&&t.time||3e3).onUpdate((function(){n._scene.fog.color=i.color,n._scene.fog.near=i.near,n._scene.fog.far=i.far,t?t.updateAmb&&(n._lightA.color=i.color):n._lightA.color=i.color,n._renderer.setClearColor(i.color)})).start()}}},{key:"_changeBackground",value:function(e){var t=e.backgroundImgKey;t!==this._backgroundImgKey&&(this._backgroundImgKey=t,this._scene.background=this._root.assets[t]||null)}}]),e}(),te=function(){function e(t){Object(b.a)(this,e);var n=t.emitter,o={up:!1,down:!1,left:!1,right:!1,p:!1},a={up:!0,down:!0,left:!0,right:!0};this.keysEnabled=a,this.keys=o;var r=function(e,t){switch(e){case 38:case 87:a.up&&(o.up=t);break;case 40:case 83:a.down&&(o.down=t);break;case 37:case 65:o.left=t;break;case 39:case 68:o.right=t;break;case 79:o.o=t;break;case 80:o.p=t}n.emit("keyEvent")(o)};document.addEventListener("keydown",(function(e){return r(e.keyCode,!0)})),document.addEventListener("keyup",(function(e){return r(e.keyCode,!1)})),n.subscribe("mouseDown")((function(e){"butt-left"===e&&r(37,!0),"butt-right"===e&&r(39,!0),"butt-front"===e&&r(38,!0),"butt-back"===e&&r(40,!0)})),n.subscribe("mouseUp")((function(e){"butt-left"===e&&r(37,!1),"butt-right"===e&&r(39,!1),"butt-front"===e&&r(38,!1),"butt-back"===e&&r(40,!1)}))}return Object(g.a)(e,[{key:"toggleEnableKeys",value:function(e,t){this.keysEnabled[e]=t,!t&&(this.keys[e]=!1)}}]),e}(),ne=function(){function e(t){Object(b.a)(this,e);var n=t.studio,o=t.CONSTANTS.playerConfig,a=(o.startPos,o.startRot,o.cameraData),r=(o.frontObjPos,o.backObjPos,o.lightDataOne);this._camera=null,this.isBlocked=!0,this.isFreeze=!0,this.mesh=new y.Object3D,this.mesh.rotation.fromArray([0,0,0]),this.mesh.userData.type="player",this.bottomObj=new y.Object3D,this.bottomObj.position.fromArray([0,-.02,0]),this.mesh.add(this.bottomObj),this.frontObj=new y.Object3D,this.frontObj.position.fromArray([0,0,-.02]),this.mesh.add(this.frontObj),this.backObj=new y.Object3D,this.backObj.position.fromArray([0,0,.02]),this.mesh.add(this.backObj);var i=a.fov,s=a.ratio,c=a.near,l=a.far;a.pos;this._camera=new y.PerspectiveCamera(i,s,c,l),this._camera.position.fromArray([0,0,-2]),this.mesh.add(this._camera);var u=r.color,h=r.strenth,d=r.pos,m=new y.PointLight(u,h);m.position.fromArray(d),this.mesh.add(m),n.setCamera(this._camera),n.addToScene(this.mesh)}return Object(g.a)(e,[{key:"toggleFeeze",value:function(e){this.isFeeze=e}},{key:"toggleCanMove",value:function(e,t){}},{key:"getObj",value:function(){return this.mesh}},{key:"getCamera",value:function(){return this._camera}},{key:"setToPos",value:function(e,t,n){this.mesh.position.set(e,t,n)}}]),e}(),oe=function(e,t){for(var n in e)e[n].wrapS&&(e[n].wrapS=e[n].wrapT=y.RepeatWrapping);var o=["bumpMap","envMap","map","normalMap","lightMap","aoMap"],a={},r=function(n){a[n]=new y[t[n].mat](Object(I.a)({},t[n].props)),o.map((function(o){return t[n].props[o]&&(a[n][o]=e[t[n].props[o]])}))};for(var i in t)r(i);return a},ae=function(e,t){var n={},o={};return e["level-rooms"].traverse((function(e){var a=null;if(e.name.includes("level")&&((a="level_020_001"===e.name?new y.Mesh(e.geometry,t.groundTop):new y.Mesh(e.geometry,t.wall)).name=e.name,n[e.name]=a),e.name.includes("roadwall")&&((a=new y.Mesh(e.geometry,t.road)).name=e.name,a.userData.isWallWalking=!0,n[e.name]=a),e.name.includes("level")||e.name.includes("roadwall")){var r=e.name.split("_");r[1]&&a&&(o[+r[1]]||(o[+r[1]]=[]),a.userData.area=+r[1],o[+r[1]].push(a))}})),{allMeshes:n,areas:o}},re=n.p+"static/media/level02.46579f34.obj",ie=n.p+"static/media/floor_outer_map3.558e9646.jpg",se=n.p+"static/media/floor_outer_map2.2bd99ce1.jpg",ce=n.p+"static/media/floor_outer_map.35e50f6e.jpg",le=n.p+"static/media/px.c5995c72.jpg",ue=n.p+"static/media/nx.04390d21.jpg",he=n.p+"static/media/py.f7a76cc4.jpg",de=n.p+"static/media/ny.4e15a317.jpg",me=n.p+"static/media/pz.7c1308f5.jpg",fe=n.p+"static/media/nz.6287fe7d.jpg",pe=n.p+"static/media/px.96d0b65f.jpg",be=n.p+"static/media/nx.8cbf039d.jpg",ge=n.p+"static/media/py.659ebc34.jpg",ye=n.p+"static/media/ny.09051a4e.jpg",ve=n.p+"static/media/pz.a1539724.jpg",je=n.p+"static/media/nz.0bc769f7.jpg",we=function(){function e(){Object(b.a)(this,e),this._arrMeshes=[],this._vecStart=new y.Vector3,this._vecDir=new y.Vector3,this._rayCaster=new y.Raycaster(this._vecStart,this._vecDir)}return Object(g.a)(e,[{key:"setItemToCollision",value:function(e){for(var t=0;t<this._arrMeshes.length;++t)if(this._arrMeshes[t]===e)return;this._arrMeshes.push(e)}},{key:"removeItemFromCollision",value:function(e){this._arrMeshes=this._arrMeshes.filter((function(t){return t!==e}))}},{key:"checkCollisions",value:function(e,t,n){e.getWorldPosition(this._vecStart),t.getWorldPosition(this._vecDir),this._vecDir.sub(this._vecStart);var o=this._rayCaster.intersectObjects(this._arrMeshes);return o[0]&&o[0].distance<n?[!0,o[0]]:[!1,null]}}]),e}(),Oe=function(e,t,n){return new Promise((function(o){var a=0;!function r(){if((a+=.03)>1&&(a=1),e.quaternion.slerpQuaternions(t,n,a),1===a)return o();setTimeout(r,15)}()}))},_e=function(e,t,n,o){var a=function(n,o){if(e[n])for(var a=0;a<e[n].length;++a){var r=e[n][a];"remove"===o&&t.removeFromScene(r),"add"===o&&t.addToScene(r)}},r=function(t,o){if(e[t])for(var a=0;a<e[t].length;++a){var r=e[t][a];"remove"===o&&n.removeItemFromCollision(r),"add"===o&&n.setItemToCollision(r)}};return function(e){console.log(e),o.emit("levelChanged")(e),a(e-4,"remove"),a(e-3,"remove"),a(e-2,"add"),a(e-1,"add"),a(e,"add"),a(e+1,"add"),a(e+2,"add"),a(e+3,"add"),r(e-3,"remove"),r(e-2,"remove"),r(e-1,"add"),r(e,"add"),r(e+1,"add"),r(e+2,"add")}},ke=Math.random,Ce={0:{pos:[0,-55,-10.680000000000003],rot:[0,0,0],walkData:null,defaultAnimation:"dialog"},4:{pos:[-697.1507105430046,-31,278.81390042624884],rot:[0,Math.PI/2,0],walkData:"4",defaultAnimation:"walk"},13:{pos:[-946.6448542936033,1263,12.835633240896737],rot:[0,Math.PI/2,0],walkData:"13",defaultAnimation:"walk"},20:{pos:[-2145.4767672182593,2118.171875,4.885100091204412],rot:[0,Math.PI/2,0],walkData:null,defaultAnimation:"stay"}},xe=function(){function e(t){var n=this;Object(b.a)(this,e);var o=t.studio,a=t.assets,r=t.materials,i=t.emitter;this._currentArea=null,this._bot=a.bot.scene.children[0],this._bot.traverse((function(e){e.material=r.skin})),this._frontObj=new y.Object3D,this._frontObj.position.set(0,0,.1),this._bot.add(this._frontObj),this._bot.scale.set(1.15,1.15,1.15),this._animations=Se(a.bot),this._animations.play("walk"),this._freeWalk=Ie(this._bot,this._frontObj,20,i),this._areas=a.areas,o.addToScene(this._bot),i.subscribe("frameUpdate")((function(e){n._bot.visible&&n._animations.update(e)}));var s=[];i.subscribe("levelChanged")((function(e){if(12===e){for(var t=0;t<s.length;++t)if(13===s[t])return;s.push(13),n.setBotTo(13)}if(19===e){for(var o=0;o<s.length;++o)if(20===s[o])return;s.push(20),n.setBotTo(20)}}))}return Object(g.a)(e,[{key:"setBotTo",value:function(e){this._currentArea=e;var t=Ce[e],n=t.pos,o=t.rot,a=t.walkData,r=t.defaultAnimation;if(this._animations.play(r),a){this._freeWalk.clearCollisions();for(var i=0;i<this._areas[a].length;++i)this._freeWalk.setItemToCollision(this._areas[a][i]);this._freeWalk.start()}else this._freeWalk.stop();this._bot.position.fromArray(n),this._bot.rotation.fromArray(o)}},{key:"getBot",value:function(){return this._bot}},{key:"getCurrentArea",value:function(){return this._currentArea}},{key:"startDialog",value:function(e){this._freeWalk.stop(),this._animations.play("dialog");var t=new y.Vector3(e.x,this._bot.position.y,e.z);this._bot.lookAt(t)}},{key:"stopDialog",value:function(){var e=Ce[this._currentArea],t=e.walkData,n=e.defaultAnimation;t&&this._freeWalk.start(),this._animations.play(n)}}]),e}(),Se=function(e){var t=e.animations,n=new y.AnimationMixer(e.scene.children[0]),o=n.clipAction(t[2]);o.timeScale=1.5;var a=n.clipAction(t[0]);a.timeScale=3;var r=n.clipAction(t[1]);r.timeScale=1;var i={dialog:o,walk:a,stay:r},s=null;return{update:function(e){return n.update(e.delta)},play:function(e){s!==e&&(s=e,n.stopAllAction(),i[e].play())}}},Te=function(e){var t=(ke()*Math.PI*1.5+1.3)*ke()<.5?1:-1,n=t/40,o=0;return function(){return e.rotation.y+=n,++o<40}},De=function(e,t){var n=t?Math.min(t/.15,800*ke()+300):null,o=0;return function(){return!!t&&(e.translateZ(.15),++o<n)}},Ie=function(e,t,n,o){var a=!1,r=Ae(),i={rotate:Te,go:De},s="rotate",c=null,l=function(n){n||("rotate"===s&&(n="go"),"go"===s&&(n="rotate")),s=n;var o=r.checkCollisions(e,t);c=i[n](e,Math.max(o-20,0))};return l(s),o.subscribe("frameUpdate")((function(){a&&!c()&&l()})),{start:function(){l("rotate"),a=!0},stop:function(){return a=!1},setItemToCollision:r.setItemToCollision,removeItemFromCollision:r.removeItemFromCollision,clearCollisions:r.clearCollisions}},Ae=function(){var e=[],t=new y.Vector3,n=new y.Vector3,o=new y.Raycaster(t,n);return{setItemToCollision:function(t){e.push(t)},removeItemFromCollision:function(t){e=e.filter((function(e){return e!==t}))},clearCollisions:function(){e=[]},checkCollisions:function(a,r){a.getWorldPosition(t),r.getWorldPosition(n),n.sub(t);var i=o.intersectObjects(e,!0);return!!i[0]&&i[0].distance}}},Me=n.p+"static/media/botWalk.01f990cb.gltf",Pe=n.p+"static/media/skin.400fd57d.jpg",Ee=(n(43),n(3)),Ne={ru:(H={"Hello there!":"\u041f\u0440\u0438\u0432\u0435\u0442 !","Good day, carbon-based life form.":"\u0414\u0435\u043d\u044c \u0434\u043e\u0431\u0440\u044b\u0439, \u043a\u0440\u0435\u043c\u043d\u0438\u0435\u0432\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u0436\u0438\u0437\u043d\u0438.","What is this place ?":"\u0427\u0442\u043e \u044d\u0442\u043e \u0437\u0430 \u043c\u0435\u0441\u0442\u043e?","This is an entrance to the entropic hyper-maze.":"\u042d\u0442\u043e \u0432\u0445\u043e\u0434 \u0432 \u044d\u043d\u0442\u0440\u043e\u043f\u0438\u0439\u043d\u044b\u0439 \u0433\u0438\u043f\u0435\u0440-\u043a\u0443\u0431.","And what happens if I enter it ?":"\u0427\u0442\u043e \u0431\u0443\u0434\u0435\u0442, \u0435\u0441\u043b\u0438 \u044f \u0432\u043e\u0439\u0434\u0443 \u0432 \u043d\u0435\u0433\u043e?","This place is waiting.":"\u041a\u0443\u0431 \u043f\u0440\u0438\u043c\u0435\u0442 \u0442\u0435\u0431\u044f.","Say, where do these corridors lead ?":"\u041a\u0443\u0434\u0430 \u0432\u0435\u0434\u0443\u0442 \u044d\u0442\u0438 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b ?","They will lead you to the end.":"\u041e\u043d\u0438 \u043f\u0440\u0438\u0432\u0435\u0434\u0443\u0442 \u0442\u0435\u0431\u044f \u043a \u0444\u0438\u043d\u0430\u043b\u0443.","Ooook, I'm heading in then.":"\u042f \u043f\u043e\u0448\u0435\u043b \u0434\u0430\u043b\u044c\u0448\u0435.","We will meet again.":"\u041c\u044b \u0435\u0449\u0435 \u0443\u0432\u0438\u0434\u0438\u043c\u0441\u044f.","What do you do here ?":"\u0427\u0442\u043e \u0442\u044b \u0437\u0434\u0435\u0441\u044c \u0434\u0435\u043b\u0430\u0435\u0448\u044c ?","Collecting the energy of the night.":"\u0421\u043e\u0431\u0438\u0440\u0430\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u043d\u043e\u0447\u0438.","Can you tell me which way is out of here ?":"\u0412 \u043a\u0430\u043a\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043c\u043d\u0435 \u0438\u0434\u0442\u0438 ?","It is about the journey, not the destination":"\u0417\u0434\u0435\u0441\u044c \u043d\u0435\u0442 \u0441\u0442\u043e\u0440\u043e\u043d. \u0417\u0434\u0435\u0441\u044c \u0432\u0430\u0436\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u0438\u043d\u0430 \u043f\u0443\u0442\u0438.","Hey, it looks like I'm walking in circles.":"\u042f \u0443\u0436\u0435 \u0434\u043e\u043b\u0433\u043e \u0438\u0434\u0443.","You have walked long enough.":"\u0422\u044b \u043f\u0440\u043e\u0448\u0435\u043b \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f.","Meaning?":"\u0427\u0442\u043e \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0438\u0442?","The way to the next level is open to you.":"\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u043f\u0443\u0442\u044c \u043d\u0430 \u043e\u0434\u043d\u0443 \u0441\u0442\u0443\u043f\u0435\u043d\u044c \u0432\u044b\u0448\u0435.",'Hi, I heard I can find the "end" around here?':"\u042f \u0438\u0449\u0443 \u0444\u0438\u043d\u0430\u043b.","Yes, I told you this is where the corridors lead.":"\u042f \u043f\u043e\u043c\u043d\u044e \u043e \u0442\u0432\u043e\u0435\u043c \u043f\u0443\u0442\u0438.","Man, you all look the same.":"\u0412\u044b \u0432\u0441\u0435 \u0442\u0430\u043a \u043f\u043e\u0445\u043e\u0436\u0438."},Object(Ee.a)(H,"We will meet again.","\u041c\u044b \u0435\u0449\u0435 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u043c\u0441\u044f."),Object(Ee.a)(H,"Soooo, is that you again ?","\u042d\u0442\u043e \u0441\u043d\u043e\u0432\u0430 \u0442\u044b?"),Object(Ee.a)(H,"Yes. All of me are myself.","\u0414\u0430, \u043c\u044b \u0432\u0441\u0435 \u0435\u0434\u0438\u043d\u044b."),Object(Ee.a)(H,"Yeah, just like those corridors.","\u0422\u0443\u0442 \u0432\u0441\u0435 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f."),Object(Ee.a)(H,"The meaning of everything is in being whole.","\u0421\u0443\u0442\u044c \u0432\u0441\u0435\u0433\u043e \u0432 \u0435\u0434\u0438\u043d\u043e\u043c."),Object(Ee.a)(H,"Am I there yet?","\u041a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0435\u0449\u0435 \u0438\u0434\u0442\u0438."),Object(Ee.a)(H,"The sign will be given when you are.","\u0422\u0435\u0431\u0435 \u0431\u0443\u0434\u0435\u0442 \u0437\u043d\u0430\u043a, \u043a\u043e\u0433\u0434\u0430 \u0442\u044b \u0431\u0443\u0434\u0435\u0448\u044c \u0433\u043e\u0442\u043e\u0432."),Object(Ee.a)(H,"How do I know what it is?","\u041a\u0430\u043a \u044f \u0443\u0437\u043d\u0430\u044e \u044d\u0442\u043e\u0442 \u0437\u043d\u0430\u043a."),Object(Ee.a)(H,"I will give it to you.","\u042f \u043f\u043e\u0434\u0430\u043c \u0435\u0433\u043e."),Object(Ee.a)(H,"That's the same exact corridor with you again.","\u042d\u0442\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0439 \u0441\u0435\u0433\u043c\u0435\u043d\u0442 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u0430 \u0441 \u0442\u043e\u0431\u043e\u0439."),Object(Ee.a)(H,"You are ready for the next level.","\u0422\u044b \u0433\u043e\u0442\u043e\u0432 \u043a \u043d\u043e\u0432\u043e\u043c\u0443 \u0443\u0440\u043e\u0432\u043d\u044e."),Object(Ee.a)(H,"Hey man, seriously, how do I get out of here ?","\u041f\u0440\u0438\u0432\u0435\u0442 \u0441\u043d\u043e\u0432\u0430. \u041a\u0430\u043a \u0432\u044b\u0431\u0440\u0430\u0442\u044c\u0441\u044f. \u0423\u0436\u0435 \u043d\u0430\u0434\u043e\u0435\u043b\u043e."),Object(Ee.a)(H,"You have not reached the end.","\u0422\u044b \u043d\u0435 \u043f\u043e\u0441\u0442\u0438\u0433 \u0434\u0437\u0435\u043d."),Object(Ee.a)(H,"We'll how do you reach it ?","\u0422\u044b-\u0442\u043e \u043a\u0430\u043a \u0432\u044b\u0445\u043e\u0434\u0438\u0448\u044c \u043d\u0430 \u043f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u044c?"),Object(Ee.a)(H,"I have my way.","\u0423 \u043c\u0435\u043d\u044f \u0441\u0432\u043e\u0439 \u043f\u0443\u0442\u044c."),Object(Ee.a)(H,"So how's your way btw ?","\u0422\u044b \u0432\u0441\u0435 \u043d\u0430 \u0441\u0432\u043e\u0435\u043c \u043f\u0443\u0442\u0438?"),Object(Ee.a)(H,"It is like yourself.","\u041a\u0430\u043a \u0438 \u0442\u044b."),Object(Ee.a)(H,"And how long you've been on it ?","\u041a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0442\u044b \u043d\u0430 \u043d\u0435\u043c?"),Object(Ee.a)(H,"These walls can hear us.","\u042d\u0442\u0438 \u0441\u0442\u0435\u043d\u044b \u043d\u0430\u0441 \u0441\u043b\u044b\u0448\u0430\u0442."),Object(Ee.a)(H,"I think you're weighing this corridor down.","\u041c\u043d\u0435 \u043a\u0430\u0436\u0435\u0442\u0441\u044f, \u0442\u044b \u0438\u0434\u0435\u0448\u044c \u0432 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043a \u044d\u0442\u043e\u043c\u0443 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0443 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u0430."),Object(Ee.a)(H,"The next level is open to you.","\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c."),Object(Ee.a)(H,"Look bud, next level or not, nothing's changed at all !","\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f."),Object(Ee.a)(H,"Except the number of steps.","\u041c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u0448\u0430\u0433\u043e\u0432."),Object(Ee.a)(H,"So this place counts steps ?","\u042d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u0448\u0430\u0433\u0438?"),Object(Ee.a)(H,"This is place is waiting.","\u042d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0436\u0434\u0435\u0442."),Object(Ee.a)(H,"How long have you been here ?","\u041a\u0430\u043a \u0434\u0430\u0432\u043d\u043e \u0442\u044b \u0437\u0434\u0435\u0441\u044c?"),Object(Ee.a)(H,"How long is irrelevant. What matters is the journey.","\u0412\u0440\u0435\u043c\u044f \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438\u043c\u0435\u0435\u0442 \u043b\u0438\u0448\u044c \u043f\u0443\u0442\u044c."),Object(Ee.a)(H,"Then why aren't you on one?","\u041d\u043e \u0442\u044b \u0436\u0435 \u043d\u0435 \u0438\u0434\u0435\u0448\u044c."),Object(Ee.a)(H,"With you walking for both of us, I do not have to.","\u0417\u0430\u0442\u043e \u0442\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0448\u044c \u043c\u0438\u043c\u043e."),Object(Ee.a)(H,"Look, just make a new level, please.","\u0421\u0434\u0435\u043b\u0430\u0439 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c."),Object(Ee.a)(H,"You are ready. It is waiting for you.","\u0422\u044b \u0433\u043e\u0442\u043e\u0432 - \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0436\u0434\u0435\u0442 \u0442\u0435\u0431\u044f."),Object(Ee.a)(H,"Wait, you are this place! You control all its fragments.","\u0422\u044b \u0438 \u0435\u0441\u0442\u044c \u044d\u0442\u043e \u043c\u0435\u0441\u0442\u043e. \u0422\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0448\u044c \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438."),Object(Ee.a)(H,"You have almost reached the end.","\u0422\u044b \u043f\u043e\u0447\u0442\u0438 \u0434\u043e\u0448\u0435\u043b \u0434\u043e \u043a\u0440\u0430\u044f."),Object(Ee.a)(H,"Why do you do this ?","\u0417\u0430\u0447\u0435\u043c \u0442\u0435\u0431\u0435 \u044d\u0442\u043e?"),Object(Ee.a)(H,"It is my way to warp space. More movement. More fragments.","\u042d\u0442\u043e \u0441\u043f\u043e\u0441\u043e\u0431 \u0441\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e. \u0411\u043e\u043b\u044c\u0448\u0435 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f. \u0411\u043e\u043b\u044c\u0448\u0435 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432."),Object(Ee.a)(H,"How many people have been through here ?","\u041a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u043d\u0438\u043a\u043e\u0432 \u043f\u043e\u043f\u0430\u0434\u0430\u043b\u043e \u0441\u044e\u0434\u0430?"),Object(Ee.a)(H,"Many are still here.","\u041c\u043d\u043e\u0433\u0438\u0435 \u0438\u0437 \u043d\u0438\u0445 \u0434\u043e \u0441\u0438\u0445 \u043f\u043e\u0440 \u0442\u0443\u0442."),Object(Ee.a)(H,"So where are they?","\u041f\u043e\u0447\u0435\u043c\u0443 \u044f \u0438\u0445 \u043d\u0435 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u043b?"),Object(Ee.a)(H,"Everyone has a different system of fragments.","\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0441\u0432\u043e\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432."),Object(Ee.a)(H,"Will you let me out ?","\u0422\u044b \u0432\u044b\u043f\u0443\u0441\u0442\u0438\u0448\u044c \u043c\u0435\u043d\u044f?"),Object(Ee.a)(H,"All ways lead to the end.","\u0412\u0441\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b \u0441\u0432\u0435\u0442\u0430 \u043e\u0442\u043a\u0440\u044b\u0442\u044b \u0442\u0435\u0431\u0435."),Object(Ee.a)(H,"I wanna meet the others.","\u042f \u0445\u043e\u0447\u0443 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u0442\u044c \u0434\u0440\u0443\u0433\u0438\u0445."),Object(Ee.a)(H,"The next level is waiting for you.","\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c."),Object(Ee.a)(H,"Everything's looped here.","\u042f \u0432\u0438\u0436\u0443 \u0437\u0430\u0440\u0435\u0432\u043e?"),Object(Ee.a)(H,"Everything is looped with small differences.","\u042d\u0442\u043e \u0437\u0430\u0440\u0435\u0432\u043e \u043f\u0440\u043e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u044f. \u0422\u044b \u0431\u043b\u0438\u0437\u043e\u043a"),Object(Ee.a)(H,"How many levels even are there ?","\u0412\u0441\u0435 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f."),Object(Ee.a)(H,"It all depends on you.","\u0412\u0441\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442\u0441\u044f \u0441 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0440\u0430\u0437\u043d\u0438\u0446\u0435\u0439."),Object(Ee.a)(H,"That's it, I'm done.","\u0412\u0441\u0435 \u043c\u043e\u0439 \u043f\u0443\u0442\u044c \u043e\u043a\u043e\u043d\u0447\u0435\u043d."),Object(Ee.a)(H,"Have you reached your journey's end ?","\u0422\u044b \u043e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0448\u044c\u0441\u044f \u0438\u0434\u0442\u0438?"),Object(Ee.a)(H,"Yes, you mad bastard! I have !","\u0414\u0430, \u0442\u044b \u0431\u0435\u0437\u0443\u043c\u0435\u043d."),Object(Ee.a)(H,"Then I am giving you the sign.","\u042f \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u044e \u0442\u0435\u0431\u044f."),Object(Ee.a)(H,"open dialog","\u043d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433"),Object(Ee.a)(H,"close dialog","\u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433"),Object(Ee.a)(H,"To be continued","\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u0435\u0442"),Object(Ee.a)(H,"chapter","\u0433\u043b\u0430\u0432\u0430"),Object(Ee.a)(H,"open","\u043f\u0443\u0441\u043a"),Object(Ee.a)(H,"Author: ","\u0410\u0432\u0442\u043e\u0440: "),Object(Ee.a)(H,"link","\u0441\u0441\u044b\u043b\u043a\u0430"),H)},Fe=M(Ne),Be=Object(T.b)((function(e){return{userReplicies:e.ui.userReplicies}}))((function(e){return Object(P.jsx)("div",{className:"replicies",children:e.userReplicies.map((function(t){return Object(P.jsx)("button",{onClick:function(){var n;(n=e.dispatch,{clickPhrase:function(e){n({type:"CLICK_PHRASE",phrase:e}),setTimeout((function(){n({type:"PHRASE_EVENT",phrase:e})}),1e3)},toggleDialog:function(e){n({type:"TOGGLE_DIALOG",isDialog:e})},toggleButtonDialog:function(e){n({type:"TOGGLE_BUTTON",isButtonDialog:e})}}).clickPhrase(t)},children:Fe(t.q)},Math.floor(1e5*Math.random()))}))})})),We=M(Ne),Le=Object(T.b)((function(e){return{botAnswers:e.ui.botAnswers}}))((function(e){return Object(P.jsx)("div",{className:"messages",children:e.botAnswers.map((function(e){return Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{className:"q",children:We(e.q)}),Object(P.jsx)("div",{className:"a",children:We(e.a)})]},Math.floor(1e5*Math.random()))}))})})),Re=M(Ne);var Ge=Object(T.b)((function(e){return{isButtonDialog:e.ui.isButtonDialog,isShowFinalMessage:e.ui.isShowFinalMessage,isShowPalleteDialog:e.ui.isShowPalleteDialog}}))((function(e){return Object(P.jsxs)(P.Fragment,{children:[(e.isButtonDialog||e.isShowPalleteDialog)&&Object(P.jsx)("div",{className:"dialog-wrapper",children:Object(P.jsxs)("div",{className:"dialog-content",children:[e.isShowPalleteDialog&&Object(P.jsxs)("div",{className:"messages-wrapper",children:[Object(P.jsx)(Le,{}),Object(P.jsx)(Be,{})]}),e.isButtonDialog&&Object(P.jsx)("button",{className:"dialog-button-toggle",onClick:function(){return e.dispatch({type:"TOGGLE_DIALOG",isShowPalleteDialog:!e.isShowPalleteDialog})},children:e.isShowPalleteDialog?Re("close dialog"):Re("open dialog")})]})}),e.isShowFinalMessage&&Object(P.jsx)("div",{className:"info",children:Object(P.jsx)("div",{className:"info-inner final-message",children:Object(P.jsx)("p",{children:Re("Level completed")})})})]})})),Ue=n(26),qe={botAnswers:[],userReplicies:[],isShowControls:!0,isButtonDialog:!1,isShowPalleteDialog:!1,currentBot:null,phraseIndex:0,isDialogComplete:!1,phrasesData:{4:[{q:"Hello there!",a:"Good day, carbon-based life form.",event:"nextReply"},{q:"What is this place ?",a:"This is an entrance to the entropic hyper-maze.",event:"nextReply"},{q:"And what happens if I enter it ?",a:"This place is waiting.",event:"close"}],13:[{q:"Say, where do these corridors lead ?",a:"They will lead you to the end.",event:"nextReply"},{q:"Ooook, I'm heading in then.",a:"We will meet again.",event:"close"}],20:[{q:"What do you do here ?",a:"Collecting the energy of the night.",event:"nextReply"},{q:"Can you tell me which way is out of here ?",a:"It is about the journey, not the destination",event:"close"}]}},Ke=[{key:"emitter",constr:_,initStateKey:"pageLoaded"},{key:"deviceResizer",constr:function e(t){Object(b.a)(this,e);var n=t.emitter,o=t.appWrapper;!o&&(o=document.querySelector(".app-wrapper")),n.subscribe("mouseDown")((function(e){"butt-fullscreen"===e&&a()}));var a=function(){o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen&&o.msRequestFullscreen()},r=function(e){o.style.width=window.innerWidth+"px",o.style.height=window.innerHeight+"px",o.style.fontSize=Math.max(Math.min(Math.min(window.innerWidth,window.innerHeight),400),350)/50+"px",document.fullscreenElement||n.emit("screenMode")("exitFullScreen")};window.addEventListener("resize",r),r()},initStateKey:"pageLoaded"},{key:"loaderAssets",constr:O,initStateKey:"pageLoaded"},{key:"frameUpdater",constr:function e(t){Object(b.a)(this,e);var n=t.emitter.emit("frameUpdate"),o={time:0,delta:0,count:0,oldTime:0},a=V.a((function(){return o}),(function(e){return e.time=Date.now(),e}),(function(e){return e.delta=.001*(e.time-e.oldTime),(isNaN(e.delta)||e.delta>1e3||0===e.delta)&&(e.delta=1e3/60*.001),e}),(function(e){return e.count=e.delta/(1/60),e}),(function(e){return n(e),e}),(function(e){return e.oldTime=e.time,e}),(function(e){return o=e}));!function e(){requestAnimationFrame(e),a(o)}()},initStateKey:"beforeStartPlay"},{key:"tweenUpdater",constr:function e(t){Object(b.a)(this,e),t.emitter.subscribe("frameUpdate")((function(){return Y.b()}))},initStateKey:"beforeStartPlay"},{key:"studio",constr:ee,initStateKey:"beforeStartPlay"},{key:"keyBoard",constr:te,initStateKey:"beforeStartPlay"},{key:"player",constr:ne,initStateKey:"beforeStartPlay"},{key:"materialsLib",constr:function e(t){Object(b.a)(this,e);var n=t.assets,o=t.CONSTANTS;t.materials=oe(n,o.MATERIALS_CONFIG)},initStateKey:"beforeStartPlay"},{key:"level",constr:function e(t){Object(b.a)(this,e);t.studio;var n=t.assets,o=t.materials,a=ae(n,o),r=(a.allMeshes,a.areas);t.assets.areas=r},initStateKey:"beforeStartPlay",assetsToLoad:[{type:"obj",path:re,key:"level-rooms"},{type:"cubeTextures",path:[le,ue,he,de,me,fe],key:"skyBox"},{type:"cubeTextures",path:[pe,be,ge,ye,ve,je],key:"skyBox2"},{type:"img",path:ie,key:"mapFloorOuter",wrap:!0},{type:"img",path:se,key:"mapFloorOuter2",wrap:!0},{type:"img",path:ce,key:"mapTop",wrap:!0}]},{key:"system_PlayerMoveOnLevel",constr:function e(t){var n=this;Object(b.a)(this,e);var o=t.emitter,a=t.CONSTANTS,r=t.player,i=(t.level,t.assets),s=t.studio,c=0;r.mesh.position.fromArray([0,-40,0]);var l=new we,u=_e(i.areas,s,l,o);u(c);var h=a.playerConfig,d=h.speed,m=h.speedDown,f=h.speedRot,p=!0;r.toggleBlocked=function(e){return p=e},this.isCanMove={forward:!0,back:!0},r.toggleCanMove=function(e,t){return n.isCanMove[e]=t};var g={},v=new y.Quaternion,j=new y.Quaternion,w=new y.Vector3(0,1,0),O=function(){v.copy(r.mesh.quaternion),j.setFromAxisAngle(w,Math.random()*Math.PI*2),p=!0,Oe(r.mesh,v,j).then((function(){r.mesh.up.copy(w),p=!1}))},_=function(e){var t=l.checkCollisions(r.mesh,r.frontObj,17),n=Object(D.a)(t,2),a=n[0],i=n[1];a&&i.object.userData.area!==c&&(c=i.object.userData.area,u(c)),a?i.object.userData.isWallWalking&&function(e){v.copy(r.mesh.quaternion);var t=(new y.Vector3).addVectors(r.mesh.position,e.face.normal);r.mesh.lookAt(t),r.mesh.up.copy(e.face.normal),r.mesh.rotateX(Math.PI/2),j.copy(r.mesh.quaternion),r.mesh.setRotationFromQuaternion(v),p=!0,Oe(r.mesh,v,j).then((function(){p=!1}))}(i):(r.mesh.translateZ(-d*e.count),o.emit("playerMove")("forward"))};o.subscribe("keyEvent")((function(e){return g=e})),o.subscribe("frameUpdate")((function(e){g.left&&r.mesh.rotateY(f*e.count),g.right&&r.mesh.rotateY(-f*e.count),p||(!function(e){var t=l.checkCollisions(r.mesh,r.bottomObj,17.2),n=Object(D.a)(t,2),o=n[0],a=n[1];if(o&&a.object.userData.area!==c&&(c=a.object.userData.area,u(c)),!(o&&17>a.distance))return o?void(a.object.userData.isWallWalking||r.mesh.up.equals(w)||O()):(!r.mesh.up.equals(w)&&O(),void(r.mesh.position.y+=m*e.count));r.mesh.translateY(17-a.distance)}(e),g.up&&n.isCanMove.forward&&_(e),g.down&&n.isCanMove.back&&function(e){var t=l.checkCollisions(r.mesh,r.backObj,17);Object(D.a)(t,1)[0]||(r.mesh.translateZ(d*e.count),o.emit("playerMove")("back"))}(e),g.p&&console.log("player.mesh.position.fromArray([".concat(r.mesh.position.x,", ").concat(r.mesh.position.y+25,", ").concat(r.mesh.position.z,"])")))}))},initStateKey:"beforeStartPlay"},{key:"system_Monsters",constr:xe,initStateKey:"beforeStartPlay",assetsToLoad:[{type:"glb",path:Me,key:"bot"},{type:"img",path:Pe,key:"skin",wrap:!0}]},{key:"system_PrepareDialogs",constr:function e(t){Object(b.a)(this,e);var n=t.emitter,o=t.player,a=t.system_Monsters,r=t.dispatcher,i=a.getBot(),s={forward:!1,back:!1},c=new y.Vector3,l=!1;n.subscribe("playerMove")((function(e){o.frontObj.getWorldPosition(c),c.distanceTo(i.position)>50?l&&(l=!1,r.dispatch({type:"TOGGLE_BUTTON",isButtonDialog:!1}),a.stopDialog()):(l||(l=!0,r.dispatch({type:"TOGGLE_BUTTON",isButtonDialog:!0,currentBot:a.getCurrentArea()}),a.startDialog(o.mesh.position)),"forward"===e&&c.distanceTo(i.position)<20&&!s[e]&&(s[e]=!0,o.toggleCanMove(e,!1),a.startDialog(o.mesh.position)),s.forward&&(s.back=!1,o.toggleCanMove("back",!0)))})),n.subscribe("frameUpdate")((function(){o.mesh.position.distanceTo(i.position)>30&&(s.forward||s.back)&&(s.forward=!1,s.back=!1,o.toggleCanMove("forward",!0),o.toggleCanMove("back",!0),a.stopDialog())}))},initStateKey:"beforeStartPlay"},{key:"customUi",constr:function e(t){Object(b.a)(this,e),t.appWrapper=document.querySelector(".app-wrapper"),t.CustomReactComponent=Ge,t.customStore=function(e){return{ui:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,n=arguments.length>1?arguments[1]:void 0;if("CLICK_PHRASE"===n.type)return Object(I.a)(Object(I.a)({},t),{},{botAnswers:[].concat(Object(Ue.a)(t.botAnswers),[n.phrase]),userReplicies:[]});if("PHRASE_EVENT"===n.type){var o=n.phrase,a=o.event;if(o.levelEvent,"nextReply"===a){var r=[t.phrasesData[t.currentBot][t.phraseIndex+1]];return Object(I.a)(Object(I.a)({},t),{},{phraseIndex:t.phraseIndex+1,userReplicies:r})}if("close"===a)return Object(I.a)(Object(I.a)({},t),{},{userReplicies:[],isDialogComplete:!0,isButtonDialog:!0})}if("TOGGLE_DIALOG"===n.type){var i=[];return e.player.toggleBlocked(n.isShowPalleteDialog),n.isShowPalleteDialog&&(i=t.isDialogComplete?[]:[t.phrasesData[t.currentBot][t.phraseIndex]]),Object(I.a)(Object(I.a)({},t),{},{isShowPalleteDialog:n.isShowPalleteDialog,userReplicies:i})}if("TOGGLE_BUTTON"===n.type){var s=t.botAnswers,c=t.phraseIndex,l=t.isDialogComplete;return n.currentBot&&n.currentBot!==t.currentBot&&(s=[],c=0,l=!1),Object(I.a)(Object(I.a)({},t),{},{phraseIndex:c,currentBot:n.currentBot||t.currentBot,isButtonDialog:n.isButtonDialog,isDialogComplete:l,botAnswers:s})}return t}}}(t);var n=new z(t);t.ui=n},initStateKey:"pageLoaded"},{key:"starterPlay",constr:function e(t){Object(b.a)(this,e);var n=t.player,o=t.ui,a=t.studio,r=t.dispatcher,i=t.system_Monsters;r.dispatch({type:"CHANGE_INFO_CHAPTER",currentChapterIndex:3}),i.setBotTo(0);o.showStartButton((function(){a.changeEnvironment(h,{updateAmb:!1,time:1500}),setTimeout((function(){a.changeEnvironment(d,{updateAmb:!1,time:1500}),setTimeout((function(){i.setBotTo(4),a.changeEnvironment(m,{updateAmb:!1,time:1500}),n.toggleBlocked(!1)}),1500)}),4e3)}))},initStateKey:"beforeStartPlay"}];window.addEventListener("load",(function(){return function(e,t){return s.apply(this,arguments)}(Ke,o)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.30ee3c49.chunk.js.map