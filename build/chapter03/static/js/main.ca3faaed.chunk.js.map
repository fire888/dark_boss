{"version":3,"sources":["_CORE/pipeLines/initPipeLine.js","_CORE/helpers/helper_LoadAssets.js","_CORE/helpers/helper_Emitter.js","chapter03/store/actions.js","chapter03/constants/constants_replicies.js","_CORE/helpers/helper_translate.js","chapter03/componentsReact/UserReplicies.js","chapter03/componentsReact/BotAnswers.js","_CORE/componentsReact/PlayerControls.js","chapter03/componentsReact/App.js","chapter03/constants/constants_elements.js","chapter03/store/createStore.js","_CORE/componentsReact/UI.js","_CORE/shaders/saturate.js","_CORE/entities/createStudio.js","_CORE/helpers/helper_KeyBoard.js","_CORE/components/component_collisionFloor.js","_CORE/components/component_collisionWalls.js","_CORE/entities/createPlayer.js","_CORE/helpers/helper_MaterialsLib.js","chapter03/systems/system_level.js","assets/level-rooms.obj","assets/floor_outer_map.jpg","assets/skybox/px.jpg","assets/skybox/nx.jpg","assets/skybox/py.jpg","assets/skybox/ny.jpg","assets/skybox/pz.jpg","assets/skybox/nz.jpg","chapter03/Entities/Bot.js","_CORE/helpers/helper_GLTFcopy.js","chapter03/systems/system_bots.js","assets/botMap.png","assets/botAnim2.glb","assets/matIronBox/posx.jpg","assets/matIronBox/negx.jpg","assets/matIronBox/posy.jpg","assets/matIronBox/negy.jpg","assets/matIronBox/posz.jpg","assets/matIronBox/negz.jpg","chapter03/store/actionByChangeQuadrant.js","_CORE/components/component_checkPlayerNearItems.js","chapter03/constants/constants_modules.js","chapter03/actions/PreInitModules.js","_CORE/helpers/helper_DeviceResizer.js","_CORE/helpers/helper_FrameUpater.js","_CORE/helpers/helper_TweenUpdater.js","chapter03/components/component_playerInBot.js","chapter03/actions/StarterPlay.js","chapter03/actions/EnderPlay.js","chapter03/index.js"],"names":["gameModules","a","initModulesByState","gameContext","loaderAssets","dataToLoad","getAssetsFromModulesData","loadAssets","assets","state","modulesData","i","length","key","constr","initStateKey","arr","assetsToLoad","j","push","createLoaders","objLoader","textureLoader","gltfLoader","cubeTextureLoader","path","type","Promise","resolve","OBJLoader","GLTFLoader","THREE","getterLoader","load","LoaderAssets","this","resources","_load","data","iterate","index","EventEmitter","_storage","id","getOrCreateArrFromObj","forEach","action","callback","filter","item","s","console","log","obj","emitter","startPlay","dispatch","newQuadrant","environmentMode","showBackground","startFinalFog","showMessages","toggleFinalMessage","val","mode","toggleDialog","clickPhrase","r","phrase","setTimeout","levelEvent","emit","is","isDialog","toggleButtonDialog","isButtonDialog","TRANSLATE_WORLDS","t","UserReplicies","connect","userReplicies","app","ui","props","className","map","onClick","q","Math","floor","random","BotAnswers","botAnswers","PlayerControls","useState","isInfo","changeShowInfo","isShowFullScreenButt","changeShowFullScreenButt","useEffect","subscribe","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","href","target","dispatcher","isShowControls","isShowClickFullScreen","isShowButtFullScreen","isShowInfo","isShowFinalMessage","MATERIALS_CONFIG","mat","color","emissive","specular","shininess","bumpMap","bumpScale","envMap","reflectivity","skinning","S","FRAME_UPDATE","FLOORS_CONF","fogNear","fogFar","backgroundImgKey","studioConfig","canId","rendererCon","antialias","clearColor","backgroundColor","amb","strength","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","backObjPos","lightDataOne","appData","sceneEnvironment","playerQuadrant","oldDialogPlayerQuadrant","oldQuadrant","counter","isStartCorridorShow","history","botIndex","phraseIndex","phrasesData","phrases","event","rootReducer","combineReducers","isNewBot","isCanChangeBotIndex","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","loader","document","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","style","marginLeft","UI","_gameContext","App","ReactDOM","render","getElementById","startButtons","progressWrapper","display","addEventListener","e","dataset","lang","hideStartScreen","Saturate","uniforms","value","vertexShader","fragmentShader","Studio","canvas","renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","_scene","lightA","getState","background","fog","add","_camera","_composer","EffectComposer","resize","size","width","height","aspect","updateProjectionMatrix","addToScene","bind","oldFogNear","oldFogFar","oldColor","oldBackgroundImgKey","startData","endData","TWEEN","to","onUpdate","start","cam","addPass","RenderPass","ShaderPass","KeyBoard","keys","keysEnabled","keyUpdate","keyCode","isDown","FLOORS_ARRAY","setItemToFloorsCollision","removeItemFromFloorsCollision","mesh","WALLS_ARRAY","createComponentCollisionWalls","objFromLink","objToLink","offset","objFrom","objTo","vec3Src2","vec3Ray2","raycasterWalls","check","getWorldPosition","copy","position","sub","intersectsWalls","intersectObjects","distance","setItemToWallCollision","removeItemFromWallCollision","Player","studio","pr","isButtonsDisabled","_isBlocked","_isCanMove","_mainObj","fromArray","rotation","frontObj","backObj","strenth","light","_checkFloors","delta","vec3Src","vec3Ray","isDisable","raycasterDown","updateData","intersectsFloor","y","count","point","toggleDisable","createComponentCollisionFloors","checkWallsFront","checkWallsBack","oldY","countDropped","isGameComplete","translateZ","dir","isOpen","setCamera","x","z","set","createMaterials","wrapS","wrapT","mapsKeys","materials","keyMap","STANDART_ROOMS","START_ROOMS","createLevelMeshes","allMeshes","rooms","collisionsBotsRooms","traverse","child","name","includes","geometry","wall","green","road","OFFSETS","Bot","inScene","_state","_targetAngle","container","_modelGroup","PI","_objFrom","_objTo","gltf","clone","animations","scene","skinnedMeshes","node","isSkinnedMesh","cloneBones","cloneSkinnedMeshes","isBone","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","boneInverses","matrixWorld","GLTFCopy","botScene","model","children","material","botMaterial","_animations","_mixer","_walkAction","clipAction","play","timeScale","_speakAction","update","_componentCollision","_updateState","_collisionMeshes","visible","stop","lookAt","_startRotate","abs","_startGo","arrWalls","intersectObject","CHANGE_LAYER_STATE","oldState","newState","emitData","emitKey","backgroundImg","levelState","getEmitsByChangeQuadrant","playerOldQ","playerNewQ","getData","conf","createCheckerNewQuadrant","currentQuadrant","isChanged","Component_PlayerNearItems","player","keyBoard","botWorldPos","objToCompare","oldDisabledDir","vec","_arr","_funcToMap","downKey","keyDirInBot","distanceTo","toggleCanMove","funcToMap","GAME_MODULES","em","appWrapper","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fontSize","max","min","fullscreenElement","emitFrameUpdate","time","oldTime","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","group","objRooms","createRoom","kv","instanceKey","objKey","typeLevelChange","isAddBot","removeRoom","remove","isRemoveBot","startL","l","wentLevels","flagIsSpecial","initState","saveOldQuadrant","saveNewQuadrant","saveIsStartCorridorShow","keyCreateRoom","newMode","oldKv","curKv","levelRoomsSrc","pxjpg","nxjpg","pyjpg","nyjpg","pzjpg","nzjpg","mapFloorOuter","wrap","iron","bot","groupBots","arrBots","botRooms","setCollisionMesh","removeCollisionMesh","botSrc","botMap","pxjpg2","nxjpg2","pyjpg2","nyjpg2","pzjpg2","nzjpg2","checkerNewQuadrant","arrEmitData","bots","setArrItems","prepareToSay","showStartButton","toggleBlocked","pipeLineForInit"],"mappings":"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","file":"static/js/main.ca3faaed.chunk.js","sourcesContent":["export async function pipeLineForInit (gameModules) {\r\n    const gameContext = {}\r\n\r\n    initModulesByState('pageLoaded', gameModules, gameContext)\r\n\r\n    const { loaderAssets } = gameContext\r\n\r\n    const dataToLoad = getAssetsFromModulesData(gameModules)\r\n    gameContext.assets = await loaderAssets.loadAssets(dataToLoad)\r\n\r\n    initModulesByState('beforeStartPlay', gameModules, gameContext)\r\n}\r\n\r\n\r\nconst initModulesByState = (state, modulesData, gameContext) => {\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        const {  key, constr, initStateKey } = modulesData[i]\r\n        initStateKey === state && (gameContext[key] = new constr(gameContext))\r\n    }\r\n}\r\n\r\nconst getAssetsFromModulesData = modulesData => {\r\n    const arr = []\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        if (modulesData[i].assetsToLoad && modulesData[i].assetsToLoad.length) {\r\n            for (let j = 0; j < modulesData[i].assetsToLoad.length; ++j) {\r\n                arr.push(modulesData[i].assetsToLoad[j])\r\n            }\r\n        }\r\n    }\r\n    return arr\r\n}","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\n\r\nconst createLoaders = () => {\r\n    let objLoader = null,\r\n        textureLoader = null,\r\n        gltfLoader = null,\r\n        cubeTextureLoader = null\r\n\r\n    const getterLoader = type => {\r\n        if (type === 'obj')\r\n            return objLoader = (objLoader || new OBJLoader())\r\n        if (type === 'glb' || type === 'gltf')\r\n            return gltfLoader = (gltfLoader || new GLTFLoader())\r\n        if (type === 'img')\r\n            return textureLoader = (textureLoader || new THREE.TextureLoader())\r\n        if (type === 'cubeTextures')\r\n            return cubeTextureLoader = (cubeTextureLoader || new THREE.CubeTextureLoader())\r\n    }\r\n\r\n    return (path, type) => new Promise(resolve => getterLoader(type).load(path, resolve))\r\n}\r\n\r\n\r\n\r\n\r\nexport class LoaderAssets {\r\n\r\n    constructor () {\r\n        this.resources = {}\r\n        this._load = createLoaders()\r\n    }\r\n\r\n    loadAssets (data) {\r\n        return new Promise(resolve => {\r\n\r\n            const load = this._load\r\n            const resources = this.resources\r\n\r\n            async function iterate (index) {\r\n                if (data[index]) {\r\n                    const { key, path, type } = data[index]\r\n                    resources[key] = await load(path, type)\r\n                }\r\n\r\n                ++index\r\n                !data[index]\r\n                    ? resolve(resources)\r\n                    : await iterate(index)\r\n            }\r\n\r\n           void iterate(0)\r\n        })\r\n    }\r\n}\r\n","export class EventEmitter {\r\n    constructor() {\r\n        this._storage = {}\r\n    }\r\n\r\n    emit (id) {\r\n        return data => getOrCreateArrFromObj(this._storage)(id).forEach(action => action(data))\r\n    }\r\n\r\n    subscribe (id) {\r\n        return callback => {\r\n            getOrCreateArrFromObj(this._storage)(id).push(callback)\r\n            return () => this._storage[id] = this._storage[id].filter(item => item !== callback)\r\n        }\r\n    }\r\n\r\n    showAll () {\r\n        const s = {}\r\n        for (let key in this._storage) {\r\n            s[key] = this._storage[key].length\r\n        }\r\n        console.log(s)\r\n    }\r\n}\r\n\r\n\r\n\r\n// const createEmitter = () => {\r\n//     const storage = {}\r\n//     return {\r\n//         emit: id => data => getOrCreateArrFromObj(storage)(id).forEach(action => action(data)),\r\n//         subscribe: id => callback => {\r\n//             getOrCreateArrFromObj(storage)(id).push(callback)\r\n//             return () => storage[id] = storage[id].filter(item => item !== callback)\r\n//         },\r\n//         showAll () {\r\n//             const s = {}\r\n//             for (let key in storage) {\r\n//                 s[key] = storage[key].length\r\n//             }\r\n//             console.log(s)\r\n//         },\r\n//     }\r\n// }\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\n\r\n\r\n\r\n\r\n\r\n","let emitter = null\r\nexport const connectEmitterToActions = em => {\r\n    emitter = em\r\n}\r\n\r\n\r\nexport const startPlay = dispatch => ({\r\n    startPlay: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'outer',\r\n    }),\r\n    showBackground: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'back',\r\n    }),\r\n    startFinalFog: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'start',\r\n    }),\r\n})\r\n\r\n\r\nexport const showMessages = dispatch => ({\r\n    toggleFinalMessage: val => dispatch({\r\n        type: 'TOGGLE_FINAL_MESSAGE',\r\n        mode: val,\r\n    })\r\n})\r\n\r\n\r\nexport const clickFullScreen = dispatch => ({\r\n    clickFullScreen: () => {\r\n        dispatch({\r\n            type: 'CLICK_FULL_SCREEN',\r\n        })\r\n    },\r\n\r\n    exitFullScreen: () => {\r\n        dispatch({\r\n            type: 'EXIT_FULL_SCREEN',\r\n        })\r\n    },\r\n})\r\n\r\n\r\nexport const clickInfo = dispatch => {\r\n    return ({\r\n        clickInfo: val => {\r\n            dispatch({\r\n                type: 'INFO_TOGGLE',\r\n                mode: val,\r\n            })\r\n        },\r\n    })\r\n}\r\n\r\n\r\n\r\nexport const toggleDialog = dispatch => ({\r\n    clickPhrase: r => {\r\n        dispatch({\r\n            type: 'CLICK_PHRASE',\r\n            phrase: r,\r\n        })\r\n\r\n        setTimeout(() => {\r\n            dispatch({\r\n                type: 'PHRASE_EVENT',\r\n                phrase: r,\r\n            })\r\n\r\n            r.levelEvent && emitter && emitter.emit('changeLevelMode')(r.levelEvent)\r\n        }, 1000)\r\n    },\r\n\r\n\r\n    toggleDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_DIALOG',\r\n            isDialog: is,\r\n        })\r\n    },\r\n\r\n\r\n    toggleButtonDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_BUTTON',\r\n            isButtonDialog: is,\r\n        })\r\n    }\r\n})\r\n","export const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'Hello there!': ' !',\r\n        'Good day, carbon-based life form.':  ' ,   .',\r\n    \r\n        'What is this place ?': '   ?',\r\n        'This is an entrance to the entropic hyper-maze.': '    -.',\r\n    \r\n        'And what happens if I enter it ?': ' ,     ?',\r\n        'This place is waiting.': '  .',\r\n    \r\n        'Say, where do these corridors lead ?': '    ?',\r\n        'They will lead you to the end.': '    .',\r\n    \r\n        'Ooook, I\\'m heading in then.': '  .',\r\n        'We will meet again.': '  .',\r\n    \r\n        'What do you do here ?': '    ?',\r\n        'Collecting the energy of the night.':  '  .',\r\n    \r\n        'Can you tell me which way is out of here ?': '     ?',\r\n        'It is about the journey, not the destination': '  .     .',\r\n    \r\n        'Hey, it looks like I\\'m walking in circles.': '   .',\r\n        'You have walked long enough.': '     .',\r\n    \r\n        'Meaning?': '  ?',\r\n        'The way to the next level is open to you.': '      .',\r\n\r\n\r\n        // %%%%%%%%%%%%%%%%%%%%%%% 22222222222222222 %%%%%%%%%%%%%%%%%%%%\r\n\r\n        'Hi, I heard I can find the \"end\" around here?': '  .',\r\n        'Yes, I told you this is where the corridors lead.': '    .',\r\n\r\n        'Man, you all look the same.': '   .',\r\n        'We will meet again.': '  .',\r\n\r\n        'Soooo, is that you again ?': '  ?',\r\n        'Yes. All of me are myself.': ',   .',\r\n\r\n        'Yeah, just like those corridors.': '   .',\r\n        'The meaning of everything is in being whole.': '   .',\r\n\r\n        'Am I there yet?': '   .',\r\n        'The sign will be given when you are.': '  ,    .',\r\n\r\n        'How do I know what it is?': '    .',\r\n        'I will give it to you.': '  .',\r\n\r\n        'That\\'s the same exact corridor with you again.':  '     .',\r\n        'You are ready for the next level.': '    .',\r\n\r\n\r\n        // %%%%%%%%%%%%%%%%%%%%% 33333333 %%%%%%%%%%%%%%%%%%%%%%\r\n\r\n        'Hey man, seriously, how do I get out of here ?':' .  .  .',\r\n        'You have not reached the end.':'   .',\r\n\r\n        'We\\'ll how do you reach it ?':'-    ?',\r\n        'I have my way.':'   .',\r\n\r\n        'So how\\'s your way btw ?':'    ?',\r\n        'It is like yourself.': '  .',\r\n\r\n        'And how long you\\'ve been on it ?': '    ?',\r\n        'These walls can hear us.': '   .',\r\n\r\n\r\n        'I think you\\'re weighing this corridor down.': ' ,        .',\r\n        'The next level is open to you.': '   .',\r\n\r\n\r\n        // %%%%%%%%%%%%%%%%%%%%% 444444444444444 %%%%%%%%%%%%%%\r\n\r\n        'Look bud, next level or not, nothing\\'s changed at all !':  '  .',\r\n        'Except the number of steps.': '   .',\r\n        \r\n        'So this place counts steps ?': '   ?',\r\n        'This is place is waiting.': '  .',\r\n        \r\n        'How long have you been here ?': '   ?',\r\n        'How long is irrelevant. What matters is the journey.': '   ,    .',\r\n        \r\n        'Then why aren\\'t you on one?': '    .',\r\n        'With you walking for both of us, I do not have to.': '     .',\r\n        \r\n        'Look, just make a new level, please.': '  .',\r\n        'You are ready. It is waiting for you.': '  -    .',\r\n\r\n    \r\n        // %%%%%%%%%%%%%%%%%% 5555555 %%%%%%%%%%%%%%%%%%%\r\n    \r\n        'Wait, you are this place! You control all its fragments.': '    .   .',\r\n        'You have almost reached the end.': '    .',\r\n        \r\n        'Why do you do this ?': '  ?',\r\n        'It is my way to warp space. More movement. More fragments.': '   .  .  .',\r\n        \r\n        'How many people have been through here ?': '    ?',\r\n        'Many are still here.': '      .',\r\n        \r\n        'So where are they?': '    ?',\r\n        'Everyone has a different system of fragments.': '    .',\r\n        \r\n        'Will you let me out ?': '  ?',\r\n        'All ways lead to the end.': '    .',\r\n        \r\n        'I wanna meet the others.': '   .',\r\n        'The next level is waiting for you.': '   .',\r\n\r\n        // %%%%%%%%%%%%%%%%%%% 6666666666666666 %%%%%%%%%%%%%%%%%%\r\n\r\n        'Everything\\'s looped here.': '  ?',\r\n        'Everything is looped with small differences.': '  .  ',\r\n\r\n        'How many levels even are there ?': '  .',\r\n        'It all depends on you.': '    .',\r\n\r\n        'That\\'s it, I\\'m done.': '   .',\r\n        'Have you reached your journey\\'s end ?': '  ?',\r\n\r\n        'Yes, you mad bastard! I have !': ',  .',\r\n        'Then I am giving you the sign.': '  .',\r\n\r\n\r\n\r\n\r\n        'open dialog': ' ',\r\n        'close dialog': ' ',\r\n        'To be continued': ' ',\r\n        'chapter': '',\r\n        'open': '',\r\n        'Author: ': ': ',\r\n        'link': '',\r\n    }\r\n}\r\n","import { TRANSLATE_WORLDS } from '../../chapter03/constants/constants_replicies'\r\n\r\nlet currentLanguage = 'en'\r\n\r\n// emitter.subscribe('setLanguage')(keyLanguage => {\r\n//     currentLanguage = keyLanguage\r\n// })\r\n\r\n\r\nexport const t = val => (TRANSLATE_WORLDS[currentLanguage] && TRANSLATE_WORLDS[currentLanguage][val]) || val\r\n","import { connect } from 'react-redux'\r\nimport { toggleDialog } from '../store/actions'\r\nimport { t } from '../../_CORE/helpers/helper_translate'\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    userReplicies: state.app.ui.userReplicies,\r\n})\r\n\r\n\r\n\r\n\r\nexport const UserReplicies = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"userReplicies\">\r\n            {props.userReplicies.map(item => (<button\r\n                    key={Math.floor(Math.random()* 100000)}\r\n                    onClick={() => {\r\n                        toggleDialog(props.dispatch).clickPhrase(item)\r\n                    }}>\r\n                    {t(item.q)}\r\n                </button>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { connect } from 'react-redux'\r\nimport { t } from '../../_CORE/helpers/helper_translate'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    botAnswers: state.app.ui.botAnswers,\r\n})\r\n\r\n\r\n\r\n\r\nexport const BotAnswers = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"botAnswers\">\r\n            {props.botAnswers.map(item => (<div key={Math.floor(Math.random() * 100000)}>\r\n                    <div className=\"q\">{t(item.q)}</div>\r\n                    <div className=\"a\">{t(item.a)}</div>\r\n                </div>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { t } from \"../helpers/helper_translate\";\r\nimport { useState, useEffect } from 'react'\r\nimport '../stylesheets/controls.css'\r\n\r\n\r\n\r\n\r\nfunction PlayerControls(props) {\r\n    const [isInfo, changeShowInfo] = useState(false)\r\n    const [isShowFullScreenButt, changeShowFullScreenButt] = useState(true)\r\n\r\n    useEffect(() =>\r\n        props.gameContext.emitter.subscribe('screenMode')(val => {\r\n            val === 'exitFullScreen' && changeShowFullScreenButt(true) })\r\n    )\r\n\r\n\r\n    return (\r\n        <div>\r\n\r\n            <button\r\n                className=\"butt-left control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n            >\r\n                &#9668;\r\n            </button>\r\n\r\n\r\n            <button\r\n                className=\"butt-right control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n            >\r\n                &#9658;\r\n            </button>\r\n\r\n\r\n            <button\r\n                className=\"butt-front control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n            >\r\n                &#9650;\r\n            </button>\r\n\r\n            <button\r\n                className=\"butt-back control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n            >\r\n                &#x25BC;\r\n            </button>\r\n\r\n\r\n\r\n            {isShowFullScreenButt && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        props.gameContext.emitter.emit('mouseDown')('butt-fullscreen')\r\n                        changeShowFullScreenButt(false)\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n            {!isInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => changeShowInfo(true)}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n            {isInfo && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner\">\r\n                        <button\r\n                            className=\"control butt-infoClose\"\r\n                            onClick={() => changeShowInfo(false)}>\r\n                            x\r\n                        </button>\r\n                        <p>\r\n                            {`1 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/factory/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {`2 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/bridge/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p><br /><br />\r\n                            {t('Author: ')}\r\n                            <a href=\"http://otrisovano.ru\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {t('Github: ')}\r\n                            <a href=\"https://github.com/fire888/levels/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                    </div>\r\n                </div>)}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default PlayerControls\r\n","import { UserReplicies } from './UserReplicies'\r\nimport { BotAnswers } from './BotAnswers'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { toggleDialog } from '../store/actions'\r\nimport { t } from '../../_CORE/helpers/helper_translate'\r\nimport PlayerControls from '../../_CORE/componentsReact/PlayerControls'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    isButtonDialog: state.app.ui.isButtonDialog,\r\n    isShowControls: !state.app.ui.isDialog,\r\n    isShowClickFullScreen: state.app.ui.isShowButtFullScreen,\r\n    isShowInfo: state.app.ui.isShowInfo,\r\n    isShowFinalMessage: state.app.ui.isShowFinalMessage,\r\n})\r\n\r\n\r\n\r\n\r\nfunction App(props) {\r\n    !dispatcher.dispatch && (dispatcher.dispatch = props.dispatch)\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"ui\">\r\n            {props.isShowControls && <PlayerControls gameContext={props.gameContext} />}\r\n\r\n            {props.isButtonDialog && (\r\n                <button\r\n                    className=\"butt-toggleDialog control\"\r\n                    onClick={() => {toggleDialog(props.dispatch).toggleDialog(props.isShowControls)}}>\r\n                    {!props.isShowControls ? t('close dialog') : t('open dialog') }\r\n                </button>)}\r\n\r\n\r\n            {!props.isShowControls && (\r\n                <div className=\"dialog\">\r\n                    <div className=\"dialog-inner\">\r\n                        <BotAnswers />\r\n                        <UserReplicies />\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n            {props.isShowFinalMessage && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner final-message\">\r\n                        <p>{t('To be continued')}</p>\r\n                    </div>\r\n                </div>)}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport const dispatcher = { dispatch: null }\r\n\r\nexport default connect(mapStateToProps)(App);\r\n","\r\n\r\nexport const MATERIALS_CONFIG = {\r\n\r\n    'iron': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x003388,\r\n            specular: 0xffffff,\r\n            shininess: 60,\r\n            bumpMap: 'botMap',\r\n            bumpScale: 0.1,\r\n            envMap: 'ironEnv',\r\n            reflectivity: 0.5,\r\n            map: 'botMap',\r\n            skinning: true,\r\n        },\r\n    },\r\n\r\n    'wall': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n            specular: 0x222222,\r\n        },\r\n    },\r\n\r\n\r\n    'green': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    },\r\n\r\n    'road': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xa1129f,\r\n            emissive: 0xa1129f,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    } \r\n}\r\n\r\n\r\n\r\n\r\n/** size element */\r\nexport const S = 175.335\r\nexport const H = 70\r\n\r\n\r\n\r\n/** emitter constants */\r\nexport const FRAME_UPDATE = 'FRAME_UPDATE'\r\n\r\n\r\n\r\n\r\nexport const FLOORS_CONF = {\r\n    '-2': {\r\n        'outer': { fogNear: -200, fogFar: 500, color: 0x18257d },\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x8805a8 },\r\n    },\r\n\r\n   \r\n\r\n    '-1': {\r\n        'start': { fogNear: 0, fogFar: 5, color: 0x18257d },\r\n        'outer': { fogNear: 20, fogFar: 500, color: 0x18257d },\r\n        'back': { fogNear: 20, fogFar: 500, color: 0x18257d, backgroundImgKey: 'skyBox' },\r\n        'firstRoomLight': { fogNear: -40, fogFar: 150, color: 0x00235e},\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x2e118b },\r\n    },\r\n\r\n\r\n    '0': { 'default': { fogNear: -40, fogFar: 150, color: 0x3c4900 }, },\r\n\r\n    \r\n    '1': { 'default': { fogNear: -40, fogFar: 150, color: 0x0e3e52 }, },\r\n\r\n\r\n    '2': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a1763 }, },\r\n\r\n\r\n    '3': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a6340 }, },\r\n\r\n\r\n    '4': { 'default': { fogNear: 0, fogFar: 80, color: 0xac0000 }, },\r\n}\r\n\r\n\r\n\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    clearColor: FLOORS_CONF[-1]['outer'].color,\r\n    backgroundColor: FLOORS_CONF[-1]['outer'].color,\r\n    amb: {\r\n        color: FLOORS_CONF[-1]['outer'].color,\r\n        strength: 0.7,\r\n    },\r\n}\r\n\r\n\r\nexport const playerConfig = {\r\n    //speed: 0.35,\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 10.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    startPos: [100, -78, 1000],\r\n    //startPos: [90, -10, 360.7140705920112], // beginPlay\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 1000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    backObjPos: [0, 0, 1],\r\n    lightDataOne: {\r\n        color: 0xffffff,\r\n        strength: 5000,\r\n        pos: [0, 50, 5],\r\n    },\r\n}\r\n","import { createStore , applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\nimport { FLOORS_CONF } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\nconst DIALOGS_DATA = [\r\n    {\r\n     phrases: [\r\n         {\r\n             q: 'Hello there!',\r\n             a: 'Good day, carbon-based life form.',\r\n             event: 'nextReply',\r\n             levelEvent: null,\r\n         }, {\r\n             q: 'What is this place ?',\r\n             a: 'This is an entrance to the entropic hyper-maze.',\r\n             event: 'nextReply',\r\n             levelEvent: null,\r\n         }, {\r\n             q: 'And what happens if I enter it ?',\r\n             a: 'This place is waiting.',\r\n             event: 'close',\r\n             levelEvent: null,\r\n         },\r\n     ]\r\n  }, {\r\n     phrases: [\r\n         {\r\n             q: 'Say, where do these corridors lead ?',\r\n             a: 'They will lead you to the end.',\r\n             event: 'nextReply',\r\n             levelEvent: null,\r\n         }, {\r\n             q: 'Ooook, I\\'m heading in then.',\r\n             a: 'We will meet again.',\r\n             event: 'close',\r\n             levelEvent: null,\r\n         },\r\n     ]\r\n  }, {\r\n  \r\n  \r\n  \r\n     phrases: [\r\n         {\r\n             q: 'What do you do here ?',\r\n             a: 'Collecting the energy of the night.',\r\n             event: 'nextReply',\r\n             levelEvent: null,\r\n         },\r\n         {\r\n             q: 'Can you tell me which way is out of here ?',\r\n             a: 'It is about the journey, not the destination',\r\n             event: 'close',\r\n             levelEvent: null,\r\n         },\r\n     ]\r\n  },\r\n  \r\n  \r\n  \r\n     {\r\n     phrases: [\r\n         {\r\n         q: 'Hey, it looks like I\\'m walking in circles.',\r\n         a: 'You have walked long enough.',\r\n         event: 'nextReply',\r\n         levelEvent: null,\r\n     },{\r\n         q: 'Meaning?',\r\n         a: 'The way to the next level is open to you.',\r\n         event: 'close',\r\n         levelEvent: 'addStairs',\r\n     },\r\n     ]\r\n  },\r\n  \r\n  \r\n     // %%%%%%%%%%%%%%%%%%%%%%% 22222222222222222 %%%%%%%%%%%%%%%%%%%%\r\n  \r\n     {\r\n     phrases: [\r\n         {\r\n             q: 'Hi, I heard I can find the \"end\" around here?',\r\n             a: 'Yes, I told you this is where the corridors lead.',\r\n             event: 'nextReply',\r\n             levelEvent: null,\r\n         }, {\r\n             q: 'Man, you all look the same.',\r\n             a: 'We will meet again.',\r\n             event: 'close',\r\n             levelEvent: null,\r\n         },\r\n     ]\r\n  },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Soooo, is that you again ?',\r\n                 a: 'Yes. All of me are myself.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             }, {\r\n                 q: 'Yeah, just like those corridors.',\r\n                 a: 'The meaning of everything is in being whole.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Am I there yet?',\r\n                 a: 'The sign will be given when you are.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             }, {\r\n                 q: 'How do I know what it is?',\r\n                 a: 'I will give it to you.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'That\\'s the same exact corridor with you again.',\r\n                 a: 'You are ready for the next level.',\r\n                 event: 'close',\r\n                 levelEvent: 'addStairs',\r\n             },\r\n         ]\r\n     },\r\n  \r\n     // %%%%%%%%%%%%%%%%%%%%% 33333333 %%%%%%%%%%%%%%%%%%%%%%\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Hey man, seriously, how do I get out of here ?',\r\n                 a: 'You have not reached the end.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'We\\'ll how do you reach it ?',\r\n                 a: 'I have my way.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'So how\\'s your way btw ?',\r\n                 a: 'It is like yourself.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'And how long you\\'ve been on it ?',\r\n                 a: 'These walls can hear us.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'I think you\\'re weighing this corridor down.',\r\n                 a: 'The next level is open to you.',\r\n                 event: 'close',\r\n                 levelEvent: 'addStairs',\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n    // %%%%%%%%%%%%%%%%%%%%% 444444444444444 %%%%%%%%%%%%%%\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Look bud, next level or not, nothing\\'s changed at all !',\r\n                 a: 'Except the number of steps.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'So this place counts steps ?',\r\n                 a: 'This is place is waiting.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'How long have you been here ?',\r\n                 a: 'How long is irrelevant. What matters is the journey.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'Then why aren\\'t you on one?',\r\n                 a: 'With you walking for both of us, I do not have to.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Look, just make a new level, please.',\r\n                 a: 'You are ready. It is waiting for you.',\r\n                 event: 'close',\r\n                 levelEvent: 'addStairs',\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n    // %%%%%%%%%%%%%%%%%% 5555555 %%%%%%%%%%%%%%%%%%%\r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Wait, you are this place! You control all its fragments.',\r\n                 a: 'You have almost reached the end.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'Why do you do this ?',\r\n                 a: 'It is my way to warp space. More movement. More fragments.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'How many people have been through here ?',\r\n                 a: 'Many are still here.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'So where are they?',\r\n                 a: 'Everyone has a different system of fragments.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Will you let me out ?',\r\n                 a: 'All ways lead to the end.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'I wanna meet the others.',\r\n                 a: 'The next level is waiting for you.',\r\n                 event: 'close',\r\n                 levelEvent: 'addStairs',\r\n             },\r\n         ]\r\n     },\r\n  \r\n    // %%%%%%%%%%%%%%%%%%% 6666666666666666 %%%%%%%%%%%%%%%%%%\r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'Everything\\'s looped here.',\r\n                 a: 'Everything is looped with small differences.',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'How many levels even are there ?',\r\n                 a: 'It all depends on you.',\r\n                 event: 'close',\r\n                 levelEvent: null,\r\n             },\r\n         ]\r\n     },\r\n  \r\n  \r\n  \r\n     {\r\n         phrases: [\r\n             {\r\n                 q: 'That\\'s it, I\\'m done.',\r\n                 a: 'Have you reached your journey\\'s end ?',\r\n                 event: 'nextReply',\r\n                 levelEvent: null,\r\n             },\r\n             {\r\n                 q: 'Yes, you mad bastard! I have !',\r\n                 a: 'Then I am giving you the sign.',\r\n                 event: 'close',\r\n                 levelEvent: 'addWell',\r\n             },\r\n         ]\r\n     },\r\n  ]  \r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst appData = {\r\n    sceneEnvironment: {\r\n        color: FLOORS_CONF['-1']['start'].color,\r\n        fogNear: FLOORS_CONF['-1']['start'].fogNear,\r\n        fogFar: FLOORS_CONF['-1']['start'].fogFar,\r\n        backgroundImgKey: null,\r\n    },\r\n\r\n    playerQuadrant: {\r\n        oldDialogPlayerQuadrant: [0, 0, -50],\r\n        oldQuadrant: [0, 0, 0],\r\n        newQuadrant: [0, 0, 0],\r\n        counter: null,\r\n    },\r\n\r\n    level: {\r\n        isStartCorridorShow: true,\r\n    },\r\n\r\n    ui: {\r\n        isShowButtFullScreen: true,\r\n        isShowInfo: false,\r\n        isShowFinalMessage: false,\r\n        botAnswers: [],\r\n        userReplicies: [],\r\n        history: [],\r\n        isDialog: false,\r\n        isButtonDialog: false,\r\n    },\r\n\r\n    botIndex: -1,\r\n    phraseIndex: 0,\r\n    phrasesData: DIALOGS_DATA,\r\n}\r\n\r\n\r\n\r\nconst app = function(state = appData, action) {\r\n    if (action.type === 'CLICK_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'EXIT_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: true,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'INFO_TOGGLE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: false,\r\n                isShowInfo: action.mode,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'TOGGLE_FINAL_MESSAGE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: action.mode,\r\n                isShowInfo: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_ENVIRONMENT') {\r\n        const { newQuadrant, environmentMode } = action\r\n\r\n        if (!FLOORS_CONF[newQuadrant[1]]) return state;\r\n\r\n        const { fogNear, fogFar, color, backgroundImgKey } = FLOORS_CONF[newQuadrant[1]][environmentMode]\r\n\r\n        return ({\r\n            ...state,\r\n            sceneEnvironment: {\r\n                fogNear,\r\n                fogFar,\r\n                color,\r\n                backgroundImgKey,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_QUADRANT') {\r\n        return ({\r\n            ...state,\r\n            playerQuadrant: {\r\n                ...state.playerQuadrant,\r\n                ...action,\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'DESTROY_START_CORRIDOR') {\r\n        return ({\r\n            ...state,\r\n            level: {\r\n                ...state.level,\r\n                isStartCorridorShow: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'CLICK_PHRASE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                botAnswers: [\r\n                    ...state.ui.botAnswers,\r\n                    action.phrase,\r\n                ],\r\n                userReplicies: [],\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'PHRASE_EVENT') {\r\n        const { event } = action.phrase\r\n\r\n        if (event === 'nextReply') {\r\n            const userReplicies = [state.phrasesData[state.botIndex].phrases[state.phraseIndex + 1]]\r\n\r\n            return ({\r\n                ...state,\r\n                phraseIndex: state.phraseIndex + 1,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies,\r\n                }\r\n            })\r\n\r\n        }\r\n\r\n        if (event === 'close') {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies: [],\r\n                    isButtonDialog: true,\r\n                },\r\n                playerQuadrant: {\r\n                    ...state.playerQuadrant,\r\n                    oldDialogPlayerQuadrant: [...state.playerQuadrant.newQuadrant]\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'TOGGLE_DIALOG') {\r\n\r\n        let isNewBot = false\r\n        const { oldDialogPlayerQuadrant, newQuadrant } = state.playerQuadrant\r\n        if (\r\n            oldDialogPlayerQuadrant[0] !== newQuadrant[0] ||\r\n            oldDialogPlayerQuadrant[1] !== newQuadrant[1] ||\r\n            oldDialogPlayerQuadrant[2] !== newQuadrant[2]\r\n        ) isNewBot = true\r\n\r\n\r\n\r\n\r\n        if (!isNewBot) {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    isDialog: action.isDialog,\r\n                    isButtonDialog: true,\r\n                },\r\n\r\n            })\r\n        }\r\n\r\n\r\n\r\n        const phraseIndex = 0\r\n        const botIndex = state.botIndex + 1\r\n        const isButtonDialog = false\r\n        /////////////////////////////////////////////////////\r\n\r\n\r\n        ///////////////////////////////////////////// TODO: REMOVE\r\n        // let botIndex = state.botIndex\r\n        // let phraseIndex = state.phraseIndex\r\n        // if (action.isDialog) {\r\n        //     botIndex = state.botIndex + 1\r\n        //     phraseIndex = 0\r\n        // }\r\n        // const isButtonDialog = !action.isDialog\r\n        // /////////////////////////////////////////////////\r\n\r\n\r\n        const userReplicies = state.phrasesData[botIndex] ? [state.phrasesData[botIndex].phrases[phraseIndex]] : []\r\n\r\n        return ({\r\n            ...state,\r\n\r\n            ui: {\r\n                ...state.ui,\r\n                userReplicies,\r\n                botAnswers: [],\r\n                isDialog: action.isDialog,\r\n                isButtonDialog,\r\n            },\r\n\r\n            isCanChangeBotIndex: false,\r\n            botIndex,\r\n            phraseIndex,\r\n        })\r\n    }\r\n\r\n    if (action.type === 'TOGGLE_BUTTON') {\r\n\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isDialog: false,\r\n                isButtonDialog: action.isButtonDialog,\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n    return state\r\n}\r\n\r\n\r\n\r\nconst rootReducer = combineReducers({ app })\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\n\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n    if (!isAnimateLoader) return;\r\n\r\n    setTimeout(() => {\r\n        offsetLoader ++;\r\n        offsetLoader === 0 && (offsetLoader -= 100)\r\n        loader.style.marginLeft = offsetLoader + '%'\r\n        loaderTimeOut()\r\n    }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport class UI {\r\n    constructor(gameContext) {\r\n        this._gameContext = gameContext\r\n        const { App, store } = gameContext\r\n\r\n        ReactDOM.render(\r\n            <Provider store={store}>\r\n                <App\r\n                    gameContext={gameContext}/>\r\n            </Provider>,\r\n            document.getElementById('root')\r\n        )\r\n    }\r\n\r\n    showStartButton(onClick) {\r\n        const startButtons = document.querySelector('.startbuttons-wrapper')\r\n        const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n        const hideStartScreen = e => {\r\n            this._gameContext.emitter.emit('setLanguage')(e.target.dataset.lang)\r\n            document.querySelector('.start-screen').style.display = 'none'\r\n        }\r\n\r\n        isAnimateLoader = false\r\n        startButtons.style.display = 'flex'\r\n        startButtons.addEventListener('click', e => {\r\n            onClick()\r\n            hideStartScreen(e)\r\n        })\r\n        progressWrapper.style.display = 'none'\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","export const Saturate = {\r\nuniforms: {\r\n\"tDiffuse\": { value: null },\r\n},\r\n\r\n\r\nvertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\nfragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { studioConfig } from '../../chapter03/constants/constants_elements'\r\nimport { FRAME_UPDATE } from '../../chapter03/constants/constants_elements'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\n\r\n\r\n\r\nexport class Studio {\r\n    constructor(gameContext) {\r\n        const { store, assets, emitter, } = gameContext\r\n        const { canId, rendererCon, clearColor, amb } = studioConfig\r\n\r\n        rendererCon.canvas = document.getElementById(canId)\r\n\r\n        const renderer = new THREE.WebGLRenderer(rendererCon)\r\n        renderer.setClearColor(clearColor)\r\n        renderer.setPixelRatio(window.devicePixelRatio)\r\n        renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        this._scene = new THREE.Scene()\r\n\r\n        {\r\n            const { color, fogNear, fogFar, backgroundImgKey } = store.getState().app.sceneEnvironment\r\n            this._scene.background = assets[backgroundImgKey] || null\r\n            this._scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n        }\r\n\r\n\r\n        let lightA\r\n        {\r\n            const { color, strength } = amb\r\n            lightA = new THREE.AmbientLight( color, strength )\r\n            this._scene.add( lightA )\r\n        }\r\n\r\n        this._camera = null\r\n\r\n\r\n        this._composer = new EffectComposer(renderer)\r\n        //composer.addPass(new RenderPass(scene, camera))\r\n\r\n\r\n\r\n        const resize = () => {\r\n            const size = { width: window.innerWidth, height: window.innerHeight }\r\n            renderer.setSize(size.width, size.height)\r\n            this._composer.setSize(size.width, size.height)\r\n            if (this._camera) {\r\n                this._camera.aspect = size.width/size.height\r\n                this._camera.updateProjectionMatrix()\r\n            }\r\n        }\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n\r\n\r\n\r\n\r\n        this.addToScene = this._scene.add.bind(this._scene)\r\n        const drawFrame = () => this._camera && this._composer.render(this._scene, this._camera)\r\n        emitter.subscribe(FRAME_UPDATE)(drawFrame)\r\n\r\n\r\n\r\n\r\n\r\n        let\r\n            oldFogNear = this._scene.fog.near,\r\n            oldFogFar = this._scene.fog.far,\r\n            oldColor = this._scene.fog.color,\r\n            oldBackgroundImgKey = store.getState().app.sceneEnvironment.backgroundImgKey\r\n\r\n\r\n\r\n\r\n        store.subscribe(() => {\r\n            const newState = store.getState()\r\n            const { fogNear, fogFar, color, backgroundImgKey } = newState.app.sceneEnvironment\r\n\r\n            if (fogNear !== oldFogNear || fogFar !== oldFogFar || color !== oldColor ) {\r\n                let startData = {\r\n                    color: this._scene.fog.color,\r\n                    near: this._scene.fog.near,\r\n                    far: this._scene.fog.far,\r\n                }\r\n                let endData = {\r\n                    color: new THREE.Color(color),\r\n                    near: fogNear,\r\n                    far: fogFar,\r\n                }\r\n\r\n                oldFogNear = fogNear\r\n                oldFogFar = fogFar\r\n                oldColor = color\r\n\r\n                new TWEEN.Tween(startData)\r\n                    .to(endData, 3000)\r\n                    .onUpdate(() => {\r\n                        this._scene.fog.color = startData.color\r\n                        this._scene.fog.near = startData.near\r\n                        this._scene.fog.far = startData.far\r\n                        lightA.color = startData.color\r\n                        renderer.setClearColor(startData.color)\r\n                    })\r\n                    .start()\r\n            }\r\n\r\n\r\n            if (backgroundImgKey !== oldBackgroundImgKey) {\r\n                oldBackgroundImgKey = backgroundImgKey\r\n                this._scene.background = assets[backgroundImgKey] || null\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    setCamera (cam) {\r\n        this._camera = cam\r\n        this._composer.addPass(new RenderPass(this._scene, this._camera))\r\n        this._composer.addPass(new ShaderPass(Saturate))\r\n    }\r\n}\r\n\r\n","\r\nexport class KeyBoard {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const keys = {\r\n            'up': false,\r\n            'down': false,\r\n            'left': false,\r\n            'right': false,\r\n        }\r\n\r\n        const keysEnabled = {\r\n            'up': true,\r\n            'down': true,\r\n            'left': true,\r\n            'right': true,\r\n        }\r\n\r\n        this.keysEnabled = keysEnabled\r\n        this.keys = keys\r\n\r\n\r\n        const keyUpdate = function ( keyCode, isDown ) {\r\n            switch( keyCode ) {\r\n                case 38:\r\n                case 87:\r\n                    keysEnabled['up'] && (keys['up'] = isDown)\r\n                    break\r\n                case 40:\r\n                case 83:\r\n                    keysEnabled['down'] && (keys['down'] = isDown)\r\n                    break\r\n                case 37:\r\n                case 65:\r\n                    keys['left'] = isDown\r\n                    break\r\n                case 39:\r\n                case 68:\r\n                    keys['right'] = isDown\r\n                    break\r\n            }\r\n            emitter.emit('keyEvent')(keys)\r\n        }\r\n\r\n\r\n\r\n        document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n        document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, true)\r\n            if (key === 'butt-right') keyUpdate(39, true)\r\n            if (key === 'butt-front') keyUpdate(38, true)\r\n            if (key === 'butt-back') keyUpdate(40, true)\r\n        })\r\n        emitter.subscribe('mouseUp')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, false)\r\n            if (key === 'butt-right') keyUpdate(39, false)\r\n            if (key === 'butt-front') keyUpdate(38, false)\r\n            if (key === 'butt-back') keyUpdate(40, false)\r\n        })\r\n    }\r\n\r\n    toggleEnableKeys (key, is) {\r\n        this.keysEnabled[key] = is\r\n        !is && (this.keys[key] = false)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet FLOORS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionFloors = (objFromLink, offset, delta, speed) => {\r\n    const objFrom = objFromLink\r\n    const offsetFromFloor = offset\r\n    const offsetFromFloorFactor = delta\r\n    const speedDown = speed\r\n\r\n    const vec3Src = new THREE.Vector3()\r\n    const vec3Ray = new THREE.Vector3(0, -1, 0)\r\n\r\n    let isDisable = false\r\n    \r\n    const raycasterDown = new THREE.Raycaster(vec3Src, vec3Ray)\r\n\r\n    return {\r\n        check: updateData => {\r\n            if (isDisable) return;\r\n\r\n            vec3Src.copy(objFrom.position)\r\n            const intersectsFloor = raycasterDown.intersectObjects(FLOORS_ARRAY)\r\n            if (intersectsFloor && intersectsFloor[0] && intersectsFloor[0].distance > offsetFromFloor + offsetFromFloorFactor) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            }\r\n            if (intersectsFloor && !intersectsFloor[0]) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            } \r\n            objFrom.position.y = intersectsFloor[0].point.y + offsetFromFloor\r\n        },\r\n        toggleDisable: val => {\r\n            isDisable = val\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport const setItemToFloorsCollision = item => FLOORS_ARRAY.push(item)\r\nexport const removeItemFromFloorsCollision = item => FLOORS_ARRAY = FLOORS_ARRAY.filter(mesh => mesh !== item) \r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet WALLS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFromLink, objToLink, offset) => {\r\n    const offsetWallCollision = offset\r\n    const objFrom = objFromLink\r\n    const objTo = objToLink\r\n\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2)\r\n    \r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            vec3Src2.copy(objFrom.position)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            \r\n            const intersectsWalls = raycasterWalls.intersectObjects(WALLS_ARRAY)\r\n\r\n            return intersectsWalls[0] && intersectsWalls[0].distance < offsetWallCollision\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const setItemToWallCollision = item => WALLS_ARRAY.push(item)\r\nexport const removeItemFromWallCollision = item => WALLS_ARRAY = WALLS_ARRAY.filter(mesh => item !== mesh)\r\n","import * as THREE from 'three'\r\n\r\nimport { playerConfig } from '../../chapter03/constants/constants_elements'\r\n\r\nimport { createComponentCollisionFloors } from '../components/component_collisionFloor'\r\nimport { createComponentCollisionWalls } from '../components/component_collisionWalls'\r\n\r\nimport { FRAME_UPDATE } from '../../chapter03/constants/constants_elements'\r\nimport { showMessages, startPlay } from '../../chapter03/store/actions'\r\n\r\n\r\n\r\nexport class Player {\r\n    constructor (gameContext) {\r\n        const { emitter, studio, pr } = gameContext\r\n\r\n        const {\r\n            startPos,\r\n            startRot,\r\n            cameraData,\r\n            frontObjPos,\r\n            backObjPos,\r\n            lightDataOne,\r\n            speed,\r\n            offsetFromFloor,\r\n            offsetFromFloorFactor,\r\n            speedDown,\r\n            offsetWallCollision,\r\n            speedRot,\r\n        } = playerConfig\r\n\r\n\r\n        this._camera = null\r\n        let keys = {}\r\n        let isButtonsDisabled = false\r\n        this._isBlocked = true\r\n        this._isCanMove = {\r\n            'up': true,\r\n            'down': true,\r\n        }\r\n\r\n        this._mainObj = new THREE.Object3D()\r\n        this._mainObj.position.fromArray(startPos)\r\n        this._mainObj.rotation.fromArray(startRot)\r\n\r\n        const frontObj = new THREE.Object3D()\r\n        frontObj.position.fromArray(frontObjPos)\r\n        this._mainObj.add(frontObj)\r\n        this.frontObj = frontObj\r\n\r\n        const backObj = new THREE.Object3D()\r\n        backObj.position.fromArray(backObjPos)\r\n        this._mainObj.add(backObj)\r\n        this.backObj = backObj\r\n\r\n        {\r\n            const { fov, ratio, near, far, pos } = cameraData\r\n            this._camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n            this._camera.position.fromArray(pos)\r\n            this._mainObj.add(this._camera)\r\n        }\r\n\r\n        {\r\n            const { color, strenth, pos } = lightDataOne\r\n            const light = new THREE.PointLight(color, strenth)\r\n            light.position.fromArray(pos)\r\n            this._mainObj.add(light)\r\n        }\r\n\r\n\r\n        this._checkFloors = createComponentCollisionFloors(this._mainObj, offsetFromFloor, offsetFromFloorFactor, speedDown)\r\n        const checkWallsFront = createComponentCollisionWalls(this._mainObj, frontObj, offsetWallCollision)\r\n        const checkWallsBack = createComponentCollisionWalls(this._mainObj, backObj, offsetWallCollision)\r\n\r\n        let oldY = this._mainObj.position.y\r\n        let countDropped = 0\r\n        let isGameComplete = false\r\n\r\n        const update = data => {\r\n            if (isButtonsDisabled) return;\r\n            if (this._isBlocked) return;\r\n\r\n            this._checkFloors.check(data)\r\n\r\n            if (!keys) return;\r\n\r\n            if (keys['up']) {\r\n                if (checkWallsFront.check()) return;\r\n                if (!this._isCanMove['up']) return;\r\n\r\n                this._mainObj.translateZ(-speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'up' })\r\n            }\r\n\r\n            if (keys['down']) {\r\n                if (checkWallsBack.check()) return;\r\n                if (!this._isCanMove['down']) return;\r\n\r\n                this._mainObj.translateZ(speed * data.count)\r\n                emitter.emit('playerMove')({ pos: this._mainObj.position, dir: 'down' })\r\n            }\r\n            keys['left'] && (this._mainObj.rotation.y += (speedRot * data.count))\r\n            keys['right'] && (this._mainObj.rotation.y -= (speedRot * data.count))\r\n\r\n\r\n            if (oldY > this._mainObj.position.y) {\r\n                ++countDropped\r\n            } else {\r\n                countDropped = 0\r\n            }\r\n            oldY = this._mainObj.position.y\r\n\r\n            if (countDropped > 800 && !isGameComplete) {\r\n                isGameComplete = true\r\n                setTimeout(() => {\r\n                    startPlay(pr.dispatch).startFinalFog()\r\n                    setTimeout(() => {\r\n                        showMessages(pr.dispatch).toggleFinalMessage(true)\r\n                    }, 6000)\r\n                }, 10000)\r\n            }\r\n        }\r\n\r\n\r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        emitter.subscribe(FRAME_UPDATE)(update)\r\n        emitter.subscribe('toggleDialog')(val => isButtonsDisabled = val.isOpen)\r\n\r\n\r\n        studio.setCamera(this._camera)\r\n        studio.addToScene(this._mainObj)\r\n    }\r\n\r\n    toggleBlocked (val) {\r\n        this._isBlocked = val\r\n    }\r\n\r\n    toggleCanMove(key, val) {\r\n        this._isCanMove[key] = val\r\n    }\r\n\r\n    getObj () {\r\n        return this._mainObj\r\n    }\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n    setToPos (x, y, z) {\r\n        this._mainObj.position.set(x, y, z)\r\n    }\r\n}\r\n","import { MATERIALS_CONFIG } from '../../chapter03/constants/constants_elements'\r\nimport * as THREE from 'three'\r\n\r\nexport class Helper_MaterialsLib {\r\n    constructor (gameContext) {\r\n        const { assets } = gameContext\r\n\r\n        gameContext.materials = createMaterials(assets)\r\n    }\r\n}\r\n\r\n\r\nconst createMaterials = assets => {\r\n    for (let key in assets)\r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}","import {\r\n    setItemToFloorsCollision,\r\n    removeItemFromFloorsCollision, \r\n} from '../../_CORE/components/component_collisionFloor'\r\nimport {\r\n    setItemToWallCollision,\r\n    removeItemFromWallCollision,\r\n} from '../../_CORE/components/component_collisionWalls'\r\nimport * as THREE from 'three'\r\nimport { S, H } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst STANDART_ROOMS = ['room_02', 'room_03', 'room_04', 'room_05']\r\nconst START_ROOMS = ['outer_walls', 'outer_floor', 'outer_road']\r\n\r\n\r\n\r\nexport class Level {\r\n    constructor(gameContext) {\r\n        const { emitter, studio, store, assets, materials } = gameContext\r\n        const { rooms, allMeshes, collisionsBotsRooms } = createLevelMeshes(assets, materials)\r\n\r\n        this.collisionsBotsRooms = collisionsBotsRooms\r\n\r\n        const group = new THREE.Group()\r\n        studio.addToScene(group)\r\n        const objRooms = {}\r\n\r\n\r\n\r\n        let state = 'normal' // 'addBot' || 'addStairs' || 'addWell'\r\n\r\n\r\n        const createRoom = (kv, key) => {\r\n            const instanceKey = key || STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n\r\n            const objKey = `r_${kv[0]}_${kv[1]}_${kv[2]}`\r\n\r\n            const mesh = rooms[instanceKey].clone()\r\n            mesh.position.set(kv[0] * S, kv[1] * H, kv[2] * S)\r\n            setItemToFloorsCollision(mesh)\r\n            setItemToWallCollision(mesh)\r\n            group.add(mesh)\r\n            objRooms[objKey] = mesh\r\n\r\n\r\n            emitter.emit('levelChanged')({\r\n                typeLevelChange: 'createRoom',\r\n                instanceKey,\r\n                objKey,\r\n                kv,\r\n                isAddBot: instanceKey === 'room_01'\r\n            })\r\n\r\n            instanceKey === 'room_06' && createRoom([kv[0], kv[1] + 1, kv[2]], 'room_dummy')\r\n        }\r\n\r\n\r\n        const removeRoom = kv => {\r\n            const objKey = `r_${ kv[0] }_${ kv[1] }_${ kv[2] }`\r\n            if (!objRooms[objKey]) return;\r\n\r\n\r\n            const instanceKey = objRooms[objKey].name\r\n\r\n\r\n            group.remove(objRooms[objKey])\r\n            removeItemFromFloorsCollision(objRooms[objKey])\r\n            removeItemFromWallCollision(objRooms[objKey])\r\n            delete objRooms[objKey]\r\n\r\n\r\n            emitter.emit('levelChanged')({\r\n                typeLevelChange: 'destroyRoom',\r\n                instanceKey,\r\n                objKey,\r\n                kv,\r\n                isRemoveBot: instanceKey === 'room_01'\r\n            })\r\n\r\n            instanceKey === 'room_dummy' && removeRoom([kv[0], kv[1] - 1, kv[2]])\r\n            instanceKey === 'room_06' && removeRoom([kv[0], kv[1] + 1, kv[2]])\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n        createRoom([0, -1, 0], 'room_02')\r\n        createRoom([0, -1, -1], 'room_02')\r\n        createRoom([-1, -1, 0], 'room_02')\r\n        createRoom([1, -1, 0], 'room_02')\r\n\r\n\r\n\r\n        /** add remove start corridors */\r\n        const startL = {}\r\n        for (let i = 0; i < START_ROOMS.length; ++i) {\r\n            const l = allMeshes[START_ROOMS[i]].clone()\r\n            setItemToFloorsCollision(l)\r\n            setItemToWallCollision(l)\r\n            group.add(l)\r\n            l.position.set(0, -1 * H, 0)\r\n            startL[START_ROOMS[i]] = l\r\n        }\r\n\r\n\r\n\r\n\r\n        let wentLevels = 0\r\n        let flagIsSpecial = false\r\n\r\n        const initState = store.getState()\r\n        let saveOldQuadrant = initState.app.playerQuadrant.oldQuadrant\r\n        let saveNewQuadrant = initState.app.playerQuadrant.newQuadrant\r\n        let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n\r\n\r\n\r\n\r\n        store.subscribe(() => {\r\n            const newState = store.getState()\r\n\r\n            if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n                saveIsStartCorridorShow = false\r\n                for (let key in startL) {\r\n                    removeItemFromFloorsCollision(startL[key])\r\n                    removeItemFromWallCollision(startL[key])\r\n                    group.remove(startL[key])\r\n                }\r\n            }\r\n\r\n\r\n            const { type, oldQuadrant, newQuadrant, counter } = newState.app.playerQuadrant\r\n\r\n\r\n            if ( type !== 'CHANGE_QUADRANT' ) return;\r\n\r\n\r\n            if (\r\n                saveOldQuadrant[0] !== oldQuadrant[0] ||\r\n                saveOldQuadrant[1] !== oldQuadrant[1] ||\r\n                saveOldQuadrant[2] !== oldQuadrant[2] ||\r\n                saveNewQuadrant[0] !== newQuadrant[0] ||\r\n                saveNewQuadrant[1] !== newQuadrant[1] ||\r\n                saveNewQuadrant[2] !== newQuadrant[2]\r\n            ) {\r\n                saveOldQuadrant = [...oldQuadrant]\r\n                saveNewQuadrant = [...newQuadrant]\r\n            } else {\r\n                return;\r\n            }\r\n\r\n\r\n\r\n            let keyCreateRoom = STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n            if (counter) {\r\n                wentLevels = counter(wentLevels)\r\n\r\n                if (flagIsSpecial) {\r\n                    flagIsSpecial = false\r\n                } else {\r\n                    if (wentLevels < 3) {\r\n                        state = 'normal'\r\n                    } else if (wentLevels < 100) {\r\n                        if (state === 'normal') {\r\n                            state = 'addBot'\r\n                        }\r\n                    } else {\r\n                        state = 'addStairs'\r\n                    }\r\n\r\n\r\n                    if (state === 'addBot') {\r\n                        keyCreateRoom = 'room_01'\r\n                        flagIsSpecial = true\r\n                    }\r\n                    if (state === 'addStairs') {\r\n                        keyCreateRoom = 'room_06'\r\n                        flagIsSpecial = true\r\n                    }\r\n                    if (state === 'addWell') {\r\n                        keyCreateRoom = 'room_07'\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            emitter.subscribe('changeLevelMode')(newMode => state = newMode)\r\n\r\n\r\n            const oldKv = oldQuadrant, curKv = newQuadrant\r\n            // move west\r\n            if (curKv[0] < oldKv[0]) {\r\n                console.log('----------- west')\r\n                // remove east\r\n                removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n\r\n                // set center to east\r\n                objRooms[`r_${curKv[0] + 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n                // create west\r\n                createRoom([oldKv[0] - 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n                // remove north\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n                // create north\r\n                createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n                // remove south\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n                // create soush\r\n                createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n            }\r\n\r\n            // move east\r\n            if (curKv[0] > oldKv[0]) {\r\n                console.log('----------- east')\r\n                // remove west\r\n                removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n\r\n                // set center to east\r\n                objRooms[`r_${curKv[0] - 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n                // create east\r\n                createRoom([oldKv[0] + 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n                // remove north\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n                // create north\r\n                createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n                // remove south\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n                // create south\r\n                createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n            }\r\n\r\n\r\n            // move north\r\n            if (curKv[2] < oldKv[2]) {\r\n                console.log('-----------north')\r\n                // remove south\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n\r\n                // set center to south\r\n                objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] + 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n                // create north\r\n                createRoom([oldKv[0], oldKv[1], oldKv[2] - 2], keyCreateRoom)\r\n\r\n                // remove west\r\n                removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n                // create west\r\n                createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n                // remove east\r\n                removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n                // create east\r\n                createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n            }\r\n\r\n\r\n            // move south\r\n            if (curKv[2] > oldKv[2]) {\r\n                console.log('-----------south')\r\n                // remove north\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n\r\n                // set center to north\r\n                objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] - 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n                // create south\r\n                createRoom([oldKv[0], oldKv[1], oldKv[2] + 2], keyCreateRoom)\r\n\r\n                // remove west\r\n                removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n                // create west\r\n                createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n                // remove east\r\n                removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n                // create east\r\n                createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n            }\r\n\r\n            // move top\r\n            if (curKv[1] > oldKv[1] || curKv[1] < oldKv[1]) {\r\n                console.log('-----------top')\r\n                // remove north\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n                // create north\r\n                createRoom([curKv[0], curKv[1], curKv[2] - 1])\r\n                // remove south\r\n                removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n                // create south\r\n                createRoom([curKv[0], curKv[1], curKv[2] + 1])\r\n                // remove left\r\n                removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n                // create left\r\n                createRoom([curKv[0] - 1, curKv[1], curKv[2]])\r\n                // remove right\r\n                removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n                // create right\r\n                createRoom([curKv[0] + 1, curKv[1], curKv[2]])\r\n            }\r\n\r\n        })\r\n    }\r\n}\r\n\r\n\r\nconst createLevelMeshes = (assets, materials) => {\r\n    const allMeshes = {}\r\n    const rooms = {}\r\n    const collisionsBotsRooms = {}\r\n\r\n    assets['level-rooms'].traverse(child => {\r\n        if (child.name.includes(\"room_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            rooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"collision_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry)\r\n            collisionsBotsRooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_walls\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_road\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.green)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_floor\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.road)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n    })\r\n\r\n    return {\r\n        rooms,\r\n        allMeshes,\r\n        collisionsBotsRooms,\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/level-rooms.5251ade2.obj\";","export default __webpack_public_path__ + \"static/media/floor_outer_map.35e50f6e.jpg\";","export default __webpack_public_path__ + \"static/media/px.2be78f43.jpg\";","export default __webpack_public_path__ + \"static/media/nx.b2401269.jpg\";","export default __webpack_public_path__ + \"static/media/py.659ebc34.jpg\";","export default __webpack_public_path__ + \"static/media/ny.462f1251.jpg\";","export default __webpack_public_path__ + \"static/media/pz.8ea5ba14.jpg\";","export default __webpack_public_path__ + \"static/media/nz.7f255b96.jpg\";","import * as THREE from 'three'\r\nimport { GLTFCopy } from '../../_CORE/helpers/helper_GLTFcopy'\r\n\r\n\r\nconst OFFSETS = {\r\n    'room_01': { x: 55, z: 75}\r\n}\r\n\r\nexport class Bot {\r\n    constructor () {\r\n        this.inScene = false\r\n\r\n        this._state = 'go' // || 'rotate' || 'say'\r\n\r\n        this._targetAngle = null\r\n\r\n\r\n        this.container = new THREE.Group()\r\n\r\n        this._modelGroup = new THREE.Group()\r\n        this._modelGroup.position.x = OFFSETS['room_01'].x\r\n        this._modelGroup.position.z = OFFSETS['room_01'].z\r\n        this._modelGroup.rotation.y = Math.random() * (2 * Math.PI)\r\n        this.container.add(this._modelGroup)\r\n\r\n        this._objFrom = new THREE.Object3D()\r\n        this._modelGroup.add(this._objFrom)\r\n\r\n\r\n        this._objTo = new THREE.Object3D()\r\n        this._objTo.position.set(0, 0, 1)\r\n        this._modelGroup.add(this._objTo)\r\n\r\n\r\n        const copy = GLTFCopy(Bot.botScene)\r\n        this.model = copy.scene.children[0]\r\n        this.model.children[1].material = Bot.botMaterial\r\n        this._animations = Bot.botScene.animations\r\n        this._mixer = new THREE.AnimationMixer(this.model.children[1])\r\n        this._walkAction = this._mixer.clipAction(this._animations[1])\r\n        this._walkAction.play()\r\n        this._walkAction.timeScale = .7\r\n\r\n        this._speakAction = this._mixer.clipAction(this._animations[0])\r\n        this._speakAction.timeScale = .4\r\n\r\n        this._modelGroup.add(this.model)\r\n    }\r\n\r\n\r\n    update (data) {\r\n        this._mixer.update(data.delta)\r\n\r\n        if (!this._componentCollision) return;\r\n\r\n        this._updateState()\r\n    }\r\n\r\n\r\n    setCollisionMesh (mesh) {\r\n        this._collisionMeshes = [mesh]\r\n        this.container.add(mesh)\r\n        mesh.material.visible = false\r\n\r\n\r\n        this._componentCollision = createComponentCollisionWalls(this._objFrom, this._objTo, 7, this._collisionMeshes)\r\n    }\r\n\r\n    removeCollisionMesh () {\r\n        this._collisionMeshes = null\r\n        this._componentCollision = null\r\n    }\r\n\r\n\r\n    prepareToSay (pos) {\r\n        this._state = 'say'\r\n        this._walkAction.stop()\r\n        this._speakAction.play()\r\n        this._modelGroup.lookAt(pos.x, this.container.position.y, pos.z)\r\n    }\r\n\r\n\r\n    /** internal *****************************/\r\n\r\n    _updateState () {\r\n        if (this._state === 'go') {\r\n            const isNear = this._componentCollision.check()\r\n            if (!isNear) {\r\n                this._modelGroup.translateZ(0.05)\r\n            } else {\r\n                this._startRotate()\r\n            }\r\n        }\r\n\r\n        if (this._state === 'rotate') {\r\n            this._modelGroup.rotation.y += ((this._targetAngle - this._modelGroup.rotation.y) < 0) ? -.01 : .01\r\n            this._modelGroup.rotation.y %= 2 * Math.PI\r\n            const isComplete = Math.abs(this._modelGroup.rotation.y - this._targetAngle) < .5\r\n            isComplete && this._startGo()\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _startGo () {\r\n        this._state = 'go'\r\n        this._walkAction.play()\r\n        this._speakAction.stop()\r\n    }\r\n\r\n\r\n    _startRotate() {\r\n        this._state = 'rotate'\r\n        this._targetAngle = (this._modelGroup.rotation.y + 1.5 + Math.random() * 4) % (2 * Math.PI)\r\n    }\r\n}\r\n\r\nBot.botScene = null\r\nBot.botMaterial = null\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFrom, objTo, offset, arrWalls) => {\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            objFrom.getWorldPosition(vec3Src2)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2, 0, 20)\r\n            const intersectsWalls = raycasterWalls.intersectObject(arrWalls[0], true)\r\n\r\n            return !!intersectsWalls[0]\r\n        }\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport const GLTFCopy = gltf => {\r\n    const clone = {\r\n          animations: gltf.animations,\r\n          scene: gltf.scene.clone(true)\r\n    };\r\n  \r\n    const skinnedMeshes = {};\r\n  \r\n    gltf.scene.traverse(node => {\r\n        if (node.isSkinnedMesh) {\r\n            skinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    const cloneBones = {};\r\n    const cloneSkinnedMeshes = {};\r\n  \r\n    clone.scene.traverse(node => {\r\n        if (node.isBone) {\r\n            cloneBones[node.name] = node;\r\n        }\r\n  \r\n        if (node.isSkinnedMesh) {\r\n            cloneSkinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    for (let name in skinnedMeshes) {\r\n        const skinnedMesh = skinnedMeshes[name];\r\n        const skeleton = skinnedMesh.skeleton;\r\n        const cloneSkinnedMesh = cloneSkinnedMeshes[name];\r\n  \r\n        const orderedCloneBones = [];\r\n  \r\n        for (let i = 0; i < skeleton.bones.length; ++i) {\r\n            const cloneBone = cloneBones[skeleton.bones[i].name];\r\n            orderedCloneBones.push(cloneBone);\r\n        }\r\n  \r\n        cloneSkinnedMesh.bind(\r\n            new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses),\r\n            cloneSkinnedMesh.matrixWorld);\r\n    }\r\n  \r\n    return clone;\r\n}","import * as THREE from 'three'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { Bot } from '../Entities/Bot'\r\n\r\n\r\nconst S = 175.335\r\nconst H = 70\r\nconst H_BOT = 14\r\n\r\n\r\nexport class Bots {\r\n    constructor(gameContext) {\r\n        const { assets, emitter, store, studio, materials } = gameContext\r\n\r\n        Bot.botMaterial = materials.iron\r\n        Bot.botScene = assets.bot\r\n\r\n\r\n\r\n        const groupBots = new THREE.Group()\r\n        studio.addToScene(groupBots)\r\n\r\n\r\n        const arrBots = []\r\n        this.arrBots = arrBots\r\n\r\n\r\n        let botRooms = null\r\n        if (gameContext['level'] && gameContext['level'].collisionsBotsRooms) {\r\n            botRooms = gameContext['level'].collisionsBotsRooms\r\n        }\r\n\r\n\r\n        for (let i = 0; i < 5; ++i) {\r\n            const bot = new Bot()\r\n            groupBots.add(bot.container)\r\n            bot.container.position.set(-30 + i * 30, -92, 750)\r\n            bot.inScene = 'aaa'\r\n            botRooms && bot.setCollisionMesh(botRooms['collision_r_01'].clone())\r\n            arrBots.push(bot)\r\n        }\r\n\r\n\r\n\r\n\r\n        emitter.subscribe(FRAME_UPDATE)(data => {\r\n            for (let i = 0; i < arrBots.length; ++i) arrBots[i].inScene && arrBots[i].update(data)\r\n        })\r\n\r\n\r\n\r\n\r\n        const initState = store.getState()\r\n        let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n        store.subscribe(() => {\r\n            const newState = store.getState()\r\n            if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n                saveIsStartCorridorShow = newState.app.level.isStartCorridorShow\r\n\r\n                for (let i = 0; i < arrBots.length; ++i) {\r\n                    arrBots[i].inScene = null\r\n                    arrBots[i].container.position.y = -10000\r\n                    arrBots[i].removeCollisionMesh()\r\n                }\r\n            }\r\n        })\r\n\r\n\r\n\r\n\r\n\r\n\r\n        emitter.subscribe('levelChanged')(({ objKey, kv, isAddBot, isRemoveBot }) => {\r\n            if (isAddBot) {\r\n                for (let i = 0; i < arrBots.length; ++i) {\r\n                    if (!arrBots[i].inScene) {\r\n                        arrBots[i].inScene = objKey\r\n                        arrBots[i].container.position.set(kv[0] * S, kv[1] * H + H_BOT, kv[2] * S)\r\n                        botRooms && arrBots[i].setCollisionMesh(botRooms['collision_r_01'].clone())\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (isRemoveBot) {\r\n                for (let i = 0; i < arrBots.length; ++i) {\r\n                    if (arrBots[i].inScene === objKey) {\r\n                        arrBots[i].inScene = null\r\n                        arrBots[i].container.position.y = -10000\r\n                        arrBots[i].removeCollisionMesh()\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/botMap.972e276e.png\";","export default __webpack_public_path__ + \"static/media/botAnim2.47b6030d.glb\";","export default __webpack_public_path__ + \"static/media/posx.be2d83a2.jpg\";","export default __webpack_public_path__ + \"static/media/negx.d016c8e7.jpg\";","export default __webpack_public_path__ + \"static/media/posy.01cfd221.jpg\";","export default __webpack_public_path__ + \"static/media/negy.f01f8356.jpg\";","export default __webpack_public_path__ + \"static/media/posz.ef37b8e1.jpg\";","export default __webpack_public_path__ + \"static/media/negz.f346a80a.jpg\";","import { S, H } from '../constants/constants_elements'\r\n\r\n\r\n\r\nexport const START_LAYER_STATE = 'outer'\r\n\r\n\r\n\r\n\r\n\r\nexport const CHANGE_LAYER_STATE = [\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'outer', newState: 'corridor',\r\n        oldQuadrant: [0, -2, 4], newQuadrant: [0, -2, 3],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n                backgroundImg: false\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'corridor', newState: 'outer',\r\n        oldQuadrant: [0, -2, 3], newQuadrant: [0, -2, 4],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'outer',\r\n            },\r\n        ]\r\n    },\r\n\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'corridor', newState: 'firstRoom',\r\n        oldQuadrant: [0, -1, 2], newQuadrant: [0, -1, 1],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'firstRoomLight',\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'corridor',\r\n        oldQuadrant: [0, -1, 1], newQuadrant: [0, -1, 2],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: [0, -1, 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_MINUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_PLUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_PLUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 0,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_MINUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 100,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            },\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_MINUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_PLUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_PLUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n]\r\n\r\n\r\n\r\nexport class ChangerQuadrant {\r\n    constructor(gameContext) {\r\n        const { pr, emitter } = gameContext\r\n        const checkerNewQuadrant = createCheckerNewQuadrant()\r\n\r\n\r\n        emitter.subscribe('playerMove')(({ pos }) => {\r\n            const data = checkerNewQuadrant.update(pos)\r\n            const { currentQuadrant, oldQuadrant, isChanged } = data\r\n\r\n            if (!isChanged) return;\r\n\r\n            const arrEmitData = getEmitsByChangeQuadrant(oldQuadrant, currentQuadrant)\r\n\r\n            arrEmitData.length && arrEmitData.forEach(item => pr.dispatch({\r\n                ...item,\r\n                type: item.emitKey,\r\n            }))\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nlet levelState = START_LAYER_STATE\r\n\r\n\r\nexport const getEmitsByChangeQuadrant = (playerOldQ, playerNewQ) => {\r\n    for (let i = 0; i < CHANGE_LAYER_STATE.length; ++i) {\r\n        const data = getData(\r\n            [...playerOldQ],\r\n            [...playerNewQ],\r\n            {\r\n                ...CHANGE_LAYER_STATE[i],\r\n                oldQuadrant: [...CHANGE_LAYER_STATE[i].oldQuadrant],\r\n                newQuadrant: [...CHANGE_LAYER_STATE[i].newQuadrant],\r\n            }\r\n        )\r\n        if (data) return data;\r\n    }\r\n    return { levelState }\r\n}\r\n\r\n\r\n\r\n\r\nconst getData = (playerOldQ, playerNewQ, conf) => {\r\n    const { oldState, newState, oldQuadrant, newQuadrant, emitData } = conf\r\n\r\n    if (levelState !== oldState)\r\n        return;\r\n\r\n\r\n    if (oldQuadrant[0] === 'ANY') oldQuadrant[0] = playerOldQ[0]\r\n    if (oldQuadrant[1] === 'ANY') oldQuadrant[1] = playerOldQ[1]\r\n    if (oldQuadrant[2] === 'ANY') oldQuadrant[2] = playerOldQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY') newQuadrant[0] = playerNewQ[0]\r\n    if (newQuadrant[1] === 'ANY') newQuadrant[1] = playerNewQ[1]\r\n    if (newQuadrant[2] === 'ANY') newQuadrant[2] = playerNewQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY_PLUS_ONE') newQuadrant[0] = playerOldQ[0] + 1\r\n    if (newQuadrant[1] === 'ANY_PLUS_ONE') newQuadrant[1] = playerOldQ[1] + 1\r\n    if (newQuadrant[2] === 'ANY_PLUS_ONE') newQuadrant[2] = playerOldQ[2] + 1\r\n\r\n    if (newQuadrant[0] === 'ANY_MINUS_ONE') newQuadrant[0] = playerOldQ[0] - 1\r\n    if (newQuadrant[1] === 'ANY_MINUS_ONE') newQuadrant[1] = playerOldQ[1] - 1\r\n    if (newQuadrant[2] === 'ANY_MINUS_ONE') newQuadrant[2] = playerOldQ[2] - 1\r\n\r\n\r\n    if (\r\n        oldQuadrant[0] !== playerOldQ[0] ||\r\n        oldQuadrant[1] !== playerOldQ[1] ||\r\n        oldQuadrant[2] !== playerOldQ[2] ||\r\n        newQuadrant[0] !== playerNewQ[0] ||\r\n        newQuadrant[1] !== playerNewQ[1] ||\r\n        newQuadrant[2] !== playerNewQ[2]\r\n    ) return;\r\n\r\n\r\n    levelState = newState\r\n\r\n    return emitData.map(item => ({\r\n        ...item,\r\n        levelState,\r\n        oldQuadrant: [...oldQuadrant],\r\n        newQuadrant: [...newQuadrant],\r\n    }))\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst createCheckerNewQuadrant = function () {\r\n    let oldQuadrant = []\r\n\r\n    return {\r\n        update ({ x, y, z}) {\r\n            const currentQuadrant = [Math.floor(x / S), Math.floor(y / H), Math.floor(z / S)]\r\n\r\n            if (\r\n                currentQuadrant[0] !== oldQuadrant[0] ||\r\n                currentQuadrant[1] !== oldQuadrant[1] ||\r\n                currentQuadrant[2] !== oldQuadrant[2]\r\n            ) {\r\n                const data = {\r\n                    isChanged: true,\r\n                    currentQuadrant,\r\n                    oldQuadrant,\r\n                }\r\n                oldQuadrant = [...currentQuadrant]\r\n\r\n                return data\r\n            } else {\r\n                return { isChanged: false }\r\n            }\r\n        },\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import * as THREE from \"three\";\r\nimport {FRAME_UPDATE} from \"../../chapter03/constants/constants_elements\";\r\nimport { toggleDialog } from '../../chapter03/store/actions'\r\n\r\nconst MIN_DIST_TO_BOT = 12\r\nconst MAX_DIALOG_DIST_TO_BOT = 30\r\n\r\nexport class Component_PlayerNearItems {\r\n    constructor(gameContext) {\r\n        const { player, emitter, keyBoard } = gameContext\r\n\r\n        const botWorldPos = new THREE.Vector3()\r\n\r\n\r\n        const objToCompare = {\r\n            'up': player.frontObj,\r\n            'down': player.backObj,\r\n        }\r\n\r\n\r\n        let oldDisabledDir = null\r\n        const vec = new THREE.Vector3()\r\n\r\n        this._arr = []\r\n        this._funcToMap = () => {}\r\n\r\n\r\n        emitter.subscribe(FRAME_UPDATE)(() => {\r\n            let downKey = null\r\n            if (keyBoard.keys['up']) downKey = 'up'\r\n            if (keyBoard.keys['down']) downKey = 'down'\r\n            if (!downKey) return;\r\n\r\n            let keyDirInBot = null\r\n\r\n            for (let i = 0; i < this._arr.length; ++i) {\r\n                if (!this._arr[i].inScene) continue;\r\n\r\n                this._arr[i]._modelGroup.getWorldPosition(botWorldPos)\r\n                const distance = botWorldPos.distanceTo(objToCompare[downKey].getWorldPosition(vec))\r\n\r\n                distance < MIN_DIST_TO_BOT && (keyDirInBot = downKey)\r\n\r\n                this._funcToMap(this._arr[i], distance)\r\n            }\r\n\r\n\r\n            if (keyDirInBot) {\r\n                if (oldDisabledDir !== keyDirInBot) {\r\n                    oldDisabledDir = downKey\r\n                    player.toggleCanMove('up', true)\r\n                    player.toggleCanMove('down', true)\r\n                    player.toggleCanMove(downKey, false)\r\n                }\r\n            } else {\r\n                if (oldDisabledDir) {\r\n                    player.toggleCanMove('up', true)\r\n                    player.toggleCanMove('down', true)\r\n                    oldDisabledDir = null\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    setArrItems (arr, funcToMap) {\r\n\r\n        this._arr = arr\r\n        this._funcToMap = funcToMap\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { LoaderAssets } from '../../_CORE/helpers/helper_LoadAssets'\r\nimport { EventEmitter } from \"../../_CORE/helpers/helper_Emitter\"\r\nimport { PreInitModules } from '../actions/PreInitModules'\r\nimport { UI } from '../../_CORE/componentsReact/UI'\r\nimport { DeviceResizer } from \"../../_CORE/helpers/helper_DeviceResizer\"\r\nimport { FrameUpdater } from \"../../_CORE/helpers/helper_FrameUpater\"\r\nimport { Helper_TweenUpdater } from \"../../_CORE/helpers/helper_TweenUpdater\"\r\nimport { Studio } from '../../_CORE/entities/createStudio'\r\nimport { KeyBoard } from \"../../_CORE/helpers/helper_KeyBoard\"\r\nimport { Player } from '../../_CORE/entities/createPlayer'\r\n\r\nimport { Helper_MaterialsLib } from '../../_CORE/helpers/helper_MaterialsLib'\r\n\r\n\r\nimport { Level } from '../systems/system_level'\r\nimport levelRoomsSrc from '../../assets/level-rooms.obj'\r\nimport mapFloorOuter from '../../assets/floor_outer_map.jpg'\r\nimport pxjpg from '../../assets/skybox/px.jpg'\r\nimport nxjpg from '../../assets/skybox/nx.jpg'\r\nimport pyjpg from '../../assets/skybox/py.jpg'\r\nimport nyjpg from '../../assets/skybox/ny.jpg'\r\nimport pzjpg from '../../assets/skybox/pz.jpg'\r\nimport nzjpg from '../../assets/skybox/nz.jpg'\r\n\r\n\r\nimport { Bots } from '../systems/system_bots'\r\nimport botMap from '../../assets/botMap.png'\r\nimport botSrc from '../../assets/botAnim2.glb'\r\nimport pxjpg2 from '../../assets/matIronBox/posx.jpg'\r\nimport nxjpg2 from '../../assets/matIronBox/negx.jpg'\r\nimport pyjpg2 from '../../assets/matIronBox/posy.jpg'\r\nimport nyjpg2 from '../../assets/matIronBox/negy.jpg'\r\nimport pzjpg2 from '../../assets/matIronBox/posz.jpg'\r\nimport nzjpg2 from '../../assets/matIronBox/negz.jpg'\r\n\r\n\r\nimport { ChangerQuadrant } from \"../store/actionByChangeQuadrant\"\r\nimport { Component_PlayerInBot } from '../components/component_playerInBot'\r\nimport { StarterPlay } from '../actions/StarterPlay'\r\nimport { EnderPlay } from '../actions/EnderPlay'\r\n\r\n\r\nexport const GAME_MODULES = [\r\n    {\r\n        key: 'emitter',\r\n        constr: EventEmitter,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'preInitModules',\r\n        constr: PreInitModules,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'ui',\r\n        constr: UI,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'deviceResizer',\r\n        constr: DeviceResizer,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'loaderAssets',\r\n        constr: LoaderAssets,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n\r\n    /////////////////////////////////////////\r\n\r\n    {\r\n        key: 'frameUpdater',\r\n        constr: FrameUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'tweenUpdater',\r\n        constr: Helper_TweenUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'studio',\r\n        constr: Studio,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'keyBoard',\r\n        constr: KeyBoard,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'player',\r\n        constr: Player,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'materialsLib',\r\n        constr: Helper_MaterialsLib,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'level',\r\n        constr: Level,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: levelRoomsSrc, key: 'level-rooms' },\r\n            { type: 'cubeTextures', path: [ pxjpg, nxjpg, pyjpg, nyjpg, pzjpg, nzjpg, ], key: 'skyBox' },\r\n            { type: 'img', path: mapFloorOuter, key: 'mapFloorOuter', wrap: true },\r\n        ],\r\n    },\r\n    {\r\n        key: 'bots',\r\n        constr: Bots,\r\n        initStateKey: 'beforeStartPlay',\r\n            assetsToLoad: [\r\n                { type: 'glb', path: botSrc, key: 'bot' },\r\n                { type: 'img', path: botMap, key: 'botMap' },\r\n                { type: 'cubeTextures', path: [  pxjpg2, nxjpg2, pyjpg2, nyjpg2, pzjpg2, nzjpg2, ], key: 'ironEnv' },\r\n            ]\r\n    },\r\n    {\r\n        key: 'changerQuadrant',\r\n        constr: ChangerQuadrant,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'playerInBot',\r\n        constr: Component_PlayerInBot,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'starterPlay',\r\n        constr: StarterPlay,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'enderPlay',\r\n        constr: EnderPlay,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n]","import { dispatcher } from \"../componentsReact/App\";\r\nimport { store } from \"../store/createStore\";\r\nimport { connectEmitterToActions } from \"../store/actions\";\r\nimport '../stylesheets/style.css'\r\nimport App from '../componentsReact/App';\r\n\r\n\r\nexport class PreInitModules {\r\n    constructor (gameContext) {\r\n        gameContext.pr = dispatcher\r\n        gameContext.store = store\r\n        gameContext.appWrapper = document.querySelector('.app-wrapper')\r\n        gameContext.App = App\r\n        connectEmitterToActions(gameContext.emitter)\r\n    }\r\n}","import { clickFullScreen } from '../../chapter03/store/actions'\r\n\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport class DeviceResizer {\r\n    constructor (gameContext) {\r\n        const { emitter, appWrapper, pr } = gameContext\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n        })\r\n\r\n        /** fullscreen */\r\n        const openAppFullScreenIfMobile = () => {\r\n            if (appWrapper.requestFullscreen) {\r\n                appWrapper.requestFullscreen()\r\n            } else if (appWrapper.mozRequestFullScreen) {\r\n                appWrapper.mozRequestFullScreen()\r\n            } else if (appWrapper.webkitRequestFullscreen) {\r\n                appWrapper.webkitRequestFullscreen()\r\n            } else if (appWrapper.msRequestFullscreen) {\r\n                appWrapper.msRequestFullscreen()\r\n            }\r\n        }\r\n\r\n        /** resize */\r\n        const resize = e => {\r\n            appWrapper.style.width = window.innerWidth + 'px'\r\n            appWrapper.style.height = window.innerHeight + 'px'\r\n            appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n            if (!document.fullscreenElement) {\r\n                emitter.emit('screenMode')('exitFullScreen')\r\n                //pr && clickFullScreen(pr.dispatch).exitFullScreen()\r\n            }\r\n\r\n        }\r\n\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n    }\r\n}\r\n","import * as R from 'ramda'\r\nimport { FRAME_UPDATE } from '../../chapter03/constants/constants_elements'\r\n\r\n\r\nexport class FrameUpdater {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const emitFrameUpdate = emitter.emit(FRAME_UPDATE)\r\n\r\n        let data = {\r\n            time: 0,\r\n            delta: 0,\r\n            count: 0,\r\n            oldTime: 0\r\n        }\r\n\r\n        const getDataFromGlobalVar = () => data\r\n\r\n        const updateTime = data => {\r\n            data.time = Date.now()\r\n            return data\r\n        }\r\n\r\n        const updateDelta = data => {\r\n            data.delta = (data.time - data.oldTime) * 0.001\r\n            if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n                data.delta = 1000/60 * 0.001;\r\n            }\r\n            return data\r\n        }\r\n\r\n        const updateCount = data => {\r\n            data.count = data.delta / (1/60)\r\n            return data\r\n        }\r\n\r\n        const emit = data => {\r\n            emitFrameUpdate(data)\r\n            return data\r\n        }\r\n\r\n        const updateOldTime = data => {\r\n            data.oldTime = data.time\r\n            return data\r\n        }\r\n\r\n        const saveDataInGlobalVar = dataFromChine => {\r\n            data = dataFromChine\r\n            return data\r\n        }\r\n\r\n        const update = R.pipe(\r\n            getDataFromGlobalVar,\r\n            updateTime,\r\n            updateDelta,\r\n            updateCount,\r\n            emit,\r\n            updateOldTime,\r\n            saveDataInGlobalVar\r\n        )\r\n\r\n        const animate = () => {\r\n            requestAnimationFrame(animate)\r\n            update(data)\r\n        }\r\n\r\n        animate()\r\n\r\n    }\r\n}","import * as TWEEN from '@tweenjs/tween.js'\r\nimport { FRAME_UPDATE } from \"../../chapter03/constants/constants_elements\";\r\n\r\nexport class Helper_TweenUpdater {\r\n    constructor (gameContext) {\r\n        gameContext['emitter'].subscribe(FRAME_UPDATE)(() => TWEEN.update())\r\n    }\r\n}","import { toggleDialog } from '../store/actions'\r\nimport { Component_PlayerNearItems } from '../../_CORE/components/component_checkPlayerNearItems'\r\n\r\n\r\nconst MAX_DIALOG_DIST_TO_BOT = 30\r\n\r\nexport class Component_PlayerInBot {\r\n    constructor(gameContext) {\r\n        const { bots, player, pr } = gameContext\r\n\r\n        const map = (bot, distance) => {\r\n            if (bot._state === 'say' && distance > MAX_DIALOG_DIST_TO_BOT) {\r\n                bot._startRotate()\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(false)\r\n            }\r\n\r\n            if (bot._state !== 'say' && distance < MAX_DIALOG_DIST_TO_BOT) {\r\n                bot.prepareToSay(player._mainObj.position)\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(true)\r\n            }\r\n        }\r\n\r\n        const checkerNearItems = new Component_PlayerNearItems(gameContext)\r\n        checkerNearItems.setArrItems(bots.arrBots, map)\r\n    }\r\n}\r\n","import { startPlay } from \"../store/actions\";\r\n\r\n\r\nexport class StarterPlay {\r\n    constructor (gameContext) {\r\n        const { player, ui, pr } = gameContext\r\n        ui.showStartButton(() => {\r\n            startPlay(pr.dispatch).startPlay()\r\n            startPlay(pr.dispatch).showBackground()\r\n            player.toggleBlocked(false)\r\n        })\r\n    }\r\n}","import {showMessages, startPlay} from \"../store/actions\";\r\nimport {FRAME_UPDATE} from \"../constants/constants_elements\";\r\n\r\n\r\nexport class EnderPlay {\r\n    constructor (gameContext) {\r\n        const { player, ui, pr, emitter } = gameContext\r\n\r\n\r\n        let oldY = player._mainObj.position.y\r\n        let countDropped = 0\r\n        let isGameComplete = false\r\n\r\n        const update = data => {\r\n            if (oldY > player._mainObj.position.y) {\r\n                ++countDropped\r\n            } else {\r\n                countDropped = 0\r\n            }\r\n            oldY = player._mainObj.position.y\r\n\r\n            if (countDropped > 800 && !isGameComplete) {\r\n                isGameComplete = true\r\n                setTimeout(() => {\r\n                    startPlay(pr.dispatch).startFinalFog()\r\n                    setTimeout(() => {\r\n                        showMessages(pr.dispatch).toggleFinalMessage(true)\r\n                    }, 6000)\r\n                }, 10000)\r\n            }\r\n        }\r\n\r\n        emitter.subscribe(FRAME_UPDATE)(update)\r\n    }\r\n}","import { pipeLineForInit } from '../_CORE/pipeLines/initPipeLine'\r\n\r\n// ********** CHAPTER03 ****************\r\n\r\nimport { GAME_MODULES } from \"./constants/constants_modules\"\r\nwindow.addEventListener('load', () => pipeLineForInit(GAME_MODULES))\r\n"],"sourceRoot":""}