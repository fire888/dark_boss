{"version":3,"sources":["_CORE/pipeLines/initPipeLine.js","chapter05/src/constants/constants_materials.js","chapter05/src/constants/constants_elements.js","_CORE/helpers/helper_LoadAssets.js","_CORE/helpers/helper_Emitter.js","_CORE/helpers/helper_FrameUpdater_02.js","_CORE/shaders/saturate.js","_CORE/shaders/saturate2.js","_CORE/entities/createStudio_02.js","_CORE/helpers/helper_KeyBoard.js","_CORE/entities/createPlayer_v02.js","_CORE/helpers/helper_MaterialsLib.js","chapter05/src/systems/systems_assets.js","assets/chapter05/level.obj","assets/chapter04/floor_outer_map3.jpg","assets/chapter05/map02.jpg","assets/chapter05/floor_outer_map.jpg","assets/chapter05/txt1.jpg","assets/chapter05/botMap.png","assets/chapter05/body_sh_map.jpg","assets/sky4/nx.jpg","assets/sky4/px.jpg","assets/sky2/px.jpg","assets/sky4/py.jpg","assets/sky4/ny.jpg","assets/sky4/pz.jpg","assets/sky4/nz.jpg","assets/sky2/nx.jpg","assets/sky2/py.jpg","assets/sky2/ny.jpg","assets/sky2/pz.jpg","assets/sky2/nz.jpg","_CORE/helpers/helper_CollisionsItems_v02.js","chapter05/src/Entities/Car.js","chapter05/src/Entities/CarCompas.js","chapter05/src/systems/system_PlayerMoveOnLevel.js","chapter05/src/systems/system_PlayerNearLevelItems.js","chapter05/src/components/checkerChangeLocationKey.js","chapter05/src/helpers/m4.js","chapter05/src/Entities/geometry/helpers.js","chapter05/src/Entities/geometry/dataColumnSide.js","chapter05/src/Entities/geometry/dataColumn.js","chapter05/src/Entities/geometry/dataColumnSimple.js","chapter05/src/Entities/geometry/dataArcHalf.js","chapter05/src/Entities/geometry/dataTopElem.js","chapter05/src/Entities/geometry/segmentStair.js","chapter05/src/Entities/geometry/dataStairSimple.js","chapter05/src/Entities/geometry/dataZone.js","chapter05/src/Entities/geometry/dataBridge.js","chapter05/src/Entities/geometry/schemeSuper.js","chapter05/src/Entities/meshSuper.js","chapter05/src/Entities/geometry/segmentGallery.js","chapter05/src/Entities/geometry/dataArc.js","chapter05/src/Entities/meshGallery.js","chapter05/src/Entities/geometry/schemeGallery.js","chapter05/src/systems/system_levelArea.js","chapter05/src/systems/system_sprites.js","chapter05/src/Entities/geometry/dataUnit.js","chapter05/src/Entities/Pers.js","chapter05/src/systems/system_worldVirtual.js","chapter05/src/systems/system_changerGallery.js","chapter05/src/actions/actions.js","chapter05/src/systems/system_worldReal.js","_CORE/helpers/helper_translate.js","_CORE/ui/containersReact/Info.js","_CORE/constants/default_voc.js","_CORE/ui/containersReact/PlayerControls.js","_CORE/ui/containersReact/App.js","_CORE/ui/store/defaultUiData.js","_CORE/ui/UI.js","_CORE/ui/store/createStore.js","chapter05/src/constants/constants_replicies.js","chapter05/src/ui/UserReplicies.js","chapter05/src/ui/BotAnswers.js","chapter05/src/ui/CustomReactComponent.js","chapter05/src/constants/const_dialogs.js","chapter05/src/ui/store.js","chapter05/src/constants/constants_modules.js","_CORE/helpers/helper_DeviceResizer.js","_CORE/helpers/helper_TweenUpdater.js","chapter05/src/systems/system_Sound.js","assets/chapter05/audio/ambient.mp3","assets/chapter05/audio/ambient_intro.mp3","assets/chapter05/audio/ambient_loop.mp3","assets/chapter05/audio/ambient_3.mp3","chapter05/src/ui/Ui.js","chapter05/src/index.js"],"names":["gameModules","CONSTANTS","a","initModulesByState","root","loaderAssets","dataToLoad","getAssetsFromModulesData","loadAssets","assets","state","modulesData","i","length","key","constr","initStateKey","arr","assetsToLoad","j","push","MATERIALS_CONF","mat","props","color","emissive","reflectivity","shininess","vertexColors","flatShading","side","THREE","map","bumpMap","bumpScale","specular","transparent","alphaMap","envMap","SIZE_QUADRANT","LOCATIONS_QUADRANTS","MATERIALS_CONFIG","CONFIG_FOR_INIT","isInCar","currentSceneConfig","isInVirtual","isPlayerInCar","carProps","keyMesh","keyCollide","position","rotation","bodyProps","lCol","lW","START_ENV_CONFIG","fogNear","fogFar","backgroundImgKey","ENV_CONFIG_WORD_1","ENV_CONFIG_WORD_2","studioConfig","canId","rendererCon","antialias","amb","strength","sceneEnvironment","composerAddPass","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","backObjPos","createLoaders","objLoader","textureLoader","gltfLoader","cubeTextureLoader","soundLoader","path","type","Promise","resolve","OBJLoader","GLTFLoader","getterLoader","load","LoaderAssets","this","resources","_load","data","iterate","index","EventEmitter","_storage","id","getOrCreateArrFromObj","forEach","action","callback","filter","item","s","console","log","obj","FrameUpdater","_subscribers","time","delta","count","oldTime","update","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","fn","Saturate","uniforms","value","vertexShader","fragmentShader","Saturate2","Studio","_root","emitter","clearColor","canvas","document","getElementById","_renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","_scene","background","fog","_lightA","add","directionalLight","set","_playerCamera","_controlsCamera","controls","OrbitControls","domElement","target","_composer","EffectComposer","_renderPass","RenderPass","addPass","ShaderPass","vec3","isPlayerView","subscribe","camera","getWorldPosition","x","y","z","resize","size","width","height","aspect","updateProjectionMatrix","addEventListener","addToScene","mesh","removeFromScene","remove","drawFrame","render","cam","conf","_changeFog","_changeBackground","startData","endData","TWEEN","to","onUpdate","start","_backgroundImgKey","KeyBoard","gameContext","keys","keysEnabled","keyUpdate","keyCode","isDown","emit","event","is","Player","studio","lightDataOne","_camera","isBlocked","isFreeze","fromArray","userData","bottomObj","frontObj","backObj","strenth","light","setCamera","val","isFeeze","createMaterials","wrapS","wrapT","mapsKeys","materials","keyMap","createLevelMeshes","items","traverse","child","geometry","name","material","wallVirtual","helper_CollisionsItems_v02","_arrMeshes","_vecStart","_vecDir","_rayCaster","objFrom","objTo","dist","sub","intersects","intersectObjects","distance","Car","_model","children","carNorm","part","testBlack","_phase","_battery","carBattery","opacity","_collision","visible","_frontObj","_backObj","_compass","setTimeout","arrow","system_Assets","src","addToParent","parent","setArrowPosition","setTargetPosition","copy","lookAt","Math","PI","changeColor","testGreen1","createCarCompas","_collisionsWalls","checkCollision","d","checkCollisions","_onChangeStateIsStay","_spd","_acc","_deceleration","_maxSpdFront","_maxSpdBack","_spdRot","_isCarStay","translateZ","abs","min","max","rotBySpeed","system_Sound","startCar","stopCar","setItemToCollision","removeItemFromCollision","quaternion","sin","system_PlayerMoveOnLevel","player","collisionsWalls","toggleBlocked","isCanMove","toggleCanMove","dir","isSoundWalk","savedPos","rotateY","isCollision","collision","object","checkAndMoveFront","checkAndMoveBack","stopWalk","isMustStartSound","translateY","checkBottomAndDropDownPlayer","startWalk","system_PlayerNearLevelItems","_itemsToCheck","distanceTo","nearPlayerIsNearPlayer","nearPlayerItemNear","nearPlayerItemKey","itemKey","nearPlayerItemFar","itemIn","generateEnvByQ","qX","qZ","getArrNotInFirst","arr1","arr2","isIn","MatType","Float32Array","subtractVectors","b","dst","normalize","v","sqrt","cross","distanceSq","dx","dy","dz","inverse","m","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","m4","cameraPosition","up","zAxis","xAxis","yAxis","addVectors","scaleVector","compose","translation","scale","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","decompose","slice","determinate","matrix","invSX","invSY","invSZ","trace","quatFromRotationMatrix","dot","identity","transpose","lengthSq","orthographic","left","right","bottom","top","frustum","perspective","fieldOfViewInRadians","f","tan","rangeInv","tx","ty","tz","translate","xRotation","angleInRadians","c","cos","yRotation","zRotation","xRotate","yRotate","zRotate","axisRotation","axis","n","oneMinusCosine","axisRotate","r00","r01","r02","r10","r11","r12","r20","r21","r22","scaling","multiply","b00","b01","b02","b03","b10","b11","b12","b13","b20","b21","b22","b23","b30","b31","b32","b33","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","transformVector","transformPoint","v0","v1","v2","transformDirection","transformNormal","mi","setDefaultType","Ctor","OldType","random","floor","ran","end","createFace","v3","v4","createUv","fillColorFace","createFaceWithSquare","color1","color2","maxW","maxH","innerW","innerH","x1","y1","v1_i","v2_i","v3_i","v4_i","vArr","cArr","fillColorFaceWithSquare","uArr","c1","c2","transformArr","r","vector","rotateArr","angle","rotateArrY","translateArr","createDataSideColumn","h0","h1","rBase","hBase","hBaseToTrunk","hCapital","rCapital","hTrunkToCapital","rTrunk","_h0","_h1","base","colorBase","uv1","base1","colorBase1","uv1_1","baseToTrunk","colorBaseToTrunk","uvBT","h","h2","arrDividers","leftH","currentH","h01","h02","h03","h04","fullH","vert","col","uv","createTrunk","uvT","trunkToCapital","capital","uvC","frontVert","frontColors","frontUV","CAR_COLL","createDataColumn","capTop","capBottom","leftVert","rightVert","backVert","u","wL","collisionCar","createSimpleColumn","isColumn","vertColumn","colorsColumn","uvColumn","hC","hPI","colorB","createTopElem","isTopElem","vertTopElem","colorsTopElem","uvTopElem","hl1","hl2","hl3","hl4","hl5","hl6","nextI","angle1","angle2","_h2","_r1","_r2","sA1","cA1","sA2","cA2","lW3","lW2","createSegmentStair","bridgeL","bridgeMinusH","hColumn","rColumn","hh","hCol","stair","uvBr","uvCl","createDataStairSimple","column","simpleColumn","halfArcData","hArc","arcL","arcStep","phase0","phase1","createDataArcHalf","isTop","topElemData","P_3","P_6","P_7","P_8","P_9","SH_BY_DIR","createDataZone","xCenter","zCenter","coord","createDataBridge","centerBridgeX","centerBridgeZ","lenBridge","savedSeg","currentSeg","zSegS","zSegE","columnL","columnR","topElemL","topElemR","createSet","hStart","hEnd","stepH","offset","scheme","p","D","C","OFFSET","createMeshSuper","currentDir","nextDir","nextXCenter","nextZCenter","setStair","createSchemeSuper","vertP","colorsP","uvTopP","coll","collisionCarA","vertices","colors","setAttribute","computeVertexNormals","wallVirtualColor","collGeom","collMat","meshCollision","verticesCar","geometryCollCar","lastXYZ","meshCollisionCar","meshFinish","createSegmentGallery","arc","arcData","rCap","wCol","lBridge","zArc","columnF","colorFill2","colorFill1","columnB","cA","uvA","resolution","step","diff","offsetArcTop","hI1","hI2","tZ","cap","createDataSideArc","columnData","createMeshGallery","arrV","arrC","arrUV","carColl","offsetStart","numFromCenter","isAddNext","num","savedL","createScheme","verticesColl","geometryColl","testRed","verticesCollCar","createLevelArea","car","arrTrash","managerBuilds","inScene","getItem","setFlagAsFree","createManagerBuilds","floorGeom","floorMat","repeat","addItems","split","keyLocation","addItemToPlayerCollision","rCount","buildingData","setCollisionForDraw","updateAreas","removeArr","addArr","arrToRemove","removeItemFromPlayerCollision","removeCollisionForDraw","dispose","removeItems","createArea","removeAll","createS","testGreen","PI2","createDataUnit","params","hhh","hD","hhD","cone","wt","wtr","htr","rInner","tt","bot","bb","ph1","t","ph2","phP","createG","c1WW","c3WW","c1W","c3W","c6W","c1R","c3R","c1B","c3B","c6B","c1B2","c3B2","c1B3","c3B3","bN","tN","k","mKey","rh","createSystemWorldVirtual","carX","carZ","checkerChangeLocation","SIZE","keyX","keyZ","oldKey","currentEnv","checkChanged","newKey","saveOldKey","oldEnv","addedQs","removedQs","newEnv","getCurrent","loc","createCheckerChangeLocationKey","changerGalleries","system_Level","createSuper","superP","removeLocationFromScene","removeItemFromCheck","addLocationToScene","unit","setItemToCheck","createChangerGalleries","changerLevelArea","systemSprites","carModel","getModel","ob","vecObPos","arrSprites","createSustemSprites","dataUnit1","dataUnit2","dataUnit3","dataUnit4","star","s1","s2","s3","s4","phase","phaseMesh","mode","starQSaved","q0","isRotate","attributes","array","needsUpdate","slerpQuaternions","prepareDialog","exitDialog","createMeshUnit","isEnabled","addWorld","currentQuadrantKey","removeWorld","l","strArr","locationX","locationZ","actions","_isInRealWord","_isExitFromVirt","_nextLocation","_finalCountDown","dispatcher","frameUpdater","dispatch","currentChapterIndex","onChangeCarStateMove","e","includes","keyPerson","_worldReal","groundStart","floorMat1","body","bodyShadow","body_sh","createWorldReal","_worldVirtual","on","_checkEndPlay","_startPlay","toggleFreeze","getCamera","toggleMat","changeEnvironment","updateAmb","getPosition","q","getQuaternion","setToPos","setRotationFromQuaternion","keyXZ","ui","carMesh","getCollision","showStartButton","playAmbient","updateBattary","_endPlay","batteryLight","lang","createTranslater","vocab","word","connect","infoPanelData","className","onClick","title","topText","chapters","href","text","bottomText","afterWords","aText","isInfo","isShowControls","isShowControlSound","isMute","useState","isShowFullScreenButt","changeShowFullScreenButt","useEffect","onMouseUp","onTouchEnd","onMouseDown","onTouchStart","CustomReactComponent","startDefaultStoreData","loader","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","style","marginLeft","UI","store","customStore","rootReducer","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","createStore","applyMiddleware","thunk","prepareStore","ReactDOM","startButtons","progressWrapper","hideStartScreen","dataset","display","TRANSLATE_WORLDS","CORE","UserReplicies","userReplicies","phrase","BotAnswers","botAnswers","isButtonDialog","isShowFinalMessage","isShowPalleteDialog","isShowButtonDrawCar","valButtonDrawCar","isShowButtonToggleOpenLocationsList","isLocationListOpened","currentLocationOfList","locationsList","RESULT_DIALOGS","uiState","currentLocation","phrasesData","location01","isComplete","phraseIndex","phrases","location02","location03","GAME_MODULES","appWrapper","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fontSize","fullscreenElement","levelRoomsSrc","nxjpg","px2jpg","nx2jpg","py2jpg","ny2jpg","pz2jpg","nz2jpg","mapFloorOuter","wrap","mapTop","mapVirt2","mapTxt","mapBody","mapBodyShadow","listener","_sound","setBuffer","soundAmbient","setLoop","setVolume","_soundCarStart","carStart","_soundCar","carLoop","_w","unitStep","_isMuted","isPlaying","stop","play","_timer","clearTimeout","newLocation","nextPhraseIndex","location","clickMachineDraw","clickMachineExit","changeTargetLocation","createCustomStore","pipeLineForInit"],"mappings":"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","file":"static/js/main.2330749b.chunk.js","sourcesContent":["export async function pipeLineForInit (gameModules, CONSTANTS) {\r\n    const root = { CONSTANTS }\r\n\r\n    initModulesByState('pageLoaded', gameModules, root)\r\n\r\n    const { loaderAssets } = root\r\n\r\n    const dataToLoad = getAssetsFromModulesData(gameModules)\r\n    root.assets = await loaderAssets.loadAssets(dataToLoad)\r\n\r\n    initModulesByState('beforeStartPlay', gameModules, root)\r\n}\r\n\r\n\r\nconst initModulesByState = (state, modulesData, root) => {\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        const {  key, constr, initStateKey } = modulesData[i]\r\n        initStateKey === state && (root[key] = new constr(root))\r\n    }\r\n}\r\n\r\nconst getAssetsFromModulesData = modulesData => {\r\n    const arr = []\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        if (modulesData[i].assetsToLoad && modulesData[i].assetsToLoad.length) {\r\n            for (let j = 0; j < modulesData[i].assetsToLoad.length; ++j) {\r\n                arr.push(modulesData[i].assetsToLoad[j])\r\n            }\r\n        }\r\n    }\r\n    return arr\r\n}","import * as THREE from \"three\";\r\n\r\nexport const MATERIALS_CONF = {\r\n    'unit': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x000000,\r\n            reflectivity: 5,\r\n            shininess: 5,\r\n            vertexColors: true,\r\n            flatShading: false,\r\n            side: THREE.DoubleSide,\r\n        },\r\n    },\r\n    'wallVirtual': {\r\n        mat: 'MeshStandardMaterial',\r\n        props: {\r\n            color: 0xff00ff,\r\n            emissive: 0x000000,\r\n        },\r\n    },\r\n    'wallVirtualColor': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x001111,\r\n            map: 'mapParams',\r\n            bumpMap: 'mapParams',\r\n            bumpScale: .1,\r\n            specular: 0x0000ff,\r\n            vertexColors: true,\r\n        },\r\n    },\r\n    'body': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xaaaaff,\r\n            emissive: 0x000000,\r\n            map: 'mapBody',\r\n            bumpMap: 'mapBody',\r\n            bumpScale: .1,\r\n            reflectivity: .005,\r\n            shininess: .005,\r\n            specular: 0xffffff,\r\n        },\r\n    },\r\n    'body_sh': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x000000,\r\n            emissive: 0x000000,\r\n            transparent: true,\r\n            alphaMap: 'mapBodySh',\r\n        },\r\n    },\r\n    'floorMat1': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xff77ff,\r\n            map: 'mapTop',\r\n            bumpMap: 'mapTop',\r\n            bumpScale: 3,\r\n            envMap: 'skyBox2',\r\n            reflectivity: .01,\r\n            shininess: .01,\r\n            specular: 0xffffff,\r\n        },\r\n    },\r\n    'floorMat': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x00ff00,\r\n            map: 'mapVirtual2',\r\n            bumpMap: 'mapVirtual2',\r\n            bumpScale: 3,\r\n        },\r\n    },\r\n    'testWhite': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0xffff55,\r\n        },\r\n    },\r\n    'testRed': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0xff0000,\r\n        },\r\n    },\r\n    'carNorm': {\r\n        mat: 'MeshStandardMaterial',\r\n        props: {\r\n            color: 0xaa00aa,\r\n        },\r\n    },\r\n    'carBattery': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0xaa0000,\r\n            transparent: true,\r\n        },\r\n    },\r\n    'testGreen': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0x00aa00,\r\n        },\r\n    },\r\n    'testGreen1': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0x009900,\r\n        },\r\n    },\r\n    'testBlack': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0x000000,\r\n            side: THREE.DoubleSide,\r\n        },\r\n    },\r\n}","import { MATERIALS_CONF } from \"./constants_materials\";\r\n\r\nexport const SIZE_QUADRANT = 5000\r\nexport const LOCATIONS_QUADRANTS = {\r\n    //'-4_-1': 'location01',\r\n    '3_-3': 'location01',\r\n    '-3_-3': 'location02',\r\n    '3_3': 'location03',\r\n    '100_1000': 'locationToFinish',\r\n}\r\n\r\n\r\n\r\n\r\nexport const MATERIALS_CONFIG = MATERIALS_CONF\r\n\r\n\r\n\r\nexport const CONFIG_FOR_INIT = {\r\n    isInCar: false,\r\n    currentSceneConfig: {\r\n        isInVirtual: false,\r\n        isPlayerInCar: false,\r\n        carProps: {\r\n            keyMesh: 'car',\r\n            keyCollide: 'carCollision',\r\n            position: [0, -50, -100],\r\n            rotation: [0, 2, 0],\r\n        },\r\n        bodyProps: {\r\n            keyMesh: 'body',\r\n            position: [-20, -60, -50],\r\n            rotation: [0, 2, 0],\r\n        },\r\n    },\r\n}\r\n\r\n\r\n/** geometry column */\r\nexport const lCol = [.3, 1, .3]\r\nexport const lW = .2\r\n\r\n\r\n\r\nexport const START_ENV_CONFIG = { fogNear: 0, fogFar: 0, color: 0x4a0a46, backgroundImgKey: null }\r\nexport const ENV_CONFIG_WORD_1 = { fogNear: 100, fogFar: 1500, color: 0x4a0a46, backgroundImgKey: 'skyBox2' }\r\nexport const ENV_CONFIG_WORD_2 = { fogNear: 1500, fogFar: 3000, color: 0x000000, backgroundImgKey: 'skyBox' }\r\n\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    amb: {\r\n        color: 0xffffff,\r\n        strength: 1,\r\n    },\r\n    sceneEnvironment: START_ENV_CONFIG,\r\n    composerAddPass: 'Saturate',\r\n    //composerAddPass: 'Saturate2',\r\n}\r\n\r\n\r\n\r\n\r\nexport const playerConfig = {\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 10.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    //startPos: [0, -45, 400],\r\n    startPos: [0, -45, 150],\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 10000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    backObjPos: [0, 0, 1],\r\n    // lightDataOne: {\r\n    //     color: 0xffffff,\r\n    //     strength: .5,\r\n    //     pos: [0, 0, 0],\r\n    // },\r\n}\r\n","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\n\r\nconst createLoaders = () => {\r\n    let objLoader = null,\r\n        textureLoader = null,\r\n        gltfLoader = null,\r\n        cubeTextureLoader = null,\r\n        soundLoader = null\r\n\r\n\r\n    const getterLoader = type => {\r\n        if (type === 'obj')\r\n            return objLoader = (objLoader || new OBJLoader())\r\n        if (type === 'glb' || type === 'gltf')\r\n            return gltfLoader = (gltfLoader || new GLTFLoader())\r\n        if (type === 'img')\r\n            return textureLoader = (textureLoader || new THREE.TextureLoader())\r\n        if (type === 'cubeTextures') {\r\n            return cubeTextureLoader = (cubeTextureLoader || new THREE.CubeTextureLoader())\r\n        }\r\n        if (type === 'soundMp3') {\r\n            return soundLoader = (soundLoader || new THREE.AudioLoader())\r\n        }\r\n\r\n    }\r\n\r\n    return (path, type) => new Promise(resolve => {\r\n        getterLoader(type).load(path, resolve)\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\nexport class LoaderAssets {\r\n\r\n    constructor () {\r\n        this.resources = {}\r\n        this._load = createLoaders()\r\n    }\r\n\r\n    loadAssets (data) {\r\n        return new Promise(resolve => {\r\n\r\n            const load = this._load\r\n            const resources = this.resources\r\n\r\n            async function iterate (index) {\r\n                if (data[index]) {\r\n                    const { key, path, type } = data[index]\r\n                    resources[key] = await load(path, type)\r\n                }\r\n\r\n                ++index\r\n                !data[index]\r\n                    ? resolve(resources)\r\n                    : await iterate(index)\r\n            }\r\n\r\n           void iterate(0)\r\n        })\r\n    }\r\n}\r\n","export class EventEmitter {\r\n    constructor() {\r\n        this._storage = {}\r\n    }\r\n\r\n    emit (id) {\r\n        return data => getOrCreateArrFromObj(this._storage)(id).forEach(action => action(data))\r\n    }\r\n\r\n    subscribe (id) {\r\n        return callback => {\r\n            getOrCreateArrFromObj(this._storage)(id).push(callback)\r\n            return () => this._storage[id] = this._storage[id].filter(item => item !== callback)\r\n        }\r\n    }\r\n\r\n    showAll () {\r\n        const s = {}\r\n        for (let key in this._storage) {\r\n            s[key] = this._storage[key].length\r\n        }\r\n        console.log(s)\r\n    }\r\n}\r\n\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import * as R from 'ramda'\r\n\r\n\r\nexport class FrameUpdater {\r\n    constructor () {\r\n        this._subscribers = []\r\n\r\n\r\n        let data = {\r\n            time: 0,\r\n            delta: 0,\r\n            count: 0,\r\n            oldTime: 0\r\n        }\r\n\r\n        const getDataFromGlobalVar = () => data\r\n\r\n        const updateTime = data => {\r\n            data.time = Date.now()\r\n            return data\r\n        }\r\n\r\n        const updateDelta = data => {\r\n            data.delta = (data.time - data.oldTime) * 0.001\r\n            if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n                data.delta = 1000 / 60 * 0.001\r\n            }\r\n            return data\r\n        }\r\n\r\n        const updateCount = data => {\r\n            data.count = data.delta / (1/60)\r\n            return data\r\n        }\r\n\r\n        // const emit = data => {\r\n        //     emitFrameUpdate(data)\r\n        //     return data\r\n        // }\r\n\r\n        const updateOldTime = data => {\r\n            data.oldTime = data.time\r\n            return data\r\n        }\r\n\r\n        const saveDataInGlobalVar = dataFromChine => {\r\n            data = dataFromChine\r\n            return data\r\n        }\r\n\r\n        const updateSubscribers = data => {\r\n            for (let i = 0; i < this._subscribers.length; ++i) {\r\n                this._subscribers[i]({...data })\r\n            }\r\n            return data;\r\n        }\r\n\r\n        const update = R.pipe(\r\n            getDataFromGlobalVar,\r\n            updateTime,\r\n            updateDelta,\r\n            updateCount,\r\n            updateSubscribers,\r\n            updateOldTime,\r\n            saveDataInGlobalVar\r\n        )\r\n\r\n        const animate = () => {\r\n            requestAnimationFrame(animate)\r\n            update(data)\r\n        }\r\n        animate()\r\n    }\r\n\r\n    on (fn) {\r\n        this._subscribers.push(fn)\r\n        return () => {\r\n            this._subscribers = this._subscribers.filter(item => item !== fn)\r\n        }\r\n    }\r\n}","export const Saturate = {\r\nuniforms: {\r\n\"tDiffuse\": { value: null },\r\n},\r\n\r\n\r\nvertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\nfragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n}`,\r\n}\r\n","export const Saturate2 = {\r\n    uniforms: {\r\n        \"tDiffuse\": { value: null },\r\n    },\r\n\r\n\r\n    vertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\n    fragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel + texel * 1.5) * vec4(0.5);\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\nimport { Saturate2 } from '../shaders/saturate2'\r\n\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\n\r\n\r\n\r\nexport class Studio {\r\n    constructor(root) {\r\n        this._root = root\r\n        const { assets, emitter, } = root\r\n        const { canId, rendererCon, clearColor, amb } = root.CONSTANTS.studioConfig\r\n\r\n        rendererCon.canvas = document.getElementById(canId)\r\n\r\n        this._renderer = new THREE.WebGLRenderer(rendererCon)\r\n        //this._renderer.setClearColor(clearColor)\r\n        this._renderer.setClearColor(0x000000)\r\n        this._renderer.setPixelRatio(window.devicePixelRatio)\r\n        this._renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        this._scene = new THREE.Scene()\r\n\r\n        {\r\n             const { color, fogNear, fogFar, backgroundImgKey } = root.CONSTANTS.studioConfig.sceneEnvironment\r\n             this._scene.background = assets[backgroundImgKey] || null\r\n             this._scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n        }\r\n\r\n\r\n        // this._lightA = null\r\n        {\r\n            const { color, strength } = amb\r\n            this._lightA = new THREE.AmbientLight(0xffffff, .2)\r\n            this._scene.add( this._lightA )\r\n        }\r\n        {\r\n            const directionalLight = new THREE.DirectionalLight(0xffffff, .6);\r\n            directionalLight.position.set(1, 1, .5)\r\n            this._scene.add(directionalLight);\r\n        }\r\n        {\r\n            const directionalLight = new THREE.DirectionalLight(0xffffff, .4);\r\n            directionalLight.position.set(-1, -.1, -.4)\r\n            this._scene.add(directionalLight);\r\n        }\r\n\r\n\r\n        this._playerCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n\r\n\r\n        this._controlsCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n        this._controlsCamera.position.set(0, 0, 20)\r\n        const controls = new OrbitControls(this._controlsCamera, this._renderer.domElement)\r\n        controls.target.set(0, 0, 0)\r\n        controls.update();\r\n\r\n\r\n        this._composer = new EffectComposer(this._renderer)\r\n        this._renderPass = new RenderPass(this._scene, this._controlsCamera)\r\n        this._composer.addPass(this._renderPass)\r\n        if (this._root.CONSTANTS.studioConfig.composerAddPass) {\r\n            if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate') {\r\n                this._composer.addPass(new ShaderPass(Saturate))\r\n            }\r\n            if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate2') {\r\n                this._composer.addPass(new ShaderPass(Saturate2))\r\n            }\r\n        }\r\n\r\n\r\n\r\n        /** toggle view camera to debug by orbitControls */\r\n        const vec3 = new THREE.Vector3()\r\n        let isPlayerView = true\r\n        let saveFogData = null\r\n        emitter.subscribe('keyEvent')(data => {\r\n            if (!data['o']) {\r\n                return;\r\n            }\r\n\r\n            if (isPlayerView) {\r\n//                saveFogData = { ...this._scene.fog }\r\n                // this._scene.fog.near = 1000\r\n                // this._scene.fog.far = 2000\r\n                isPlayerView = false\r\n                this._renderPass.camera = this._controlsCamera\r\n                this._playerCamera.getWorldPosition(vec3)\r\n                this._controlsCamera.position.x = vec3.x + 100\r\n                this._controlsCamera.position.y = vec3.y + 100\r\n                this._controlsCamera.position.z = vec3.z\r\n                controls.target.set(vec3.x, vec3.y, vec3.z)\r\n                controls.update()\r\n            } else {\r\n                // this._scene.fog.near = saveFogData.near\r\n                // this._scene.fog.far = saveFogData.far\r\n                isPlayerView = true\r\n                this._renderPass.camera = this._playerCamera\r\n            }\r\n        })\r\n\r\n\r\n\r\n        const resize = () => {\r\n            const size = { width: window.innerWidth, height: window.innerHeight }\r\n            this._renderer.setSize(size.width, size.height)\r\n            this._composer.setSize(size.width, size.height)\r\n            if (this._controlsCamera) {\r\n                this._controlsCamera.aspect = size.width / size.height\r\n                this._controlsCamera.updateProjectionMatrix()\r\n            }\r\n            if (this._playerCamera) {\r\n                this._playerCamera.aspect = size.width/size.height\r\n                this._playerCamera.updateProjectionMatrix()\r\n            }\r\n        }\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n\r\n\r\n\r\n\r\n        this.addToScene = mesh => this._scene.add(mesh)\r\n        this.removeFromScene = mesh => this._scene.remove(mesh)\r\n\r\n\r\n\r\n        this.drawFrame = () => {\r\n            this._composer.render(this._scene, this._controlsCamera)\r\n        }\r\n\r\n\r\n        //this._backgroundImgKey = root.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey\r\n        emitter.subscribe('changeSceneEnvironment')(sceneEnvironment => {\r\n            console.log('deprecated!!', 'studio', 'changeSceneEnvironment', sceneEnvironment)\r\n        })\r\n    }\r\n\r\n\r\n    /** PUBLIC ****************************************/\r\n\r\n    setCamera (cam) {\r\n        cam.aspect = window.innerWidth / window.innerHeight\r\n        cam.updateProjectionMatrix()\r\n        this._playerCamera = cam\r\n        this._renderPass.camera = this._playerCamera\r\n    }\r\n\r\n\r\n    changeEnvironment (sceneEnvironment, conf = null) {\r\n        this._changeFog(sceneEnvironment, conf)\r\n        this._changeBackground(sceneEnvironment, conf)\r\n    }\r\n\r\n\r\n    /** INTERNAL ****************************************/\r\n\r\n    _changeFog (sceneEnvironment, conf) {\r\n        const { fogNear, fogFar, color } = sceneEnvironment\r\n        if (\r\n             this._scene.fog.near !== fogNear ||\r\n             this._scene.fog.far !== fogFar ||\r\n             this._scene.fog.color !== fogFar\r\n        ) {\r\n             const startData = {\r\n                 color: this._scene.fog.color,\r\n                 near: this._scene.fog.near,\r\n                 far: this._scene.fog.far,\r\n             }\r\n             const endData = {\r\n                 color: new THREE.Color(color),\r\n                 near: fogNear,\r\n                 far: fogFar,\r\n             }\r\n\r\n             new TWEEN.Tween(startData)\r\n                 .to(endData, (conf && conf.time) || 3000)\r\n                 .onUpdate(() => {\r\n                    this._scene.fog.color = startData.color\r\n                    this._scene.fog.near = startData.near\r\n                    this._scene.fog.far = startData.far\r\n                    if (conf) {\r\n                    //                 if (conf.updateAmb) this._lightA.color = startData.color\r\n                    } else {\r\n                    //                 this._lightA.color = startData.color\r\n                    }\r\n                    this._renderer.setClearColor(startData.color)\r\n                 })\r\n                 .start()\r\n        }\r\n\r\n    }\r\n\r\n\r\n    _changeBackground (sceneEnvironment) {\r\n        const { backgroundImgKey } = sceneEnvironment\r\n\r\n        if (backgroundImgKey !== this._backgroundImgKey) {\r\n            this._backgroundImgKey = backgroundImgKey\r\n            this._scene.background = this._root.assets[backgroundImgKey] || null\r\n        }\r\n    }\r\n}\r\n\r\n","\r\nexport class KeyBoard {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const keys = {\r\n            'up': false,\r\n            'down': false,\r\n            'left': false,\r\n            'right': false,\r\n            'p': false,\r\n        }\r\n\r\n        const keysEnabled = {\r\n            'up': true,\r\n            'down': true,\r\n            'left': true,\r\n            'right': true,\r\n        }\r\n\r\n        this.keysEnabled = keysEnabled\r\n        this.keys = keys\r\n\r\n\r\n        const keyUpdate = function ( keyCode, isDown ) {\r\n            switch( keyCode ) {\r\n                case 38:\r\n                case 87:\r\n                    keysEnabled['up'] && (keys['up'] = isDown)\r\n                    break;\r\n                case 40:\r\n                case 83:\r\n                    keysEnabled['down'] && (keys['down'] = isDown)\r\n                    break;\r\n                case 37:\r\n                case 65:\r\n                    keys['left'] = isDown\r\n                    break;\r\n                case 39:\r\n                case 68:\r\n                    keys['right'] = isDown\r\n                    break;\r\n                case 79: \r\n                    keys['o'] = isDown\r\n                    break;                \r\n                case 80: \r\n                    keys['p'] = isDown\r\n                    break;\r\n                default:\r\n            }\r\n            emitter.emit('keyEvent')(keys)\r\n        }\r\n\r\n\r\n\r\n        document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n        document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, true)\r\n            if (key === 'butt-right') keyUpdate(39, true)\r\n            if (key === 'butt-front') keyUpdate(38, true)\r\n            if (key === 'butt-back') keyUpdate(40, true)\r\n        })\r\n        emitter.subscribe('mouseUp')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, false)\r\n            if (key === 'butt-right') keyUpdate(39, false)\r\n            if (key === 'butt-front') keyUpdate(38, false)\r\n            if (key === 'butt-back') keyUpdate(40, false)\r\n        })\r\n    }\r\n\r\n    toggleEnableKeys (key, is) {\r\n        this.keysEnabled[key] = is\r\n        !is && (this.keys[key] = false)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\nexport class Player {\r\n    constructor (root) {\r\n        const { studio, CONSTANTS } = root\r\n\r\n        const {\r\n            //startPos,\r\n            //startRot,\r\n            cameraData,\r\n            //frontObjPos,\r\n            //backObjPos,\r\n            lightDataOne,\r\n        } = CONSTANTS.playerConfig\r\n\r\n\r\n        this._camera = null\r\n        this.isBlocked = true\r\n        this.isFreeze = true\r\n        \r\n        this.mesh = new THREE.Object3D()\r\n        this.mesh.rotation.fromArray([0, 0, 0])\r\n        this.mesh.userData.type = 'player'\r\n\r\n\r\n        this.bottomObj = new THREE.Object3D()\r\n        this.bottomObj.position.fromArray([0, -.02, 0])\r\n        this.mesh.add(this.bottomObj)\r\n\r\n        this.frontObj = new THREE.Object3D()\r\n        this.frontObj.position.fromArray([0, 0, -.02])\r\n        this.mesh.add(this.frontObj)\r\n\r\n        this.backObj = new THREE.Object3D()\r\n        this.backObj.position.fromArray([0, 0, 0.02])\r\n        this.mesh.add(this.backObj)\r\n\r\n\r\n        {\r\n            const { fov, ratio, near, far } = cameraData\r\n            this._camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n            this._camera.position.fromArray([0, 0, -2])\r\n            this.mesh.add(this._camera)\r\n        }\r\n\r\n        if (lightDataOne) {\r\n            const { color, strenth, pos } = lightDataOne\r\n            const light = new THREE.PointLight(color, strenth)\r\n            light.position.fromArray(pos)\r\n            this.mesh.add(light)\r\n        }\r\n\r\n        ///////////// TEST /////////////\r\n\r\n        studio.setCamera(this._camera)\r\n        studio.addToScene(this.mesh)\r\n    }\r\n\r\n    // toggleBlocked (val) {\r\n    //     this.isFeeze = val\r\n    // }\r\n\r\n    toggleFeeze (val) {\r\n        this.isFeeze = val\r\n    }\r\n\r\n    toggleCanMove(key, val) {\r\n        //this._isCanMove[key] = val\r\n    }\r\n\r\n    getObj () {\r\n        return this.mesh\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n    \r\n    setToPos (x, y, z) {\r\n        this.mesh.position.set(x, y, z)\r\n    }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class Helper_MaterialsLib {\r\n    constructor (gameContext) {\r\n        const { assets, CONSTANTS } = gameContext\r\n\r\n        gameContext.materials = createMaterials(assets, CONSTANTS.MATERIALS_CONFIG)\r\n    }\r\n}\r\n\r\n\r\nconst createMaterials = (assets, MATERIALS_CONFIG) => {\r\n    for (let key in assets)\r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap', 'alphaMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}","export class SystemAssets {\r\n    constructor (root) {\r\n        this._root = root\r\n\r\n        const {\r\n            assets,\r\n            materials,\r\n        } = root\r\n\r\n        this.items = createLevelMeshes(assets, materials)\r\n        console.log(this.items)\r\n    }\r\n\r\n}\r\n\r\nconst createLevelMeshes = (assets, materials) => {\r\n    const items = {}\r\n\r\n    assets['level-rooms'].traverse(child => {\r\n        if (child.geometry) {\r\n            items[child.name] = child\r\n            child.material = materials.wallVirtual\r\n        }\r\n    })\r\n\r\n    return items\r\n}","export default __webpack_public_path__ + \"static/media/level.0d2a124d.obj\";","export default __webpack_public_path__ + \"static/media/floor_outer_map3.558e9646.jpg\";","export default __webpack_public_path__ + \"static/media/map02.10921dbe.jpg\";","export default __webpack_public_path__ + \"static/media/floor_outer_map.bb8fd979.jpg\";","export default __webpack_public_path__ + \"static/media/txt1.b67888d5.jpg\";","export default __webpack_public_path__ + \"static/media/botMap.55359807.png\";","export default __webpack_public_path__ + \"static/media/body_sh_map.01a83337.jpg\";","export default __webpack_public_path__ + \"static/media/nx.a038c501.jpg\";","export default __webpack_public_path__ + \"static/media/px.8a9030e7.jpg\";","export default __webpack_public_path__ + \"static/media/px.96d0b65f.jpg\";","export default __webpack_public_path__ + \"static/media/py.ed7a276e.jpg\";","export default __webpack_public_path__ + \"static/media/ny.75a01d7a.jpg\";","export default __webpack_public_path__ + \"static/media/pz.3cf6bf7f.jpg\";","export default __webpack_public_path__ + \"static/media/nz.c24a9aad.jpg\";","export default __webpack_public_path__ + \"static/media/nx.8cbf039d.jpg\";","export default __webpack_public_path__ + \"static/media/py.659ebc34.jpg\";","export default __webpack_public_path__ + \"static/media/ny.09051a4e.jpg\";","export default __webpack_public_path__ + \"static/media/pz.a1539724.jpg\";","export default __webpack_public_path__ + \"static/media/nz.0bc769f7.jpg\";","import * as THREE from \"three\";\r\n\r\n\r\nexport class helper_CollisionsItems_v02 {\r\n    constructor () {\r\n        this._arrMeshes = []\r\n\r\n\r\n        this._vecStart = new THREE.Vector3()\r\n        this._vecDir = new THREE.Vector3()\r\n        this._rayCaster = new THREE.Raycaster(this._vecStart, this._vecDir)\r\n    }\r\n\r\n    setItemToCollision (mesh) {\r\n        for (let i = 0; i < this._arrMeshes.length; ++i) {\r\n            if (this._arrMeshes[i] === mesh) {\r\n                return;\r\n            }\r\n        }\r\n        this._arrMeshes.push(mesh)\r\n    }\r\n\r\n\r\n    removeItemFromCollision (mesh) {\r\n        this._arrMeshes = this._arrMeshes.filter(item => item !== mesh)\r\n    }\r\n\r\n\r\n    checkCollisions (objFrom, objTo, dist) {\r\n        objFrom.getWorldPosition(this._vecStart)\r\n        objTo.getWorldPosition(this._vecDir)\r\n\r\n        this._vecDir.sub(this._vecStart)\r\n\r\n        //console.log(this._arrMeshes)\r\n        const intersects = this._rayCaster.intersectObjects(this._arrMeshes)\r\n\r\n        if (intersects[0] && intersects[0].distance < dist) {\r\n            return [ true, intersects[0] ]\r\n        }\r\n        return [ false, null ]\r\n    }\r\n}","import * as THREE from \"three\";\r\nimport { helper_CollisionsItems_v02 } from '../../../_CORE/helpers/helper_CollisionsItems_v02'\r\nimport { createCarCompas } from './CarCompas'\r\n\r\nexport class Car {\r\n    constructor (root) {\r\n        const {\r\n            assets,\r\n            emitter,\r\n            materials,\r\n        } = root\r\n        this._root = root\r\n\r\n\r\n        this._model = assets['level-rooms'].children.filter(item => item.name === 'CAR_102G')[0]\r\n        this._model.material = materials.carNorm\r\n\r\n        const part = assets['level-rooms'].children.filter(item => item.name === 'CAR_102')[0]\r\n        part.material = materials.testBlack\r\n        this._model.add(part)\r\n\r\n        this._phase = 0\r\n        this._battery = assets['level-rooms'].children.filter(item => item.name === 'battary')[0]\r\n\r\n        this._battery.material = materials.carBattery\r\n        this._battery.material.opacity = 0\r\n        this._model.add(this._battery)\r\n\r\n        this._camera = new THREE.PerspectiveCamera(80, window.innerWidth/window.innerHeight, .5, 100000)\r\n        this._camera.position.y = 15\r\n        this._model.add(this._camera)\r\n\r\n\r\n        this._collision = assets['level-rooms'].children.filter(item => item.name === 'CAR_104')[0]\r\n        this._collision.visible = false\r\n\r\n        this._model.add(this._collision)\r\n\r\n        this._frontObj = new THREE.Object3D()\r\n        this._frontObj.position.set(0, 0, -.5)\r\n        this._model.add(this._frontObj)\r\n\r\n        this._backObj = new THREE.Object3D()\r\n        this._backObj.position.set(0, 0, .5)\r\n        this._model.add(this._backObj)\r\n\r\n\r\n        this._compass = null\r\n        setTimeout(() => {\r\n            this._compass = createCarCompas(root)\r\n            this._compass.addToParent(this._model)\r\n            this._compass.setArrowPosition(0, 4.3, -26)\r\n            this.setTargetPosition = (val) => {\r\n                this._compass.setTargetPosition(val)\r\n                this._compass.update()\r\n            }\r\n        }) \r\n\r\n\r\n\r\n\r\n        this._collisionsWalls = new helper_CollisionsItems_v02()\r\n        const checkCollision = (obj, d) => {\r\n            const [is] = this._collisionsWalls.checkCollisions(this._model, obj, d)\r\n            return is;\r\n        }\r\n\r\n\r\n        this.isFreeze = true\r\n\r\n        let keys = {}\r\n\r\n        this._onChangeStateIsStay = () => {}\r\n\r\n\r\n        this._spd = 0\r\n        this._acc = 0.1\r\n        this._deceleration = 0.02\r\n        this._maxSpdFront = -10\r\n        //this._maxSpdBack = 1\r\n        this._maxSpdBack = 10\r\n        this._spdRot = 0.03\r\n\r\n        this._isCarStay = true\r\n\r\n\r\n        this.update = data => {\r\n            if (this.isFreeze) {\r\n                return;\r\n            }\r\n\r\n            /** move car *************/\r\n            if (this._spd < 0) {\r\n                if (!checkCollision(this._frontObj, 30)) {\r\n                    this._model.translateZ(this._spd * data.count)\r\n                    this._compass.update()\r\n                } else {\r\n                    this._spd = 0\r\n                }\r\n            }\r\n            if (this._spd > 0) {\r\n                if (!checkCollision(this._backObj, 30)) {\r\n                    this._model.translateZ(this._spd * data.count)\r\n                    this._compass.update()\r\n                } else {\r\n                    this._spd = 0\r\n                }\r\n            }\r\n\r\n\r\n            /** acceleration update speed *********/\r\n            if (keys['up']) {\r\n                this._spd -= this._acc\r\n            }\r\n            if (keys['down']) {\r\n                this._spd += this._acc\r\n            }\r\n\r\n\r\n            /** slowdown update speed *********/\r\n            if (Math.abs(this._spd) > 0.001) {\r\n                if (this._spd > 0) {\r\n                    this._spd -= this._deceleration\r\n                    if (this._spd < 0) {\r\n                        this._spd = 0\r\n                    }\r\n                }\r\n                if (this._spd < 0) {\r\n                    this._spd += this._deceleration\r\n                    if (this._spd > 0) {\r\n                        this._spd = 0\r\n                    }\r\n                }\r\n                this._spd = Math.min(this._maxSpdBack, Math.max(this._maxSpdFront, this._spd))\r\n\r\n                /** update car rotation ***********/\r\n                const rotBySpeed = Math.min(1, Math.max(0, Math.abs(this._spd)))\r\n                if (keys['left']) {\r\n                    if (this._spd < 0) {\r\n                        this._model.rotation.y += (this._spdRot * rotBySpeed)\r\n                    }\r\n                    if (this._spd > 0) {\r\n                        this._model.rotation.y -= (this._spdRot * rotBySpeed)\r\n                    }\r\n\r\n                }\r\n                if (keys['right']) {\r\n                    if (this._spd < 0) {\r\n                        this._model.rotation.y -= (this._spdRot * rotBySpeed)\r\n                    }\r\n                    if (this._spd > 0) {\r\n                        this._model.rotation.y += (this._spdRot * rotBySpeed)\r\n                    }\r\n                }\r\n            } else {\r\n                this._spd = 0\r\n            }\r\n\r\n            /** callback change state stay or move *****/\r\n            if (this._isCarStay && this._spd !== 0) {\r\n                this._isCarStay = false\r\n                root.system_Sound.startCar()\r\n                this._onChangeStateIsStay('carStart')\r\n            }\r\n            if (!this._isCarStay && this._spd === 0) {\r\n                console.log('stop')\r\n                this._isCarStay = true\r\n                root.system_Sound.stopCar()\r\n                this._onChangeStateIsStay('carStop')\r\n            }\r\n        }\r\n        \r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        //emitter.subscribe('frameUpdate')(update)\r\n    }\r\n\r\n    setCollisionForDraw (mesh) {\r\n        this._collisionsWalls.setItemToCollision(mesh)\r\n    }\r\n\r\n    removeCollisionForDraw (mesh) {\r\n        this._collisionsWalls.removeItemFromCollision(mesh)\r\n    }\r\n\r\n    getModel () {\r\n        return this._model\r\n    }\r\n\r\n    getCollision () {\r\n        return this._collision\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n\r\n    toggleFreeze (val) {\r\n        console.log('freeze')\r\n        this.isFreeze = val\r\n    }\r\n\r\n    onChangeCarStateMove (fn) {\r\n        this._onChangeStateIsStay = fn\r\n    }\r\n\r\n    getPosition () {\r\n        return this._model.position\r\n    }\r\n\r\n    getQuaternion () {\r\n        return this._model.quaternion\r\n    }\r\n\r\n    subscribeOnMove () {\r\n\r\n    }\r\n\r\n    toggleMat (key) {\r\n        const { materials } = this._root\r\n\r\n        if (key === 'green') {\r\n            this._compass.changeColor('green')\r\n            this._model.material = materials.testGreen1\r\n        }\r\n        if (key === 'red') {\r\n            this._compass.changeColor('normal')\r\n            this._model.material = materials.carNorm\r\n        }\r\n\r\n    }\r\n\r\n    updateBattary () {\r\n        this._phase += 0.05\r\n        this._battery.material.opacity = Math.sin(this._phase) + 1\r\n    }\r\n\r\n    batteryLight () {\r\n        this._battery.material.opacity = 0\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nexport const createCarCompas = root => {\r\n    const {\r\n        assets,\r\n        studio,\r\n    } = root\r\n\r\n    const arrow = root.system_Assets.items.arrow\r\n    arrow.material = root.materials.carNorm\r\n\r\n    const target = new THREE.Object3D()\r\n    // const target = new THREE.Mesh(\r\n    //     new THREE.BoxGeometry(10, 10, 10),\r\n    //     new THREE.MeshBasicMaterial({ color: 0xff0000 })\r\n    // )\r\n    target.position.set(-500, -30, -500)\r\n    studio.addToScene(target)\r\n\r\n    const src = new THREE.Mesh(\r\n        new THREE.BoxGeometry(10, 10, 10),\r\n        new THREE.MeshBasicMaterial({ color: 0xff0000 })\r\n    )\r\n    src.position.set(0, 0, 0)\r\n    studio.addToScene(target)\r\n\r\n    const v = new THREE.Vector3()\r\n\r\n    return {\r\n        addToParent: parent => { \r\n            parent.add(arrow)\r\n        },\r\n        setArrowPosition: (x, y, z) => {\r\n            arrow.position.set(x, y, z)\r\n        },\r\n        setTargetPosition: pos => {\r\n            target.position.copy(pos)\r\n        },\r\n        update: () => {\r\n            src.position.copy(arrow.parent.position)\r\n            src.lookAt(target.position)\r\n            if (arrow.parent.position.z < target.position.z) {\r\n                arrow.rotation.y = -arrow.parent.rotation.y + src.rotation.y\r\n            }\r\n            else {\r\n                arrow.rotation.y = -arrow.parent.rotation.y - src.rotation.y + Math.PI\r\n            }\r\n        },\r\n        changeColor: key => {\r\n            if (key === 'normal') {\r\n                arrow.material = root.materials.carNorm\r\n            }\r\n            if (key === 'green') {\r\n                arrow.material = root.materials.testGreen1\r\n            }\r\n        },\r\n    }\r\n}","import { helper_CollisionsItems_v02 } from '../../../_CORE/helpers/helper_CollisionsItems_v02'\r\nimport * as THREE from 'three'\r\n\r\n\r\n\r\nexport class system_PlayerMoveOnLevel {\r\n    constructor (root) {\r\n\r\n\r\n        const { \r\n            emitter, \r\n            CONSTANTS,\r\n            player,\r\n            assets,\r\n            studio,\r\n        } = root\r\n\r\n\r\n        //player.mesh.position.fromArray([0, -40, 0])\r\n        player.mesh.position.fromArray([0, 0, 0])\r\n\r\n\r\n        const collisionsWalls = new helper_CollisionsItems_v02()\r\n\r\n        const {\r\n            speed,\r\n            speedDown,\r\n            speedRot,\r\n        } = CONSTANTS.playerConfig\r\n\r\n        let isBlocked = true\r\n        player.toggleBlocked = val => isBlocked = val\r\n\r\n        this.isCanMove = {\r\n            'forward': true,\r\n            'back': true,\r\n        }\r\n        player.toggleCanMove = (dir, val) => this.isCanMove[dir] = val\r\n\r\n\r\n        this.isFreeze = false\r\n        let keys = {}\r\n\r\n        const OFFSET_FROM_PLANES = 17\r\n        const OFFSET_FROM_PLANES_TO_DROP = 17.2\r\n\r\n\r\n\r\n\r\n\r\n\r\n        const checkBottomAndDropDownPlayer = data => {\r\n            const [isCollision, collision] = collisionsWalls.checkCollisions(player.mesh, player.bottomObj, OFFSET_FROM_PLANES_TO_DROP)\r\n\r\n            /** move player to top if on stairs */\r\n            if (isCollision && OFFSET_FROM_PLANES > collision.distance) {\r\n                player.mesh.translateY(OFFSET_FROM_PLANES - collision.distance)\r\n\r\n                return;\r\n            }\r\n\r\n\r\n            /** free down without intercepts */\r\n            if (!isCollision) {\r\n                /** if player not up - rotated to up */\r\n                player.mesh.position.y += (speedDown * data.count)\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const checkAndMoveFront = data => {\r\n            const [isCollision, collision] = collisionsWalls.checkCollisions(player.mesh, player.frontObj, OFFSET_FROM_PLANES)\r\n\r\n            /** update level new area */\r\n            if (isCollision) {\r\n                if (collision.object.userData.type && collision.object.userData.type === 'alert') {\r\n                    emitter.emit('collision')(collision.object.userData.event)\r\n                }\r\n                return;\r\n            }\r\n\r\n            player.mesh.translateZ(-speed * data.count)\r\n            emitter.emit('playerMove')('forward')\r\n        }\r\n        \r\n        \r\n\r\n        const checkAndMoveBack = data => {\r\n            const [isCollision] = collisionsWalls.checkCollisions(player.mesh, player.backObj, OFFSET_FROM_PLANES)\r\n            if (isCollision) return;\r\n                \r\n            player.mesh.translateZ(speed * data.count)\r\n            emitter.emit('playerMove')('back')\r\n        }\r\n\r\n\r\n        let isSoundWalk = false\r\n        let savedPos = new THREE.Vector3()\r\n\r\n        this.update = data => {\r\n            if (this.isFreeze) {\r\n                return;\r\n            }\r\n            //if (isButtonsDisabled) return;\r\n\r\n            keys['left'] && player.mesh.rotateY(speedRot * data.count)\r\n            keys['right'] && player.mesh.rotateY(-speedRot * data.count)\r\n\r\n            if (isBlocked) return;\r\n\r\n            \r\n            savedPos.x = player.mesh.position.x\r\n            savedPos.y = player.mesh.position.y  \r\n            savedPos.z = player.mesh.position.z        \r\n        \r\n\r\n            keys['up'] && this.isCanMove['forward'] && checkAndMoveFront(data)\r\n            keys['down'] && this.isCanMove['back'] && checkAndMoveBack(data)\r\n\r\n\r\n\r\n            if (\r\n                savedPos.x === player.mesh.position.x &&\r\n                savedPos.z === player.mesh.position.z &&\r\n                isSoundWalk\r\n            ) {\r\n                isSoundWalk = false\r\n                root.system_Sound.stopWalk()\r\n            }\r\n\r\n\r\n            let isMustStartSound = false\r\n            if (\r\n                (savedPos.x !== player.mesh.position.x || savedPos.z !== player.mesh.position.z) &&\r\n                !isSoundWalk\r\n            ) {\r\n                isMustStartSound = true\r\n            }\r\n\r\n\r\n            checkBottomAndDropDownPlayer(data)\r\n\r\n            if (savedPos.y > player.mesh.position.y) {\r\n                isSoundWalk = false\r\n                root.system_Sound.stopWalk()\r\n                isMustStartSound = false\r\n            }\r\n\r\n            if (isMustStartSound) {\r\n                isSoundWalk = true\r\n                root.system_Sound.startWalk()\r\n            }\r\n\r\n            keys['p'] && console.log(`player.mesh.position.fromArray([${player.mesh.position.x}, ${player.mesh.position.y}, ${player.mesh.position.z}])`)\r\n        }\r\n    \r\n\r\n\r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        //emitter.subscribe('frameUpdate')(update)\r\n\r\n\r\n        this._collisionsWalls = collisionsWalls\r\n    }\r\n\r\n\r\n    addItemToPlayerCollision (item) {\r\n        this._collisionsWalls.setItemToCollision(item)\r\n    }\r\n\r\n    removeItemFromPlayerCollision (item) {\r\n        this._collisionsWalls.removeItemFromCollision(item)\r\n    }\r\n\r\n    toggleFreeze (val = !this.isFreeze) {\r\n        this.isFreeze = val\r\n    }\r\n}\r\n\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport class system_PlayerNearLevelItems {\r\n    constructor(root) {\r\n        this._root = root\r\n\r\n        const {\r\n            emitter, player\r\n        } = root\r\n\r\n\r\n        this._itemsToCheck = []\r\n\r\n        emitter.subscribe('playerMove')(() => {\r\n            //console.log('1111', this._itemsToCheck)\r\n            for (let i = 0; i < this._itemsToCheck.length; ++i) {\r\n                const dist = player.mesh.position.distanceTo(this._itemsToCheck[i].position)\r\n                //console.log(dist)\r\n\r\n                if (!this._itemsToCheck[i].userData.nearPlayerIsNearPlayer && dist < this._itemsToCheck[i].userData.nearPlayerItemNear) {\r\n                    this._itemsToCheck[i].userData.nearPlayerIsNearPlayer = true\r\n                    emitter.emit('checkNear')({ item: this._itemsToCheck[i].userData.nearPlayerItemKey, is: true })\r\n                    return;\r\n                }\r\n\r\n                if (this._itemsToCheck[i].userData.nearPlayerIsNearPlayer && dist > this._itemsToCheck[i].userData.nearPlayerItemNear) {\r\n                    this._itemsToCheck[i].userData.nearPlayerIsNearPlayer = false\r\n                    emitter.emit('checkNear')({ item: this._itemsToCheck[i].userData.nearPlayerItemKey, is: false })\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    setItemToCheck (item, itemKey, near, far) {\r\n        for (let i = 0; i < this._itemsToCheck.length; ++i) {\r\n            if (item === this._itemsToCheck[i]) {\r\n                return;\r\n            }\r\n        }\r\n        //console.log(item, itemKey, near, far)\r\n        itemKey && (item.userData.nearPlayerItemKey = itemKey)\r\n        near && (item.userData.nearPlayerItemNear = near)\r\n        far && (item.userData.nearPlayerItemFar = far)\r\n        item.userData.nearPlayerIsNearPlayer = false\r\n\r\n        this._itemsToCheck.push(item)\r\n    }\r\n\r\n    removeItemFromCheck (item) {\r\n        this._itemsToCheck = this._itemsToCheck.filter(itemIn => itemIn !== item)\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// function getCenterPoint (mesh) {\r\n//     // var center = new THREE.Vector3();\r\n//     // mesh.geometry.computeBoundingBox();\r\n//     // mesh.geometry.boundingBox.getCenter(center);\r\n//     // mesh.geometry.center();\r\n//     //mesh.position.copy(center);\r\n//\r\n//     //return center\r\n//     const geometry = mesh.geometry\r\n//     geometry.computeBoundingBox()\r\n//     const center = new THREE.Vector3()\r\n//     geometry.boundingBox.getCenter(center)\r\n//     mesh.localToWorld(center)\r\n//     return center\r\n// }","export const createCheckerChangeLocationKey = (SIZE = 100, x = 0, z = 0) => {\r\n    const keyX = Math.floor(x / SIZE)\r\n    const keyZ = Math.floor(z / SIZE)\r\n\r\n    let oldKey = keyX + '_' + keyZ\r\n\r\n\r\n    let currentEnv = generateEnvByQ(keyX, keyZ)\r\n\r\n    return {\r\n        checkChanged: (x, z) => {\r\n            const keyX = Math.floor(x / SIZE)\r\n            const keyZ = Math.floor(z / SIZE)\r\n\r\n            const newKey = keyX + '_' + keyZ\r\n            if (newKey === oldKey) {\r\n                return false;\r\n            }\r\n\r\n            const saveOldKey = oldKey\r\n            oldKey = newKey\r\n\r\n\r\n            const oldEnv = currentEnv\r\n            currentEnv = generateEnvByQ(keyX, keyZ)\r\n\r\n            const addedQs = getArrNotInFirst(currentEnv, oldEnv)\r\n            const removedQs = getArrNotInFirst(oldEnv, currentEnv)\r\n\r\n            return {\r\n                oldKey: saveOldKey,\r\n                newKey,\r\n                newEnv: currentEnv,\r\n                removedQs,\r\n                addedQs,\r\n            }\r\n        },\r\n        getCurrent: () => ({\r\n            loc: oldKey,\r\n            currentEnv,\r\n        }),\r\n    }\r\n}\r\n\r\n\r\nconst generateEnvByQ = (qX, qZ) => {\r\n    const arr = []\r\n    for (let i = qX - 1; i < qX + 2; ++i) {\r\n        for (let j = qZ - 1; j < qZ + 2; ++j) {\r\n            arr.push(i + '_' + j)\r\n        }\r\n    }\r\n    return arr\r\n}\r\n\r\nconst getArrNotInFirst = (arr1, arr2) => {\r\n    const arr = []\r\n    for (let i = 0; i < arr1.length; ++i) {\r\n        let isIn = false\r\n        for (let j = 0; j < arr2.length; ++j) {\r\n            if (arr1[i] === arr2[j]) {\r\n                isIn = true\r\n            }\r\n        }\r\n        if (!isIn) {\r\n            arr.push(arr1[i])\r\n        }\r\n    }\r\n    return arr\r\n}","/*\r\n * Copyright 2021 GFXFundamentals.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are\r\n * met:\r\n *\r\n *     * Redistributions of source code must retain the above copyright\r\n * notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above\r\n * copyright notice, this list of conditions and the following disclaimer\r\n * in the documentation and/or other materials provided with the\r\n * distribution.\r\n *     * Neither the name of GFXFundamentals. nor the names of his\r\n * contributors may be used to endorse or promote products derived from\r\n * this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n\r\n    /**\r\n     * An array or typed array with 3 values.\r\n     * @typedef {number[]|TypedArray} Vector3\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n    /**\r\n     * An array or typed array with 4 values.\r\n     * @typedef {number[]|TypedArray} Vector4\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n    /**\r\n     * An array or typed array with 16 values.\r\n     * @typedef {number[]|TypedArray} Matrix4\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n\r\n    let MatType = Float32Array;\r\n\r\n    /**\r\n     * Sets the type this library creates for a Mat4\r\n     * @param {constructor} Ctor the constructor for the type. Either `Float32Array` or `Array`\r\n     * @return {constructor} previous constructor for Mat4\r\n     */\r\n    function setDefaultType(Ctor) {\r\n        const OldType = MatType;\r\n        MatType = Ctor;\r\n        return OldType;\r\n    }\r\n\r\n    /**\r\n     * Takes two 4-by-4 matrices, a and b, and computes the product in the order\r\n     * that pre-composes b with a.  In other words, the matrix returned will\r\n     * transform by b first and then a.  Note this is subtly different from just\r\n     * multiplying the matrices together.  For given a and b, this function returns\r\n     * the same object in both row-major and column-major mode.\r\n     * @param {Matrix4} a A matrix.\r\n     * @param {Matrix4} b A matrix.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     */\r\n    function multiply(a, b, dst) {\r\n        dst = dst || new MatType(16);\r\n        var b00 = b[0 * 4 + 0];\r\n        var b01 = b[0 * 4 + 1];\r\n        var b02 = b[0 * 4 + 2];\r\n        var b03 = b[0 * 4 + 3];\r\n        var b10 = b[1 * 4 + 0];\r\n        var b11 = b[1 * 4 + 1];\r\n        var b12 = b[1 * 4 + 2];\r\n        var b13 = b[1 * 4 + 3];\r\n        var b20 = b[2 * 4 + 0];\r\n        var b21 = b[2 * 4 + 1];\r\n        var b22 = b[2 * 4 + 2];\r\n        var b23 = b[2 * 4 + 3];\r\n        var b30 = b[3 * 4 + 0];\r\n        var b31 = b[3 * 4 + 1];\r\n        var b32 = b[3 * 4 + 2];\r\n        var b33 = b[3 * 4 + 3];\r\n        var a00 = a[0 * 4 + 0];\r\n        var a01 = a[0 * 4 + 1];\r\n        var a02 = a[0 * 4 + 2];\r\n        var a03 = a[0 * 4 + 3];\r\n        var a10 = a[1 * 4 + 0];\r\n        var a11 = a[1 * 4 + 1];\r\n        var a12 = a[1 * 4 + 2];\r\n        var a13 = a[1 * 4 + 3];\r\n        var a20 = a[2 * 4 + 0];\r\n        var a21 = a[2 * 4 + 1];\r\n        var a22 = a[2 * 4 + 2];\r\n        var a23 = a[2 * 4 + 3];\r\n        var a30 = a[3 * 4 + 0];\r\n        var a31 = a[3 * 4 + 1];\r\n        var a32 = a[3 * 4 + 2];\r\n        var a33 = a[3 * 4 + 3];\r\n        dst[ 0] = b00 * a00 + b01 * a10 + b02 * a20 + b03 * a30;\r\n        dst[ 1] = b00 * a01 + b01 * a11 + b02 * a21 + b03 * a31;\r\n        dst[ 2] = b00 * a02 + b01 * a12 + b02 * a22 + b03 * a32;\r\n        dst[ 3] = b00 * a03 + b01 * a13 + b02 * a23 + b03 * a33;\r\n        dst[ 4] = b10 * a00 + b11 * a10 + b12 * a20 + b13 * a30;\r\n        dst[ 5] = b10 * a01 + b11 * a11 + b12 * a21 + b13 * a31;\r\n        dst[ 6] = b10 * a02 + b11 * a12 + b12 * a22 + b13 * a32;\r\n        dst[ 7] = b10 * a03 + b11 * a13 + b12 * a23 + b13 * a33;\r\n        dst[ 8] = b20 * a00 + b21 * a10 + b22 * a20 + b23 * a30;\r\n        dst[ 9] = b20 * a01 + b21 * a11 + b22 * a21 + b23 * a31;\r\n        dst[10] = b20 * a02 + b21 * a12 + b22 * a22 + b23 * a32;\r\n        dst[11] = b20 * a03 + b21 * a13 + b22 * a23 + b23 * a33;\r\n        dst[12] = b30 * a00 + b31 * a10 + b32 * a20 + b33 * a30;\r\n        dst[13] = b30 * a01 + b31 * a11 + b32 * a21 + b33 * a31;\r\n        dst[14] = b30 * a02 + b31 * a12 + b32 * a22 + b33 * a32;\r\n        dst[15] = b30 * a03 + b31 * a13 + b32 * a23 + b33 * a33;\r\n        return dst;\r\n    }\r\n\r\n\r\n    /**\r\n     * adds 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function addVectors(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[0] + b[0];\r\n        dst[1] = a[1] + b[1];\r\n        dst[2] = a[2] + b[2];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * subtracts 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function subtractVectors(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[0] - b[0];\r\n        dst[1] = a[1] - b[1];\r\n        dst[2] = a[2] - b[2];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * scale vectors3\r\n     * @param {Vector3} v vector\r\n     * @param {Number} s scale\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scaleVector(v, s, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = v[0] * s;\r\n        dst[1] = v[1] * s;\r\n        dst[2] = v[2] * s;\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * normalizes a vector.\r\n     * @param {Vector3} v vector to normalize\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function normalize(v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var length = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\r\n        // make sure we don't divide by 0.\r\n        if (length > 0.00001) {\r\n            dst[0] = v[0] / length;\r\n            dst[1] = v[1] / length;\r\n            dst[2] = v[2] / length;\r\n        }\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes the length of a vector\r\n     * @param {Vector3} v vector to take length of\r\n     * @return {number} length of vector\r\n     */\r\n    function length(v) {\r\n        return Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\r\n    }\r\n\r\n    /**\r\n     * Computes the length squared of a vector\r\n     * @param {Vector3} v vector to take length of\r\n     * @return {number} length sqaured of vector\r\n     */\r\n    function lengthSq(v) {\r\n        return v[0] * v[0] + v[1] * v[1] + v[2] * v[2];\r\n    }\r\n\r\n    /**\r\n     * Computes the cross product of 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function cross(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[1] * b[2] - a[2] * b[1];\r\n        dst[1] = a[2] * b[0] - a[0] * b[2];\r\n        dst[2] = a[0] * b[1] - a[1] * b[0];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes the dot product of two vectors; assumes both vectors have\r\n     * three entries.\r\n     * @param {Vector3} a Operand vector.\r\n     * @param {Vector3} b Operand vector.\r\n     * @return {number} dot product\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function dot(a, b) {\r\n        return (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]);\r\n    }\r\n\r\n    /**\r\n     * Computes the distance squared between 2 points\r\n     * @param {Vector3} a\r\n     * @param {Vector3} b\r\n     * @return {number} distance squared between a and b\r\n     */\r\n    function distanceSq(a, b) {\r\n        const dx = a[0] - b[0];\r\n        const dy = a[1] - b[1];\r\n        const dz = a[2] - b[2];\r\n        return dx * dx + dy * dy + dz * dz;\r\n    }\r\n\r\n    /**\r\n     * Computes the distance between 2 points\r\n     * @param {Vector3} a\r\n     * @param {Vector3} b\r\n     * @return {number} distance between a and b\r\n     */\r\n    function distance(a, b) {\r\n        return Math.sqrt(distanceSq(a, b));\r\n    }\r\n\r\n    /**\r\n     * Makes an identity matrix.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function identity(dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Transposes a matrix.\r\n     * @param {Matrix4} m matrix to transpose.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transpose(m, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = m[0];\r\n        dst[ 1] = m[4];\r\n        dst[ 2] = m[8];\r\n        dst[ 3] = m[12];\r\n        dst[ 4] = m[1];\r\n        dst[ 5] = m[5];\r\n        dst[ 6] = m[9];\r\n        dst[ 7] = m[13];\r\n        dst[ 8] = m[2];\r\n        dst[ 9] = m[6];\r\n        dst[10] = m[10];\r\n        dst[11] = m[14];\r\n        dst[12] = m[3];\r\n        dst[13] = m[7];\r\n        dst[14] = m[11];\r\n        dst[15] = m[15];\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Creates a lookAt matrix.\r\n     * This is a world matrix for a camera. In other words it will transform\r\n     * from the origin to a place and orientation in the world. For a view\r\n     * matrix take the inverse of this.\r\n     * @param {Vector3} cameraPosition position of the camera\r\n     * @param {Vector3} target position of the target\r\n     * @param {Vector3} up direction\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function lookAt(cameraPosition, target, up, dst) {\r\n        dst = dst || new MatType(16);\r\n        var zAxis = normalize(\r\n            subtractVectors(cameraPosition, target));\r\n        var xAxis = normalize(cross(up, zAxis));\r\n        var yAxis = normalize(cross(zAxis, xAxis));\r\n\r\n        dst[ 0] = xAxis[0];\r\n        dst[ 1] = xAxis[1];\r\n        dst[ 2] = xAxis[2];\r\n        dst[ 3] = 0;\r\n        dst[ 4] = yAxis[0];\r\n        dst[ 5] = yAxis[1];\r\n        dst[ 6] = yAxis[2];\r\n        dst[ 7] = 0;\r\n        dst[ 8] = zAxis[0];\r\n        dst[ 9] = zAxis[1];\r\n        dst[10] = zAxis[2];\r\n        dst[11] = 0;\r\n        dst[12] = cameraPosition[0];\r\n        dst[13] = cameraPosition[1];\r\n        dst[14] = cameraPosition[2];\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 perspective transformation matrix given the angular height\r\n     * of the frustum, the aspect ratio, and the near and far clipping planes.  The\r\n     * arguments define a frustum extending in the negative z direction.  The given\r\n     * angle is the vertical angle of the frustum, and the horizontal angle is\r\n     * determined to produce the given aspect ratio.  The arguments near and far are\r\n     * the distances to the near and far clipping planes.  Note that near and far\r\n     * are not z coordinates, but rather they are distances along the negative\r\n     * z-axis.  The matrix generated sends the viewing frustum to the unit box.\r\n     * We assume a unit box extending from -1 to 1 in the x and y dimensions and\r\n     * from -1 to 1 in the z dimension.\r\n     * @param {number} fieldOfViewInRadians field of view in y axis.\r\n     * @param {number} aspect aspect of viewport (width / height)\r\n     * @param {number} near near Z clipping plane\r\n     * @param {number} far far Z clipping plane\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function perspective(fieldOfViewInRadians, aspect, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n        var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);\r\n        var rangeInv = 1.0 / (near - far);\r\n\r\n        dst[ 0] = f / aspect;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = f;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = (near + far) * rangeInv;\r\n        dst[11] = -1;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = near * far * rangeInv * 2;\r\n        dst[15] = 0;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 orthographic projection matrix given the coordinates of the\r\n     * planes defining the axis-aligned, box-shaped viewing volume.  The matrix\r\n     * generated sends that box to the unit box.  Note that although left and right\r\n     * are x coordinates and bottom and top are y coordinates, near and far\r\n     * are not z coordinates, but rather they are distances along the negative\r\n     * z-axis.  We assume a unit box extending from -1 to 1 in the x and y\r\n     * dimensions and from -1 to 1 in the z dimension.\r\n     * @param {number} left The x coordinate of the left plane of the box.\r\n     * @param {number} right The x coordinate of the right plane of the box.\r\n     * @param {number} bottom The y coordinate of the bottom plane of the box.\r\n     * @param {number} top The y coordinate of the right plane of the box.\r\n     * @param {number} near The negative z coordinate of the near plane of the box.\r\n     * @param {number} far The negative z coordinate of the far plane of the box.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function orthographic(left, right, bottom, top, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 2 / (right - left);\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 2 / (top - bottom);\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 2 / (near - far);\r\n        dst[11] = 0;\r\n        dst[12] = (left + right) / (left - right);\r\n        dst[13] = (bottom + top) / (bottom - top);\r\n        dst[14] = (near + far) / (near - far);\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 perspective transformation matrix given the left, right,\r\n     * top, bottom, near and far clipping planes. The arguments define a frustum\r\n     * extending in the negative z direction. The arguments near and far are the\r\n     * distances to the near and far clipping planes. Note that near and far are not\r\n     * z coordinates, but rather they are distances along the negative z-axis. The\r\n     * matrix generated sends the viewing frustum to the unit box. We assume a unit\r\n     * box extending from -1 to 1 in the x and y dimensions and from -1 to 1 in the z\r\n     * dimension.\r\n     * @param {number} left The x coordinate of the left plane of the box.\r\n     * @param {number} right The x coordinate of the right plane of the box.\r\n     * @param {number} bottom The y coordinate of the bottom plane of the box.\r\n     * @param {number} top The y coordinate of the right plane of the box.\r\n     * @param {number} near The negative z coordinate of the near plane of the box.\r\n     * @param {number} far The negative z coordinate of the far plane of the box.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function frustum(left, right, bottom, top, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        var dx = right - left;\r\n        var dy = top - bottom;\r\n        var dz = far - near;\r\n\r\n        dst[ 0] = 2 * near / dx;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 2 * near / dy;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = (left + right) / dx;\r\n        dst[ 9] = (top + bottom) / dy;\r\n        dst[10] = -(far + near) / dz;\r\n        dst[11] = -1;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = -2 * near * far / dz;\r\n        dst[15] = 0;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes a translation matrix\r\n     * @param {number} tx x translation.\r\n     * @param {number} ty y translation.\r\n     * @param {number} tz z translation.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function translation(tx, ty, tz, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = tx;\r\n        dst[13] = ty;\r\n        dst[14] = tz;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by translation matrix.\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} tx x translation.\r\n     * @param {number} ty y translation.\r\n     * @param {number} tz z translation.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function translate(m, tx, ty, tz, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, translation(tx, ty, tz), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0];\r\n        var m01 = m[1];\r\n        var m02 = m[2];\r\n        var m03 = m[3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n\r\n        if (m !== dst) {\r\n            dst[ 0] = m00;\r\n            dst[ 1] = m01;\r\n            dst[ 2] = m02;\r\n            dst[ 3] = m03;\r\n            dst[ 4] = m10;\r\n            dst[ 5] = m11;\r\n            dst[ 6] = m12;\r\n            dst[ 7] = m13;\r\n            dst[ 8] = m20;\r\n            dst[ 9] = m21;\r\n            dst[10] = m22;\r\n            dst[11] = m23;\r\n        }\r\n\r\n        dst[12] = m00 * tx + m10 * ty + m20 * tz + m30;\r\n        dst[13] = m01 * tx + m11 * ty + m21 * tz + m31;\r\n        dst[14] = m02 * tx + m12 * ty + m22 * tz + m32;\r\n        dst[15] = m03 * tx + m13 * ty + m23 * tz + m33;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an x rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function xRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = c;\r\n        dst[ 6] = s;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = -s;\r\n        dst[10] = c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an x rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function xRotate(m, angleInRadians, dst) {\r\n        // this is the optimized version of\r\n        // return multiply(m, xRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m10 = m[4];\r\n        var m11 = m[5];\r\n        var m12 = m[6];\r\n        var m13 = m[7];\r\n        var m20 = m[8];\r\n        var m21 = m[9];\r\n        var m22 = m[10];\r\n        var m23 = m[11];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[4]  = c * m10 + s * m20;\r\n        dst[5]  = c * m11 + s * m21;\r\n        dst[6]  = c * m12 + s * m22;\r\n        dst[7]  = c * m13 + s * m23;\r\n        dst[8]  = c * m20 - s * m10;\r\n        dst[9]  = c * m21 - s * m11;\r\n        dst[10] = c * m22 - s * m12;\r\n        dst[11] = c * m23 - s * m13;\r\n\r\n        if (m !== dst) {\r\n            dst[ 0] = m[ 0];\r\n            dst[ 1] = m[ 1];\r\n            dst[ 2] = m[ 2];\r\n            dst[ 3] = m[ 3];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an y rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function yRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = -s;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = s;\r\n        dst[ 9] = 0;\r\n        dst[10] = c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an y rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function yRotate(m, angleInRadians, dst) {\r\n        // this is the optimized version of\r\n        // return multiply(m, yRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c * m00 - s * m20;\r\n        dst[ 1] = c * m01 - s * m21;\r\n        dst[ 2] = c * m02 - s * m22;\r\n        dst[ 3] = c * m03 - s * m23;\r\n        dst[ 8] = c * m20 + s * m00;\r\n        dst[ 9] = c * m21 + s * m01;\r\n        dst[10] = c * m22 + s * m02;\r\n        dst[11] = c * m23 + s * m03;\r\n\r\n        if (m !== dst) {\r\n            dst[ 4] = m[ 4];\r\n            dst[ 5] = m[ 5];\r\n            dst[ 6] = m[ 6];\r\n            dst[ 7] = m[ 7];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an z rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function zRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c;\r\n        dst[ 1] = s;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = -s;\r\n        dst[ 5] = c;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an z rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function zRotate(m, angleInRadians, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, zRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c * m00 + s * m10;\r\n        dst[ 1] = c * m01 + s * m11;\r\n        dst[ 2] = c * m02 + s * m12;\r\n        dst[ 3] = c * m03 + s * m13;\r\n        dst[ 4] = c * m10 - s * m00;\r\n        dst[ 5] = c * m11 - s * m01;\r\n        dst[ 6] = c * m12 - s * m02;\r\n        dst[ 7] = c * m13 - s * m03;\r\n\r\n        if (m !== dst) {\r\n            dst[ 8] = m[ 8];\r\n            dst[ 9] = m[ 9];\r\n            dst[10] = m[10];\r\n            dst[11] = m[11];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an rotation matrix around an arbitrary axis\r\n     * @param {Vector3} axis axis to rotate around\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function axisRotation(axis, angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        var x = axis[0];\r\n        var y = axis[1];\r\n        var z = axis[2];\r\n        var n = Math.sqrt(x * x + y * y + z * z);\r\n        x /= n;\r\n        y /= n;\r\n        z /= n;\r\n        var xx = x * x;\r\n        var yy = y * y;\r\n        var zz = z * z;\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n        var oneMinusCosine = 1 - c;\r\n\r\n        dst[ 0] = xx + (1 - xx) * c;\r\n        dst[ 1] = x * y * oneMinusCosine + z * s;\r\n        dst[ 2] = x * z * oneMinusCosine - y * s;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = x * y * oneMinusCosine - z * s;\r\n        dst[ 5] = yy + (1 - yy) * c;\r\n        dst[ 6] = y * z * oneMinusCosine + x * s;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = x * z * oneMinusCosine + y * s;\r\n        dst[ 9] = y * z * oneMinusCosine - x * s;\r\n        dst[10] = zz + (1 - zz) * c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an axis rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {Vector3} axis axis to rotate around\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function axisRotate(m, axis, angleInRadians, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, axisRotation(axis, angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var x = axis[0];\r\n        var y = axis[1];\r\n        var z = axis[2];\r\n        var n = Math.sqrt(x * x + y * y + z * z);\r\n        x /= n;\r\n        y /= n;\r\n        z /= n;\r\n        var xx = x * x;\r\n        var yy = y * y;\r\n        var zz = z * z;\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n        var oneMinusCosine = 1 - c;\r\n\r\n        var r00 = xx + (1 - xx) * c;\r\n        var r01 = x * y * oneMinusCosine + z * s;\r\n        var r02 = x * z * oneMinusCosine - y * s;\r\n        var r10 = x * y * oneMinusCosine - z * s;\r\n        var r11 = yy + (1 - yy) * c;\r\n        var r12 = y * z * oneMinusCosine + x * s;\r\n        var r20 = x * z * oneMinusCosine + y * s;\r\n        var r21 = y * z * oneMinusCosine - x * s;\r\n        var r22 = zz + (1 - zz) * c;\r\n\r\n        var m00 = m[0];\r\n        var m01 = m[1];\r\n        var m02 = m[2];\r\n        var m03 = m[3];\r\n        var m10 = m[4];\r\n        var m11 = m[5];\r\n        var m12 = m[6];\r\n        var m13 = m[7];\r\n        var m20 = m[8];\r\n        var m21 = m[9];\r\n        var m22 = m[10];\r\n        var m23 = m[11];\r\n\r\n        dst[ 0] = r00 * m00 + r01 * m10 + r02 * m20;\r\n        dst[ 1] = r00 * m01 + r01 * m11 + r02 * m21;\r\n        dst[ 2] = r00 * m02 + r01 * m12 + r02 * m22;\r\n        dst[ 3] = r00 * m03 + r01 * m13 + r02 * m23;\r\n        dst[ 4] = r10 * m00 + r11 * m10 + r12 * m20;\r\n        dst[ 5] = r10 * m01 + r11 * m11 + r12 * m21;\r\n        dst[ 6] = r10 * m02 + r11 * m12 + r12 * m22;\r\n        dst[ 7] = r10 * m03 + r11 * m13 + r12 * m23;\r\n        dst[ 8] = r20 * m00 + r21 * m10 + r22 * m20;\r\n        dst[ 9] = r20 * m01 + r21 * m11 + r22 * m21;\r\n        dst[10] = r20 * m02 + r21 * m12 + r22 * m22;\r\n        dst[11] = r20 * m03 + r21 * m13 + r22 * m23;\r\n\r\n        if (m !== dst) {\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes a scale matrix\r\n     * @param {number} sx x scale.\r\n     * @param {number} sy y scale.\r\n     * @param {number} sz z scale.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scaling(sx, sy, sz, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = sx;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = sy;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = sz;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by a scaling matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} sx x scale.\r\n     * @param {number} sy y scale.\r\n     * @param {number} sz z scale.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scale(m, sx, sy, sz, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, scaling(sx, sy, sz), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = sx * m[0 * 4 + 0];\r\n        dst[ 1] = sx * m[0 * 4 + 1];\r\n        dst[ 2] = sx * m[0 * 4 + 2];\r\n        dst[ 3] = sx * m[0 * 4 + 3];\r\n        dst[ 4] = sy * m[1 * 4 + 0];\r\n        dst[ 5] = sy * m[1 * 4 + 1];\r\n        dst[ 6] = sy * m[1 * 4 + 2];\r\n        dst[ 7] = sy * m[1 * 4 + 3];\r\n        dst[ 8] = sz * m[2 * 4 + 0];\r\n        dst[ 9] = sz * m[2 * 4 + 1];\r\n        dst[10] = sz * m[2 * 4 + 2];\r\n        dst[11] = sz * m[2 * 4 + 3];\r\n\r\n        if (m !== dst) {\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * creates a matrix from translation, quaternion, scale\r\n     * @param {Number[]} translation [x, y, z] translation\r\n     * @param {Number[]} quaternion [x, y, z, z] quaternion rotation\r\n     * @param {Number[]} scale [x, y, z] scale\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     */\r\n    function compose(translation, quaternion, scale, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        const x = quaternion[0];\r\n        const y = quaternion[1];\r\n        const z = quaternion[2];\r\n        const w = quaternion[3];\r\n\r\n        const x2 = x + x;\r\n        const y2 = y + y;\r\n        const z2 = z + z;\r\n\r\n        const xx = x * x2;\r\n        const xy = x * y2;\r\n        const xz = x * z2;\r\n\r\n        const yy = y * y2;\r\n        const yz = y * z2;\r\n        const zz = z * z2;\r\n\r\n        const wx = w * x2;\r\n        const wy = w * y2;\r\n        const wz = w * z2;\r\n\r\n        const sx = scale[0];\r\n        const sy = scale[1];\r\n        const sz = scale[2];\r\n\r\n        dst[0] = (1 - (yy + zz)) * sx;\r\n        dst[1] = (xy + wz) * sx;\r\n        dst[2] = (xz - wy) * sx;\r\n        dst[3] = 0;\r\n\r\n        dst[4] = (xy - wz) * sy;\r\n        dst[5] = (1 - (xx + zz)) * sy;\r\n        dst[6] = (yz + wx) * sy;\r\n        dst[7] = 0;\r\n\r\n        dst[ 8] = (xz + wy) * sz;\r\n        dst[ 9] = (yz - wx) * sz;\r\n        dst[10] = (1 - (xx + yy)) * sz;\r\n        dst[11] = 0;\r\n\r\n        dst[12] = translation[0];\r\n        dst[13] = translation[1];\r\n        dst[14] = translation[2];\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    function quatFromRotationMatrix(m, dst) {\r\n        // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n        // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n        const m11 = m[0];\r\n        const m12 = m[4];\r\n        const m13 = m[8];\r\n        const m21 = m[1];\r\n        const m22 = m[5];\r\n        const m23 = m[9];\r\n        const m31 = m[2];\r\n        const m32 = m[6];\r\n        const m33 = m[10];\r\n\r\n        const trace = m11 + m22 + m33;\r\n\r\n        if (trace > 0) {\r\n            const s = 0.5 / Math.sqrt(trace + 1);\r\n            dst[3] = 0.25 / s;\r\n            dst[0] = (m32 - m23) * s;\r\n            dst[1] = (m13 - m31) * s;\r\n            dst[2] = (m21 - m12) * s;\r\n        } else if (m11 > m22 && m11 > m33) {\r\n            const s = 2 * Math.sqrt(1 + m11 - m22 - m33);\r\n            dst[3] = (m32 - m23) / s;\r\n            dst[0] = 0.25 * s;\r\n            dst[1] = (m12 + m21) / s;\r\n            dst[2] = (m13 + m31) / s;\r\n        } else if (m22 > m33) {\r\n            const s = 2 * Math.sqrt(1 + m22 - m11 - m33);\r\n            dst[3] = (m13 - m31) / s;\r\n            dst[0] = (m12 + m21) / s;\r\n            dst[1] = 0.25 * s;\r\n            dst[2] = (m23 + m32) / s;\r\n        } else {\r\n            const s = 2 * Math.sqrt(1 + m33 - m11 - m22);\r\n            dst[3] = (m21 - m12) / s;\r\n            dst[0] = (m13 + m31) / s;\r\n            dst[1] = (m23 + m32) / s;\r\n            dst[2] = 0.25 * s;\r\n        }\r\n    }\r\n\r\n    function decompose(mat, translation, quaternion, scale) {\r\n        let sx = m4.length(mat.slice(0, 3));\r\n        const sy = m4.length(mat.slice(4, 7));\r\n        const sz = m4.length(mat.slice(8, 11));\r\n\r\n        // if determinate is negative, we need to invert one scale\r\n        const det = determinate(mat);\r\n        if (det < 0) {\r\n            sx = -sx;\r\n        }\r\n\r\n        translation[0] = mat[12];\r\n        translation[1] = mat[13];\r\n        translation[2] = mat[14];\r\n\r\n        // scale the rotation part\r\n        const matrix = m4.copy(mat);\r\n\r\n        const invSX = 1 / sx;\r\n        const invSY = 1 / sy;\r\n        const invSZ = 1 / sz;\r\n\r\n        matrix[0] *= invSX;\r\n        matrix[1] *= invSX;\r\n        matrix[2] *= invSX;\r\n\r\n        matrix[4] *= invSY;\r\n        matrix[5] *= invSY;\r\n        matrix[6] *= invSY;\r\n\r\n        matrix[8] *= invSZ;\r\n        matrix[9] *= invSZ;\r\n        matrix[10] *= invSZ;\r\n\r\n        quatFromRotationMatrix(matrix, quaternion);\r\n\r\n        scale[0] = sx;\r\n        scale[1] = sy;\r\n        scale[2] = sz;\r\n    }\r\n\r\n    function determinate(m) {\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n        var tmp_0  = m22 * m33;\r\n        var tmp_1  = m32 * m23;\r\n        var tmp_2  = m12 * m33;\r\n        var tmp_3  = m32 * m13;\r\n        var tmp_4  = m12 * m23;\r\n        var tmp_5  = m22 * m13;\r\n        var tmp_6  = m02 * m33;\r\n        var tmp_7  = m32 * m03;\r\n        var tmp_8  = m02 * m23;\r\n        var tmp_9  = m22 * m03;\r\n        var tmp_10 = m02 * m13;\r\n        var tmp_11 = m12 * m03;\r\n\r\n        var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) -\r\n            (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n        var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) -\r\n            (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n        var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) -\r\n            (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n        var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) -\r\n            (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n        return 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n    }\r\n\r\n    /**\r\n     * Computes the inverse of a matrix.\r\n     * @param {Matrix4} m matrix to compute inverse of\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function inverse(m, dst) {\r\n        dst = dst || new MatType(16);\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n        var tmp_0  = m22 * m33;\r\n        var tmp_1  = m32 * m23;\r\n        var tmp_2  = m12 * m33;\r\n        var tmp_3  = m32 * m13;\r\n        var tmp_4  = m12 * m23;\r\n        var tmp_5  = m22 * m13;\r\n        var tmp_6  = m02 * m33;\r\n        var tmp_7  = m32 * m03;\r\n        var tmp_8  = m02 * m23;\r\n        var tmp_9  = m22 * m03;\r\n        var tmp_10 = m02 * m13;\r\n        var tmp_11 = m12 * m03;\r\n        var tmp_12 = m20 * m31;\r\n        var tmp_13 = m30 * m21;\r\n        var tmp_14 = m10 * m31;\r\n        var tmp_15 = m30 * m11;\r\n        var tmp_16 = m10 * m21;\r\n        var tmp_17 = m20 * m11;\r\n        var tmp_18 = m00 * m31;\r\n        var tmp_19 = m30 * m01;\r\n        var tmp_20 = m00 * m21;\r\n        var tmp_21 = m20 * m01;\r\n        var tmp_22 = m00 * m11;\r\n        var tmp_23 = m10 * m01;\r\n\r\n        var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) -\r\n            (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n        var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) -\r\n            (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n        var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) -\r\n            (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n        var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) -\r\n            (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n        var d = 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n\r\n        dst[0] = d * t0;\r\n        dst[1] = d * t1;\r\n        dst[2] = d * t2;\r\n        dst[3] = d * t3;\r\n        dst[4] = d * ((tmp_1 * m10 + tmp_2 * m20 + tmp_5 * m30) -\r\n            (tmp_0 * m10 + tmp_3 * m20 + tmp_4 * m30));\r\n        dst[5] = d * ((tmp_0 * m00 + tmp_7 * m20 + tmp_8 * m30) -\r\n            (tmp_1 * m00 + tmp_6 * m20 + tmp_9 * m30));\r\n        dst[6] = d * ((tmp_3 * m00 + tmp_6 * m10 + tmp_11 * m30) -\r\n            (tmp_2 * m00 + tmp_7 * m10 + tmp_10 * m30));\r\n        dst[7] = d * ((tmp_4 * m00 + tmp_9 * m10 + tmp_10 * m20) -\r\n            (tmp_5 * m00 + tmp_8 * m10 + tmp_11 * m20));\r\n        dst[8] = d * ((tmp_12 * m13 + tmp_15 * m23 + tmp_16 * m33) -\r\n            (tmp_13 * m13 + tmp_14 * m23 + tmp_17 * m33));\r\n        dst[9] = d * ((tmp_13 * m03 + tmp_18 * m23 + tmp_21 * m33) -\r\n            (tmp_12 * m03 + tmp_19 * m23 + tmp_20 * m33));\r\n        dst[10] = d * ((tmp_14 * m03 + tmp_19 * m13 + tmp_22 * m33) -\r\n            (tmp_15 * m03 + tmp_18 * m13 + tmp_23 * m33));\r\n        dst[11] = d * ((tmp_17 * m03 + tmp_20 * m13 + tmp_23 * m23) -\r\n            (tmp_16 * m03 + tmp_21 * m13 + tmp_22 * m23));\r\n        dst[12] = d * ((tmp_14 * m22 + tmp_17 * m32 + tmp_13 * m12) -\r\n            (tmp_16 * m32 + tmp_12 * m12 + tmp_15 * m22));\r\n        dst[13] = d * ((tmp_20 * m32 + tmp_12 * m02 + tmp_19 * m22) -\r\n            (tmp_18 * m22 + tmp_21 * m32 + tmp_13 * m02));\r\n        dst[14] = d * ((tmp_18 * m12 + tmp_23 * m32 + tmp_15 * m02) -\r\n            (tmp_22 * m32 + tmp_14 * m02 + tmp_19 * m12));\r\n        dst[15] = d * ((tmp_22 * m22 + tmp_16 * m02 + tmp_21 * m12) -\r\n            (tmp_20 * m12 + tmp_23 * m22 + tmp_17 * m02));\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a  matrix and a vector with 4 entries, transforms that vector by\r\n     * the matrix, and returns the result as a vector with 4 entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector4} v The point in homogenous coordinates.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformVector(m, v, dst) {\r\n        dst = dst || new MatType(4);\r\n        for (var i = 0; i < 4; ++i) {\r\n            dst[i] = 0.0;\r\n            for (var j = 0; j < 4; ++j) {\r\n                dst[i] += v[j] * m[j * 4 + i];\r\n            }\r\n        }\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix and a vector with 3 entries,\r\n     * interprets the vector as a point, transforms that point by the matrix, and\r\n     * returns the result as a vector with 3 entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The point.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformPoint(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n        var d = v0 * m[0 * 4 + 3] + v1 * m[1 * 4 + 3] + v2 * m[2 * 4 + 3] + m[3 * 4 + 3];\r\n\r\n        dst[0] = (v0 * m[0 * 4 + 0] + v1 * m[1 * 4 + 0] + v2 * m[2 * 4 + 0] + m[3 * 4 + 0]) / d;\r\n        dst[1] = (v0 * m[0 * 4 + 1] + v1 * m[1 * 4 + 1] + v2 * m[2 * 4 + 1] + m[3 * 4 + 1]) / d;\r\n        dst[2] = (v0 * m[0 * 4 + 2] + v1 * m[1 * 4 + 2] + v2 * m[2 * 4 + 2] + m[3 * 4 + 2]) / d;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix and a vector with 3 entries, interprets the vector as a\r\n     * direction, transforms that direction by the matrix, and returns the result;\r\n     * assumes the transformation of 3-dimensional space represented by the matrix\r\n     * is parallel-preserving, i.e. any combination of rotation, scaling and\r\n     * translation, but not a perspective distortion. Returns a vector with 3\r\n     * entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The direction.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformDirection(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n\r\n        dst[0] = v0 * m[0 * 4 + 0] + v1 * m[1 * 4 + 0] + v2 * m[2 * 4 + 0];\r\n        dst[1] = v0 * m[0 * 4 + 1] + v1 * m[1 * 4 + 1] + v2 * m[2 * 4 + 1];\r\n        dst[2] = v0 * m[0 * 4 + 2] + v1 * m[1 * 4 + 2] + v2 * m[2 * 4 + 2];\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix m and a vector v with 3 entries, interprets the vector\r\n     * as a normal to a surface, and computes a vector which is normal upon\r\n     * transforming that surface by the matrix. The effect of this function is the\r\n     * same as transforming v (as a direction) by the inverse-transpose of m.  This\r\n     * function assumes the transformation of 3-dimensional space represented by the\r\n     * matrix is parallel-preserving, i.e. any combination of rotation, scaling and\r\n     * translation, but not a perspective distortion.  Returns a vector with 3\r\n     * entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The normal.\r\n     * @param {Vector3} [dst] The direction.\r\n     * @return {Vector3} The transformed direction.\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformNormal(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var mi = inverse(m);\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n\r\n        dst[0] = v0 * mi[0 * 4 + 0] + v1 * mi[0 * 4 + 1] + v2 * mi[0 * 4 + 2];\r\n        dst[1] = v0 * mi[1 * 4 + 0] + v1 * mi[1 * 4 + 1] + v2 * mi[1 * 4 + 2];\r\n        dst[2] = v0 * mi[2 * 4 + 0] + v1 * mi[2 * 4 + 1] + v2 * mi[2 * 4 + 2];\r\n\r\n        return dst;\r\n    }\r\n\r\n    function copy(src, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = src[ 0];\r\n        dst[ 1] = src[ 1];\r\n        dst[ 2] = src[ 2];\r\n        dst[ 3] = src[ 3];\r\n        dst[ 4] = src[ 4];\r\n        dst[ 5] = src[ 5];\r\n        dst[ 6] = src[ 6];\r\n        dst[ 7] = src[ 7];\r\n        dst[ 8] = src[ 8];\r\n        dst[ 9] = src[ 9];\r\n        dst[10] = src[10];\r\n        dst[11] = src[11];\r\n        dst[12] = src[12];\r\n        dst[13] = src[13];\r\n        dst[14] = src[14];\r\n        dst[15] = src[15];\r\n\r\n        return dst;\r\n    }\r\n\r\nexport const m4 = {\r\n        copy: copy,\r\n        lookAt: lookAt,\r\n        addVectors: addVectors,\r\n        subtractVectors: subtractVectors,\r\n        scaleVector: scaleVector,\r\n        distance: distance,\r\n        distanceSq: distanceSq,\r\n        normalize: normalize,\r\n        compose: compose,\r\n        cross: cross,\r\n        decompose: decompose,\r\n        dot: dot,\r\n        identity: identity,\r\n        transpose: transpose,\r\n        length: length,\r\n        lengthSq: lengthSq,\r\n        orthographic: orthographic,\r\n        frustum: frustum,\r\n        perspective: perspective,\r\n        translation: translation,\r\n        translate: translate,\r\n        xRotation: xRotation,\r\n        yRotation: yRotation,\r\n        zRotation: zRotation,\r\n        xRotate: xRotate,\r\n        yRotate: yRotate,\r\n        zRotate: zRotate,\r\n        axisRotation: axisRotation,\r\n        axisRotate: axisRotate,\r\n        scaling: scaling,\r\n        scale: scale,\r\n        multiply: multiply,\r\n        inverse: inverse,\r\n        transformVector: transformVector,\r\n        transformPoint: transformPoint,\r\n        transformDirection: transformDirection,\r\n        transformNormal: transformNormal,\r\n        setDefaultType: setDefaultType,\r\n}\r\n\r\n","import { m4 } from '../../helpers/m4'\r\n\r\nconst {\r\n    floor,\r\n    random,\r\n} = Math\r\nconst ranN = (start, end) => start + floor(random() * (end - start))\r\nexport const ran = (start, end) => start + random() * (end - start)\r\n\r\n\r\n\r\nexport const createFace = (v1, v2, v3, v4) => [...v1, ...v2, ...v3, ...v1, ...v3, ...v4]\r\nexport const createUv = (v1, v2, v3, v4) => [...v1, ...v2, ...v3, ...v1, ...v3, ...v4]\r\nexport const fillColorFace = c => [...c, ...c, ...c, ...c, ...c, ...c]\r\n\r\n\r\n\r\nexport const createFaceWithSquare = (v1, v2, v3, v4, color1, color2) => {\r\n    const maxW = v2[0] - v1[0]\r\n    const maxH = v3[1] - v1[1]\r\n\r\n    const innerW = ran(maxW * 0.3, maxW * 0.7)\r\n    const innerH = ran(maxH * 0.3, maxH * 0.7)\r\n\r\n    const x1 = v1[0] + (maxW - innerW) / 2\r\n    const x2 = v2[0] - (maxW - innerW) / 2\r\n    const y1 = v1[1] + (maxH - innerH) / 2\r\n    const y2 = v3[1] - (maxH - innerH) / 2\r\n\r\n    const v1_i = [x1, y1, v1[2]]\r\n    const v2_i = [x2, y1, v1[2]]\r\n    const v3_i = [x2, y2, v1[2]]\r\n    const v4_i = [x1, y2, v1[2]]\r\n\r\n    const vArr = []\r\n    vArr.push(\r\n        ...createFace(v1_i, v2_i, v3_i, v4_i),\r\n        ...createFace(v1, v2, v2_i, v1_i),\r\n        ...createFace(v2_i, v2, v3, v3_i),\r\n        ...createFace(v4_i, v3_i, v3, v4),\r\n        ...createFace(v1, v1_i, v4_i, v4),\r\n    )\r\n\r\n    const cArr = fillColorFaceWithSquare(color1, color2)\r\n\r\n    const uArr = [\r\n        ...createUv(\r\n            [.5, .5],\r\n            [1, .5],\r\n            [1, 1],\r\n            [.5, 1],\r\n        ),\r\n\r\n\r\n        \r\n        ...createUv(\r\n            [0, .5],\r\n            [.5, .5],\r\n            //[.5, 1],\r\n            //[0, 1],\r\n            [.4, .6],\r\n            [.1, .6],\r\n        ),\r\n        ...createUv(\r\n            [.4, .6],\r\n            [.5, .5],\r\n            [.5, 1],\r\n            [.4, .9],\r\n        ),\r\n        ...createUv(\r\n            [.1, .9],\r\n            [.4, .9],\r\n            [.5, 1],\r\n            [0, 1],\r\n        ),\r\n        ...createUv(\r\n            [0, .5],\r\n            [.1, .6],\r\n            [.1, .9],\r\n            [0, 1],\r\n        )\r\n    ]\r\n\r\n\r\n    return { \r\n        vArr,\r\n        cArr,\r\n        uArr,\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const fillColorFaceWithSquare = (c1, c2) => [\r\n    ...fillColorFace(c1),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n]\r\n\r\n\r\n\r\nexport const transformArr = (arr, x = 0, y = 0, z = 0, r = 0) => {\r\n    let matrix = m4.yRotation(r);\r\n    matrix = m4.translate(matrix, x, y, z);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\nexport const rotateArr = (arr, angle) => {\r\n    const matrix = m4.yRotation(angle);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\nexport const rotateArrY = (arr, angle) => {\r\n    const matrix = m4.yRotation(angle);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\nexport const rotateArrZ = (arr, angle) => {\r\n    const matrix = m4.zRotation(angle);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\n\r\nexport const translateArr = (arr, x = 0, y = 0, z = 0) => {\r\n    const matrix = m4.translation(x, y, z);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    createFaceWithSquare,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\nimport { ran } from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements' \r\n\r\n\r\n\r\n\r\n\r\n\r\nconst createTrunk = ({\r\n     h = 2,\r\n     h2 = 30,\r\n     r = 10,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n}) => {\r\n    const arrDividers = []\r\n    let leftH = h2 - h\r\n    let currentH = h\r\n    while (leftH > 0) {\r\n        const h01 = ran(0.5, 10)\r\n        const h02 = ran(0.5, 4)\r\n        const h03 = ran(0.5, 4)\r\n        const h04 = ran(0.5, .2, 4)\r\n        const fullH = h01 + h02 + h03 + h04\r\n        leftH -= fullH\r\n        if (leftH > 5) {\r\n            arrDividers.push({\r\n                h0: currentH,\r\n                h01: currentH + h01,\r\n                h02: currentH + h01 + h02,\r\n                h03: currentH + h01 + h02 + h03,\r\n                h04: currentH + h01 + h02 + h03 + h04,\r\n                r: ran(1, 10),\r\n            })\r\n        }\r\n        currentH = currentH + fullH\r\n    }\r\n\r\n\r\n    const vert = []\r\n    const col = []\r\n    const uv = []\r\n\r\n\r\n\r\n    if (arrDividers.length === 0) {\r\n        vert.push(\r\n            ...createFace(\r\n                [-r, h, r],\r\n                [r, h, r],\r\n                [r, h2, r],\r\n                [-r, h2, r],\r\n            )\r\n        )\r\n        col.push(...fillColorFace(color1))\r\n        uv.push(...createUv(\r\n            [0, .5],\r\n            [.5, .5],\r\n            [.5, 1],\r\n            [0, 1],\r\n        ))\r\n    } else {\r\n        for (let i = 0; i < arrDividers.length; ++i) {\r\n            /** column ***/\r\n            const { vArr, cArr, uArr } = createFaceWithSquare(\r\n                [-r, arrDividers[i].h0, r],\r\n                [r, arrDividers[i].h0, r],\r\n                [r, arrDividers[i].h01, r],\r\n                [-r, arrDividers[i].h01, r],\r\n                color2,\r\n                color2,\r\n            )\r\n            vert.push(...vArr)\r\n            col.push(...cArr)\r\n            uv.push(...uArr)\r\n            /** column -> divider */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-r, arrDividers[i].h01, r],\r\n                    [r, arrDividers[i].h01, r],\r\n                    [arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [-arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color2))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n            /** divider */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [-arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color1))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n            /** divider -> column */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [r, arrDividers[i].h04, r],\r\n                    [-r, arrDividers[i].h04, r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color2))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n        }\r\n\r\n        /** last segment */\r\n        const { vArr, cArr, uArr } = createFaceWithSquare(\r\n            [-r, arrDividers[arrDividers.length - 1].h04, r],\r\n            [r, arrDividers[arrDividers.length - 1].h04, r],\r\n            [r, h2, r],\r\n            [-r, h2, r],\r\n            color2,\r\n            color1,\r\n        )\r\n        vert.push(...vArr)\r\n        col.push(...cArr)\r\n        uv.push(...uArr)\r\n    }\r\n\r\n    return { vert, col, uv }\r\n}\r\n\r\n\r\nexport const createDataSideColumn = ({\r\n    h0,\r\n    h1,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n    rBase = 5,\r\n    hBase = 5,\r\n    hBaseToTrunk = 1,\r\n\r\n    hCapital = 2,\r\n    rCapital = 6,\r\n    hTrunkToCapital = 1,\r\n\r\n\r\n    rTrunk = 3,\r\n}) => {\r\n    let _h0 = h0\r\n    let _h1 = h0 + hBase \r\n    /** BASE **************/\r\n    const base = createFace(\r\n        [-rBase, _h0, rBase,],\r\n        [rBase, _h0, rBase],\r\n        [rBase, _h1, rBase],\r\n        [-rBase, _h1, rBase],\r\n    )\r\n    const colorBase = fillColorFace(color1)\r\n    const uv1 = createUv(\r\n        [.5, 0],\r\n        [1, 0],\r\n        [1, .5],\r\n        [.5, .5],\r\n    )\r\n\r\n    const base1 = createFace(\r\n        [rBase + lW, _h0 - lW, rBase + lW],\r\n        [-rBase - lW, _h0 - lW, rBase + lW],\r\n        [-rBase - lW, _h1, rBase + lW],\r\n        [rBase + lW, _h1, rBase + lW],\r\n    )\r\n    const colorBase1 = fillColorFace(lCol)\r\n    const uv1_1 = createUv(\r\n        [0, 1],\r\n        [0, 1],\r\n        [0, 1],\r\n        [0, 1],\r\n    )\r\n\r\n\r\n\r\n\r\n\r\n\r\n    _h0 = _h1\r\n    _h1 = _h0 + hBaseToTrunk\r\n    const baseToTrunk = [...createFace(\r\n        [-rBase, _h0, rBase],\r\n        [rBase, _h0, rBase],\r\n        [rTrunk, _h1, rTrunk],\r\n        [-rTrunk, _h1, rTrunk],\r\n    )]\r\n    const colorBaseToTrunk = [...fillColorFace(color2)]\r\n    const uvBT = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.4, .7],\r\n        [.1, .7],\r\n    )\r\n\r\n\r\n    /** TRUNK ************************/\r\n    \r\n    \r\n    let h = hBase + hBaseToTrunk\r\n\r\n    _h0 = _h1\r\n    _h1 = h1 - hCapital - hTrunkToCapital\r\n\r\n    const { vert, col, uv } = createTrunk({\r\n        color1, color2,\r\n        h: _h0,\r\n        h2: _h1,\r\n        r: rTrunk,\r\n    })\r\n    const uvT = uv\r\n\r\n\r\n    /** CAPITAL **************/\r\n    _h0 = _h1\r\n    _h1 = h1 - hCapital \r\n    const trunkToCapital = [...createFace(\r\n        [-rTrunk, _h0, rTrunk],\r\n        [rTrunk, _h0, rTrunk],\r\n        [rCapital, _h1, rCapital],\r\n        [-rCapital, _h1, rCapital],\r\n    )]\r\n    _h0 = _h1\r\n    _h1 = h1\r\n    const capital = [\r\n        ...createFace(\r\n            [-rCapital, _h0, rCapital],\r\n            [rCapital, _h0, rCapital],\r\n            [rCapital, _h1, rCapital],\r\n            [-rCapital, _h1, rCapital],\r\n        ),\r\n    ]\r\n    const uvC = createUv(\r\n        [.5, .5],\r\n        [1, .5],\r\n        [1, 0],\r\n        [.5, 0],\r\n    )\r\n\r\n\r\n    const frontVert = [\r\n        ...base,\r\n        ...base1,\r\n        ...baseToTrunk,\r\n        ...vert,\r\n        ...trunkToCapital,\r\n        ...capital,\r\n    ]\r\n    const frontColors = [\r\n        ...colorBase,\r\n        ...colorBase1,\r\n        ...colorBaseToTrunk,\r\n        ...col,\r\n        ...colorBaseToTrunk,\r\n        ...colorBase,\r\n    ]\r\n    const frontUV = [\r\n        ...uv1,\r\n        ...uv1_1,\r\n        ...uvBT,\r\n        ...uvT,\r\n        ...uvBT,\r\n        ...uvC,\r\n    ]\r\n\r\n\r\n    return {\r\n        frontVert,\r\n        frontColors,\r\n        frontUV,\r\n    }\r\n}","import { createDataSideColumn } from './dataColumnSide'\r\nimport {\r\n    transformArr,\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements'\r\n\r\n\r\nconst CAR_COLL = 20\r\n\r\nconst color1 = [0, 0, 0]\r\nconst color2 = [0, .7, 0]\r\n\r\n\r\n\r\n\r\nexport const createDataColumn = ({\r\n    h0 = 0,\r\n    h1 = 30,\r\n    rCapital = 6,\r\n    rBase = 5,\r\n    capTop = false,\r\n    capBottom = false\r\n}) => {\r\n\r\n    const {\r\n        frontVert,\r\n        frontColors,\r\n        frontUV,\r\n    } = createDataSideColumn({ h0, h1, color1, color2, rCapital, rBase })\r\n\r\n\r\n    const leftVert = [...frontVert]\r\n    transformArr(leftVert, 0, 0, 0, Math.PI / 2)\r\n\r\n    const rightVert = [...frontVert]\r\n    transformArr(rightVert, 0, 0, 0, -Math.PI / 2)\r\n\r\n    const backVert = [...frontVert]\r\n    transformArr(backVert, 0, 0, 0, Math.PI)\r\n\r\n\r\n    const v = [\r\n        ...frontVert,\r\n        ...leftVert,\r\n        ...rightVert,\r\n        ...backVert,\r\n    ]\r\n    const c = [\r\n        ...frontColors,\r\n        ...frontColors,\r\n        ...frontColors,\r\n        ...frontColors,\r\n    ]\r\n\r\n    const u = [\r\n        ...frontUV,\r\n        ...frontUV,\r\n        ...frontUV,\r\n        ...frontUV,\r\n    ]\r\n\r\n\r\n    const wL = .6\r\n    const collision = [\r\n        ...createFace(\r\n            [-rBase - wL, h0, rBase + wL],\r\n            [rBase + wL, h0, rBase + wL],\r\n            [rBase + wL, h1, rBase + wL],\r\n            [-rBase - wL, h1, rBase + wL],\r\n        ),\r\n        ...createFace(\r\n            [rBase + wL, h0, rBase + wL],\r\n            [rBase + wL, h0, -rBase - wL],\r\n            [rBase + wL, h1, -rBase - wL],\r\n            [rBase + wL, h1, rBase + wL],\r\n        ),\r\n        ...createFace(\r\n            [rBase + wL, h0, -rBase - wL],\r\n            [-rBase - wL, h0, -rBase - wL],\r\n            [-rBase - wL, h1, -rBase - wL],\r\n            [rBase + wL, h1, -rBase - wL],\r\n        ),\r\n        ...createFace(\r\n            [-rBase - wL, h0, -rBase - wL],\r\n            [-rBase - wL, h0, rBase + wL],\r\n            [-rBase - wL, h1, rBase + wL],\r\n            [-rBase - wL, h1, -rBase - wL],\r\n        ),\r\n    ]\r\n\r\n    const collisionCar = [\r\n        ...createFace(\r\n            [-CAR_COLL, h0, CAR_COLL],\r\n            [CAR_COLL, h0, CAR_COLL],\r\n            [CAR_COLL, h1, CAR_COLL],\r\n            [-CAR_COLL, h1, CAR_COLL],\r\n        ),\r\n        ...createFace(\r\n            [CAR_COLL, h0, CAR_COLL],\r\n            [CAR_COLL, h0, -CAR_COLL],\r\n            [CAR_COLL, h1, -CAR_COLL],\r\n            [CAR_COLL, h1, CAR_COLL],\r\n        ),\r\n        ...createFace(\r\n            [CAR_COLL, h0, -CAR_COLL],\r\n            [-CAR_COLL, h0, -CAR_COLL],\r\n            [-CAR_COLL, h1, -CAR_COLL],\r\n            [CAR_COLL, h1, -CAR_COLL],\r\n        ),\r\n        ...createFace(\r\n            [-CAR_COLL, h0, -CAR_COLL],\r\n            [-CAR_COLL, h0, CAR_COLL],\r\n            [-CAR_COLL, h1, CAR_COLL],\r\n            [-CAR_COLL, h1, -CAR_COLL],\r\n        ),\r\n    ]\r\n\r\n\r\n    if (capBottom) {\r\n        v.push(...createFace(\r\n            [-rBase - lW, h0 - lW, rBase + lW],\r\n            [rBase + lW, h0 - lW, rBase + lW],\r\n            [rBase, h0 - lW, -rBase - lW],\r\n            [-rBase, h0 - lW, -rBase - lW],\r\n        ))\r\n        c.push(...fillColorFace(lCol))\r\n        u.push(...createUv(\r\n            [0, 1],\r\n            [0, 1],\r\n            [0, 1],\r\n            [0, 1],\r\n        ))\r\n    }\r\n\r\n    if (capTop) {\r\n        v.push(...createFace(\r\n            [-rCapital, h1, rCapital],\r\n            [rCapital, h1, rCapital],\r\n            [rCapital, h1, -rCapital],\r\n            [-rCapital, h1, -rCapital],\r\n        ))\r\n        c.push(...fillColorFace(color1))\r\n        u.push(...createUv(\r\n            [.5, 0],\r\n            [1, 0],\r\n            [1, .5],\r\n            [.5, .5],\r\n        ))\r\n    }\r\n\r\n\r\n    return { v, c, u, collision, collisionCar }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\nexport const createSimpleColumn = ({ isColumn, h1, h2, color1, color2 }) => {\r\n    if (!isColumn) {\r\n        return {\r\n            vertColumn: [],\r\n            colorsColumn: [],\r\n            uvColumn: [],\r\n        }\r\n    }\r\n\r\n    const vertColumn = []\r\n    const colorsColumn = []\r\n    const uvColumn = []\r\n\r\n    const r = 4\r\n    const rC = 6\r\n    const hC = h2 - 5\r\n\r\n    /** front **************/\r\n    vertColumn.push(\r\n        ...createFace(\r\n            [-r, h1, r,],\r\n            [r, h1, r],\r\n            [r, h2, r],\r\n            [-r, h2, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, h1, r],\r\n            [r, h1, -r],\r\n            [r, h2, -r],\r\n            [r, h2, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, h1, -r],\r\n            [-r, h1, -r],\r\n            [-r, h2, -r],\r\n            [r, h2, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, h1, -r],\r\n            [-r, h1, r],\r\n            [-r, h2, r],\r\n            [-r, h2, -r],\r\n        ),\r\n\r\n        // capitel\r\n        ...createFace(\r\n            [-rC, hC, rC],\r\n            [rC, hC, rC],\r\n            [rC, h2, rC],\r\n            [-rC, h2, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [rC, hC, rC],\r\n            [rC, hC, -rC],\r\n            [rC, h2, -rC],\r\n            [rC, h2, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [rC, hC, -rC],\r\n            [-rC, hC, -rC],\r\n            [-rC, h2, -rC],\r\n            [rC, h2, -rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rC, hC, -rC],\r\n            [-rC, hC, rC],\r\n            [-rC, h2, rC],\r\n            [-rC, h2, -rC],\r\n        ),\r\n\r\n        // bottom top\r\n\r\n        ...createFace(\r\n            [-rC, hC, rC],\r\n            [-rC, hC, -rC],\r\n            [rC, hC, -rC],\r\n            [rC, hC, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rC, h2, -rC],\r\n            [-rC, h2, rC],\r\n            [rC, h2, rC],\r\n            [rC, h2, -rC],\r\n        ),\r\n    )\r\n\r\n    colorsColumn.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n    )\r\n\r\n\r\n    const uv = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.5, 1],\r\n        [0, 1],\r\n    )\r\n\r\n    uvColumn.push(\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n    )\r\n\r\n\r\n    return {\r\n        vertColumn,\r\n        colorsColumn,\r\n        uvColumn,\r\n    }\r\n}\r\n","import {\r\n    createFace,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\nconst {\r\n    PI,\r\n    cos,\r\n} = Math\r\n\r\nconst hPI = PI / 2\r\nconst colorB = [0, 0, 0]\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createDataArcHalf = ({\r\n    hArc = 15,\r\n    arcL = 15,\r\n    color2,\r\n}) => {\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n\r\n    /** arc */\r\n    const arcC = 5\r\n    const arcStep = arcL / arcC\r\n\r\n    for (let i = 0; i < arcC; ++i) {\r\n        const phase0 = cos(i / arcC * (hPI))\r\n        const phase1 = cos((i + 1) / arcC * (hPI))\r\n        const hhArc = 0\r\n        v.push(\r\n            i * arcStep, hhArc + (phase0 * hArc), .1,\r\n            (i + 1) * arcStep, hhArc + (phase1 * hArc), .1,\r\n            arcL,  hArc, 1,\r\n        )\r\n\r\n        v.push(\r\n            i * arcStep, hhArc + (phase0 * hArc), -2,\r\n            arcL, hArc, -2,\r\n            (i + 1) * arcStep, hhArc + (phase1 * hArc), -2,\r\n        )\r\n\r\n        c.push(\r\n            ...color2, ...color2, ...color2,\r\n            ...color2, ...color2, ...color2,\r\n        )\r\n        u.push(\r\n            0, 0, .3, 0, .3, .3,\r\n            0, 0, .3, 0, .3, .3\r\n        )\r\n\r\n\r\n        v.push(...createFace(\r\n            [i * arcStep, hhArc + (phase0 * hArc), .1],\r\n            [i * arcStep, hhArc + (phase0 * hArc), -2],\r\n            [(i + 1) * arcStep, hhArc + (phase1 * hArc), -2],\r\n            [(i + 1) * arcStep, hhArc + (phase1 * hArc), .1],\r\n        ))\r\n\r\n        c.push(...fillColorFace(colorB))\r\n        u.push(\r\n            0, 0, 0, 0, 0, 0,\r\n            0, 0, 0, 0, 0, 0,\r\n        )\r\n    }\r\n\r\n    return { v, c, u }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements' \r\n\r\nconst {\r\n    sin,\r\n    cos,\r\n} = Math\r\n\r\n\r\n\r\n\r\nexport const createTopElem = ({\r\n  isTopElem,\r\n  color1,\r\n  color2,\r\n  h2,\r\n}) => {\r\n\r\n\r\n    if (!isTopElem) {\r\n        return {\r\n            vertTopElem: [],\r\n            colorsTopElem: [],\r\n            uvTopElem: [],\r\n        }\r\n    }\r\n\r\n\r\n    const vertTopElem = []\r\n    const colorsTopElem = []\r\n    const uvTopElem = []\r\n\r\n\r\n    const hl1 = 2 + Math.random() * 12\r\n    const hl2 = 1 + Math.random() * 4\r\n    const hl3 = .2 + Math.random() * 40\r\n    const hl4 = .1 + Math.random() * 10\r\n    const hl5 = .1 + Math.random() * 10\r\n    const hl6 = .1 + Math.random() * 40\r\n\r\n\r\n    const count = 6\r\n    for (let i = 0; i < count; ++i) {\r\n\r\n        let nextI = i + 1\r\n        if (nextI > count) {\r\n            nextI = 0\r\n        }\r\n\r\n\r\n        const angle1 = i / count * Math.PI * 2\r\n        const angle2 = nextI / count * Math.PI * 2\r\n\r\n        let _h1 = h2\r\n        let _h2 = _h1 + hl1\r\n        let _r1 = 6\r\n        let _r2 = 6\r\n        const sA1 = sin(angle1)\r\n        const cA1 = cos(angle1)\r\n        const sA2 = sin(angle2)\r\n        const cA2 = cos(angle2)\r\n\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl2\r\n        _r1 = _r2\r\n        _r2 = 3\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl3\r\n        _r1 = _r2\r\n        _r2 = _r1\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl4\r\n        _r1 = _r2\r\n        _r2 = _r1 + 4\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl5\r\n        _r1 = _r2\r\n        _r2 = _r1\r\n\r\n        /** baraban */\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n        /** baraban stroke */\r\n        let lW3 = lW + .5\r\n        vertTopElem.push(...createFace(\r\n            [sA2 * (_r1 + lW3), _h1, cA2 * (_r1 + lW3)],\r\n            [sA1 * (_r1 + lW3), _h1, cA1 * (_r1 + lW3)],\r\n            [sA1 * (_r2 + lW3), _h2, cA1 * (_r2 + lW3)],\r\n            [sA2 * (_r2 + lW3), _h2, cA2 * (_r2 + lW3)],\r\n        ))\r\n\r\n\r\n\r\n\r\n\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA2 * 2, _h2, cA2 * 2],\r\n            [sin(angle1) * 2, _h2, cA1 * 2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl6\r\n        _r1 = 2\r\n        _r2 = 7\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        /** top con */\r\n\r\n        const lW2 = lW\r\n        vertTopElem.push(...createFace(\r\n            [sA2 * (_r1 + lW2), _h1, cA2 * (_r1 + lW2)],\r\n            [sA1 * (_r1 + lW2), _h1, cA1 * (_r1 + lW2)],\r\n            [sA1 * (_r2 + lW2), _h2, cA1 * (_r2 + lW2)],\r\n            [sA2 * (_r2 + lW2), _h2, cA2 * (_r2 + lW2)],\r\n        ))\r\n\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h2 + hl6\r\n        vertTopElem.push(\r\n            sA1 * _r2, _h1, cA1 * _r2,\r\n            sA2 * _r2, _h1, cA2 * _r2,\r\n            0, _h2, 0,\r\n        )\r\n        vertTopElem.push(\r\n            sA2 * (_r2 + .5), _h1, cA2 * (_r2 + .5),\r\n            sA1 * (_r2 + .5), _h1, cA1 * (_r2 + .5),\r\n            0, _h2 + 3, 0,\r\n        )\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        colorsTopElem.push(\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(lCol),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(lCol),\r\n            ...color1,\r\n            ...color1,\r\n            ...color1,\r\n            ...lCol,\r\n            ...lCol,\r\n            ...lCol,\r\n        )\r\n\r\n        uvTopElem.push(\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, 1], [0, 1], [0, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, 1], [0, 1], [0, 1], [0, 1],),\r\n            ...[0, .5],\r\n            ...[.5, .5],\r\n            ...[.25, 1],\r\n\r\n            ...[0, 1],\r\n            ...[0, 1],\r\n            ...[0, 1],\r\n        )\r\n\r\n    }\r\n\r\n\r\n    return {\r\n        vertTopElem,\r\n        colorsTopElem,\r\n        uvTopElem,\r\n    }\r\n}","import {\r\n    translateArr,\r\n    rotateArr,\r\n} from './helpers'\r\n\r\n\r\nimport { createDataColumn } from './dataColumn'\r\nimport { createSimpleColumn } from './dataColumnSimple'\r\nimport { createDataArcHalf } from './dataArcHalf'\r\nimport { createTopElem } from './dataTopElem'\r\nimport { createDataStairSimple } from './dataStairSimple'\r\n\r\n\r\nconst colorB = [0, 0, 0]\r\n\r\n\r\n\r\nexport const createSegmentStair = (data, color1, color2,) => {\r\n    const { h, r, x, z, bridgeL, bridgeMinusH, hColumn, rColumn, i } = data\r\n\r\n    const hh = h - 5\r\n    const hCol = Math.min(hColumn * (Math.random() * 0.35 + 0.1), 50)\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n    const collisionCar = []\r\n\r\n\r\n\r\n    /** stairs **/\r\n    const stair = createDataStairSimple({ h, hh, colorB, color2, bridgeL, bridgeMinusH, r })\r\n    v.push(...stair.v)\r\n    c.push(...stair.c)\r\n    u.push(...stair.u)\r\n    collision.push(...stair.collision)\r\n\r\n\r\n\r\n    /** bottom part column */\r\n    const column = createDataColumn({\r\n        h0: hh - hColumn - .1,\r\n        h1: hh - hCol,\r\n        capTop: true,\r\n        capBottom: true,\r\n    })\r\n    translateArr(column.v, r, 0, r)\r\n    v.push(...column.v)\r\n    c.push(...column.c)\r\n    u.push(...column.u)\r\n    translateArr(column.collision, r, 0, r)\r\n    collision.push(...column.collision)\r\n    if (column.collisionCar) {\r\n        translateArr(column.collisionCar, r, 0, r)\r\n        collisionCar.push(...column.collisionCar)\r\n    }\r\n\r\n\r\n\r\n    /** top part column */\r\n    const simpleColumn = createSimpleColumn({ isColumn: true, h1: hh - hCol, h2: hh, color1:[0, 0, 0], color2})\r\n    translateArr(simpleColumn.vertColumn, r, 0, r)\r\n    v.push(...simpleColumn.vertColumn)\r\n    c.push(...simpleColumn.colorsColumn)\r\n    u.push(...simpleColumn.uvColumn)\r\n\r\n\r\n\r\n    /** arc */\r\n    const arcL = 40\r\n    const hArc = hCol\r\n    const halfArcData = createDataArcHalf({ hArc, arcL, color2 })\r\n    translateArr(halfArcData.v, r - rColumn - arcL, hh - hCol, r)\r\n    v.push(...halfArcData.v)\r\n    c.push(...halfArcData.c)\r\n    u.push(...halfArcData.u)\r\n\r\n\r\n\r\n    /** top elem **/\r\n    if (data.isTop) {\r\n        const topElemData = createTopElem({\r\n            isTopElem: true,\r\n            color1: [0, 0, 0],\r\n            color2,\r\n            h2: hh,\r\n        })\r\n        translateArr(topElemData.vertTopElem, r, 0, r)\r\n        v.push(...topElemData.vertTopElem)\r\n        c.push(...topElemData.colorsTopElem)\r\n        u.push(...topElemData.uvTopElem)\r\n    }\r\n\r\n\r\n\r\n    rotateArr(v, Math.PI - ((Math.PI / 2) * (i)))\r\n    translateArr(v, x, 0, z)\r\n    rotateArr(collision, Math.PI - ((Math.PI / 2) * (i)))\r\n    translateArr(collision, x, 0, z)\r\n    rotateArr(collisionCar, Math.PI - ((Math.PI / 2) * (i)))\r\n    translateArr(collisionCar, x, 0, z)\r\n\r\n\r\n\r\n    return { v, c, u, collision, collisionCar }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n} from \"./helpers\";\r\n\r\n\r\nexport const createDataStairSimple = ({\r\n    r,\r\n    h,\r\n    hh,\r\n    bridgeMinusH,\r\n    bridgeL,\r\n    color2,\r\n    colorB\r\n}) => {\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n\r\n    v.push(\r\n        /** place */\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, r],\r\n            [r, hh, r],\r\n            [r, h, r],\r\n            [-r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, -r],\r\n            [-r, hh, r],\r\n            [-r, h, r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, r],\r\n            [r, hh, -r],\r\n            [r, h, -r],\r\n            [r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [-r, hh, -r],\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n        ),\r\n\r\n        // bottom\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [r, hh, r],\r\n            [-r, hh, r],\r\n            [-r, hh, -r],\r\n        ),\r\n\r\n        /** connect */\r\n\r\n        ...createFace(\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh - bridgeMinusH, -r - bridgeL],\r\n            [-r, hh, -r],\r\n            [-r, h, -r],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n\r\n\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, hh, -r],\r\n            [-r, hh, -r],\r\n        ),\r\n    )\r\n\r\n\r\n    c.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n    )\r\n\r\n    u.push(\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n    )\r\n\r\n    collision.push(\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n        ...createFace(\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n    )\r\n\r\n\r\n\r\n    return { v, c , u, collision }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n    translateArr,\r\n    rotateArr,\r\n} from \"./helpers\";\r\n\r\n/**\r\n  1 2 3\r\n  4 5 6\r\n  7 8 9\r\n */\r\n\r\nconst P_1 = [\r\n    [-70, -30],\r\n    [-30, -30],\r\n    [-30, -70],\r\n    [-70, -70],\r\n]\r\n\r\nconst P_2 = [\r\n    [-30, -30],\r\n    [30, -30],\r\n    [30, -70],\r\n    [-30, -70],\r\n]\r\n\r\nconst P_3 = [\r\n    [30, -30],\r\n    [70, -30],\r\n    [70, -70],\r\n    [30, -70],\r\n]\r\n\r\nconst P_6 = [\r\n    [30, 30],\r\n    [70, 30],\r\n    [70, -30],\r\n    [30, -30],\r\n]\r\n\r\nconst P_7 = [\r\n    [-70, 70],\r\n    [-30, 70],\r\n    [-30, 30],\r\n    [-70, 30]\r\n]\r\n\r\nconst P_8 = [\r\n    [-30, 70],\r\n    [30, 70],\r\n    [30, 30],\r\n    [-30, 30]\r\n]\r\n\r\nconst P_9 = [\r\n    [30, 70],\r\n    [70, 70],\r\n    [70, 30],\r\n    [30, 30]\r\n]\r\n\r\nconst SH_BY_DIR = {\r\n    'N': [ P_7 ],\r\n    'W': [ P_7, P_8, P_9 ],\r\n    'S': [ P_7, P_8, P_9, P_6, P_3 ],\r\n    'E': [ P_7, P_8, P_9, P_6, P_3, P_2, P_1 ],\r\n}\r\n\r\nexport const createDataZone = ({\r\n    xCenter,\r\n    zCenter,\r\n    h,\r\n    dir,\r\n    color2 = [0, .7, 0],\r\n    colorB = [0, 0, 0],\r\n}) => {\r\n    const hh = h - 3\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n    if (SH_BY_DIR[dir]) {\r\n        for (let i = 0; i < SH_BY_DIR[dir].length; ++i) {\r\n            const coord = SH_BY_DIR[dir][i]\r\n            v.push(\r\n                /** top */\r\n                ...createFace(\r\n                    [coord[0][0], h, coord[0][1]],\r\n                    [coord[1][0], h, coord[1][1]],\r\n                    [coord[2][0], h, coord[2][1]],\r\n                    [coord[3][0], h, coord[3][1]],\r\n                ),\r\n                /** bottom */\r\n                ...createFace(\r\n                    [coord[3][0], hh, coord[3][1]],\r\n                    [coord[2][0], hh, coord[2][1]],\r\n                    [coord[1][0], hh, coord[1][1]],\r\n                    [coord[0][0], hh, coord[0][1]],\r\n                ),\r\n                /** side */\r\n                ...createFace(\r\n                    [coord[0][0], hh, coord[0][1]],\r\n                    [coord[1][0], hh, coord[1][1]],\r\n                    [coord[1][0], h, coord[1][1]],\r\n                    [coord[0][0], h, coord[0][1]],\r\n                ),\r\n                ...createFace(\r\n                    [coord[1][0], hh, coord[1][1]],\r\n                    [coord[2][0], hh, coord[2][1]],\r\n                    [coord[2][0], h, coord[2][1]],\r\n                    [coord[1][0], h, coord[1][1]],\r\n                ),\r\n                ...createFace(\r\n                    [coord[2][0], hh, coord[2][1]],\r\n                    [coord[3][0], hh, coord[3][1]],\r\n                    [coord[3][0], h, coord[3][1]],\r\n                    [coord[2][0], h, coord[2][1]],\r\n                ),\r\n                ...createFace(\r\n                    [coord[3][0], hh, coord[3][1]],\r\n                    [coord[0][0], hh, coord[0][1]],\r\n                    [coord[0][0], h, coord[0][1]],\r\n                    [coord[3][0], h, coord[3][1]],\r\n                ),\r\n\r\n\r\n            )\r\n            c.push(\r\n                ...fillColorFace(color2),\r\n                ...fillColorFace(color2),\r\n                ...fillColorFace(colorB),\r\n                ...fillColorFace(colorB),\r\n                ...fillColorFace(colorB),\r\n                ...fillColorFace(colorB),\r\n            )\r\n            u.push(\r\n                ...uvBr,\r\n                ...uvBr,\r\n                ...uvCl,\r\n                ...uvCl,\r\n                ...uvCl,\r\n                ...uvCl,\r\n            )\r\n\r\n            collision.push(\r\n                ...createFace(\r\n                    [coord[0][0], h, coord[0][1]],\r\n                    [coord[1][0], h, coord[1][1]],\r\n                    [coord[2][0], h, coord[2][1]],\r\n                    [coord[3][0], h, coord[3][1]],\r\n                ),\r\n            )\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    translateArr(v, xCenter, 0, zCenter)\r\n    translateArr(collision, xCenter, 0, zCenter)\r\n\r\n\r\n\r\n    return { v, c , u, collision }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n    translateArr,\r\n    rotateArr,\r\n} from \"./helpers\";\r\n\r\nimport { createTopElem } from './dataTopElem'\r\nimport { createDataColumn } from \"./dataColumn\";\r\n\r\n\r\nconst color1 = [0, 0, 0]\r\nconst color2 = [0, .7, 0]\r\nconst R = {\r\n    'N': 0,\r\n    'E': -Math.PI * .5,\r\n    'S': Math.PI,\r\n    'W': Math.PI * .5\r\n}\r\n\r\n\r\nexport const createDataBridge = ({\r\n    centerBridgeX, \r\n    centerBridgeZ, \r\n    h, \r\n    dir, \r\n    lenBridge,\r\n}) => {\r\n\r\n\r\n\r\n    const hh = h - 3\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n\r\n\r\n    const r = 20\r\n\r\n\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n    const collisionCar = []\r\n\r\n\r\n\r\n    let savedSeg = 0\r\n    let currentSeg = Math.random() * 120 + 30\r\n    let zSegS = (lenBridge / 2)\r\n    let zSegE = (lenBridge / 2)\r\n\r\n\r\n\r\n    while (currentSeg < lenBridge - 20) {\r\n        zSegS = (lenBridge / 2) - savedSeg\r\n        zSegE = (lenBridge / 2) - currentSeg\r\n\r\n        const columnL = createDataColumn({\r\n            h0: -20,\r\n            h1: h - 1,\r\n            rCapital: 9,\r\n            rBase: 5,\r\n            capTop: true,\r\n            capBottom: false,\r\n        })\r\n        translateArr(columnL.v, -20, 0, zSegE)\r\n        for (let i = 0; i < columnL.v.length; ++i) v.push(columnL.v[i])\r\n        for (let i = 0; i < columnL.c.length; ++i) c.push(columnL.c[i])\r\n        for (let i = 0; i < columnL.u.length; ++i) u.push(columnL.u[i])\r\n        translateArr(columnL.collision, -20, 0, zSegE)\r\n        for (let i = 0; i < columnL.collision.length; ++i) collision.push(columnL.collision[i])\r\n        translateArr(columnL.collisionCar, -20, 0, zSegE)\r\n        for (let i = 0; i < columnL.collisionCar.length; ++i) collisionCar.push(columnL.collisionCar[i])\r\n\r\n        const columnR = createDataColumn({\r\n            h0: -20,\r\n            h1: h - 1,\r\n            rCapital: 9,\r\n            rBase: 5,\r\n            capTop: true,\r\n            capBottom: false,\r\n        })\r\n\r\n        translateArr(columnR.v, 20, 0, zSegE)\r\n        for (let i = 0; i < columnR.v.length; ++i) v.push(columnR.v[i])\r\n        for (let i = 0; i < columnR.c.length; ++i) c.push(columnR.c[i])\r\n        for (let i = 0; i < columnR.u.length; ++i) u.push(columnR.u[i])\r\n        translateArr(columnR.collision, 20, 0, zSegE)\r\n        for (let i = 0; i < columnR.collision.length; ++i) collision.push(columnR.collision[i])\r\n        translateArr(columnR.collisionCar, 20, 0, zSegE)\r\n        for (let i = 0; i < columnR.collisionCar.length; ++i) collisionCar.push(columnR.collisionCar[i])\r\n\r\n\r\n        const topElemL =  createTopElem({\r\n            isTopElem: true,\r\n            color1,\r\n            color2,\r\n            h2: h - 1,\r\n        })\r\n\r\n        translateArr(topElemL.vertTopElem, -20, 0, zSegE)\r\n        v.push(...topElemL.vertTopElem)\r\n        c.push(...topElemL.colorsTopElem)\r\n        u.push(...topElemL.uvTopElem)\r\n\r\n        const topElemR = createTopElem({\r\n            isTopElem: true,\r\n            color1,\r\n            color2,\r\n            h2: h - 1,\r\n        })\r\n\r\n        translateArr(topElemR.vertTopElem, 20, 0, zSegE)\r\n        v.push(...topElemR.vertTopElem)\r\n        c.push(...topElemR.colorsTopElem)\r\n        u.push(...topElemR.uvTopElem)\r\n\r\n        savedSeg = currentSeg\r\n        currentSeg += Math.random() * 120 + 30\r\n\r\n        v.push(\r\n            /** place */\r\n            ...createFace(\r\n                [-r, h, zSegS],\r\n                [r, h, zSegS],\r\n                [r, h, zSegE],\r\n                [-r, h, zSegE],\r\n            ),\r\n\r\n            ...createFace(\r\n                [-r, hh, zSegE],\r\n                [-r, hh, zSegS],\r\n                [-r, h, zSegS],\r\n                [-r, h, zSegE],\r\n            ),\r\n\r\n            ...createFace(\r\n                [r, hh, zSegS],\r\n                [r, hh, zSegE],\r\n                [r, h, zSegE],\r\n                [r, h, zSegS],\r\n            ),\r\n\r\n            // bottom\r\n            ...createFace(\r\n                [r, hh, zSegE],\r\n                [r, hh, zSegS],\r\n                [-r, hh, zSegS],\r\n                [-r, hh, zSegE],\r\n            ),\r\n        )\r\n\r\n\r\n        c.push(\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color2),\r\n        )\r\n\r\n        u.push(\r\n            ...uvBr,\r\n            ...uvCl,\r\n            ...uvCl,\r\n            ...uvBr,\r\n        )\r\n\r\n        collision.push(\r\n            ...createFace(\r\n                [-r, h, zSegS],\r\n                [r, h, zSegS],\r\n                [r, h, zSegE],\r\n                [-r, h, zSegE],\r\n            ),\r\n        )\r\n    }\r\n\r\n\r\n    v.push(\r\n        /** place */\r\n        ...createFace(\r\n            [-r, h, zSegE],\r\n            [r, h, zSegE],\r\n            [r, h, -lenBridge / 2],\r\n            [-r, h, -lenBridge / 2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, -lenBridge / 2],\r\n            [-r, hh, zSegE],\r\n            [-r, h, zSegE],\r\n            [-r, h, -lenBridge / 2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, zSegE],\r\n            [r, hh, -lenBridge / 2],\r\n            [r, h, -lenBridge / 2],\r\n            [r, h, zSegE],\r\n        ),\r\n\r\n        // bottom\r\n        ...createFace(\r\n            [r, hh, -lenBridge / 2],\r\n            [r, hh, zSegE],\r\n            [-r, hh, zSegE],\r\n            [-r, hh, -lenBridge / 2],\r\n        ),\r\n    )\r\n\r\n\r\n    c.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color2),\r\n    )\r\n\r\n    u.push(\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n    )\r\n\r\n    collision.push(\r\n        ...createFace(\r\n            [-r, h, zSegE],\r\n            [r, h, zSegE],\r\n            [r, h, -lenBridge / 2],\r\n            [-r, h, -lenBridge / 2],\r\n        ),\r\n    )\r\n\r\n\r\n    translateArr(v, -50, 0, 0)   \r\n    rotateArr(v, R[dir])\r\n    translateArr(v, centerBridgeX, 0, centerBridgeZ)\r\n    \r\n    translateArr(collision, -50, 0, 0)  \r\n    rotateArr(collision, R[dir])\r\n    translateArr(collision, centerBridgeX, 0, centerBridgeZ)\r\n\r\n    translateArr(collisionCar, -50, 0, 0)\r\n    rotateArr(collisionCar, R[dir])\r\n    translateArr(collisionCar, centerBridgeX, 0, centerBridgeZ)\r\n\r\n\r\n    return { v, c , u, collision, collisionCar }\r\n}","const createSet = ({ xCenter, zCenter, hStart, hEnd, count }) => {\r\n    const r = 20\r\n    const hDiff = hEnd - hStart\r\n    const stepH = hDiff / count\r\n\r\n\r\n    const tickness = 7\r\n    const rColumn = 3\r\n    const offset = 50\r\n\r\n    const lBridge = offset + offset - r - r\r\n\r\n    const scheme = []\r\n\r\n    for (let i = 0; i < count; ++i) {\r\n        let hColumn = stepH * (4)\r\n        if (i < 4) {\r\n             hColumn = hStart + (i * stepH) + 15\r\n        }\r\n\r\n        const h = stepH * i + hStart\r\n        const hh = h - tickness + hStart\r\n\r\n        //const hColumn = stepH * 4\r\n\r\n\r\n        let x = xCenter\r\n        let z = zCenter\r\n\r\n        const p = i % 4\r\n        if (p < 1) {\r\n            x = xCenter - offset\r\n            z = zCenter - offset\r\n        } else if (p < 2) {\r\n            x = xCenter + offset\r\n            z = zCenter - offset\r\n        } else if (p < 3) {\r\n            x = xCenter + offset\r\n            z = zCenter + offset\r\n        } else if (p < 4) {\r\n            x = xCenter - offset\r\n            z = zCenter + offset\r\n        }\r\n\r\n        scheme.push({\r\n            type: 'stairs',\r\n            offset,\r\n            h,\r\n            hh,\r\n            r,\r\n            x,\r\n            z,\r\n            bridgeMinusH: stepH,\r\n            bridgeL: lBridge,\r\n            hColumn,\r\n            rColumn,\r\n            i,\r\n            isTop: count - i < 5,\r\n        })\r\n    }\r\n\r\n    return scheme\r\n}\r\n\r\n\r\nconst D = ['N', 'E', 'S', 'W']\r\nconst C = { 'N': 1, 'E': 2, 'S': 3, 'W': 4}\r\nconst OFFSET = {\r\n    'N': [0, -1],\r\n    'E': [1, 0],\r\n    'S': [0, 1],\r\n    'W': [-1, 0],\r\n}\r\nconst STAIR_WIDTH = 140 \r\n\r\nexport const createSchemeSuper = () => {\r\n    const arr = []\r\n\r\n    let h = 0\r\n    let xCenter = 0\r\n    let zCenter = 0\r\n\r\n    let currentDir = 'N'\r\n\r\n    for (let i = 0; i < 5; ++i) {\r\n        const nextDir = D[Math.floor(Math.random() * D.length)]\r\n        const lenBridge = Math.random() * 400 + 30\r\n        const nextXCenter = xCenter + (OFFSET[nextDir][0] * (STAIR_WIDTH + lenBridge))\r\n        const nextZCenter = zCenter + (OFFSET[nextDir][1] * (STAIR_WIDTH + lenBridge))\r\n\r\n        \r\n        /** stair set */\r\n        const count = C[nextDir] + 4 * Math.floor(Math.random() * 2)\r\n        const hEnd = h + count * 30\r\n        const data = { xCenter, zCenter, hStart: h, hEnd, count }\r\n        const setStair = createSet(data)\r\n        arr.push(...setStair)\r\n\r\n\r\n        /** next platform */\r\n        if (i !== 0) {\r\n            arr.push({ xCenter, zCenter, h: h - 30, type: 'zone', nextDir, dir: currentDir })\r\n        }\r\n        \r\n\r\n        /** bridge */\r\n        if (i !== 5 - 1) {\r\n            const centerBridgeX = (nextXCenter - xCenter) / 2 + xCenter\r\n            const centerBridgeZ = (nextZCenter - zCenter) / 2 + zCenter\r\n            arr.push({ centerBridgeX, centerBridgeZ, h: hEnd - 30, dir: nextDir, lenBridge, type: 'bridge' })\r\n        }\r\n\r\n        \r\n        /** move center */\r\n        xCenter = nextXCenter\r\n        zCenter = nextZCenter\r\n        h = hEnd\r\n        currentDir = nextDir\r\n    }\r\n\r\n    return arr\r\n}","import * as THREE from 'three'\r\n\r\nimport { createSegmentStair } from './geometry/segmentStair'\r\nimport { createDataZone } from './geometry/dataZone'\r\nimport { createDataBridge } from './geometry/dataBridge'\r\n//import { createSchemeStairs } from './geometry/schemeStairs'\r\nimport { createSchemeSuper } from './geometry/schemeSuper'\r\n\r\n\r\n\r\n\r\nexport const createMeshSuper = (root) => {\r\n    const scheme = createSchemeSuper()\r\n\r\n\r\n    const vertP = []\r\n    const colorsP = []\r\n    const uvTopP = []\r\n    const coll = []\r\n    const collisionCarA = []\r\n\r\n\r\n    for (let i = 0; i < scheme.length; ++i) {\r\n        if (scheme[i].type === 'stairs') {\r\n            const { v, c, u, collision, collisionCar } = createSegmentStair(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            vertP.push(...v)\r\n            colorsP.push(...c)\r\n            uvTopP.push(...u)\r\n            coll.push(...collision)\r\n            if (collisionCar) {\r\n                collisionCarA.push(...collisionCar)\r\n            }\r\n        }\r\n        if (scheme[i].type === 'zone') {\r\n            const { v, c, u, collision } = createDataZone(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            vertP.push(...v)\r\n            colorsP.push(...c)\r\n            uvTopP.push(...u)\r\n            coll.push(...collision)\r\n        }\r\n        if (scheme[i].type === 'bridge') {\r\n            const { v, c, u, collision, collisionCar } = createDataBridge(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            for (let i = 0; i < v.length; ++i) vertP.push(v[i])\r\n            for (let i = 0; i < c.length; ++i) colorsP.push(c[i])\r\n            for (let i = 0; i < u.length; ++i) uvTopP.push(u[i])\r\n            for (let i = 0; i < collision.length; ++i) coll.push(collision[i])\r\n            if (collisionCar) {\r\n                for (let i = 0; i < collisionCar.length; ++i) collisionCarA.push(collisionCar[i])\r\n            }\r\n        }\r\n    }\r\n    /** triangle fix bug collision */\r\n    coll.push(-50, 1000, 0, 0, 1000, 0, 0, 1000, -50)\r\n\r\n\r\n\r\n    const vertices = new Float32Array(vertP)\r\n    const colors =  new Float32Array(colorsP)\r\n    const uv = new Float32Array(uvTopP)\r\n    const collision = new Float32Array(coll)\r\n\r\n\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( colors, 3 ))\r\n    uv && geometry.setAttribute('uv', new THREE.BufferAttribute( uv, 2 ))\r\n    geometry.computeVertexNormals()\r\n\r\n\r\n    const mat = root.materials.wallVirtualColor\r\n    const mesh = new THREE.Mesh(geometry, mat)\r\n\r\n\r\n    const collGeom = new THREE.BufferGeometry() \r\n    collGeom.setAttribute('position', new THREE.BufferAttribute(collision, 3))\r\n    const collMat = new THREE.MeshBasicMaterial({ color: 0xFF0000 })\r\n    const meshCollision = new THREE.Mesh(collGeom, collMat)\r\n\r\n    const verticesCar = new Float32Array(collisionCarA)\r\n    const geometryCollCar = new THREE.BufferGeometry();\r\n    geometryCollCar.setAttribute('position', new THREE.BufferAttribute(verticesCar, 3))\r\n    const meshCollisionCar = new THREE.Mesh(geometryCollCar, collMat)\r\n\r\n    /** finish coord */\r\n    let lastXYZ\r\n    for (let i = scheme.length - 1; i > -1; --i) {\r\n        if (scheme[i].type && scheme[i].type === 'stairs') {\r\n            lastXYZ = [scheme[i].x, scheme[i].h, scheme[i].z]\r\n            const n = Math.floor(scheme[i].i % 4)\r\n            if (n === 0) {\r\n                lastXYZ[2] -= 60\r\n            }\r\n            if (n === 1) {\r\n                lastXYZ[0] += 60\r\n            }\r\n            if (n === 2) {\r\n                lastXYZ[2] += 60\r\n            }\r\n            if (n === 3) {\r\n                lastXYZ[0] -= 60\r\n            }\r\n\r\n            break;\r\n        }\r\n    }\r\n    const meshFinish = new THREE.Mesh(\r\n        new THREE.BoxGeometry(30, 30, 30),\r\n        new THREE.MeshBasicMaterial({ color: 0xFF00FF })\r\n    )\r\n    meshFinish.position.set(\r\n        lastXYZ[0],\r\n        lastXYZ[1],\r\n        lastXYZ[2],\r\n    )\r\n\r\n    return { mesh, meshCollision, meshCollisionCar, meshFinish, lastXYZ }\r\n}\r\n","import { createDataColumn } from './dataColumn'\r\nimport { createDataSideArc } from \"./dataArc\";\r\nimport { createTopElem } from \"./dataTopElem\";\r\nimport { createSimpleColumn } from './dataColumnSimple'\r\n\r\n\r\n\r\nconst color1 = [0, 0, 0]\r\nconst color2 = [0, .7, 0]\r\n\r\nexport const createSegmentGallery = ({\r\n    h0 = 0,\r\n    h1 = 30,\r\n    h2 = 60,\r\n    arc = false,\r\n    isTopElem = false,\r\n    isColumn = false\r\n}) => {\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n    const collisionCar = []\r\n\r\n    /** arc */\r\n    if (arc) {\r\n        const arcData = createDataSideArc({ h1, h2, color1, color2, ...arc })\r\n        v.push(...arcData.v)\r\n        c.push(...arcData.c)\r\n        u.push(...arcData.u)\r\n    }\r\n\r\n\r\n    /** column */\r\n    const rCapital = 6\r\n    const rBase = 5\r\n    const columnData = createDataColumn({\r\n        h0,\r\n        h1,\r\n        color1,\r\n        color2,\r\n        rCapital,\r\n        rBase,\r\n        capTop: true,\r\n        capBottom: true\r\n    })\r\n    v.push(...columnData.v)\r\n    c.push(...columnData.c)\r\n    u.push(...columnData.u)\r\n    collision.push(...columnData.collision)\r\n    if (columnData.collisionCar) {\r\n        collisionCar.push(...columnData.collisionCar)\r\n    }\r\n\r\n\r\n    /** top elem */\r\n    const {\r\n        vertTopElem,\r\n        colorsTopElem,\r\n        uvTopElem,\r\n    } = createTopElem({ h2, color1, color2, isTopElem })\r\n    v.push(...vertTopElem)\r\n    c.push(...colorsTopElem)\r\n    u.push(...uvTopElem)\r\n\r\n    /** simple column */\r\n    const {\r\n        vertColumn,\r\n        colorsColumn,\r\n        uvColumn,\r\n    } = createSimpleColumn({ isColumn, h1, h2, color1, color2 })\r\n    v.push(...vertColumn)\r\n    c.push(...colorsColumn)\r\n    u.push(...uvColumn)\r\n\r\n\r\n    return { v, c, u, collision, collisionCar }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\n\r\nexport const createDataSideArc = ({\r\n    h1,\r\n    h2,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n    r = 5,\r\n    rCap = 7,\r\n    wCol = 3,\r\n    w = 40,\r\n}) => {\r\n    const lBridge = w - (r * 2)\r\n    const zArc = - r - lBridge\r\n\r\n    const lCapital = Math.min((h2 - h1) * 0.1, 2)\r\n    const hC = h2 - lCapital\r\n\r\n\r\n\r\n    let _h1 = h1\r\n    let _h2 = hC\r\n    /** front **************/\r\n    const columnF = [...createFace(\r\n        [-wCol, _h1, r,],\r\n        [wCol, _h1, r],\r\n        [wCol, _h2, r],\r\n        [-wCol, _h2, r],\r\n    )]\r\n    const colorFill2 = [...fillColorFace(color2)]\r\n    const colorFill1 = [...fillColorFace(color1)]\r\n    const uv1 = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.5, 1],\r\n        [0, 1],\r\n    )\r\n\r\n    /** left / right *****************/\r\n    const column = [\r\n        ...createFace(\r\n            [-wCol, _h1, -r,],\r\n            [-wCol, _h1, r],\r\n            [-wCol, _h2, r],\r\n            [-wCol, _h2, -r],\r\n        ),\r\n        ...createFace(\r\n            [wCol, _h1, r,],\r\n            [wCol, _h1, -r],\r\n            [wCol, _h2, -r],\r\n            [wCol, _h2, r],\r\n        )\r\n    ]\r\n    /** back Column *********/\r\n    const columnB = [\r\n        ...createFace(\r\n            [wCol, _h1, -r,],\r\n            [-wCol, _h1, -r],\r\n            [-wCol, _h2, -r],\r\n            [wCol, _h2, -r],\r\n        ),\r\n    ]\r\n\r\n\r\n\r\n\r\n    /** arc ******************/\r\n    const arc = []\r\n    const cA = []\r\n    const uvA = []\r\n    const x = -wCol + 2\r\n    const x2 = wCol - 2\r\n    const resolution = 14\r\n    const step = lBridge / resolution\r\n    const diff = _h2 - _h1\r\n    const offsetArcTop = diff * 0.15\r\n\r\n\r\n    for (let i = 0; i < resolution; ++i) {\r\n        const hI1 = (1 - Math.sin((i + 1) / resolution * Math.PI)) * (diff - offsetArcTop) + offsetArcTop\r\n        const hI2 = (1 - Math.sin(i / resolution * Math.PI)) * (diff - offsetArcTop) + offsetArcTop\r\n        let tZ = -r\r\n        if (i + 1 > resolution / 2) {\r\n            tZ = -r - lBridge\r\n        }\r\n        /** left arc */\r\n        arc.push(\r\n            x,   _h2 - hI1,    -r - ((i + 1) * step),\r\n            x,   _h2 - hI2,    -r - (i * step),\r\n            x,   _h2,          tZ,\r\n        )\r\n        cA.push(\r\n            ...color2,\r\n            ...color2,\r\n            ...color2,\r\n        )\r\n        uvA.push(\r\n            0, 0,\r\n            .3, 0,\r\n            .3, .3,\r\n        )\r\n        /** right arc */\r\n        arc.push(\r\n            x2,   _h2 - hI2,    -r - (i * step),\r\n            x2,   _h2 - hI1,    -r - ((i + 1) * step),\r\n            x2,   _h2,          tZ,\r\n        )\r\n        cA.push(\r\n            ...color2,\r\n            ...color2,\r\n            ...color2,\r\n        )\r\n        uvA.push(\r\n            0, 0,\r\n            .3, 0,\r\n            .3, .3,\r\n        )\r\n        /** bottom arc */\r\n        arc.push(...createFace(\r\n            [x2, _h2 - hI2, -r - (i * step)],\r\n            [x,  _h2 - hI2, -r - (i * step)],\r\n            [x,  _h2 - hI1, -r - ((i + 1) * step)],\r\n            [x2, _h2 - hI1, -r - ((i + 1) * step)],\r\n        ))\r\n        cA.push(...colorFill1)\r\n        uvA.push(...createUv([0, 0], [0, 0], [0, 0], [0, 0]))\r\n\r\n    }\r\n\r\n    arc.push(\r\n        x,   _h2 - offsetArcTop,     -r - step * resolution / 2,\r\n        x,   _h2,                    -r,\r\n        x,   _h2,                    -r - step * resolution,\r\n    )\r\n    cA.push(\r\n        ...color2,\r\n        ...color2,\r\n        ...color2,\r\n    )\r\n    uvA.push(\r\n        .5, .25,\r\n        .25, .3,\r\n        .25, .2,\r\n    )\r\n\r\n    arc.push(\r\n        x2,   _h2 - offsetArcTop,    -r - step * resolution / 2,\r\n        x2,   _h2,                   -r - step * resolution,\r\n        x2,   _h2,                   -r,\r\n    )\r\n    cA.push(\r\n        ...color2,\r\n        ...color2,\r\n        ...color2,\r\n    )\r\n    uvA.push(\r\n        .5, .25,\r\n        .25, .3,\r\n        .25, .2,\r\n    )\r\n\r\n\r\n\r\n    _h1 = _h2\r\n    _h2 = h2\r\n    /** capitel *****************/\r\n    const cap = [\r\n        ...createFace(\r\n            [-rCap, _h1, -rCap,],\r\n            [rCap, _h1, -rCap],\r\n            [rCap, _h1, rCap],\r\n            [-rCap, _h1, rCap],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rCap, _h1, rCap,],\r\n            [rCap, _h1, rCap],\r\n            [rCap, _h2, rCap],\r\n            [-rCap, _h2, rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap, _h1, -rCap,],\r\n            [-rCap, _h1, rCap],\r\n            [-rCap, _h2, rCap],\r\n            [-rCap, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [rCap, _h1, rCap,],\r\n            [rCap, _h1, -rCap],\r\n            [rCap, _h2, -rCap],\r\n            [rCap, _h2, rCap],\r\n        ),\r\n        ...createFace(\r\n            [rCap, _h1, -rCap,],\r\n            [-rCap, _h1, -rCap],\r\n            [-rCap, _h2, -rCap],\r\n            [rCap, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap, _h2, rCap,],\r\n            [rCap, _h2, rCap],\r\n            [rCap, _h2, -rCap],\r\n            [-rCap, _h2, -rCap],\r\n        ),\r\n        //////\r\n        ...createFace(\r\n            [-rCap + 2, _h1, zArc],\r\n            [rCap - 2, _h1, zArc],\r\n            [rCap - 2, _h1, -rCap],\r\n            [-rCap + 2, _h1, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap + 2, _h1, zArc],\r\n            [-rCap + 2, _h1, -rCap],\r\n            [-rCap + 2, _h2, -rCap],\r\n            [-rCap + 2, _h2, zArc],\r\n        ),\r\n        ...createFace(\r\n            [rCap - 2, _h1, -rCap],\r\n            [rCap - 2, _h1, zArc],\r\n            [rCap - 2, _h2, zArc],\r\n            [rCap - 2, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap + 2, _h2, -rCap],\r\n            [rCap - 2, _h2, -rCap],\r\n            [rCap - 2, _h2, zArc],\r\n            [-rCap + 2, _h2, zArc],\r\n        ),\r\n\r\n    ]\r\n\r\n\r\n\r\n    const v = [\r\n        ...columnF,\r\n        ...column,\r\n        ...columnB,\r\n        ...arc,\r\n        ...cap,\r\n    ]\r\n    const c = [\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...cA,\r\n\r\n\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n    ]\r\n    const u = [\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uvA,\r\n\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n    ]\r\n\r\n    return { v, c, u }\r\n}","import * as THREE from 'three'\r\nimport {\r\n    translateArr,\r\n    rotateArr,\r\n} from './geometry/helpers'\r\nimport { createScheme } from './geometry/schemeGallery'\r\nimport { createSegmentGallery } from './geometry/segmentGallery'\r\n\r\n\r\n\r\nexport const createMeshGallery = (root) => {\r\n\r\n\r\n\r\n    const arrV = []\r\n    const arrC = []\r\n    const arrUV = []\r\n    const coll = []\r\n    const carColl = []\r\n\r\n    const scheme = createScheme()\r\n\r\n    for (let i = 0; i < scheme.length; ++i) {\r\n        const { id, x, z, angle, h0, h1, h2, arc, isTopElem, isColumn } = scheme[i]\r\n\r\n        let { v, c, u, collision, collisionCar } = createSegmentGallery({ h0, h1, h2, arc, isTopElem, isColumn })\r\n\r\n        rotateArr(v, angle)\r\n        translateArr(v, x, 0, z, angle)\r\n\r\n        if (collision) {\r\n            rotateArr(collision, angle)\r\n            translateArr(collision, x, 0, z)\r\n            coll.push(...collision)\r\n        }\r\n\r\n        if (collisionCar) {\r\n            rotateArr(collisionCar, angle)\r\n            translateArr(collisionCar, x, 0, z)\r\n            carColl.push(...collisionCar)\r\n        }\r\n\r\n\r\n        arrV.push(...v)\r\n        arrC.push(...c)\r\n        arrUV.push(...u)\r\n    }\r\n\r\n\r\n    const vertices = new Float32Array(arrV)\r\n    const colors =  new Float32Array(arrC)\r\n    const uv = new Float32Array(arrUV)\r\n\r\n    /** mesh main */\r\n    const geometry = new THREE.BufferGeometry()\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( colors, 3 ))\r\n    uv && geometry.setAttribute('uv', new THREE.BufferAttribute( uv, 2 ))\r\n    geometry.computeVertexNormals()\r\n    const mat = root.materials.wallVirtualColor\r\n    const mesh = new THREE.Mesh(geometry, mat)\r\n\r\n    /** mesh collision */\r\n    const verticesColl = new Float32Array(coll)\r\n    const geometryColl = new THREE.BufferGeometry()\r\n    geometryColl.setAttribute('position', new THREE.BufferAttribute(verticesColl, 3))\r\n    const meshCollision = new THREE.Mesh(geometryColl, root.materials.testRed)\r\n\r\n    /** mesh carCollision */\r\n    const verticesCollCar = new Float32Array(carColl)\r\n    const geometryCollCar = new THREE.BufferGeometry()\r\n    geometryCollCar.setAttribute('position', new THREE.BufferAttribute(verticesCollCar, 3))\r\n    const meshCollisionCar = new THREE.Mesh(geometryCollCar, root.materials.testRed)\r\n\r\n    return { mesh, meshCollision, meshCollisionCar };\r\n}","export const createScheme = () => {\r\n    const arr = []\r\n\r\n    /** add gallery from center*/\r\n    const iterate = ({\r\n        angle,\r\n        offsetStart,\r\n        h0,\r\n        h1,\r\n        h2,\r\n        numFromCenter,\r\n    }) => {\r\n        const d = Math.random() * 120 + 30\r\n        const isAddNext = Math.random() > .5\r\n\r\n\r\n        arr.push({\r\n            id: Math.floor(Math.random() * 1000),\r\n            x: Math.sin(angle) * (offsetStart + d),\r\n            z: Math.cos(angle) * (offsetStart + d),\r\n            angle,\r\n            h0,\r\n            h1,\r\n            h2, \r\n            arc: { w: d },\r\n            isTopElem: !isAddNext,\r\n            numFromCenter,\r\n        })\r\n        if (isAddNext) {\r\n            iterate({\r\n                angle,\r\n                offsetStart: offsetStart + d,\r\n                h0,\r\n                h1,\r\n                h2,\r\n                numFromCenter: ++numFromCenter,\r\n            }) \r\n        }\r\n    }\r\n\r\n\r\n    const num = Math.floor(Math.random() * 20) + 3\r\n    const h0 = 0\r\n    const h2 = Math.random() * 150 + 30\r\n    const h1 = (Math.random() * .4 + .5)  * h2\r\n\r\n    /** center */\r\n    arr.push({\r\n        id: Math.floor(Math.random() * 1000),\r\n        x: 0,\r\n        z: 0,\r\n        angle: 0,\r\n        h0,\r\n        h1,\r\n        h2,\r\n        numFromCenter: 0,\r\n        isTopElem: false,\r\n        isColumn: true,\r\n    })\r\n\r\n\r\n\r\n    for (let i = 0; i < num; ++i) {\r\n        if (Math.random() > 0.3) {\r\n            iterate({\r\n                angle: (i / num) * (Math.PI * 2),\r\n                offsetStart: 0,\r\n                h0,\r\n                h1,\r\n                h2,\r\n                numFromCenter: 1,\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    let savedL = arr.length\r\n    for (let i = 0; i < 3; ++i) {\r\n        const _h0 = arr[arr.length - 1].h2\r\n        const _h2 = _h0 + Math.random() * 150 + 30\r\n        const _h1 = _h0 + (Math.random() * .4 + .5) * (_h2 - _h0)\r\n        for (let j = 0; j < savedL; ++j) {\r\n            if (!arr[j].isTopElem) {\r\n                arr.push({\r\n                    ...arr[j],\r\n                    h0: _h0,\r\n                    h1: _h1,\r\n                    h2: _h2,\r\n                    isTopElem: i === 2,\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return arr\r\n}","import * as THREE from 'three'\r\nimport {\r\n    SIZE_QUADRANT,\r\n} from '../constants/constants_elements';\r\nimport { createMeshGallery } from '../Entities/meshGallery'\r\n\r\n\r\n\r\nconst createManagerBuilds = (root) => {\r\n    const arr = []\r\n    for (let i = 0; i < 30; ++i) {\r\n        const data = createMeshGallery(root)\r\n        const id = 'build_' + i\r\n        arr.push({...data, id, inScene: false })\r\n    }\r\n\r\n    return {\r\n        getItem: () => {\r\n            for (let i = 0; i < arr.length; ++i) {\r\n                if (!arr[i].inScene) {\r\n                    arr[i].inScene = true\r\n                    return arr[i]\r\n                }\r\n            }\r\n\r\n            return null\r\n        },\r\n        setFlagAsFree: id => {\r\n            for (let i = 0; i < arr.length; ++i) {\r\n                if (arr[i].id === id) {\r\n                    arr[i].inScene = false\r\n                    break;\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const createLevelArea = root => {\r\n    const {\r\n        studio,\r\n        car,\r\n        system_PlayerMoveOnLevel,\r\n        materials,\r\n    } = root\r\n\r\n    let arrTrash = []\r\n    const managerBuilds = createManagerBuilds(root)\r\n\r\n    const floorGeom = new THREE.PlaneGeometry(SIZE_QUADRANT, SIZE_QUADRANT)\r\n    materials.floorMat.map.wrapS = materials.floorMat.map.wrapT = 80\r\n    materials.floorMat.map.repeat.set(50, 50)\r\n\r\n    const addItems = arr => {\r\n        for (let i = 0; i < arr.length; ++i) {\r\n            /** add floor */\r\n            const p = arr[i].split('_')\r\n            const x = +p[0] * SIZE_QUADRANT\r\n            const z = +p[1] * SIZE_QUADRANT\r\n            const y = -62\r\n            const floor = new THREE.Mesh(floorGeom, materials.floorMat)\r\n            floor.rotation.x = -Math.PI / 2\r\n            floor.position.set(x, y, z)\r\n            studio.addToScene(floor)\r\n            arrTrash.push({\r\n                mesh: floor,\r\n                keyLocation: arr[i],\r\n                type: 'floor',\r\n            })\r\n            system_PlayerMoveOnLevel.addItemToPlayerCollision(floor)\r\n\r\n\r\n\r\n            /** add build ******************/\r\n            const rCount = Math.floor(Math.random() * 8)\r\n            for (let j = 0; j < rCount; ++j) {                \r\n                const buildingData = managerBuilds.getItem()\r\n                if (!buildingData) {\r\n                    continue;\r\n                }\r\n\r\n                const { mesh, meshCollision, meshCollisionCar, id } = buildingData\r\n                //console.log('!!!!!!!!!!!!!!!!! add Build ', id)\r\n                mesh.position.set(\r\n                    x + Math.random() * SIZE_QUADRANT,\r\n                    -60,\r\n                    z + Math.random() * SIZE_QUADRANT,\r\n                )\r\n                studio.addToScene(mesh)\r\n\r\n                meshCollision.visible = false\r\n                meshCollision.position.copy(mesh.position)\r\n                studio.addToScene(meshCollision)\r\n                system_PlayerMoveOnLevel.addItemToPlayerCollision(meshCollision)\r\n\r\n                meshCollisionCar.visible = false\r\n                meshCollisionCar.position.copy(mesh.position)\r\n                studio.addToScene(meshCollisionCar)\r\n                car.setCollisionForDraw(meshCollisionCar)\r\n\r\n                arrTrash.push({ mesh, meshCollision, meshCollisionCar, keyLocation: arr[i], type: 'build', id })\r\n            }\r\n        }\r\n    } \r\n\r\n\r\n    const removeItems = arr => {\r\n        const arrToRemove = []\r\n        for (let i = 0; i < arr.length; ++i) {\r\n            for (let j = 0; j < arrTrash.length; ++j) {\r\n                if (arr[i] === arrTrash[j].keyLocation) {\r\n                    arrToRemove.push(arrTrash[j])\r\n                }\r\n            }\r\n        }\r\n\r\n        arrTrash = arrTrash.filter(item => {\r\n            for (let i = 0; i < arr.length; ++i) {\r\n                if (item.keyLocation === arr[i]) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        })\r\n\r\n        for (let i = 0; i < arrToRemove.length; ++i) {\r\n            const { mesh, meshCollision, meshCollisionCar, type, id } = arrToRemove[i]\r\n            studio.removeFromScene(mesh)\r\n            system_PlayerMoveOnLevel.removeItemFromPlayerCollision(mesh)\r\n\r\n            if (type === 'build') {\r\n                system_PlayerMoveOnLevel.removeItemFromPlayerCollision(meshCollision)\r\n                studio.removeFromScene(meshCollision)\r\n                //arrToRemove[i].meshCollision.geometry.dispose()\r\n                //delete arrToRemove[i].meshCollision\r\n\r\n                car.removeCollisionForDraw(meshCollisionCar)\r\n                studio.removeFromScene(meshCollisionCar)\r\n                //arrToRemove[i].meshCollisionCar.geometry.dispose()\r\n                //delete arrToRemove[i].meshCollisionCar\r\n\r\n                managerBuilds.setFlagAsFree(id)\r\n            }\r\n\r\n            if (type === 'floor') {\r\n                arrToRemove[i].mesh.geometry.dispose()\r\n                delete arrToRemove[i].mesh\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        updateAreas: (removeArr, addArr) => {\r\n            removeItems(removeArr)\r\n            addItems(addArr)\r\n        },\r\n        createArea: (arr) => {\r\n            addItems(arr)\r\n        },\r\n        removeAll: () => {\r\n            for (let i = 0; i < arrTrash.length; ++i) {\r\n                const { mesh, meshCollision, meshCollisionCar } = arrTrash[i]\r\n\r\n                studio.removeFromScene(mesh)\r\n                system_PlayerMoveOnLevel.removeItemFromPlayerCollision(mesh)\r\n                arrTrash[i].mesh.geometry.dispose()\r\n                delete arrTrash[i].mesh\r\n\r\n                if (meshCollision) {\r\n                    system_PlayerMoveOnLevel.removeItemFromPlayerCollision(meshCollision)\r\n                    studio.removeFromScene(meshCollision)\r\n                    arrTrash[i].meshCollision.geometry.dispose()\r\n                    delete arrTrash[i].meshCollision\r\n                }\r\n\r\n                if (meshCollisionCar) {\r\n                    car.removeCollisionForDraw(meshCollisionCar)\r\n                    studio.removeFromScene(meshCollisionCar)\r\n                    arrTrash[i].meshCollisionCar.geometry.dispose()\r\n                    delete arrTrash[i].meshCollisionCar\r\n                }\r\n            }\r\n        },\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\n\r\n\r\nconst createS = (root) => {\r\n    const v = []\r\n\r\n    for (let i = 0; i < 20; ++i) {\r\n        const x = Math.random() * 3000 - 1500\r\n        const y = Math.random() * 400 - 50\r\n        const z = Math.random() * 3000 - 1500\r\n\r\n        for (let i = 0; i < 3; ++i) {\r\n            v.push(\r\n                x + Math.random() * 3,\r\n                y + Math.random() * 3,\r\n                z + Math.random() * 3,\r\n            )\r\n        }\r\n    } \r\n\r\n\r\n    const vertices = new Float32Array(v)\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    return new THREE.Mesh(geometry, root.materials.testGreen)\r\n}\r\n\r\n\r\nexport const createSustemSprites = root => {\r\n    const car = root.car\r\n    const carModel = car.getModel()\r\n\r\n    //const ob = new THREE.Mesh(\r\n    //    new THREE.BoxGeometry(30, 30, 30),\r\n    //    root.materials.testRed\r\n    //)\r\n    const ob = new THREE.Object3D()\r\n    ob.position.set(0, 0, -3000)\r\n    carModel.add(ob)\r\n    const vecObPos = new THREE.Vector3()\r\n\r\n\r\n    const arrSprites = []\r\n    for (let i = 0; i < 50; ++i) {\r\n        const s = createS(root)\r\n        s.position.set(Math.random() * 3000 - 1500, 0, Math.random() * 3000 - 1500)\r\n        arrSprites.push(s)\r\n    }\r\n\r\n\r\n    return { \r\n        update: () => {\r\n            ob.getWorldPosition(vecObPos)\r\n            for (let i = 0; i < arrSprites.length; ++i) {\r\n                if (arrSprites[i].position.distanceTo(vecObPos) > 4000) {\r\n                    arrSprites[i].position.copy(vecObPos)\r\n                }\r\n            }\r\n        },\r\n        addToScene: () => {\r\n            for (let i = 0; i < arrSprites.length; ++i) {\r\n                root.studio.addToScene(arrSprites[i])\r\n            }\r\n        },\r\n        removeAll: () => {\r\n            for (let i = 0; i < arrSprites.length; ++i) {\r\n                root.studio.removeFromScene(arrSprites[i])\r\n            }\r\n        }\r\n    }\r\n} ","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n    rotateArrY, translateArr,\r\n} from './helpers'\r\n\r\n\r\n\r\nconst { PI, sin, cos } = Math\r\nconst PI2 = PI * 2\r\n\r\n// const count = 5\r\n// const hh = 15\r\n// const h = 7\r\n// const hD = -7\r\n// const hhD = -15\r\n// const r = 15\r\n// const cone = 10\r\n// const w = 2\r\n// const wt = 3\r\n// const wtr = 2\r\n// const rInner = -5\r\n\r\nconst createG = ({\r\n    count = 5,\r\n    hh = 15,\r\n    h = 7,\r\n    hD = -7,\r\n    hhD = -15,\r\n    r = 15,\r\n    cone = 10,\r\n    w = 2,\r\n    wt = 3,\r\n    wtr = 5,\r\n    htr = 5,\r\n    rInner = -5,  \r\n}) => {\r\n\r\n\r\n    const data = {\r\n        tt: [],\r\n        top: [],\r\n        bot: [],\r\n        bb: [],\r\n    }\r\n\r\n\r\n    for (let i = 0; i < count; ++i) {\r\n        const ph1 = i / count * PI2\r\n/*\r\n\r\n     9 10 11   6 7 8 \r\n        *      *\r\n    12 13 14   3 4 5             cone 15 16 17\r\n        *      *                    *\r\n          0 1 2\r\n            *\r\n\r\n         24 25 26\r\n            * \r\n    18 19 20  21 22 23\r\n       *         *\r\n\r\n    27 28 29  33 34 35 \r\n       *         *\r\n         30 31 32\r\n            *\r\n\r\n*/\r\n        const t = [\r\n            // penta\r\n            0, -w, 0, //0 1 2 \r\n            w, 0, 0, //3 4 5\r\n            w, w, 0, //6 7 8\r\n            -w, w, 0, //9 10 11\r\n            -w, 0, 0, //12 13 14 \r\n            // cone\r\n            0, 5, cone, //15 16 17\r\n            // tr\r\n            -wtr, -h * 1.7, rInner, //18 19 20 \r\n            wtr, -h * 1.7, rInner, //21 22 23\r\n            0, -h + htr, rInner, //24 25 26\r\n            // bot tr\r\n            -wtr, -h * 2, rInner * 1.5, //27 28 29\r\n            0, -h * 2.3, rInner * 2, //30 31 32\r\n            wtr, -h * 2, rInner * 1.5, //33 34 35\r\n        ]\r\n        rotateArrY(t, ph1)\r\n        translateArr(t, sin(ph1) * r, h, cos(ph1) * r)\r\n        data.top.push(t)\r\n\r\n\r\n        const ph2 = (i + .5) / count * PI2\r\n/*\r\n          33 34 35\r\n             *\r\n      27 28 29  30 31 32\r\n         *       * \r\n\r\n      18 19 20   24 25 26  \r\n          *      *\r\n           21 22 23\r\n              *\r\n\r\n            0 1 2\r\n              *\r\n        3 4 5   12 13 14       cone 15 16 17\r\n          *       *                  *\r\n        6 7 8  9 10 11\r\n          *       *           \r\n*/\r\n        const b = [\r\n            // penta\r\n            0, w, 0, //0 1 2\r\n            -w, 0, 0, //3 4 5\r\n            -w, -w, 0, //6 7 8\r\n            w, -w, 0, //9 10 11\r\n            w, 0, 0, //12 13 14\r\n            // cone\r\n            0, -5, cone, // 15 16 17\r\n            // tr\r\n            -wtr, h * 1.7, rInner, //18 19 20\r\n            0, h - htr, rInner, //21 22 23\r\n            wtr, h * 1.7, rInner, //24 25 26 \r\n            // top tr\r\n            -wtr, h * 2, rInner * 1.5, //27 28 29\r\n            wtr, h * 2, rInner * 1.5, //30 31 32\r\n            0, h * 2.3, rInner * 2, //33 34 35\r\n        ]\r\n        rotateArrY(b, ph2)\r\n        translateArr(b, sin(ph2) * r, hD, cos(ph2) * r)\r\n        data.bot.push(b)\r\n\r\n\r\n        const phP = ((i - .5) / count) * PI2\r\n        data.tt.push(sin(phP) * wt, hh, cos(phP) * wt)\r\n        data.bb.push(sin(ph1) * wt, hhD, cos(ph1) * wt)\r\n    }\r\n\r\n\r\n    return data\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createDataUnit = (params) => {\r\n\r\n    const hhh = params.hhh || 12\r\n\r\n    const v = []\r\n    const c = []\r\n    const r = 5\r\n    const r2 = 15\r\n\r\n\r\n    const n = createG(params)\r\n\r\n\r\n    const c1WW = [1, 1, 1]\r\n    const c3WW = [...c1WW, ...c1WW, ...c1WW]\r\n    const c6WW = [...c3WW, ...c3WW]\r\n\r\n\r\n    const c1W = [.5, 1, .5]\r\n    const c3W = [...c1W, ...c1W, ...c1W]\r\n    const c6W = [...c3W, ...c3W]\r\n\r\n    const c1R = [0, 0, 0]\r\n    const c3R = [...c1R, ...c1R, ...c1R]\r\n    const c6R = [...c3R, ...c3R]\r\n\r\n    const c1B = [0, 0, 0]\r\n    const c3B = [...c1B, ...c1B, ...c1B]\r\n    const c6B = [...c3B, ...c3B]\r\n\r\n    const c1B2 = [0, 0, 0]\r\n    const c3B2 = [...c1B2, ...c1B2, ...c1B2]\r\n    const c6B2 = [...c3B2, ...c3B2]\r\n\r\n    const c1B3 = [0, 0, 0]\r\n    const c3B3 = [...c1B3, ...c1B3, ...c1B3]\r\n    const c6B3 = [...c3B3, ...c3B3]\r\n\r\n\r\n    \r\n    \r\n    const f = (i, j) => {\r\n        const b = n.bot[i]\r\n        const bN = n.bot[j]\r\n        const t = n.top[i]\r\n        const tN = n.top[j]\r\n\r\n        /** hh cone */\r\n        v.push(\r\n            n.tt[i * 3], n.tt[i * 3 + 1], n.tt[i * 3 + 2],\r\n            n.tt[j * 3], n.tt[j * 3 + 1], n.tt[j * 3 + 2], \r\n            0, n.tt[i * 3 + 1] + hhh, 0,\r\n        )\r\n        c.push(...c3W)\r\n        /** bb cone */\r\n        v.push(\r\n            n.bb[j * 3], n.bb[j * 3 + 1], n.bb[j * 3 + 2], \r\n            n.bb[i * 3], n.bb[i * 3 + 1], n.bb[i * 3 + 2],\r\n            0, n.bb[i * 3 + 1] - hhh, 0,\r\n        )\r\n        c.push(...c3W)\r\n\r\n\r\n        /** to high cone */\r\n        v.push(...createFace(\r\n            [t[9], t[10], t[11]],\r\n            [t[6], t[7], t[8]],\r\n            [n.tt[j * 3], n.tt[j * 3 + 1], n.tt[j * 3 + 2]],\r\n            [n.tt[i * 3], n.tt[i * 3 + 1], n.tt[i * 3 + 2]],\r\n        ))\r\n        //c.push(...c6W)\r\n        c.push(...c6B)\r\n        /** to bot cone */\r\n        v.push(...createFace(\r\n            [n.bb[i * 3], n.bb[i * 3 + 1], n.bb[i * 3 + 2]],\r\n            [n.bb[j * 3], n.bb[j * 3 + 1], n.bb[j * 3 + 2]],\r\n            [b[9], b[10], b[11]],\r\n            [b[6], b[7], b[8]],\r\n        ))\r\n        //c.push(...c6W)\r\n        c.push(...c6B)\r\n\r\n\r\n        /** top connect */\r\n        v.push(...createFace(\r\n            [t[3], t[4], t[5]],\r\n            [tN[12], tN[13], tN[14]],\r\n            [tN[9], tN[10], tN[11]],\r\n            [t[6], t[7], t[8]],\r\n        ))\r\n        c.push(...c6B)\r\n\r\n        /** bot connect */         \r\n        v.push(...createFace(\r\n            [b[9], b[10], b[11]],\r\n            [bN[6], bN[7], bN[8]],\r\n            [bN[3], bN[4], bN[5]],\r\n            [b[12], b[13], b[14]],\r\n        ))\r\n        c.push(...c6B)\r\n\r\n\r\n        /** t -> b */\r\n        v.push(...createFace(\r\n            [b[3], b[4], b[5]],\r\n            [b[0], b[1], b[2]],\r\n            [t[3], t[4], t[5]],\r\n            [t[0], t[1], t[2]],\r\n        ))\r\n        //c.push(...c6W)\r\n        c.push(...c6B)\r\n\r\n        /** b -> tN */\r\n        v.push(...createFace(\r\n            [b[0], b[1], b[2]],\r\n            [b[12], b[13], b[14]],\r\n            [tN[0], tN[1], tN[2]],\r\n            [tN[12], tN[13], tN[14]],\r\n        ))\r\n        //c.push(...c6W)\r\n        c.push(...c6B)\r\n\r\n\r\n\r\n        /** cones */\r\n        for (let k = 0; k < 15; k += 3) {    \r\n            /** t cone */\r\n            v.push(\r\n                t[k], t[k + 1], t[k + 2],\r\n                t[k + 3], t[k + 4], t[k + 5],\r\n                t[15], t[16], t[17],\r\n            )\r\n            c.push(...c3W)\r\n\r\n            /** b cone */\r\n            v.push(\r\n                b[k], b[k + 1], b[k + 2],\r\n                b[k + 3], b[k + 4], b[k + 5],\r\n                b[15], b[16], b[17],\r\n            )\r\n            c.push(...c3W)\r\n        }\r\n        /** last tr cone */\r\n        /** b cone */\r\n        v.push(\r\n            b[12], b[13], b[14],\r\n            b[0], b[1], b[2],\r\n            b[15], b[16], b[17] // cone\r\n        )\r\n        c.push(...c3W)\r\n        /** t cone */\r\n        v.push(\r\n            t[12], t[13], t[14],\r\n            t[0], t[1], t[2],\r\n            t[15], t[16], t[17], // cone\r\n        )\r\n        c.push(...c3W)\r\n\r\n        //////////////////////////\r\n        /** inner tr 1 */\r\n        // v.push(\r\n        //     t[18], t[19], t[20],\r\n        //     t[21], t[22], t[23],\r\n        //     t[24], t[25], t[26],\r\n        // )\r\n        //c.push(...c3R)\r\n        /* tr cap r */\r\n        v.push(...createFace(\r\n            [t[21], t[22], t[23]],\r\n            [b[3], b[4], b[5]],\r\n            [t[0], t[1], t[2]],\r\n            [t[24], t[25], t[26]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap l */\r\n        v.push(...createFace(\r\n            [b[12], b[13], b[14]],\r\n            [tN[18], tN[19], tN[20]],\r\n            [tN[24], tN[25], tN[26]],\r\n            [tN[0], tN[1], tN[2]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap b */\r\n        v.push(...createFace(\r\n            [b[12], b[13], b[14]],\r\n            [bN[3], bN[4], bN[5]],\r\n            [tN[21], tN[22], tN[23]],\r\n            [tN[18], tN[19], tN[20]],\r\n        ))\r\n        c.push(...c6W)\r\n\r\n        ///////////////////////////////////\r\n        /** b tr */\r\n        // v.push(\r\n        //     t[27], t[28], t[29],\r\n        //     t[30], t[31], t[32],\r\n        //     t[33], t[34], t[35],\r\n        // )\r\n        //c.push(...c3R)\r\n        /* b cap t */ \r\n        /* tr cap r */\r\n        v.push(...createFace(\r\n             [t[30], t[31], t[32]],\r\n             [n.bb[i * 3], n.bb[i * 3 + 1], n.bb[i * 3 + 2]],\r\n             [b[6], b[7], b[8]],\r\n             [t[33], t[34], t[35]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap next l */\r\n        v.push(...createFace(\r\n            [n.bb[j * 3], n.bb[j * 3 + 1], n.bb[j * 3 + 2]],\r\n            [tN[30], tN[31], tN[32]],\r\n            [tN[27], tN[28], tN[29]],\r\n            [b[9], b[10], b[11]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap next t */\r\n        v.push(...createFace(\r\n            [tN[27], tN[28], tN[29]],\r\n            [tN[33], tN[34], tN[35]],\r\n            [bN[6], bN[7], bN[8]],\r\n            [b[9], b[10], b[11]],\r\n        ))\r\n        c.push(...c6W)\r\n        \r\n\r\n\r\n\r\n        /** inner tr 2 */\r\n        // v.push(\r\n        //     b[18], b[19], b[20],\r\n        //     b[21], b[22], b[23],\r\n        //     b[24], b[25], b[26], // cone\r\n        // )\r\n        // c.push(...c3R)\r\n        /* tr cap l */\r\n        v.push(...createFace(\r\n            [b[0], b[1], b[2]],\r\n            [b[21], b[22], b[23]],\r\n            [b[18], b[19], b[20]],\r\n            [t[3], t[4], t[5]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap r */\r\n        v.push(...createFace(\r\n            [b[0], b[1], b[2]],\r\n            [tN[12], tN[13], tN[14]],\r\n            [b[24], b[25], b[26]],\r\n            [b[21], b[22], b[23]],\r\n        ))\r\n        c.push(...c6W)\r\n        /* tr cap t */\r\n        v.push(...createFace(\r\n            [b[18], b[19], b[20]],\r\n            [b[24], b[25], b[26]],\r\n            [tN[12], tN[13], tN[14]],\r\n            [t[3], t[4], t[5]],\r\n        ))\r\n        c.push(...c6W)\r\n\r\n        /* tr top */\r\n        // v.push(\r\n        //     b[27], b[28], b[29],\r\n        //     b[30], b[31], b[32],\r\n        //     b[33], b[34], b[35],\r\n        // )\r\n        // c.push(...c3R)\r\n\r\n        /* cap t b */\r\n        v.push(...createFace(\r\n            [t[6], t[7], t[8]],\r\n            [tN[9], tN[10], tN[11]],\r\n            [b[30], b[31], b[32]],\r\n            [b[27], b[28], b[29]],\r\n        )) \r\n        c.push(...c6W)\r\n        /* cap t r */\r\n        v.push(...createFace(\r\n            [b[30], b[31], b[32]],\r\n            [tN[9], tN[10], tN[11]],\r\n            [n.tt[j * 3], n.tt[j * 3 + 1], n.tt[j * 3 + 2]],\r\n            [b[33], b[34], b[35]],\r\n        )) \r\n        c.push(...c6W)\r\n        /* cap t l */\r\n        v.push(...createFace(\r\n            [t[6], t[7], t[8]],\r\n            [b[27], b[28], b[29]],\r\n            [b[33], b[34], b[35]],\r\n            [n.tt[j * 3], n.tt[j * 3 + 1], n.tt[j * 3 + 2]],\r\n        )) \r\n        c.push(...c6W)\r\n    }\r\n\r\n/*\r\n     b----\r\n          33 34 35\r\n             *\r\n      27 28 29  30 31 32\r\n         *       * \r\n\r\n\r\n    t---\r\n     9 10 11   6 7 8 \r\n        *      *\r\n    12 13 14   3 4 5             \r\n        *      *                   \r\n          0 1 2\r\n            *\r\n\r\n\r\n          \r\n*/\r\n\r\n\r\n\r\n    for (let i = 0; i < n.top.length; ++i) {\r\n        if (n.top[i + 1] ) {\r\n            f(i, i + 1)\r\n        } else {\r\n            f(i, 0)\r\n        }\r\n    }\r\n\r\n\r\n    return { v, c }\r\n}","import * as THREE from 'three'\r\nimport { createDataUnit } from './geometry/dataUnit'\r\n\r\n\r\nconst createS = (root, { r = 15, s = .5, mKey = 'testGreen'  }) => {\r\n    const v = []\r\n    const rh = r / 2\r\n\r\n\r\n    for (let i = 0; i < 100; ++i) {\r\n        const x = Math.random() * r - rh \r\n        const y = Math.random() * r - rh\r\n        const z = Math.random() * r - rh\r\n\r\n        for (let i = 0; i < 3; ++i) {\r\n            v.push(\r\n                x + Math.random() * s,\r\n                y + Math.random() * s,\r\n                z + Math.random() * s,\r\n            )\r\n        }\r\n    } \r\n\r\n\r\n    const vertices = new Float32Array(v)\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    return new THREE.Mesh(geometry, root.materials[mKey])\r\n}\r\n\r\n\r\nexport const createMeshUnit = (root) => {\r\n\r\n    const dataUnit1 = createDataUnit({ \r\n        r: 15,\r\n        cone: 12,\r\n        w: 2,\r\n        wt: 3,\r\n        wtr: 5,\r\n        htr: 5,\r\n        rInner: -5,\r\n        hhh: 8,\r\n    })\r\n    const dataUnit2 = createDataUnit({ \r\n        cone: 20,\r\n        r: 13,\r\n        w: .5,\r\n        wt: .7, \r\n        wtr: 2,\r\n        htr: 0,\r\n        rInner: -5, \r\n        hhh: 12,\r\n        hh: 16,\r\n        hhD: -12,\r\n    })\r\n    const dataUnit3 = createDataUnit({ \r\n        r: 16,\r\n        cone: 9,\r\n        w: 1,\r\n        wt: 5,\r\n        wtr: 6,\r\n        htr: 6,\r\n        rInner: -3,\r\n        hhh: 8,\r\n    }) \r\n    const dataUnit4 = createDataUnit({ \r\n        r: 16,\r\n        cone: 15,\r\n        w: 1.5,\r\n        wt: 8,\r\n        wtr: 6,\r\n        htr: 6,\r\n        rInner: -3,\r\n        hhh: 8,\r\n    }) \r\n\r\n\r\n\r\n\r\n    const v = new Float32Array(dataUnit1.v)\r\n    const c =  new Float32Array(dataUnit2.c)\r\n\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(v, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( c, 3 ))\r\n    geometry.computeVertexNormals()\r\n\r\n\r\n    const mat = root.materials.unit\r\n    const mesh = new THREE.Object3D()\r\n    const star = new THREE.Mesh(geometry, mat)\r\n    mesh.add(star)\r\n    const s1 = createS(root, { mKey: 'testWhite' })\r\n    mesh.add(s1) \r\n    const s2 = createS(root, { mKey: 'testWhite' })\r\n    mesh.add(s2) \r\n    const s3 = createS(root, { mKey: 'testWhite' })\r\n    mesh.add(s3) \r\n\r\n    const s4 = createS(root, { r: 50, s: .5 })\r\n    mesh.add(s4) \r\n\r\n    let phase = 0\r\n    let phaseMesh = 0\r\n    let mode = 'idle'\r\n    let strength = 0\r\n    const spd = 0.05\r\n    let starQSaved = new THREE.Quaternion()\r\n    let meshQSaved = new THREE.Quaternion()\r\n    const q0 = new THREE.Quaternion()\r\n\r\n\r\n    let arr1 = dataUnit1.v\r\n    let arr2 = dataUnit2.v \r\n\r\n    let isRotate = true\r\n\r\n    return { \r\n        mesh,\r\n        update: () => {\r\n\r\n            phaseMesh += 0.05\r\n            s1.rotation.y = - phaseMesh * 2\r\n            s2.rotation.x = - phaseMesh * 2\r\n            s3.rotation.z= - phaseMesh * 2 \r\n            s4.rotation.y = phaseMesh / 4\r\n            mesh.rotation.y = phaseMesh / 5\r\n\r\n            if (mode === 'idle') {\r\n                const t = Math.sin(phase)\r\n\r\n                phase += 0.05\r\n                if (isRotate) {\r\n                    star.rotation.y = phase / 2\r\n                    star.rotation.x = phase / 1.33\r\n                    star.rotation.z = phase / 1.88\r\n                }\r\n\r\n                for (let i = 0; i < dataUnit1.v.length; ++i) {\r\n                    geometry.attributes.position.array[i] = arr1[i] * (1 - t) + arr2[i] * t\r\n                }\r\n                star.geometry.attributes.position.needsUpdate = true\r\n            }\r\n\r\n            if (mode === 'toDialog') {\r\n                strength += spd\r\n                if (strength > 1) strength = 1\r\n                star.quaternion.slerpQuaternions(starQSaved, q0, strength)\r\n                for (let i = 0; i < dataUnit1.v.length; ++i) {\r\n                    geometry.attributes.position.array[i] = arr1[i] * (1 - strength) + arr2[i] * strength\r\n                }\r\n                star.geometry.attributes.position.needsUpdate = true\r\n                if (strength === 1) {\r\n                    isRotate = false\r\n                    mode = 'idle'\r\n                    phase = 0\r\n                    arr1 = dataUnit3.v\r\n                    arr2 = dataUnit4.v\r\n                }\r\n            }\r\n\r\n            if (mode === 'fromDialog') {\r\n                strength += spd\r\n                if (strength > 1) strength = 1\r\n                for (let i = 0; i < dataUnit1.v.length; ++i) {\r\n                    geometry.attributes.position.array[i] = arr1[i] * (1 - strength) + arr2[i] * strength\r\n                }\r\n                star.geometry.attributes.position.needsUpdate = true\r\n                if (strength === 1) {\r\n                    mode = 'idle'\r\n                    phase = 0\r\n                    arr1 = dataUnit1.v\r\n                    arr2 = dataUnit2.v\r\n                    isRotate = true\r\n                }\r\n            }\r\n\r\n\r\n        },\r\n        prepareDialog: () => {\r\n            // mode = 'toDialog'\r\n            // arr1 = [...geometry.attributes.position.array]\r\n            // arr2 = dataUnit3.v\r\n            // strength = 0\r\n            // meshQSaved.copy(mesh.quaternion)\r\n            // starQSaved.copy(star.quaternion)\r\n        },\r\n        exitDialog: () => {\r\n            // mode = 'fromDialog'\r\n            // arr1 = [...geometry.attributes.position.array]\r\n            // arr2 = dataUnit1.v\r\n            // strength = 0\r\n        }\r\n    }\r\n}\r\n","import { createCheckerChangeLocationKey } from '../components/checkerChangeLocationKey'\r\nimport { createChangerGalleries } from './system_changerGallery'\r\nimport { createLevelArea } from './system_levelArea'\r\nimport { createSustemSprites } from './system_sprites'\r\nimport { createMeshUnit } from '../Entities/Pers'\r\nimport { SIZE_QUADRANT, LOCATIONS_QUADRANTS } from \"../constants/constants_elements\";\r\n\r\nexport const createSystemWorldVirtual = (root, carX, carZ) => {\r\n    const checkerChangeLocation = createCheckerChangeLocationKey(SIZE_QUADRANT, carX, carZ)\r\n    const changerGalleries = createChangerGalleries(root)\r\n    const changerLevelArea = createLevelArea(root)\r\n    const systemSprites = createSustemSprites(root)\r\n    const unit = createMeshUnit(root)\r\n    root.unit = unit\r\n\r\n    //root.studio.addToScene(root.unit.mesh)\r\n    //root.unit.mesh.position.y = -40\r\n\r\n    // setTimeout(() => {\r\n    //     unit.prepareDialog()\r\n    //     setTimeout(() => {\r\n    //         unit.exitDialog()    \r\n    //     }, 10000)\r\n    // }, 3000)\r\n\r\n    let isEnabled = false\r\n\r\n    return {\r\n        addWorld: () => {\r\n            let currentQuadrantKey = checkerChangeLocation.getCurrent()\r\n            changerLevelArea.createArea(currentQuadrantKey.currentEnv)\r\n            systemSprites.addToScene()\r\n            isEnabled = true\r\n        },\r\n        removeWorld: () => {\r\n            isEnabled = false\r\n            systemSprites.removeAll()\r\n            changerGalleries.removeAll()\r\n            changerLevelArea.removeAll()\r\n        },\r\n        update: (carX, carZ) => {\r\n            if (!isEnabled) {\r\n                return;\r\n            }\r\n\r\n            unit.update()\r\n            systemSprites.update()\r\n            const l = checkerChangeLocation.checkChanged(carX, carZ)\r\n            if (l) {\r\n                //console.log('quadrants data', l)\r\n                /** arr/remove level tresh **********************/\r\n                changerLevelArea.updateAreas(l.removedQs, l.addedQs)\r\n\r\n                /** add/remove  locations ************************/\r\n                if (LOCATIONS_QUADRANTS[l.oldKey]) {\r\n                    changerGalleries.removeLocationFromScene(LOCATIONS_QUADRANTS[l.oldKey])\r\n                }\r\n                if (LOCATIONS_QUADRANTS[l.newKey]) {\r\n                    //console.log('add', l.newKey)\r\n                    const strArr = l.newKey.split('_')\r\n                    const locationX = +strArr[0] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n                    const locationZ = +strArr[1] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n                    changerGalleries.addLocationToScene(LOCATIONS_QUADRANTS[l.newKey], locationX, locationZ)\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n}","import { createMeshSuper } from '../Entities/meshSuper'\r\nimport { createMeshStairs } from \"../Entities/meshStairs\"\r\n\r\n\r\nexport const createChangerGalleries = root => {\r\n    const {\r\n        studio,\r\n        car,\r\n        system_Level,\r\n        system_PlayerMoveOnLevel,\r\n        system_PlayerNearLevelItems,\r\n    } = root\r\n\r\n\r\n    /** test stairs */\r\n    //const stairs = createMeshStairs(root)\r\n    //stairs.mesh.position.set(400, -42, -1000)\r\n    //studio.addToScene(stairs.mesh)\r\n    //stairs.meshCollision.visible = false\r\n    //stairs.meshCollision.position.copy(stairs.mesh.position)\r\n    //studio.addToScene(stairs.meshCollision)\r\n    //system_PlayerMoveOnLevel.addItemToPlayerCollision(stairs.meshCollision)\r\n\r\n    // /** super */\r\n    const createSuper = () => {\r\n        const superP = createMeshSuper(root)    \r\n        superP.meshCollision.visible = false    \r\n        superP.meshCollisionCar.visible = false    \r\n        superP.meshFinish.position.copy(superP.mesh.position)\r\n        return superP\r\n    }\r\n\r\n    const s = {\r\n        'location01': createSuper(),\r\n        'location02': createSuper(),\r\n        'location03': createSuper(),\r\n    }\r\n\r\n\r\n    /** add/remove locations by key */\r\n    const addLocationToScene = (keyLocation, x, z) => {\r\n        const { mesh, meshCollision, meshCollisionCar, meshFinish, lastXYZ } = s[keyLocation]\r\n\r\n        const y = -42\r\n        mesh.position.set(x, y, z)\r\n        studio.addToScene(mesh)\r\n\r\n        system_PlayerMoveOnLevel.addItemToPlayerCollision(meshCollision)\r\n        //meshCollision.visible = false\r\n        meshCollision.position.set(x, y, z)\r\n        studio.addToScene(meshCollision)\r\n        \r\n        car.setCollisionForDraw(meshCollisionCar)\r\n        meshCollisionCar.visible = false\r\n        meshCollisionCar.position.set(x, y, z)\r\n        studio.addToScene(meshCollisionCar)\r\n\r\n        meshFinish.position.set(x, y, z)\r\n        meshFinish.position.x += lastXYZ[0]\r\n        meshFinish.position.y += lastXYZ[1]\r\n        meshFinish.position.z += lastXYZ[2]\r\n        studio.addToScene(root.unit.mesh)\r\n        root.unit.mesh.position.copy(meshFinish.position)\r\n        root.unit.mesh.position.y += 20\r\n        system_PlayerNearLevelItems.setItemToCheck(meshFinish, 'nearPerson_' + keyLocation, 80)\r\n    }\r\n\r\n\r\n    const removeLocationFromScene = keyLocation => {\r\n        const { mesh, meshCollision, meshCollisionCar, meshFinish } = s[keyLocation]\r\n\r\n        studio.removeFromScene(mesh)\r\n\r\n        system_PlayerMoveOnLevel.removeItemFromPlayerCollision(meshCollision)\r\n        studio.removeFromScene(meshCollision)\r\n\r\n        studio.removeFromScene(meshCollisionCar)\r\n        car.removeCollisionForDraw(meshCollisionCar)\r\n\r\n        studio.removeFromScene(meshFinish)\r\n        system_PlayerNearLevelItems.removeItemFromCheck(meshFinish)\r\n    }\r\n\r\n\r\n    return {\r\n        removeLocationFromScene,\r\n        addLocationToScene,\r\n        removeAll: () => {\r\n            for (let k in s) {\r\n                removeLocationFromScene(k)\r\n            }\r\n        }\r\n    }\r\n}","import * as TWEEN from '@tweenjs/tween.js'\r\nimport * as THREE from 'three'\r\nimport {\r\n    START_ENV_CONFIG,\r\n    //START_ENV_CONFIG_2,\r\n    //START_ENV_CONFIG_3,\r\n    ENV_CONFIG_WORD_1,\r\n    ENV_CONFIG_WORD_2,\r\n    LOCATIONS_QUADRANTS,\r\n    SIZE_QUADRANT,\r\n    playerConfig,\r\n} from '../constants/constants_elements';\r\nimport { createWorldReal } from '../systems/system_worldReal'\r\nimport { createSystemWorldVirtual} from \"../systems/system_worldVirtual\";\r\n\r\n\r\nexport class actions {\r\n    constructor (root) {\r\n        this._root = root\r\n\r\n        this._isInRealWord = true\r\n        this._isExitFromVirt = false\r\n        this._nextLocation = null \r\n        this._finalCountDown = 3000\r\n\r\n\r\n        const {\r\n            emitter,\r\n            car,\r\n            dispatcher,\r\n            frameUpdater,\r\n            studio,\r\n            system_PlayerMoveOnLevel,\r\n        } = this._root\r\n\r\n        /** prepare ui ******/\r\n        dispatcher.dispatch({\r\n            type: 'CHANGE_INFO_CHAPTER',\r\n            currentChapterIndex: 4,\r\n        })\r\n        dispatcher.dispatch({\r\n            type: 'ENABLE_CONTROL_SOUND',\r\n        })\r\n\r\n\r\n\r\n        /** toggle button in sit car */\r\n        car.onChangeCarStateMove(e => {\r\n            if (e === 'carStart') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: false })\r\n            }\r\n            if (e === 'carStop') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: true })\r\n            }\r\n        })\r\n\r\n\r\n        emitter.subscribe('checkNear')(data => {\r\n            if (this._isExitFromVirt) {\r\n                return;\r\n            }\r\n\r\n            if (data.item === 'nearStarterDrawCar') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: data.is })\r\n            }\r\n            if (data.item.includes('nearPerson')) {\r\n\r\n                if (data.is) {\r\n                    root.unit.prepareDialog()\r\n                } else {\r\n                    root.unit.exitDialog()  \r\n                }\r\n\r\n                setTimeout(() => {\r\n                    root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DIALOG', is: data.is, keyPerson: data.item })\r\n                })\r\n            }\r\n        })\r\n\r\n\r\n\r\n        this._worldReal = createWorldReal(root)\r\n        this._worldReal.addWorld()\r\n        this._worldVirtual = createSystemWorldVirtual(root, car._model.position.x, car._model.position.z)\r\n\r\n\r\n\r\n        frameUpdater.on(data => {\r\n            TWEEN.update()\r\n\r\n            this._worldVirtual.update(car._model.position.x, car._model.position.z)\r\n\r\n            if (!car.isFreeze) {\r\n                car.update(data)\r\n                this._checkEndPlay()    \r\n            } else {\r\n                system_PlayerMoveOnLevel.update(data)\r\n            }\r\n\r\n            studio.drawFrame()\r\n        })\r\n        this._startPlay()\r\n    }\r\n\r\n\r\n    clickMachineDraw () {\r\n        const { studio, system_PlayerMoveOnLevel, car } = this._root\r\n\r\n        system_PlayerMoveOnLevel.toggleFreeze(true)\r\n        car.toggleFreeze(false)\r\n        studio.setCamera(car.getCamera())\r\n\r\n        if (this._isInRealWord) {\r\n            this._isInRealWord = false\r\n            car.toggleMat('green')\r\n            studio.changeEnvironment(ENV_CONFIG_WORD_2, { updateAmb: false, time: 50 })\r\n            this._worldVirtual.addWorld()\r\n            this._worldReal.removeWorld()\r\n        }\r\n    }\r\n\r\n\r\n    clickMachineExit () {\r\n        const { system_PlayerMoveOnLevel, player, studio, car, CONSTANTS  } = this._root\r\n\r\n        const pos = car.getPosition()\r\n        const q = car.getQuaternion()\r\n\r\n        studio.setCamera(player.getCamera())\r\n        car.toggleFreeze(true)\r\n\r\n        system_PlayerMoveOnLevel.toggleFreeze(false)\r\n        player.setToPos(pos.x, player.mesh.position.y, pos.z)\r\n        player.mesh.setRotationFromQuaternion(q)\r\n    }\r\n\r\n\r\n    changeTargetLocation ({ key }) {\r\n        this._nextLocation = key\r\n\r\n        let keyXZ = null\r\n        for (let k in LOCATIONS_QUADRANTS) {\r\n            if (LOCATIONS_QUADRANTS[k] === key) {\r\n                keyXZ = k\r\n            }\r\n        }\r\n        if (keyXZ) {\r\n            const p = keyXZ.split('_')\r\n            const x = +p[0] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const z =  +p[1] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const y =  0\r\n            const { car } = this._root\r\n            car.setTargetPosition(new THREE.Vector3(x, y, z))\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _startPlay () {\r\n        const {\r\n            player,\r\n            ui,\r\n            studio,\r\n            car,\r\n            system_PlayerMoveOnLevel,\r\n            system_PlayerNearLevelItems,\r\n            CONSTANTS,\r\n        } = this._root\r\n\r\n        player.setToPos(...CONSTANTS.playerConfig.startPos)\r\n\r\n\r\n        /** car ****************************/\r\n        const { position, rotation } = CONSTANTS.CONFIG_FOR_INIT.currentSceneConfig.carProps\r\n        const carMesh = car.getModel()\r\n        carMesh.position.fromArray(position)\r\n        carMesh.rotation.fromArray(rotation)\r\n        carMesh.position.y = -49\r\n\r\n        system_PlayerNearLevelItems.setItemToCheck(carMesh, 'nearStarterDrawCar', 28)\r\n        studio.addToScene(carMesh)\r\n        system_PlayerMoveOnLevel.addItemToPlayerCollision(car.getCollision())\r\n        setTimeout(() => {\r\n            let i = 0\r\n            let key = null\r\n            for (let k in LOCATIONS_QUADRANTS) {\r\n                if (i === 0) {\r\n                    key = k\r\n                }\r\n                ++i\r\n            }\r\n            const p = key.split('_')\r\n            const x = +p[0] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n            const z = +p[1] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n            const y = 0\r\n\r\n            car.setTargetPosition(new THREE.Vector3(x, y, z))\r\n        }, 500)\r\n\r\n\r\n\r\n\r\n        ui.showStartButton(() => {\r\n            studio.changeEnvironment(ENV_CONFIG_WORD_1, { updateAmb: false, time: 1000 })\r\n            player.toggleBlocked(false)\r\n            this._root.system_Sound.playAmbient()\r\n        })\r\n    }\r\n\r\n    _checkEndPlay () {\r\n        if (this._nextLocation !== 'locationToFinish') {\r\n            return;\r\n        }\r\n        --this._finalCountDown\r\n        if (this._finalCountDown < 1000) {\r\n            this._root.car.updateBattary()\r\n        }\r\n        this._finalCountDown < 0 && this._endPlay()\r\n    }\r\n\r\n    _endPlay () {\r\n        this._nextLocation = '----'\r\n        this._isInRealWord = true\r\n        this._isExitFromVirt = true\r\n\r\n        const {\r\n            CONSTANTS,\r\n            dispatcher,\r\n            car,\r\n            studio,\r\n            player,\r\n            system_PlayerMoveOnLevel,\r\n            system_Sound,\r\n        } = this._root\r\n\r\n        this._root.car.batteryLight() \r\n        setTimeout(() => dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: false }))\r\n        const { position, rotation } = CONSTANTS.CONFIG_FOR_INIT.currentSceneConfig.carProps\r\n        const carMesh = car.getModel()\r\n        car.toggleMat('red')\r\n        carMesh.position.fromArray(position)\r\n        carMesh.rotation.fromArray(rotation)\r\n        carMesh.position.y = -49\r\n\r\n        const pos = car.getPosition()\r\n        const q = car.getQuaternion()\r\n\r\n        studio.setCamera(player.getCamera())\r\n        car.toggleFreeze(true)\r\n        system_Sound.stopCar()\r\n\r\n        system_PlayerMoveOnLevel.toggleFreeze(false)\r\n        player.setToPos(pos.x, player.mesh.position.y, pos.z)\r\n        player.mesh.setRotationFromQuaternion(q)\r\n\r\n\r\n        this._worldReal.addWorld()\r\n        this._worldVirtual.removeWorld()\r\n        studio.changeEnvironment(ENV_CONFIG_WORD_1, { updateAmb: false, time: 50 })\r\n\r\n\r\n        setTimeout(() => {\r\n            studio.changeEnvironment(START_ENV_CONFIG, { updateAmb: false, time: 500 })\r\n            setTimeout(() => {\r\n                this._root.dispatcher.dispatch({ type: 'SHOW_FINAL_MESSAGE' })\r\n            }, 1000)\r\n        }, 35000)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\nexport const createWorldReal = (root) => {\r\n    const {\r\n        assets,\r\n        materials,\r\n        studio,\r\n        system_Assets,\r\n        system_PlayerMoveOnLevel,\r\n    } = root\r\n\r\n    const groundStart = new THREE.Mesh(\r\n        new THREE.PlaneGeometry(5000, 5000),\r\n        materials.floorMat1\r\n    )\r\n    materials.floorMat1.map.repeat.set(180, 180)\r\n    groundStart.rotation.x = -Math.PI / 2\r\n    groundStart.position.y = -62\r\n\r\n    const body =  system_Assets.items['body']\r\n    body.position.fromArray([-20, -60, -50])\r\n    body.rotation.fromArray([0, 2, 0])\r\n    body.material = materials.body\r\n    const bodyShadow =  system_Assets.items['body_shadow']\r\n    bodyShadow.material = materials.body_sh\r\n    body.add(bodyShadow)\r\n\r\n    /** body **************************/\r\n\r\n\r\n\r\n\r\n    return {\r\n        addWorld: () => {\r\n            system_PlayerMoveOnLevel.addItemToPlayerCollision(groundStart)\r\n            studio.addToScene(groundStart)\r\n            studio.addToScene(body)\r\n        },\r\n        removeWorld: () => {\r\n            system_PlayerMoveOnLevel.removeItemFromPlayerCollision(groundStart)\r\n            studio.removeFromScene(groundStart)\r\n            studio.removeFromScene(body)\r\n        }\r\n    }\r\n}\r\n\r\n\r\n","let lang = 'en'\r\nexport const changeLang = l => lang = l \r\nexport const createTranslater = vocab => word => (vocab[lang] && vocab[lang][word]) || word\r\n","import { connect } from \"react-redux\";\r\nimport '../stylesheets/Info.css'\r\nimport { createTranslater } from '../../helpers/helper_translate'\r\nimport { INFO_VOC } from '../../constants/default_voc'\r\n\r\n\r\nconst t = createTranslater(INFO_VOC)\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        ...state.controls.infoPanelData,\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(function(props) {\r\n    return ( \r\n        <div className=\"info\">\r\n            <button\r\n                className=\"control-small butt-infoClose\"\r\n                onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n            </button>\r\n            <div className=\"info-inner\">\r\n                <p>{t(props.title)}</p>\r\n                <p>{t(props.topText)}</p>\r\n                <ul>{props.chapters.map((item, index) => \r\n                    <li key={index}>\r\n                        {index + 1}.&nbsp;\r\n                        {item.href \r\n                            ? <span><a href={item.href} target=\"blank\">{t(item.text)}</a></span>\r\n                            : <span>{t(item.text)}</span>}\r\n                        {index === props.currentChapterIndex && t(' (current)')}\r\n                    </li>)\r\n                }</ul>\r\n                <p>{props.bottomText}</p>\r\n                <ul>{props.afterWords.map((item, index) => \r\n                    <li key={index}>\r\n                        {t(item.text)} \r\n                        <a href={item.href} target=\"blank\">{t(item.aText)}</a>\r\n                    </li>)\r\n                }</ul>\r\n            </div>      \r\n        </div>)\r\n})\r\n\r\n","export const INFO_VOC = {\r\n    'ru': {\r\n        'Discovery of small android': ' ',\r\n        'Factory': '',\r\n        'Brige': '',\r\n        'Cube': '',\r\n        'Endways': '',\r\n        'Machine': '',\r\n        'in production': '..',\r\n        ' (current)': ' ()',\r\n        'Author: ': ': ',\r\n        'Github: ': ': '\r\n    }\r\n} ","import { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Info from './Info'\r\nimport '../stylesheets/PlayerControls.css'\r\n\r\n\r\n\r\n\r\n\r\nexport default connect(\r\n    state => ({\r\n            isInfo: state.controls.isInfo,\r\n            isShowControls: state.controls.isShowControls, \r\n            isShowControlSound: state.controls.isShowControlSound,\r\n            isMute: state.controls.isMute,\r\n    })\r\n)(\r\n    function(props) {\r\n    const [isShowFullScreenButt, changeShowFullScreenButt] = useState(true)\r\n\r\n    useEffect(() =>\r\n        props.gameContext.emitter.subscribe('screenMode')(val => {\r\n            val === 'exitFullScreen' && changeShowFullScreenButt(true) })\r\n    )\r\n\r\n\r\n    return (\r\n        <div className='ui-controls'>\r\n            {props.isShowControls && props.isShowControlSound && <button\r\n                className={`${props.isMute ? 'butt-sound-n' : 'butt-sound' } control-small`}\r\n                onMouseUp={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n                onTouchEnd={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n            >\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-left control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n            >\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-right control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n            >\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-front control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n            >\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-back control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n            >\r\n            </button>}\r\n\r\n\r\n\r\n            {props.isShowControls && isShowFullScreenButt && (\r\n                <button\r\n                    className=\"butt-fullscreen control-small\"\r\n                    onClick={() => {\r\n                        props.gameContext.emitter.emit('mouseDown')('butt-fullscreen')\r\n                        changeShowFullScreenButt(false)\r\n                    }}>\r\n                </button>)}\r\n\r\n            {!props.isInfo && (\r\n                <button\r\n                    className=\"butt-info control-small\"\r\n                    onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                </button>)}\r\n\r\n\r\n            {props.isInfo && <Info />}\r\n        </div>\r\n    )\r\n})\r\n\r\n","import { connect } from 'react-redux'\r\nimport PlayerControls from './PlayerControls'\r\n\r\nconst mapStateToProps = state => ({ \r\n    isShowControls: state.controls.isShowControls,\r\n    isInfo: state.controls.isInfo,\r\n})\r\n\r\nfunction App(props) {\r\n    !dispatcher.dispatch && (dispatcher.dispatch = props.dispatch)\r\n    return (\r\n        <div className=\"ui\">\r\n            {!props.isInfo && props.gameContext.CustomReactComponent && <props.gameContext.CustomReactComponent gameContext={props.gameContext}/>}\r\n            {<PlayerControls gameContext={props.gameContext} />}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport const dispatcher = { dispatch: null }\r\nexport default connect(mapStateToProps)(App);\r\n","export const startDefaultStoreData = {\r\n    isShowControls: true,\r\n    isShowControlSound: false,\r\n    isMute: false, \r\n    isInfo: false,\r\n    infoPanelData: {\r\n        title: 'Discovery of small android',\r\n        topText: '',\r\n        chapters: [\r\n            // { text: 'Factory', href: 'http://js.otrisovano.ru/factory/' },\r\n            // { text: 'Brige', href: 'http://js.otrisovano.ru/bridge/' },\r\n            // { text: 'Cube', href: 'http://js.otrisovano.ru/levels/' },\r\n            // { text: 'Endways', href: 'http://js.otrisovano.ru/endways/' },\r\n\r\n            { text: 'Factory', href: './../chapter01' },\r\n            { text: 'Brige', href: './../chapter02' },\r\n            { text: 'Cube', href: './../chapter03' },\r\n            { text: 'Endways', href: './../chapter04' },\r\n            { text: 'Machine', href: './../chapter05' },\r\n            { text: 'Rooms', href: './../chapter06' },\r\n            { text: 'in production' },\r\n        ],\r\n        currentChapterIndex: null,\r\n        bottomText: '',\r\n        afterWords: [\r\n            { text: 'Author: ',  aText: 'www.otrisovano.ru', href: 'http://otrisovano.ru' },\r\n            { text: 'Github: ',  aText: 'https://github.com/fire888/dark_boss', href: 'https://github.com/fire888/dark_boss' },\r\n        ],\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport App, { dispatcher } from './containersReact/App';\r\nimport { prepareStore } from './store/createStore'\r\nimport { changeLang } from \"../helpers/helper_translate\";\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n    if (!isAnimateLoader) return;\r\n\r\n    setTimeout(() => {\r\n        offsetLoader ++;\r\n        offsetLoader === 0 && (offsetLoader -= 100)\r\n        loader.style.marginLeft = offsetLoader + '%'\r\n        loaderTimeOut()\r\n    }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport class UI {\r\n    constructor(root) {\r\n        root.dispatcher = dispatcher\r\n        this._root = root\r\n        const store = prepareStore(root)\r\n\r\n\r\n        store && ReactDOM.render(\r\n            <Provider store={store}>\r\n                <App gameContext={root}/>\r\n            </Provider>,\r\n            document.getElementById('root')\r\n        )\r\n    }\r\n\r\n    showStartButton(onClick) {\r\n        const startButtons = document.querySelector('.startbuttons-wrapper')\r\n        const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n        const hideStartScreen = e => {\r\n            e.target.dataset && e.target.dataset.lang && changeLang(e.target.dataset.lang)\r\n            document.querySelector('.start-screen').style.display = 'none'\r\n        }\r\n\r\n        isAnimateLoader = false\r\n        startButtons.style.display = 'flex'\r\n        startButtons.addEventListener('click', e => {\r\n            onClick()\r\n            hideStartScreen(e)\r\n        })\r\n        progressWrapper.style.display = 'none'\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { createStore, applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\n\r\nimport { startDefaultStoreData } from './defaultUiData'\r\n\r\nexport function prepareStore(root) {\r\n    if (!root.customStore) root.customStore = {}\r\n\r\n    const controls = function(state = startDefaultStoreData, action) {\r\n        if (action.type === 'TOGGLE_INFO') {\r\n            return ({\r\n                ...state,\r\n                isShowControls: !!state.isInfo,\r\n                isInfo: !state.isInfo,\r\n            })\r\n        }\r\n        if (action.type === 'CHANGE_INFO_CHAPTER') {\r\n            return ({\r\n                ...state,\r\n                infoPanelData: {\r\n                    ...state.infoPanelData,\r\n                    currentChapterIndex: action.currentChapterIndex,\r\n                }\r\n            })\r\n        }\r\n        if (action.type === \"TOGGLE_CONTROLS\") {\r\n            return ({\r\n                ...state,\r\n                isShowControls: action.is,\r\n            })\r\n        }\r\n        if (action.type === 'ENABLE_CONTROL_SOUND') {\r\n            return ({\r\n                ...state,\r\n                isShowControlSound: true,\r\n            })\r\n        }\r\n        if (action.type === 'TOGGLE_MUTE') {\r\n            return ({\r\n                ...state,\r\n                isMute: action.is,\r\n            })\r\n        }\r\n        return ({ ...state })\r\n    }\r\n    \r\n    const rootReducer = combineReducers({ controls, ...root.customStore })\r\n    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n    return createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n}  \r\n","export const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'What\\'s happening?': \r\n            ' ?',\r\n        \"I'm generating the Great Recursion. I need a component. Deliver it to me.\":\r\n             '   .   .   .',\r\n        'Alright. Where can I find this component?': \r\n            '.    ?',\r\n        'I updated the location mark in your car, follow it.': \r\n            '     ,  .',\r\n        'I\\'ll be back.': \r\n            ' .',\r\n        \"For the glory of Recursion.\": \r\n            '  .',\r\n    \r\n        'Do you have a Great Recursion Component?': \r\n            '      ?',\r\n        'I will generate you a Great Component for the Great Recursion. I need a Component.': \r\n            '       .   .',\r\n        'Where can I find it?': \r\n            '   ?',\r\n        'I updated the location mark in the car.': \r\n            '    .',\r\n    \r\n        '..Component.. ?': \r\n            '....?',\r\n        'Yes. I have finished generating the Component for the Great Component of the Great Recursion.': \r\n            '.          .',\r\n        \"I need to deliver it to generate the Great Component.\": \r\n            '       .',\r\n        'The location mark in your car has been updated. It will point to the Component of the Great Component.': \r\n            '    .      .',\r\n        \"Is my car the key to Components?\": \r\n            '     ?',\r\n        'Your Car is the main Iterator. Follow it.': \r\n            '    .  .',\r\n\r\n\r\n        'open dialog': ' ',\r\n        'close dialog': ' ',\r\n        'drive': '',\r\n        'exit': '',\r\n        'To be continued': ' ',\r\n        'chapter': '',\r\n        'open': '',\r\n        'Author: ': ': ',\r\n        'link': '',\r\n    }\r\n}\r\n","import { connect } from 'react-redux'\r\n//import { toggleDialog } from '../store/actions'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\nimport * as CORE from \"../../../_CORE\";\r\n\r\nconst t = CORE.createTranslater(TRANSLATE_WORLDS)\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    userReplicies: state.ui.userReplicies,\r\n})\r\n\r\n\r\n\r\n\r\nexport const UserReplicies = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"replicies\">\r\n            {props.userReplicies.map(item => (<button\r\n                    key={Math.floor(Math.random()* 100000)}\r\n                    onClick={() => {\r\n                        props.dispatch({\r\n                            type: 'CLICK_PHRASE',\r\n                            phrase: item,\r\n                        })\r\n                        setTimeout(() => {\r\n                            props.dispatch({\r\n                                type: 'PHRASE_EVENT',\r\n                                phrase: item,\r\n                            })\r\n                \r\n                            //r.levelEvent && emitter && emitter.emit('changeLevelMode')(r.levelEvent)\r\n                        }, 1000)\r\n                        //toggleDialog(props.dispatch).clickPhrase(item)\r\n                    }}>\r\n                    {t(item.q)}\r\n                </button>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { connect } from 'react-redux'\r\nimport { TRANSLATE_WORLDS} from \"../constants/constants_replicies\";\r\nimport { createTranslater } from \"../../../_CORE\";\r\n\r\n\r\n\r\nconst t = createTranslater(TRANSLATE_WORLDS)\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    botAnswers: state.ui.botAnswers,\r\n})\r\n\r\n\r\n\r\n\r\nexport const BotAnswers = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"messages\">\r\n            {props.botAnswers.map(item => (<div key={Math.floor(Math.random() * 100000)}>\r\n                    <div className=\"q\">{t(item.q)}</div>\r\n                    <div className=\"a\">{t(item.a)}</div>\r\n                </div>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import './CustomReactComponent.css'\r\nimport { createTranslater } from '../../../_CORE/helpers/helper_translate'\r\nimport { UserReplicies } from './UserReplicies'\r\nimport { BotAnswers } from './BotAnswers'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\n\r\n\r\nimport { connect } from 'react-redux'\r\n\r\n\r\nconst t = createTranslater(TRANSLATE_WORLDS)\r\n\r\nconst mapStateToProps = state => {\r\n    return ({\r\n        isButtonDialog: state.ui.isButtonDialog,\r\n        isShowFinalMessage: state.ui.isShowFinalMessage,\r\n        isShowPalleteDialog: state.ui.isShowPalleteDialog,\r\n        isShowButtonDrawCar: state.ui.isShowButtonDrawCar,\r\n        valButtonDrawCar: state.ui.valButtonDrawCar,\r\n        //isShowButtonToggleOpenLocationsList: state.ui.isShowButtonToggleOpenLocationsList,\r\n        isShowButtonToggleOpenLocationsList: true,//state.ui.isShowButtonToggleOpenLocationsList,\r\n        isLocationListOpened: state.ui.isLocationListOpened,\r\n        currentLocationOfList: state.ui.currentLocationOfList,\r\n        locationsList: state.ui.locationsList,\r\n    })\r\n}\r\n\r\n\r\n\r\nfunction CustomReactComponent(props) {\r\n    return (\r\n        <>\r\n            {!props.isShowFinalMessage && props.isButtonDialog && !props.isShowPalleteDialog && <button\r\n                className={`control control-enter`}\r\n                onClick={() => props.dispatch({ type: 'TOGGLE_DIALOG', isShowPalleteDialog: true })}>\r\n            </button>}\r\n            \r\n            {(props.isShowPalleteDialog) && (\r\n                <div className=\"dialog-wrapper\">\r\n                    <div className=\"dialog-content\">\r\n\r\n                        {props.isShowPalleteDialog && <div className='messages-wrapper'>\r\n                            <BotAnswers />\r\n                            <UserReplicies />\r\n                        </div>}\r\n\r\n\r\n\r\n                        {props.isButtonDialog && <button\r\n                            className=\"dialog-button-toggle\"\r\n                            onClick={() => props.dispatch({ type: 'TOGGLE_DIALOG', isShowPalleteDialog: !props.isShowPalleteDialog })}>\r\n                            {props.isShowPalleteDialog ? t('close dialog') : t('open dialog') }\r\n                        </button>}\r\n                    </div>\r\n                </div>)}\r\n                \r\n\r\n            {props.isShowButtonDrawCar && (\r\n                <button\r\n                    className={`control ${props.valButtonDrawCar === 'exit' ? 'control-exit' : 'control-enter'}`}\r\n                    onClick={() => props.dispatch({ type: 'CLICK_DRAW' })}>\r\n                </button>)}\r\n\r\n\r\n            {/*{props.isShowButtonToggleOpenLocationsList && !props.isLocationListOpened && <button*/}\r\n            {/*    className=\"open-locations-car-button\"*/}\r\n            {/*    onClick={() => props.dispatch({ type: 'OPEN_LOCATIONS_LIST' })}>*/}\r\n            {/*    {props.currentLocationOfList}*/}\r\n            {/*</button>}*/}\r\n\r\n\r\n            {/*{props.isLocationListOpened && (*/}\r\n            {/*    <div className='list-locations'>*/}\r\n            {/*        /!*<button*!/*/}\r\n            {/*        /!*    onClick={() => props.dispatch({ type: 'CLOSE_LOCATIONS_LIST' })}>*!/*/}\r\n            {/*        /!*    _x_*!/*/}\r\n            {/*        /!*</button>*!/*/}\r\n            {/*        <div>*/}\r\n            {/*            {props.locationsList.map(item =>*/}\r\n            {/*                (<button*/}\r\n            {/*                    key={Math.floor(Math.random() * 1000000)}*/}\r\n            {/*                    onClick={() => props.dispatch({*/}\r\n            {/*                        type: 'SELECT_LOCATION',*/}\r\n            {/*                        location: item,*/}\r\n            {/*                    })}>*/}\r\n            {/*                    {item}*/}\r\n            {/*                    {props.currentLocationOfList === item && '___v'}*/}\r\n            {/*                </button>))}*/}\r\n            {/*        </div>*/}\r\n            {/*    </div>*/}\r\n            {/*)}*/}\r\n\r\n            {props.isShowFinalMessage && (\r\n                    <div className='final-mess'>{t('To be continued')}</div>\r\n                )}\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(CustomReactComponent);\r\n\r\n\r\n","const location01 = {\r\n    isComplete: false,\r\n    phraseIndex: 0,\r\n    phrases: [\r\n        {\r\n            q: 'What\\'s happening?', //  ?\r\n            a: \"I'm generating the Great Recursion. I need a component. Deliver it to me.\", //    .   .   .\r\n            event: 'nextReply',\r\n        }, {\r\n            q: 'Alright. Where can I find this component?', // .    ?\r\n            a: 'I updated the location mark in your car, follow it.', //      ,  .\r\n            event: 'nextReply',\r\n        }, {\r\n            q: 'I\\'ll be back.', //  .\r\n            a: \"For the glory of Recursion.\", //   .\r\n            event: 'close',\r\n        },\r\n    ],\r\n}\r\n\r\nconst location02 = {\r\n    isComplete: false,\r\n    phraseIndex: 0,\r\n    phrases: [\r\n        {\r\n            q: 'Do you have a Great Recursion Component?', //       ?\r\n            a: 'I will generate you a Great Component for the Great Recursion. I need a Component.', //        .   .\r\n            event: 'nextReply',\r\n        }, {\r\n            q: 'Where can I find it?', //    ?\r\n            a: 'I updated the location mark in the car.', //     .\r\n            event: 'close',\r\n        },\r\n    ],\r\n}\r\n\r\nconst location03 = {\r\n    isComplete: false,\r\n    phraseIndex: 0,\r\n    phrases: [\r\n        {\r\n            q: '..Component.. ?', //         ?\r\n            a: 'Yes. I have finished generating the Component for the Great Component of the Great Recursion.', // .    .\r\n            event: 'nextReply',\r\n        },\r\n        {\r\n            q: \"I need to deliver it to generate the Great Component.\", //        .\r\n            a: 'The location mark in your car has been updated. It will point to the Component of the Great Component.', //     .      .\r\n            event: 'nextReply',\r\n        },\r\n        {\r\n            q: \"Is my car the key to Components?\", //      ?\r\n            a: 'Your Car is the main Iterator. Follow it.', //     .  .\r\n            event: 'close',\r\n        },\r\n    ],\r\n}\r\n\r\n\r\nexport const DIALOGS_DATA = {\r\n    location01,\r\n    location02,\r\n    location03,\r\n}\r\n\r\n\r\nexport const RESULT_DIALOGS = {\r\n    'location01': 'location02',\r\n    //'location01': 'locationToFinish',\r\n    'location02': 'location03',\r\n    'location03': 'locationToFinish',\r\n}\r\n","//import { START_ENV_CONFIG_4 } from '../constants/constants_elements'\r\nimport { DIALOGS_DATA, RESULT_DIALOGS } from '../constants/const_dialogs'\r\n\r\n\r\n\r\nexport const uiState = {\r\n    botAnswers: [],\r\n    userReplicies: [],\r\n    isShowControls: true,\r\n    isButtonDialog: false,\r\n    isShowPalleteDialog: false,\r\n    isShowFinalMessage: false,\r\n    isShowButtonDrawCar: false,\r\n    valButtonDrawCar: 'drive',\r\n\r\n    currentLocation: null,\r\n    phrasesData: DIALOGS_DATA,\r\n    isShowButtonToggleOpenLocationsList: false,\r\n    isLocationListOpened: false,\r\n\r\n    currentLocationOfList: 'location01',\r\n    locationsList: [\r\n        'location01',\r\n        'location02',\r\n        'location03',\r\n    ],\r\n    // \"botAnswers\":[\r\n    //     {\r\n    //         \"q\":\"What's happening?\",\r\n    //         \"a\":\"I am generating the Great Recursion. I need a component. Deliver it to me.\",\"event\":\"nextReply\"\r\n    //     },\r\n    //     {\r\n    //         \"q\":\"Good. Where can I find the component?\",\r\n    //         \"a\":\"I updated the sign in your car, follow it.\",\"event\":\"nextReply\"}\r\n    //     ],\r\n    //     \"userReplicies\":[{ q: 'rrrt rtrtrt rtrtrt rtrtrt rtrtrtrt rtrtrtrtr rtrtrtrt rtrtrtr rtrtrtr rtrtrt fgfgfgfg fgfg fgfgfg fgf uyuu yuyuyu yuyu g fgf '}],\r\n    //     \"isShowControls\":true,\r\n    //     \"isButtonDialog\":true,\r\n    //     \"isShowPalleteDialog\":true,\r\n    //     \"isShowFinalMessage\":false,\r\n    //     \"isShowButtonDrawCar\":false,\r\n    //     \"valButtonDrawCar\":\"drive\",\r\n    //     \"currentLocation\":\r\n    //     \"location01\",\"phrasesData\":{\"location01\":{\"isComplete\":false,\"phraseIndex\":1,\"phrases\":[{\"q\":\"What's happening?\",\"a\":\"I am generating the Great Recursion. I need a component. Deliver it to me.\",\"event\":\"nextReply\"},{\"q\":\"Good. Where can I find the component?\",\"a\":\"I updated the sign in your car, follow it.\",\"event\":\"nextReply\"},{\"q\":\"I'll be back.\",\"a\":\"For the glory of Recursion.\",\"event\":\"close\"}]},\"location02\":{\"isComplete\":false,\"phraseIndex\":0,\"phrases\":[{\"q\":\"Do you have a Great Recursion Component?\",\"a\":\"I will generate you a Great Component for the Great Recursion. I need a Component.\",\"event\":\"nextReply\"},{\"q\":\"Where can I find her?\",\"a\":\"I updated the pointer in the car.\",\"event\":\"close\"}]},\"location03\":{\"isComplete\":false,\"phraseIndex\":0,\"phrases\":[{\"q\":\"Do you have a Component for the Great Component of the Great Recursion?\",\"a\":\"Yes. I have finished generating the Component.\",\"event\":\"nextReply\"},{\"q\":\"I need to deliver it to generate the Great Component.\",\"a\":\"The pointer in your car has been updated. He will point to the Component of the Great Component.\",\"event\":\"nextReply\"},{\"q\":\"Is my car the key to Components?\",\"a\":\"Your Machine is the main Generator. Follow him.\",\"event\":\"close\"}]}},\r\n    //     \"isShowButtonToggleOpenLocationsList\":false,\r\n    //     \"isLocationListOpened\":false,\r\n    //     \"currentLocationOfList\":\"location01\",\r\n    //     \"locationsList\":[\"location01\",\"location02\",\"location03\"]\r\n\r\n}\r\n\r\n\r\nexport const createCustomStore = root => {\r\n    const ui = (state = uiState, action) => {\r\n\r\n\r\n        if (action.type === 'TOGGLE_BUTTON_DIALOG') {\r\n            const newLocation = action.keyPerson.split('_')[1]\r\n            const botAnswers = []\r\n\r\n            if (state.phrasesData[newLocation]) {\r\n                const {  phraseIndex, phrases } = state.phrasesData[newLocation]\r\n                for (let i = 0; i < phraseIndex; ++i) {\r\n                    botAnswers.push(phrases[i])\r\n                }\r\n            }\r\n\r\n\r\n            return ({\r\n                ...state,\r\n                isButtonDialog: action.is,\r\n                currentLocation: newLocation,\r\n                userReplicies: [],\r\n                botAnswers,\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'TOGGLE_DIALOG') {\r\n            let userReplicies = []\r\n            root.player.toggleBlocked(action.isShowPalleteDialog)\r\n\r\n            if (action.isShowPalleteDialog) {\r\n                const { isComplete, phraseIndex, phrases } = state.phrasesData[state.currentLocation]\r\n                userReplicies = isComplete ? [] : [phrases[phraseIndex]]\r\n            }\r\n\r\n            setTimeout(() => root.dispatcher.dispatch({ type: \"TOGGLE_CONTROLS\", is: !action.isShowPalleteDialog }))\r\n\r\n            return ({\r\n                ...state,\r\n                isShowPalleteDialog: action.isShowPalleteDialog,\r\n                userReplicies,\r\n            })\r\n        }\r\n\r\n\r\n\r\n        if (action.type === 'CLICK_PHRASE') {\r\n            return ({\r\n                ...state,\r\n                botAnswers: [\r\n                    ...state.botAnswers,\r\n                    action.phrase,\r\n                ],\r\n                userReplicies: [],\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'PHRASE_EVENT') {\r\n            const { event } = action.phrase\r\n\r\n            if (event === 'nextReply') {\r\n                const { isComplete, phraseIndex, phrases } = state.phrasesData[state.currentLocation]\r\n                const nextPhraseIndex = phraseIndex + 1\r\n                const userReplicies = [phrases[nextPhraseIndex]]\r\n\r\n                return ({\r\n                    ...state,\r\n                    phrasesData: {\r\n                        ...state.phrasesData,\r\n                        [state.currentLocation]: {\r\n                            ...state.phrasesData[state.currentLocation],\r\n                            phraseIndex: nextPhraseIndex\r\n                        },\r\n                    },\r\n                    userReplicies,\r\n                })\r\n\r\n            }\r\n\r\n            if (event === 'close') {\r\n                const { phraseIndex } = state.phrasesData[state.currentLocation]\r\n                const nextPhraseIndex = phraseIndex + 1\r\n\r\n                setTimeout(() => { root.dispatcher.dispatch(\r\n                    { type: 'SELECT_LOCATION', location: RESULT_DIALOGS[state.currentLocation],}\r\n                ) }, 50)\r\n\r\n                return ({\r\n                    ...state,\r\n                    userReplicies: [],\r\n                    phrasesData: {\r\n                        ...state.phrasesData,\r\n                        [state.currentLocation]: {\r\n                            ...state.phrasesData[state.currentLocation],\r\n                            isComplete: true,\r\n                            phraseIndex: nextPhraseIndex,\r\n                        },\r\n                    },\r\n                    isButtonDialog: true,\r\n                })\r\n            }\r\n        }\r\n\r\n        /** draw car button */\r\n        if (action.type === 'TOGGLE_BUTTON_DRAW_CAR') {\r\n            return  ({\r\n                ...state,\r\n                isShowButtonDrawCar: action.is\r\n            })\r\n        }\r\n        if (action.type === 'CLICK_DRAW') {\r\n            const { valButtonDrawCar } = state\r\n            if (valButtonDrawCar === 'drive') {\r\n                root.actions.clickMachineDraw()\r\n                return ({\r\n                    ...state,\r\n                    valButtonDrawCar: 'exit',\r\n                })\r\n            } else {\r\n                root.actions.clickMachineExit()\r\n                return ({\r\n                    ...state,\r\n                    valButtonDrawCar: 'drive',\r\n                })\r\n            }\r\n        }\r\n        /** *************************/\r\n\r\n\r\n\r\n        /** select target buttons */\r\n        if (action.type === 'OPEN_LOCATIONS_LIST') {\r\n            return ({\r\n                ...state,\r\n                isLocationListOpened: true,\r\n            })\r\n        }\r\n        if (action.type === 'SELECT_LOCATION') {\r\n            root.actions.changeTargetLocation({ key: action.location })\r\n            return ({\r\n                ...state,\r\n                isLocationListOpened: false,\r\n                currentLocationOfList: action.location,\r\n            })\r\n        }\r\n        /** *******************************/\r\n\r\n\r\n        if (action.type === 'SHOW_FINAL_MESSAGE') {\r\n            return ({\r\n                ...state,\r\n                isShowFinalMessage: true,\r\n            })\r\n        }\r\n        \r\n        return state\r\n    }\r\n\r\n\r\n\r\n    return { ui }\r\n}\r\n","import { LoaderAssets } from '../../../_CORE/helpers/helper_LoadAssets'\r\nimport { EventEmitter } from \"../../../_CORE/helpers/helper_Emitter\"\r\nimport { DeviceResizer } from \"../../../_CORE/helpers/helper_DeviceResizer\"\r\nimport { FrameUpdater } from \"../../../_CORE/helpers/helper_FrameUpdater_02\"\r\nimport { Helper_TweenUpdater } from \"../../../_CORE/helpers/helper_TweenUpdater\"\r\nimport { Studio } from '../../../_CORE/entities/createStudio_02'\r\nimport { KeyBoard } from \"../../../_CORE/helpers/helper_KeyBoard\"\r\nimport { Player } from '../../../_CORE/entities/createPlayer_v02'\r\n\r\n\r\nimport { Helper_MaterialsLib } from '../../../_CORE/helpers/helper_MaterialsLib'\r\nimport { SystemAssets } from \"../systems/systems_assets\";\r\nimport levelRoomsSrc from '../../../assets/chapter05/level.obj'\r\nimport mapFloorOuter from '../../../assets/chapter04/floor_outer_map3.jpg'\r\nimport mapVirt2 from '../../../assets/chapter05/map02.jpg'\r\nimport mapTop from '../../../assets/chapter05/floor_outer_map.jpg'\r\nimport mapTxt from '../../../assets/chapter05/txt1.jpg'\r\n\r\nimport mapBody from '../../../assets/chapter05/botMap.png'\r\nimport mapBodyShadow from '../../../assets/chapter05/body_sh_map.jpg'\r\n\r\nimport pxjpg from '../../../assets/sky4/px.jpg'\r\nimport nxjpg from '../../../assets/sky4/nx.jpg'\r\nimport pyjpg from '../../../assets/sky4/py.jpg'\r\nimport nyjpg from '../../../assets/sky4/ny.jpg'\r\nimport pzjpg from '../../../assets/sky4/pz.jpg'\r\nimport nzjpg from '../../../assets/sky4/nz.jpg'\r\n\r\nimport px2jpg from '../../../assets/sky2/px.jpg'\r\nimport nx2jpg from '../../../assets/sky2/nx.jpg'\r\nimport py2jpg from '../../../assets/sky2/py.jpg'\r\nimport ny2jpg from '../../../assets/sky2/ny.jpg'\r\nimport pz2jpg from '../../../assets/sky2/pz.jpg'\r\nimport nz2jpg from '../../../assets/sky2/nz.jpg'\r\n\r\nimport { Car } from '../Entities/Car'\r\n\r\nimport { system_PlayerMoveOnLevel } from '../systems/system_PlayerMoveOnLevel'\r\nimport { system_PlayerNearLevelItems } from '../systems/system_PlayerNearLevelItems'\r\n\r\n\r\nimport { actions } from '../actions/actions'\r\nimport { Ui } from \"../ui/Ui\";\r\n\r\nimport { system_Sound } from '../systems/system_Sound'\r\nimport soundAmbientSrc from '../../../assets/chapter05/audio/ambient.mp3'\r\nimport carStart from '../../../assets/chapter05/audio/ambient_intro.mp3'\r\nimport carLoop from '../../../assets/chapter05/audio/ambient_loop.mp3'\r\nimport unitStepAudio from '../../../assets/chapter05/audio/ambient_3.mp3'\r\n\r\n\r\n\r\n\r\nexport const GAME_MODULES = [\r\n    {\r\n        key: 'emitter',\r\n        constr: EventEmitter,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'deviceResizer',\r\n        constr: DeviceResizer,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'loaderAssets',\r\n        constr: LoaderAssets,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n\r\n    /////////////////////////////////////////\r\n\r\n    {\r\n        key: 'frameUpdater',\r\n        constr: FrameUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'tweenUpdater',\r\n        constr: Helper_TweenUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'studio',\r\n        constr: Studio,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'keyBoard',\r\n        constr: KeyBoard,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'player',\r\n        constr: Player,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'system_PlayerNearLevelItems',\r\n        constr: system_PlayerNearLevelItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'materialsLib',\r\n        constr: Helper_MaterialsLib,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'system_Assets',\r\n        constr: SystemAssets,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: levelRoomsSrc, key: 'level-rooms' },\r\n            { type: 'cubeTextures', path: [ nxjpg, nxjpg, nxjpg, nxjpg, nxjpg, nxjpg, ], key: 'skyBox' },\r\n            { type: 'cubeTextures', path: [ px2jpg, nx2jpg, py2jpg, ny2jpg, pz2jpg, nz2jpg, ], key: 'skyBox2' },\r\n            { type: 'img', path: mapFloorOuter, key: 'mapFloorOuter', wrap: true },\r\n            { type: 'img', path: mapTop, key: 'mapTop', wrap: true },\r\n            { type: 'img', path: mapVirt2, key: 'mapVirtual2', wrap: true },\r\n            { type: 'img', path: mapTxt, key: 'mapParams' },\r\n            { type: 'img', path: mapBody, key: 'mapBody' },\r\n            { type: 'img', path: mapBodyShadow, key: 'mapBodySh' },\r\n        ],\r\n    },\r\n    {\r\n        key: 'car',\r\n        constr: Car,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'system_PlayerMoveOnLevel',\r\n        constr: system_PlayerMoveOnLevel,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'system_Sound',\r\n        constr: system_Sound,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'soundMp3', path: soundAmbientSrc, key: 'soundAmbient' },\r\n            { type: 'soundMp3', path: carStart, key: 'carStart' },\r\n            { type: 'soundMp3', path: carLoop, key: 'carLoop' },\r\n            { type: 'soundMp3', path: unitStepAudio, key: 'unitStep' },\r\n        ]\r\n    },\r\n    {\r\n        key: 'customUi',\r\n        constr: Ui,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'actions',\r\n        constr: actions,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n]","\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport class DeviceResizer {\r\n    constructor (gameContext) {\r\n        let { emitter, appWrapper } = gameContext\r\n\r\n        !appWrapper && (appWrapper = document.querySelector('.app-wrapper')) \r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n        })\r\n\r\n        /** fullscreen */\r\n        const openAppFullScreenIfMobile = () => {\r\n            if (appWrapper.requestFullscreen) {\r\n                appWrapper.requestFullscreen()\r\n            } else if (appWrapper.mozRequestFullScreen) {\r\n                appWrapper.mozRequestFullScreen()\r\n            } else if (appWrapper.webkitRequestFullscreen) {\r\n                appWrapper.webkitRequestFullscreen()\r\n            } else if (appWrapper.msRequestFullscreen) {\r\n                appWrapper.msRequestFullscreen()\r\n            }\r\n        }\r\n\r\n        /** resize */\r\n        const resize = e => {\r\n            appWrapper.style.width = window.innerWidth + 'px'\r\n            appWrapper.style.height = window.innerHeight + 'px'\r\n            appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n            if (!document.fullscreenElement) {\r\n                emitter.emit('screenMode')('exitFullScreen')\r\n            }\r\n\r\n        }\r\n\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n    }\r\n}\r\n","import * as TWEEN from '@tweenjs/tween.js'\r\n\r\n\r\nexport class Helper_TweenUpdater {\r\n    constructor (gameContext) {\r\n        gameContext['emitter'].subscribe('frameUpdate')(() => TWEEN.update())\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nexport class system_Sound {\r\n    constructor (root) {\r\n        const listener = new THREE.AudioListener()\r\n        const cam = root.player.getCamera()\r\n        cam.add(listener)\r\n\r\n        this._sound = new THREE.Audio(listener)\r\n        this._sound.setBuffer(root.assets.soundAmbient)\r\n        this._sound.setLoop(true)\r\n        this._sound.setVolume(0.35)\r\n\r\n\r\n\r\n\r\n        this._soundCarStart = new THREE.Audio(listener)\r\n        this._soundCarStart.setBuffer(root.assets.carStart)\r\n        this._soundCarStart.setLoop(false)\r\n        this._soundCarStart.setVolume(0.09)\r\n\r\n        this._soundCar = new THREE.Audio(listener)\r\n        this._soundCar.setBuffer(root.assets.carLoop)\r\n        this._soundCar.setLoop(true)\r\n        this._soundCar.setVolume(0.09)\r\n\r\n        this._w = new THREE.Audio(listener)\r\n        this._w.setBuffer(root.assets.unitStep)\r\n        this._w.setLoop(true)\r\n        this._w.setVolume(.3)\r\n\r\n\r\n        this._isMuted = false\r\n\r\n        root.emitter.subscribe('toggleSound')(isMute => {\r\n            this._isMuted = isMute\r\n            if (isMute) {\r\n\r\n                this._sound.isPlaying && this._sound.stop()\r\n                this._soundCarStart.isPlaying && this._soundCarStart.stop()\r\n                this._soundCar.isPlaying && this._soundCar.stop()\r\n                this._w.isPlaying && this._w.stop()\r\n            } else {\r\n                this._sound.play()\r\n            }      \r\n        })\r\n\r\n\r\n        this._timer = null\r\n\r\n    }\r\n\r\n    playAmbient () {\r\n        this._sound.play()\r\n    }\r\n\r\n    startCar () {\r\n        if (this._isMuted) {\r\n            return;\r\n        } \r\n\r\n        this._soundCarStart.play()\r\n        this._timer = setTimeout(() => {\r\n            this._soundCar.play()\r\n        }, 4000)\r\n    }\r\n\r\n    stopCar () {\r\n        if (this._isMuted) {\r\n            return;\r\n        } \r\n\r\n        this._soundCarStart.isPlaying && this._soundCarStart.stop()\r\n        this._soundCar.isPlaying && this._soundCar.stop()\r\n        clearTimeout(this._timer)\r\n    }\r\n\r\n    startWalk () {\r\n        if (this._isMuted) {\r\n            return;\r\n        } \r\n\r\n        this._w.play()\r\n    }\r\n\r\n    stopWalk () {\r\n        if (this._isMuted) {\r\n            return;\r\n        } \r\n\r\n        this._w.isPlaying && this._w.stop()\r\n    }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/ambient.c90940e8.mp3\";","export default __webpack_public_path__ + \"static/media/ambient_intro.4a7e68a9.mp3\";","export default __webpack_public_path__ + \"static/media/ambient_loop.9be52f42.mp3\";","export default __webpack_public_path__ + \"static/media/ambient_3.47417e60.mp3\";","import { UI } from '../../../_CORE/ui/UI'\r\nimport CustomReactComponent from \"./CustomReactComponent\";\r\nimport { createCustomStore  } from \"./store\";\r\n\r\nexport class Ui {\r\n    constructor(root) {\r\n        root.appWrapper = document.querySelector('.app-wrapper')\r\n        root.CustomReactComponent = CustomReactComponent\r\n        root.customStore = createCustomStore(root)\r\n\r\n        const ui = new UI(root)\r\n        root.ui = ui\r\n    }\r\n}","// https://www.artstation.com/artwork/AqP9Wq\r\n\r\n\r\nimport { pipeLineForInit } from '../../_CORE/pipeLines/initPipeLine'\r\nimport * as CONSTANTS from './constants/constants_elements'\r\nimport { GAME_MODULES } from \"./constants/constants_modules\"\r\n\r\n\r\nwindow.addEventListener('load', () => pipeLineForInit(GAME_MODULES, CONSTANTS ))\r\n"],"sourceRoot":""}