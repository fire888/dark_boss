{"version":3,"sources":["_CORE/pipeLines/initPipeLine.js","chapter05/src/constants/constants_elements.js","_CORE/helpers/helper_LoadAssets.js","_CORE/helpers/helper_Emitter.js","_CORE/helpers/helper_translate.js","_CORE/ui/containersReact/Info.js","_CORE/constants/default_voc.js","_CORE/ui/containersReact/PlayerControls.js","_CORE/ui/containersReact/App.js","_CORE/ui/store/defaultUiData.js","_CORE/ui/UI.js","_CORE/ui/store/createStore.js","_CORE/helpers/helper_FrameUpdater_02.js","_CORE/shaders/saturate.js","_CORE/shaders/saturate2.js","_CORE/entities/createStudio_02.js","_CORE/helpers/helper_KeyBoard.js","_CORE/entities/createPlayer_v02.js","_CORE/helpers/helper_MaterialsLib.js","chapter05/src/systems/system_level.js","assets/chapter05/level.obj","assets/chapter04/floor_outer_map3.jpg","assets/chapter05/map01.jpg","assets/chapter04/floor_outer_map2.jpg","assets/floor_outer_map.jpg","assets/chapter05/txt1.jpg","assets/sky4/px.jpg","assets/sky4/nx.jpg","assets/sky4/py.jpg","assets/sky4/ny.jpg","assets/sky4/pz.jpg","assets/sky4/nz.jpg","assets/sky2/px.jpg","assets/sky2/nx.jpg","assets/sky2/py.jpg","assets/sky2/ny.jpg","assets/sky2/pz.jpg","assets/sky2/nz.jpg","_CORE/helpers/helper_CollisionsItems_v02.js","chapter05/src/Entities/Car.js","chapter05/src/Entities/CarCompas.js","assets/chapter05/car.obj","assets/chapter05/car_collision.obj","assets/chapter05/body.obj","chapter05/src/systems/system_PlayerMoveOnLevel.js","chapter05/src/systems/system_PlayerNearLevelItems.js","chapter05/src/components/checkerChangeLocationKey.js","chapter05/src/helpers/m4.js","chapter05/src/Entities/geometry/helpers.js","chapter05/src/Entities/geometry/dataColumnSide.js","chapter05/src/Entities/geometry/dataColumn.js","chapter05/src/Entities/geometry/dataTopElem.js","chapter05/src/Entities/geometry/dataColumnSimple.js","chapter05/src/Entities/geometry/segmentGallery.js","chapter05/src/Entities/geometry/dataArc.js","chapter05/src/Entities/meshGallery.js","chapter05/src/Entities/geometry/schemeGallery.js","chapter05/src/Entities/geometry/dataArcHalf.js","chapter05/src/Entities/geometry/segmentStair.js","chapter05/src/Entities/geometry/dataStairSimple.js","chapter05/src/Entities/geometry/dataZone.js","chapter05/src/Entities/geometry/dataBridge.js","chapter05/src/Entities/geometry/schemeSuper.js","chapter05/src/Entities/meshSuper.js","chapter05/src/actions/actions.js","chapter05/src/Entities/meshStairs.js","chapter05/src/Entities/geometry/schemeStairs.js","chapter05/src/constants/constants_replicies.js","chapter05/src/ui/UserReplicies.js","chapter05/src/ui/BotAnswers.js","chapter05/src/ui/CustomReactComponent.js","chapter05/src/ui/store.js","chapter05/src/constants/constants_modules.js","_CORE/helpers/helper_DeviceResizer.js","_CORE/helpers/helper_TweenUpdater.js","chapter05/src/ui/Ui.js","chapter05/src/index.js"],"names":["gameModules","CONSTANTS","a","initModulesByState","root","loaderAssets","dataToLoad","getAssetsFromModulesData","loadAssets","assets","state","modulesData","i","length","key","constr","initStateKey","arr","assetsToLoad","j","push","SIZE_QUADRANT","LOCATIONS_QUADRANTS","CONFIG_FOR_INIT","isInCar","currentSceneConfig","isInVirtual","isPlayerInCar","carProps","keyMesh","keyCollide","position","rotation","bodyProps","lCol","lW","MATERIALS_CONFIG","mat","props","color","emissive","map","bumpMap","bumpScale","specular","vertexColors","reflectivity","shininess","START_ENV_CONFIG","fogNear","fogFar","studioConfig","canId","rendererCon","antialias","amb","strength","sceneEnvironment","composerAddPass","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","backObjPos","createLoaders","objLoader","textureLoader","gltfLoader","cubeTextureLoader","soundLoader","path","type","Promise","resolve","OBJLoader","GLTFLoader","THREE","getterLoader","load","LoaderAssets","this","resources","_load","data","iterate","index","EventEmitter","_storage","id","getOrCreateArrFromObj","forEach","action","callback","filter","item","s","console","log","obj","lang","createTranslater","vocab","word","t","connect","controls","infoPanelData","className","onClick","dispatch","title","topText","chapters","href","target","text","currentChapterIndex","bottomText","afterWords","aText","isInfo","isShowControls","isShowControlSound","isMute","useState","isShowFullScreenButt","changeShowFullScreenButt","useEffect","gameContext","emitter","subscribe","val","onMouseUp","emit","is","onTouchEnd","onMouseDown","onTouchStart","dispatcher","CustomReactComponent","startDefaultStoreData","loader","document","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","setTimeout","style","marginLeft","UI","_root","store","customStore","rootReducer","combineReducers","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","thunk","prepareStore","ReactDOM","render","getElementById","startButtons","progressWrapper","hideStartScreen","e","l","dataset","display","addEventListener","FrameUpdater","_subscribers","time","delta","count","oldTime","update","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","fn","Saturate","uniforms","value","vertexShader","fragmentShader","Saturate2","Studio","clearColor","canvas","_renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","_scene","backgroundImgKey","background","fog","_lightA","add","directionalLight","set","_playerCamera","_controlsCamera","OrbitControls","domElement","_composer","EffectComposer","_renderPass","RenderPass","addPass","ShaderPass","vec3","isPlayerView","camera","getWorldPosition","x","y","z","resize","size","width","height","aspect","updateProjectionMatrix","addToScene","mesh","removeFromScene","remove","drawFrame","cam","conf","_changeFog","_changeBackground","_backgroundImgKey","KeyBoard","keys","keysEnabled","keyUpdate","keyCode","isDown","event","Player","studio","lightDataOne","_camera","isBlocked","isFreeze","fromArray","userData","bottomObj","frontObj","backObj","strenth","light","setCamera","isFeeze","createMaterials","wrapS","wrapT","mapsKeys","materials","keyMap","createLevelMeshes","items","traverse","child","geometry","name","material","wallVirtual","includes","helper_CollisionsItems_v02","_arrMeshes","_vecStart","_vecDir","_rayCaster","objFrom","objTo","dist","sub","intersects","intersectObjects","distance","Car","system_Level","_model","car","children","_collision","carCollision","visible","_frontObj","_backObj","_compass","arrow","_items","src","addToParent","parent","setArrowPosition","setTargetPosition","copy","lookAt","Math","PI","createCarCompas","_collisionsWalls","checkCollision","d","checkCollisions","_onChangeStateIsStay","_spd","_acc","_deceleration","_maxSpdFront","_maxSpdBack","_spdRot","_isCarStay","translateZ","abs","min","max","rotBySpeed","setItemToCollision","removeItemFromCollision","quaternion","system_PlayerMoveOnLevel","player","collisionsWalls","toggleBlocked","isCanMove","toggleCanMove","dir","rotateY","isCollision","collision","translateY","checkBottomAndDropDownPlayer","object","checkAndMoveFront","checkAndMoveBack","system_PlayerNearLevelItems","_itemsToCheck","distanceTo","nearPlayerIsNearPlayer","nearPlayerItemNear","nearPlayerItemKey","itemKey","nearPlayerItemFar","itemIn","generateEnvByQ","qX","qZ","getArrNotInFirst","arr1","arr2","isIn","MatType","Float32Array","subtractVectors","b","dst","normalize","v","sqrt","cross","distanceSq","dx","dy","dz","inverse","m","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","m4","cameraPosition","up","zAxis","xAxis","yAxis","addVectors","scaleVector","translation","scale","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","decompose","slice","determinate","matrix","invSX","invSY","invSZ","trace","quatFromRotationMatrix","dot","identity","transpose","lengthSq","orthographic","left","right","bottom","top","frustum","perspective","fieldOfViewInRadians","f","tan","rangeInv","tx","ty","tz","translate","xRotation","angleInRadians","c","cos","sin","yRotation","zRotation","xRotate","yRotate","zRotate","axisRotation","axis","n","oneMinusCosine","axisRotate","r00","r01","r02","r10","r11","r12","r20","r21","r22","scaling","multiply","b00","b01","b02","b03","b10","b11","b12","b13","b20","b21","b22","b23","b30","b31","b32","b33","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","transformVector","transformPoint","v0","v1","v2","transformDirection","transformNormal","mi","setDefaultType","Ctor","OldType","random","floor","ran","start","end","createFace","v3","v4","createUv","fillColorFace","createFaceWithSquare","color1","color2","maxW","maxH","innerW","innerH","x1","y1","v1_i","v2_i","v3_i","v4_i","vArr","cArr","fillColorFaceWithSquare","uArr","c1","c2","transformArr","r","vector","rotateArr","angle","translateArr","createDataSideColumn","h0","h1","rBase","hBase","hBaseToTrunk","hCapital","rCapital","hTrunkToCapital","rTrunk","_h0","_h1","base","colorBase","uv1","base1","colorBase1","uv1_1","baseToTrunk","colorBaseToTrunk","uvBT","h","h2","arrDividers","leftH","currentH","h01","h02","h03","h04","fullH","vert","col","uv","createTrunk","uvT","trunkToCapital","capital","uvC","frontVert","frontColors","frontUV","createDataColumn","capTop","capBottom","leftVert","rightVert","backVert","u","wL","createTopElem","isTopElem","vertTopElem","colorsTopElem","uvTopElem","hl1","hl2","hl3","hl4","hl5","hl6","nextI","angle1","angle2","_h2","_r1","_r2","sA1","cA1","sA2","cA2","lW3","lW2","createSimpleColumn","isColumn","vertColumn","colorsColumn","uvColumn","hC","createSegmentGallery","arc","arcData","rCap","wCol","lBridge","zArc","columnF","colorFill2","colorFill1","column","columnB","cA","uvA","resolution","step","diff","offsetArcTop","hI1","hI2","tZ","cap","createDataSideArc","columnData","createMeshGallery","arrV","arrC","arrUV","scheme","offsetStart","numFromCenter","isAddNext","num","savedL","createScheme","vertices","colors","setAttribute","computeVertexNormals","wallVirtualColor","hPI","colorB","createSegmentStair","bridgeL","bridgeMinusH","hColumn","rColumn","hh","hCol","stair","uvBr","uvCl","createDataStairSimple","simpleColumn","halfArcData","hArc","arcL","arcStep","phase0","phase1","createDataArcHalf","isTop","topElemData","createDataZone","xCenter","zCenter","offset","createDataBridge","centerBridgeX","centerBridgeZ","r2","lenBridge","createSet","hStart","hEnd","stepH","p","D","C","OFFSET","createMeshSuper","nextDir","nextXCenter","nextZCenter","createSchemeSuper","vertP","colorsP","uvTopP","coll","collGeom","collMat","meshCollision","meshFinish","actions","frameUpdater","onChangeCarStateMove","checkerChangeLocation","SIZE","keyX","keyZ","oldKey","currentEnv","checkChanged","newKey","saveOldKey","oldEnv","addedQs","removedQs","newEnv","getCurrent","loc","createCheckerChangeLocationKey","currentQuadrantKey","_changerLocations","createChangerLocations","_changerLevelTresh","createManagerLevelTrash","createTresh","on","updateTrash","removeLocationFromScene","strArr","split","locationX","locationZ","addLocationToScene","_startPlay","toggleFreeze","getCamera","getPosition","q","getQuaternion","setToPos","setRotationFromQuaternion","keyXZ","k","ui","setItemToCheck","getModel","addItemToPlayerCollision","getCollision","showStartButton","locations","keyLocation","personCollision","removeItemFromPlayerCollision","removeCollisionForDraw","removeItemFromCheck","personOffset","setCollisionForDraw","arrTrash","stairs","createSchemeStairs","createMeshStairs","superP","trashCollisionGeom","trashMat","testRed","floorGeom","addItems","floorMat","rCount","removeArr","addArr","arrToRemove","dispose","removeItems","TRANSLATE_WORLDS","CORE","UserReplicies","userReplicies","phrase","BotAnswers","botAnswers","isButtonDialog","isShowFinalMessage","isShowPalleteDialog","isShowButtonDrawCar","valButtonDrawCar","isShowButtonToggleOpenLocationsList","isLocationListOpened","currentLocation","locationsList","location","uiState","currentBot","phraseIndex","isDialogComplete","GAME_MODULES","appWrapper","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fontSize","fullscreenElement","TWEEN","carSrc","carCollisionSrc","body","computeBoundingSphere","offsetP01","boundingSphere","center","offsetP02","offsetP03","location01","location02","location03","levelRoomsSrc","bodySrc","pxjpg","nxjpg","pyjpg","nyjpg","pzjpg","nzjpg","px2jpg","nx2jpg","py2jpg","ny2jpg","pz2jpg","nz2jpg","mapFloorOuter","wrap","mapTop","mapVirt","mapTxt","changeTargetLocation","levelEvent","phrasesData","clickMachineDraw","clickMachineExit","createCustomStore","pipeLineForInit"],"mappings":"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","file":"static/js/main.1d2c57c4.chunk.js","sourcesContent":["export async function pipeLineForInit (gameModules, CONSTANTS) {\r\n    const root = { CONSTANTS }\r\n\r\n    initModulesByState('pageLoaded', gameModules, root)\r\n\r\n    const { loaderAssets } = root\r\n\r\n    const dataToLoad = getAssetsFromModulesData(gameModules)\r\n    root.assets = await loaderAssets.loadAssets(dataToLoad)\r\n\r\n    initModulesByState('beforeStartPlay', gameModules, root)\r\n}\r\n\r\n\r\nconst initModulesByState = (state, modulesData, root) => {\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        const {  key, constr, initStateKey } = modulesData[i]\r\n        initStateKey === state && (root[key] = new constr(root))\r\n    }\r\n}\r\n\r\nconst getAssetsFromModulesData = modulesData => {\r\n    const arr = []\r\n    for (let i = 0; i < modulesData.length; ++i) {\r\n        if (modulesData[i].assetsToLoad && modulesData[i].assetsToLoad.length) {\r\n            for (let j = 0; j < modulesData[i].assetsToLoad.length; ++j) {\r\n                arr.push(modulesData[i].assetsToLoad[j])\r\n            }\r\n        }\r\n    }\r\n    return arr\r\n}","export const SIZE_QUADRANT = 2000\r\nexport const LOCATIONS_QUADRANTS = {\r\n    //'-4_-1': 'location01',\r\n    '0_0': 'location01',\r\n    '0_-3': 'location02',\r\n    '3_-1': 'location03',\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const CONFIG_FOR_INIT = {\r\n    isInCar: false,\r\n    currentSceneConfig: {\r\n        isInVirtual: false,\r\n        isPlayerInCar: false,\r\n        carProps: {\r\n            keyMesh: 'car',\r\n            keyCollide: 'carCollision',\r\n            position: [0, -50, -100],\r\n            rotation: [0, 2, 0],\r\n        },\r\n        bodyProps: {\r\n            keyMesh: 'body',\r\n            position: [-20, -60, -50],\r\n            rotation: [0, 2, 0],\r\n        },\r\n    },\r\n}\r\n\r\n\r\n\r\nexport const lCol = [.3, 1, .3]\r\nexport const lW = .2 \r\n\r\nexport const MATERIALS_CONFIG = {\r\n    'wallVirtual': {\r\n        mat: 'MeshStandardMaterial',\r\n        props: {\r\n            //color: 0xffd4a8,\r\n            color: 0xff00ff,\r\n            //color: 0x999999,\r\n            emissive: 0x000000,\r\n            //map: 'mapVirtual',\r\n            //bumpMap: 'mapVirtual',\r\n            //bumpScale: 3,\r\n            //envMap: 'skyBox',\r\n            //reflectivity: .5,\r\n            //shininess: .5,\r\n            //specular: 0xffffff,\r\n        },\r\n    },\r\n    'wallVirtualColor': {\r\n        //mat: 'MeshPhongMaterial',\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            //color: 0xffd4a8,\r\n            color: 0xffffff,\r\n            //color: 0x999999,\r\n            emissive: 0x001111,\r\n            map: 'mapParams',\r\n            bumpMap: 'mapParams',\r\n            bumpScale: .1,\r\n            //envMap: 'skyBox',\r\n            //reflectivity: .5,\r\n            //shininess: .5,\r\n            specular: 0x0000ff,\r\n            vertexColors: true,\r\n        },\r\n    },\r\n\r\n    'car': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            //color: 0xffd4a8,\r\n            color: 0x0000ff,\r\n            //color: 0x999999,\r\n            emissive: 0x000000,\r\n            //map: 'mapVirtual',\r\n            //bumpMap: 'mapVirtual',\r\n            //bumpScale: 3,\r\n            ///envMap: 'skyBox',\r\n            reflectivity: .5,\r\n            shininess: .5,\r\n            specular: 0xffffff,\r\n        },\r\n    },\r\n\r\n    'floorMat': {\r\n        mat: 'MeshStandardMaterial',\r\n        props: {\r\n            color: 0x004400,\r\n            //color: 0x999999,\r\n            //emissive: 0x000000,\r\n            //map: 'mapVirtual',\r\n            //bumpMap: 'mapVirtual',\r\n            //bumpScale: 3,\r\n            ///envMap: 'skyBox',\r\n            //reflectivity: .5,\r\n            //shininess: .5,\r\n            //specular: 0xffffff,\r\n        },\r\n    },\r\n\r\n    'testRed': {\r\n        mat: 'MeshBasicMaterial',\r\n        props: {\r\n            color: 0xff0000,\r\n        },\r\n    },\r\n\r\n}\r\n\r\n\r\n\r\nexport const START_ENV_CONFIG = { fogNear: 500, fogFar: 1500, color: 0x00aa00, /*backgroundImgKey: 'skyBox2'*/ }\r\n//export const START_ENV_CONFIG_2 = { fogNear: -10, fogFar: 0, color: 0x4a0a45, backgroundImgKey: 'skyBox2' }\r\n//export const START_ENV_CONFIG_3 = { fogNear: 20, fogFar: 1500, color: 0x334455, backgroundImgKey: 'skyBox2' }\r\n//export const START_ENV_CONFIG_4 = { fogNear: -10, fogFar: 0, color: 0x4a0a45, backgroundImgKey: null }\r\n\r\n//export const START_ENV_CONFIG = { fogNear: -10, fogFar: 20, color: 0xffd4a8, backgroundImgKey: 'skyBox' }\r\n//export const START_ENV_CONFIG = { fogNear: 20, fogFar: 1500, color: 0x888888, backgroundImgKey: 'skyBox' }\r\n//export const START_ENV_CONFIG_2 = { fogNear: -10, fogFar: 0, color: 0x888888, backgroundImgKey: 'skyBox' }\r\n//export const START_ENV_CONFIG_3 = { fogNear: 20, fogFar: 1500, color: 0x888888, backgroundImgKey: 'skyBox' }\r\n//export const START_ENV_CONFIG_4 = { fogNear: -10, fogFar: 0, color: 0x888888, backgroundImgKey: null }\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    amb: {\r\n        color: 0xffffff,\r\n        strength: 1,\r\n    },\r\n    sceneEnvironment: START_ENV_CONFIG,\r\n    composerAddPass: 'Saturate',\r\n    //composerAddPass: 'Saturate2',\r\n}\r\n\r\n\r\n\r\n\r\nexport const playerConfig = {\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 10.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    startPos: [0, 5, 0],\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 10000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    backObjPos: [0, 0, 1],\r\n    // lightDataOne: {\r\n    //     color: 0xffffff,\r\n    //     strength: .5,\r\n    //     pos: [0, 0, 0],\r\n    // },\r\n}\r\n","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\n\r\nconst createLoaders = () => {\r\n    let objLoader = null,\r\n        textureLoader = null,\r\n        gltfLoader = null,\r\n        cubeTextureLoader = null,\r\n        soundLoader = null\r\n\r\n\r\n    const getterLoader = type => {\r\n        if (type === 'obj')\r\n            return objLoader = (objLoader || new OBJLoader())\r\n        if (type === 'glb' || type === 'gltf')\r\n            return gltfLoader = (gltfLoader || new GLTFLoader())\r\n        if (type === 'img')\r\n            return textureLoader = (textureLoader || new THREE.TextureLoader())\r\n        if (type === 'cubeTextures') {\r\n            return cubeTextureLoader = (cubeTextureLoader || new THREE.CubeTextureLoader())\r\n        }\r\n        if (type === 'soundMp3') {\r\n            return soundLoader = (soundLoader || new THREE.AudioLoader())\r\n        }\r\n\r\n    }\r\n\r\n    return (path, type) => new Promise(resolve => {\r\n        getterLoader(type).load(path, resolve)\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\nexport class LoaderAssets {\r\n\r\n    constructor () {\r\n        this.resources = {}\r\n        this._load = createLoaders()\r\n    }\r\n\r\n    loadAssets (data) {\r\n        return new Promise(resolve => {\r\n\r\n            const load = this._load\r\n            const resources = this.resources\r\n\r\n            async function iterate (index) {\r\n                if (data[index]) {\r\n                    const { key, path, type } = data[index]\r\n                    resources[key] = await load(path, type)\r\n                }\r\n\r\n                ++index\r\n                !data[index]\r\n                    ? resolve(resources)\r\n                    : await iterate(index)\r\n            }\r\n\r\n           void iterate(0)\r\n        })\r\n    }\r\n}\r\n","export class EventEmitter {\r\n    constructor() {\r\n        this._storage = {}\r\n    }\r\n\r\n    emit (id) {\r\n        return data => getOrCreateArrFromObj(this._storage)(id).forEach(action => action(data))\r\n    }\r\n\r\n    subscribe (id) {\r\n        return callback => {\r\n            getOrCreateArrFromObj(this._storage)(id).push(callback)\r\n            return () => this._storage[id] = this._storage[id].filter(item => item !== callback)\r\n        }\r\n    }\r\n\r\n    showAll () {\r\n        const s = {}\r\n        for (let key in this._storage) {\r\n            s[key] = this._storage[key].length\r\n        }\r\n        console.log(s)\r\n    }\r\n}\r\n\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\n\r\n\r\n\r\n\r\n\r\n","let lang = 'en'\r\nexport const changeLang = l => lang = l \r\nexport const createTranslater = vocab => word => (vocab[lang] && vocab[lang][word]) || word\r\n","import { connect } from \"react-redux\";\r\nimport '../stylesheets/Info.css'\r\nimport { createTranslater } from '../../helpers/helper_translate'\r\nimport { INFO_VOC } from '../../constants/default_voc'\r\n\r\n\r\nconst t = createTranslater(INFO_VOC)\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        ...state.controls.infoPanelData,\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(function(props) {\r\n    return ( \r\n        <div className=\"info\">\r\n            <button\r\n                className=\"control butt-infoClose\"\r\n                onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                x\r\n            </button>\r\n            <div className=\"info-inner\">\r\n                <p>{t(props.title)}</p>\r\n                <p>{t(props.topText)}</p>\r\n                <ul>{props.chapters.map((item, index) => \r\n                    <li key={index}>\r\n                        {index + 1}.&nbsp;\r\n                        {item.href \r\n                            ? <span><a href={item.href} target=\"blank\">{t(item.text)}</a></span>\r\n                            : <span>{t(item.text)}</span>}\r\n                        {index === props.currentChapterIndex && t(' (current)')}\r\n                    </li>)\r\n                }</ul>\r\n                <p>{props.bottomText}</p>\r\n                <ul>{props.afterWords.map((item, index) => \r\n                    <li key={index}>\r\n                        {t(item.text)} \r\n                        <a href={item.href} target=\"blank\">{t(item.aText)}</a>\r\n                    </li>)\r\n                }</ul>\r\n            </div>      \r\n        </div>)\r\n})\r\n\r\n","export const INFO_VOC = {\r\n    'ru': {\r\n        'Discovery of small android': 'Путешествия дроида',\r\n        'Factory': 'Фабрика',\r\n        'Brige': 'Мост',\r\n        'Cube': 'Куб',\r\n        'Endways': 'Напрямик',\r\n        'in production': 'скоро..',\r\n        ' (current)': ' (тут)',\r\n        'Author: ': 'от: ',\r\n        'Github: ': 'Гитхаб: '\r\n    }\r\n} ","import { useState, useEffect } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Info from './Info'\r\nimport '../stylesheets/PlayerControls.css'\r\n\r\n\r\n\r\n\r\n\r\nexport default connect(\r\n    state => ({\r\n            isInfo: state.controls.isInfo,\r\n            isShowControls: state.controls.isShowControls, \r\n            isShowControlSound: state.controls.isShowControlSound,\r\n            isMute: state.controls.isMute,\r\n    })\r\n)(\r\n    function(props) {\r\n    const [isShowFullScreenButt, changeShowFullScreenButt] = useState(true)\r\n\r\n    useEffect(() =>\r\n        props.gameContext.emitter.subscribe('screenMode')(val => {\r\n            val === 'exitFullScreen' && changeShowFullScreenButt(true) })\r\n    )\r\n\r\n\r\n    return (\r\n        <div className='ui-controls'>\r\n            {props.isShowControls && props.isShowControlSound && <button\r\n                className=\"butt-sound control\"\r\n                onMouseUp={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n                onTouchEnd={() => { \r\n                    props.gameContext.emitter.emit('toggleSound')(!props.isMute) \r\n                    props.dispatch({ type: 'TOGGLE_MUTE', is: !props.isMute })\r\n                }}\r\n            >\r\n                {props.isMute ? <>&#10236;</> : <>&#10239;</>}\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-left control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-left')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-left')}\r\n            >\r\n                &#9668;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-right control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-right')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-right')}\r\n            >\r\n                &#9658;\r\n            </button>}\r\n\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-front control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-front')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-front')}\r\n            >\r\n                &#9650;\r\n            </button>}\r\n\r\n            {props.isShowControls && <button\r\n                className=\"butt-back control\"\r\n                onMouseDown={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onTouchStart={() => props.gameContext.emitter.emit('mouseDown')('butt-back')}\r\n                onMouseUp={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n                onTouchEnd={() => props.gameContext.emitter.emit('mouseUp')('butt-back')}\r\n            >\r\n                &#x25BC;\r\n            </button>}\r\n\r\n\r\n\r\n            {props.isShowControls && isShowFullScreenButt && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        props.gameContext.emitter.emit('mouseDown')('butt-fullscreen')\r\n                        changeShowFullScreenButt(false)\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n            {!props.isInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => props.dispatch({ type: 'TOGGLE_INFO' })}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n            {props.isInfo && <Info />}\r\n        </div>\r\n    )\r\n})\r\n\r\n","import { connect } from 'react-redux'\r\nimport PlayerControls from './PlayerControls'\r\n\r\nconst mapStateToProps = state => ({ \r\n    isShowControls: state.controls.isShowControls,\r\n    isInfo: state.controls.isInfo,\r\n})\r\n\r\nfunction App(props) {\r\n    !dispatcher.dispatch && (dispatcher.dispatch = props.dispatch)\r\n    return (\r\n        <div className=\"ui\">\r\n            {!props.isInfo && props.gameContext.CustomReactComponent && <props.gameContext.CustomReactComponent gameContext={props.gameContext}/>}\r\n            {<PlayerControls gameContext={props.gameContext} />}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport const dispatcher = { dispatch: null }\r\nexport default connect(mapStateToProps)(App);\r\n","export const startDefaultStoreData = {\r\n    isShowControls: true,\r\n    isShowControlSound: false,\r\n    isMute: false, \r\n    isInfo: false,\r\n    infoPanelData: {\r\n        title: 'Discovery of small android',\r\n        topText: '',\r\n        chapters: [\r\n            // { text: 'Factory', href: 'http://js.otrisovano.ru/factory/' },\r\n            // { text: 'Brige', href: 'http://js.otrisovano.ru/bridge/' },\r\n            // { text: 'Cube', href: 'http://js.otrisovano.ru/levels/' },\r\n            // { text: 'Endways', href: 'http://js.otrisovano.ru/endways/' },\r\n\r\n            { text: 'Factory', href: './../chapter01' },\r\n            { text: 'Brige', href: './../chapter02' },\r\n            { text: 'Cube', href: './../chapter03' },\r\n            { text: 'Endways', href: './../chapter04' },\r\n            { text: 'in production' },\r\n        ],\r\n        currentChapterIndex: null,\r\n        bottomText: '',\r\n        afterWords: [\r\n            { text: 'Author: ',  aText: 'www.otrisovano.ru', href: 'http://otrisovano.ru' },\r\n            { text: 'Github: ',  aText: 'https://github.com/fire888/dark_boss', href: 'https://github.com/fire888/dark_boss' },\r\n        ],\r\n    }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport App, { dispatcher } from './containersReact/App';\r\nimport { prepareStore } from './store/createStore'\r\nimport { changeLang } from \"../helpers/helper_translate\";\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n    if (!isAnimateLoader) return;\r\n\r\n    setTimeout(() => {\r\n        offsetLoader ++;\r\n        offsetLoader === 0 && (offsetLoader -= 100)\r\n        loader.style.marginLeft = offsetLoader + '%'\r\n        loaderTimeOut()\r\n    }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport class UI {\r\n    constructor(root) {\r\n        root.dispatcher = dispatcher\r\n        this._root = root\r\n        const store = prepareStore(root)\r\n\r\n\r\n        store && ReactDOM.render(\r\n            <Provider store={store}>\r\n                <App gameContext={root}/>\r\n            </Provider>,\r\n            document.getElementById('root')\r\n        )\r\n    }\r\n\r\n    showStartButton(onClick) {\r\n        const startButtons = document.querySelector('.startbuttons-wrapper')\r\n        const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n        const hideStartScreen = e => {\r\n            e.target.dataset && e.target.dataset.lang && changeLang(e.target.dataset.lang)\r\n            document.querySelector('.start-screen').style.display = 'none'\r\n        }\r\n\r\n        isAnimateLoader = false\r\n        startButtons.style.display = 'flex'\r\n        startButtons.addEventListener('click', e => {\r\n            onClick()\r\n            hideStartScreen(e)\r\n        })\r\n        progressWrapper.style.display = 'none'\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import { createStore, applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\n\r\nimport { startDefaultStoreData } from './defaultUiData'\r\n\r\nexport function prepareStore(root) {\r\n    if (!root.customStore) root.customStore = {}\r\n\r\n    const controls = function(state = startDefaultStoreData, action) {\r\n        if (action.type === 'TOGGLE_INFO') {\r\n            return ({\r\n                ...state,\r\n                isShowControls: !!state.isInfo,\r\n                isInfo: !state.isInfo,\r\n            })\r\n        }\r\n        if (action.type === 'CHANGE_INFO_CHAPTER') {\r\n            return ({\r\n                ...state,\r\n                infoPanelData: {\r\n                    ...state.infoPanelData,\r\n                    currentChapterIndex: action.currentChapterIndex,\r\n                }\r\n            })\r\n        }\r\n        if (action.type === \"TOGGLE_CONTROLS\") {\r\n            return ({\r\n                ...state,\r\n                isShowControls: action.is,\r\n            })\r\n        }\r\n        if (action.type === 'ENABLE_CONTROL_SOUND') {\r\n            return ({\r\n                ...state,\r\n                isShowControlSound: true,\r\n            })\r\n        }\r\n        if (action.type === 'TOGGLE_MUTE') {\r\n            return ({\r\n                ...state,\r\n                isMute: action.is,\r\n            })\r\n        }\r\n        return ({ ...state })\r\n    }\r\n    \r\n    const rootReducer = combineReducers({ controls, ...root.customStore })\r\n    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n    return createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n}  \r\n","import * as R from 'ramda'\r\n\r\n\r\nexport class FrameUpdater {\r\n    constructor () {\r\n        this._subscribers = []\r\n\r\n\r\n        let data = {\r\n            time: 0,\r\n            delta: 0,\r\n            count: 0,\r\n            oldTime: 0\r\n        }\r\n\r\n        const getDataFromGlobalVar = () => data\r\n\r\n        const updateTime = data => {\r\n            data.time = Date.now()\r\n            return data\r\n        }\r\n\r\n        const updateDelta = data => {\r\n            data.delta = (data.time - data.oldTime) * 0.001\r\n            if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n                data.delta = 1000 / 60 * 0.001\r\n            }\r\n            return data\r\n        }\r\n\r\n        const updateCount = data => {\r\n            data.count = data.delta / (1/60)\r\n            return data\r\n        }\r\n\r\n        // const emit = data => {\r\n        //     emitFrameUpdate(data)\r\n        //     return data\r\n        // }\r\n\r\n        const updateOldTime = data => {\r\n            data.oldTime = data.time\r\n            return data\r\n        }\r\n\r\n        const saveDataInGlobalVar = dataFromChine => {\r\n            data = dataFromChine\r\n            return data\r\n        }\r\n\r\n        const updateSubscribers = data => {\r\n            for (let i = 0; i < this._subscribers.length; ++i) {\r\n                this._subscribers[i]({...data })\r\n            }\r\n            return data;\r\n        }\r\n\r\n        const update = R.pipe(\r\n            getDataFromGlobalVar,\r\n            updateTime,\r\n            updateDelta,\r\n            updateCount,\r\n            updateSubscribers,\r\n            updateOldTime,\r\n            saveDataInGlobalVar\r\n        )\r\n\r\n        const animate = () => {\r\n            requestAnimationFrame(animate)\r\n            update(data)\r\n        }\r\n        animate()\r\n    }\r\n\r\n    on (fn) {\r\n        this._subscribers.push(fn)\r\n        return () => {\r\n            this._subscribers = this._subscribers.filter(item => item !== fn)\r\n        }\r\n    }\r\n}","export const Saturate = {\r\nuniforms: {\r\n\"tDiffuse\": { value: null },\r\n},\r\n\r\n\r\nvertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\nfragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n}`,\r\n}\r\n","export const Saturate2 = {\r\n    uniforms: {\r\n        \"tDiffuse\": { value: null },\r\n    },\r\n\r\n\r\n    vertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vUv = uv;\r\n  gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n\r\n\r\n    fragmentShader: `\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec4 texel = texture2D( tDiffuse, vUv );\r\n  gl_FragColor = (texel + texel * 1.5) * vec4(0.5);\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\nimport { Saturate2 } from '../shaders/saturate2'\r\n\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\n\r\n\r\n\r\nexport class Studio {\r\n    constructor(root) {\r\n        this._root = root\r\n        const { assets, emitter, } = root\r\n        const { canId, rendererCon, clearColor, amb } = root.CONSTANTS.studioConfig\r\n\r\n        rendererCon.canvas = document.getElementById(canId)\r\n\r\n        this._renderer = new THREE.WebGLRenderer(rendererCon)\r\n        //this._renderer.setClearColor(clearColor)\r\n        this._renderer.setClearColor(0x000000)\r\n        this._renderer.setPixelRatio(window.devicePixelRatio)\r\n        this._renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n        this._scene = new THREE.Scene()\r\n\r\n        {\r\n             const { color, fogNear, fogFar, backgroundImgKey } = root.CONSTANTS.studioConfig.sceneEnvironment\r\n             this._scene.background = assets[backgroundImgKey] || null\r\n             this._scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n        }\r\n\r\n\r\n        // this._lightA = null\r\n        {\r\n            const { color, strength } = amb\r\n            this._lightA = new THREE.AmbientLight(0xffffff, .2)\r\n            this._scene.add( this._lightA )\r\n        }\r\n        {\r\n            const directionalLight = new THREE.DirectionalLight(0xffffff, .6);\r\n            directionalLight.position.set(1, 1, .5)\r\n            this._scene.add(directionalLight);\r\n        }\r\n        {\r\n            const directionalLight = new THREE.DirectionalLight(0xffffff, .4);\r\n            directionalLight.position.set(-1, -.1, -.4)\r\n            this._scene.add(directionalLight);\r\n        }\r\n\r\n\r\n        this._playerCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n\r\n\r\n        this._controlsCamera = new THREE.PerspectiveCamera(90, window.innerWidth / window.innerHeight, 0.1, 5000)\r\n        this._controlsCamera.position.set(0, 0, 20)\r\n        const controls = new OrbitControls(this._controlsCamera, this._renderer.domElement)\r\n        controls.target.set(0, 0, 0)\r\n        controls.update();\r\n\r\n\r\n        this._composer = new EffectComposer(this._renderer)\r\n        this._renderPass = new RenderPass(this._scene, this._controlsCamera)\r\n        this._composer.addPass(this._renderPass)\r\n        if (this._root.CONSTANTS.studioConfig.composerAddPass) {\r\n            if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate') {\r\n                this._composer.addPass(new ShaderPass(Saturate))\r\n            }\r\n            if (this._root.CONSTANTS.studioConfig.composerAddPass === 'Saturate2') {\r\n                this._composer.addPass(new ShaderPass(Saturate2))\r\n            }\r\n        }\r\n\r\n\r\n\r\n        /** toggle view camera to debug by orbitControls */\r\n        const vec3 = new THREE.Vector3()\r\n        let isPlayerView = true\r\n        let saveFogData = null\r\n        emitter.subscribe('keyEvent')(data => {\r\n            if (!data['o']) {\r\n                return;\r\n            }\r\n\r\n            if (isPlayerView) {\r\n//                saveFogData = { ...this._scene.fog }\r\n                // this._scene.fog.near = 1000\r\n                // this._scene.fog.far = 2000\r\n                isPlayerView = false\r\n                this._renderPass.camera = this._controlsCamera\r\n                this._playerCamera.getWorldPosition(vec3)\r\n                this._controlsCamera.position.x = vec3.x + 100\r\n                this._controlsCamera.position.y = vec3.y + 100\r\n                this._controlsCamera.position.z = vec3.z\r\n                controls.target.set(vec3.x, vec3.y, vec3.z)\r\n                controls.update()\r\n            } else {\r\n                // this._scene.fog.near = saveFogData.near\r\n                // this._scene.fog.far = saveFogData.far\r\n                isPlayerView = true\r\n                this._renderPass.camera = this._playerCamera\r\n            }\r\n        })\r\n\r\n\r\n\r\n        const resize = () => {\r\n            const size = { width: window.innerWidth, height: window.innerHeight }\r\n            this._renderer.setSize(size.width, size.height)\r\n            this._composer.setSize(size.width, size.height)\r\n            if (this._controlsCamera) {\r\n                this._controlsCamera.aspect = size.width/size.height\r\n                this._controlsCamera.updateProjectionMatrix()\r\n            }\r\n            if (this._playerCamera) {\r\n                this._playerCamera.aspect = size.width/size.height\r\n                this._playerCamera.updateProjectionMatrix()\r\n            }\r\n        }\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n\r\n\r\n\r\n\r\n        this.addToScene = mesh => this._scene.add(mesh)\r\n        this.removeFromScene = mesh => this._scene.remove(mesh)\r\n\r\n\r\n\r\n        this.drawFrame = () => {\r\n            this._composer.render(this._scene, this._controlsCamera)\r\n        }\r\n        //emitter.subscribe('frameUpdate')(this.drawFrame)\r\n\r\n\r\n\r\n        //this._backgroundImgKey = root.CONSTANTS.studioConfig.sceneEnvironment.backgroundImgKey\r\n        emitter.subscribe('changeSceneEnvironment')(sceneEnvironment => {\r\n            console.log('deprecated!!', 'studio', 'changeSceneEnvironment', sceneEnvironment)\r\n        })\r\n    }\r\n\r\n\r\n    /** PUBLIC ****************************************/\r\n\r\n    setCamera (cam) {\r\n        this._playerCamera = cam\r\n        this._renderPass.camera = this._playerCamera\r\n    }\r\n\r\n\r\n    changeEnvironment (sceneEnvironment, conf = null) {\r\n        this._changeFog(sceneEnvironment, conf)\r\n        this._changeBackground(sceneEnvironment, conf)\r\n    }\r\n\r\n\r\n    /** INTERNAL ****************************************/\r\n\r\n    _changeFog (sceneEnvironment, conf) {\r\n        // const { fogNear, fogFar, color } = sceneEnvironment\r\n        // if (\r\n        //     this._scene.fog.near !== fogNear ||\r\n        //     this._scene.fog.far !== fogFar ||\r\n        //     this._scene.fog.color !== fogFar\r\n        // ) {\r\n        //     const startData = {\r\n        //         color: this._scene.fog.color,\r\n        //         near: this._scene.fog.near,\r\n        //         far: this._scene.fog.far,\r\n        //     }\r\n        //     const endData = {\r\n        //         color: new THREE.Color(color),\r\n        //         near: fogNear,\r\n        //         far: fogFar,\r\n        //     }\r\n        //\r\n        //     new TWEEN.Tween(startData)\r\n        //         .to(endData, (conf && conf.time) || 3000)\r\n        //         .onUpdate(() => {\r\n        //             // this._scene.fog.color = startData.color\r\n        //             // this._scene.fog.near = startData.near\r\n        //             // this._scene.fog.far = startData.far\r\n        //             if (conf) {\r\n        //                 if (conf.updateAmb) this._lightA.color = startData.color\r\n        //             } else {\r\n        //                 this._lightA.color = startData.color\r\n        //             }\r\n        //             this._renderer.setClearColor(startData.color)\r\n        //         })\r\n        //         .start()\r\n        // }\r\n\r\n    }\r\n\r\n\r\n    _changeBackground (sceneEnvironment) {\r\n        const { backgroundImgKey } = sceneEnvironment\r\n\r\n        if (backgroundImgKey !== this._backgroundImgKey) {\r\n            this._backgroundImgKey = backgroundImgKey\r\n            this._scene.background = this._root.assets[backgroundImgKey] || null\r\n        }\r\n    }\r\n}\r\n\r\n","\r\nexport class KeyBoard {\r\n    constructor (gameContext) {\r\n        const { emitter } = gameContext\r\n\r\n        const keys = {\r\n            'up': false,\r\n            'down': false,\r\n            'left': false,\r\n            'right': false,\r\n            'p': false,\r\n        }\r\n\r\n        const keysEnabled = {\r\n            'up': true,\r\n            'down': true,\r\n            'left': true,\r\n            'right': true,\r\n        }\r\n\r\n        this.keysEnabled = keysEnabled\r\n        this.keys = keys\r\n\r\n\r\n        const keyUpdate = function ( keyCode, isDown ) {\r\n            switch( keyCode ) {\r\n                case 38:\r\n                case 87:\r\n                    keysEnabled['up'] && (keys['up'] = isDown)\r\n                    break;\r\n                case 40:\r\n                case 83:\r\n                    keysEnabled['down'] && (keys['down'] = isDown)\r\n                    break;\r\n                case 37:\r\n                case 65:\r\n                    keys['left'] = isDown\r\n                    break;\r\n                case 39:\r\n                case 68:\r\n                    keys['right'] = isDown\r\n                    break;\r\n                case 79: \r\n                    keys['o'] = isDown\r\n                    break;                \r\n                case 80: \r\n                    keys['p'] = isDown\r\n                default:\r\n                    break;\r\n\r\n            }\r\n            emitter.emit('keyEvent')(keys)\r\n        }\r\n\r\n\r\n\r\n        document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n        document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, true)\r\n            if (key === 'butt-right') keyUpdate(39, true)\r\n            if (key === 'butt-front') keyUpdate(38, true)\r\n            if (key === 'butt-back') keyUpdate(40, true)\r\n        })\r\n        emitter.subscribe('mouseUp')(key => {\r\n            if (key === 'butt-left') keyUpdate(37, false)\r\n            if (key === 'butt-right') keyUpdate(39, false)\r\n            if (key === 'butt-front') keyUpdate(38, false)\r\n            if (key === 'butt-back') keyUpdate(40, false)\r\n        })\r\n    }\r\n\r\n    toggleEnableKeys (key, is) {\r\n        this.keysEnabled[key] = is\r\n        !is && (this.keys[key] = false)\r\n    }\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\nexport class Player {\r\n    constructor (root) {\r\n        const { studio, CONSTANTS } = root\r\n\r\n        const {\r\n            startPos,\r\n            startRot,\r\n            cameraData,\r\n            frontObjPos,\r\n            backObjPos,\r\n            lightDataOne,\r\n        } = CONSTANTS.playerConfig\r\n\r\n\r\n        this._camera = null\r\n        this.isBlocked = true\r\n        this.isFreeze = true\r\n        \r\n        this.mesh = new THREE.Object3D()\r\n        this.mesh.rotation.fromArray([0, 0, 0])\r\n        this.mesh.userData.type = 'player'\r\n\r\n\r\n        this.bottomObj = new THREE.Object3D()\r\n        this.bottomObj.position.fromArray([0, -.02, 0])\r\n        this.mesh.add(this.bottomObj)\r\n\r\n        this.frontObj = new THREE.Object3D()\r\n        this.frontObj.position.fromArray([0, 0, -.02])\r\n        this.mesh.add(this.frontObj)\r\n\r\n        this.backObj = new THREE.Object3D()\r\n        this.backObj.position.fromArray([0, 0, 0.02])\r\n        this.mesh.add(this.backObj)\r\n\r\n\r\n        {\r\n            const { fov, ratio, near, far, pos } = cameraData\r\n            this._camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n            this._camera.position.fromArray([0, 0, -2])\r\n            this.mesh.add(this._camera)\r\n        }\r\n\r\n        {\r\n            if (lightDataOne) {\r\n                const { color, strenth, pos } = lightDataOne\r\n                const light = new THREE.PointLight(color, strenth)\r\n                light.position.fromArray(pos)\r\n                this.mesh.add(light)\r\n            }\r\n        }\r\n\r\n        ///////////// TEST /////////////\r\n\r\n        studio.setCamera(this._camera)\r\n        studio.addToScene(this.mesh)\r\n    }\r\n\r\n    // toggleBlocked (val) {\r\n    //     this.isFeeze = val\r\n    // }\r\n\r\n    toggleFeeze (val) {\r\n        this.isFeeze = val\r\n    }\r\n\r\n    toggleCanMove(key, val) {\r\n        //this._isCanMove[key] = val\r\n    }\r\n\r\n    getObj () {\r\n        return this.mesh\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n    \r\n    setToPos (x, y, z) {\r\n        this.mesh.position.set(x, y, z)\r\n    }\r\n}\r\n","import * as THREE from 'three'\r\n\r\nexport class Helper_MaterialsLib {\r\n    constructor (gameContext) {\r\n        const { assets, CONSTANTS } = gameContext\r\n\r\n        gameContext.materials = createMaterials(assets, CONSTANTS.MATERIALS_CONFIG)\r\n    }\r\n}\r\n\r\n\r\nconst createMaterials = (assets, MATERIALS_CONFIG) => {\r\n    for (let key in assets)\r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}","import * as THREE from 'three'\r\n\r\n\r\nexport class Level {\r\n    constructor(root) {\r\n        this._root = root\r\n\r\n        const {\r\n            assets, \r\n            materials,\r\n        } = root\r\n\r\n\r\n        const { items } = createLevelMeshes(assets, materials)\r\n        this._items = items\r\n        console.log('system_level_items', this._items)\r\n\r\n\r\n\r\n        items.body.material = materials.car\r\n\r\n\r\n        this._items['location_collision_01'].visible = false\r\n        this._items['location_collision_02'].visible = false\r\n        this._items['location_collision_03'].visible = false\r\n\r\n\r\n        /** locations persons ******* */\r\n        const personCollision = new THREE.Mesh(\r\n            new THREE.BoxGeometry(15, 15, 15),\r\n            new THREE.MeshBasicMaterial({ color: 0xffff00 })\r\n        )\r\n\r\n        this._items['location01_person'].geometry.computeBoundingSphere()\r\n        const offsetP01 = [\r\n            this._items['location01_person'].geometry.boundingSphere.center.x,\r\n            this._items['location01_person'].geometry.boundingSphere.center.y,\r\n            this._items['location01_person'].geometry.boundingSphere.center.z,\r\n        ]\r\n\r\n        this._items['location02_person'].geometry.computeBoundingSphere()\r\n        const offsetP02 = [\r\n            this._items['location02_person'].geometry.boundingSphere.center.x,\r\n            this._items['location02_person'].geometry.boundingSphere.center.y,\r\n            this._items['location02_person'].geometry.boundingSphere.center.z,\r\n        ]\r\n\r\n        this._items['location03_person'].geometry.computeBoundingSphere()\r\n        const offsetP03 = [\r\n            this._items['location03_person'].geometry.boundingSphere.center.x,\r\n            this._items['location03_person'].geometry.boundingSphere.center.y,\r\n            this._items['location03_person'].geometry.boundingSphere.center.z,\r\n        ]\r\n\r\n\r\n        /** locations data ***********wd */\r\n        this.locations = {\r\n            location01: {\r\n                mesh: this._items['location01'],\r\n                carCollision: this._items['location_collision_01'],\r\n                personOffset: offsetP01,\r\n                personCollision,\r\n            },\r\n            location02: {\r\n                mesh: this._items['location02'],\r\n                carCollision: this._items['location_collision_02'],\r\n                personOffset: offsetP02,\r\n                personCollision,\r\n            },\r\n            location03: {\r\n                mesh: this._items['location03'],\r\n                carCollision: this._items['location_collision_03'],\r\n                personOffset: offsetP03,\r\n                personCollision,\r\n            },\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nconst createLevelMeshes = (assets, materials) => {\r\n    const items = {}\r\n\r\n    assets['level-rooms'].traverse(child => {\r\n        let mesh = null\r\n\r\n        if (child.geometry) {\r\n            items[child.name] = child\r\n            child.material = materials.wallVirtual\r\n        }\r\n        \r\n        if (child.name.includes(\"level\")) {\r\n            if (child.name === 'level_000_000') {\r\n                mesh = new THREE.Mesh(child.geometry, materials.wallVirtual)\r\n                mesh.name = child.name\r\n            }\r\n\r\n            if (child.name === 'level_001_000') {\r\n                mesh = new THREE.Mesh(child.geometry, materials.wallVirtual)\r\n                mesh.name = child.name\r\n            }\r\n        }\r\n    })\r\n\r\n    return { items }\r\n}\r\n","export default __webpack_public_path__ + \"static/media/level.21832d73.obj\";","export default __webpack_public_path__ + \"static/media/floor_outer_map3.558e9646.jpg\";","export default __webpack_public_path__ + \"static/media/map01.48219503.jpg\";","export default __webpack_public_path__ + \"static/media/floor_outer_map2.2bd99ce1.jpg\";","export default __webpack_public_path__ + \"static/media/floor_outer_map.35e50f6e.jpg\";","export default __webpack_public_path__ + \"static/media/txt1.b67888d5.jpg\";","export default __webpack_public_path__ + \"static/media/px.8a9030e7.jpg\";","export default __webpack_public_path__ + \"static/media/nx.dc0a1bc7.jpg\";","export default __webpack_public_path__ + \"static/media/py.ed7a276e.jpg\";","export default __webpack_public_path__ + \"static/media/ny.75a01d7a.jpg\";","export default __webpack_public_path__ + \"static/media/pz.3cf6bf7f.jpg\";","export default __webpack_public_path__ + \"static/media/nz.c24a9aad.jpg\";","export default __webpack_public_path__ + \"static/media/px.96d0b65f.jpg\";","export default __webpack_public_path__ + \"static/media/nx.8cbf039d.jpg\";","export default __webpack_public_path__ + \"static/media/py.659ebc34.jpg\";","export default __webpack_public_path__ + \"static/media/ny.09051a4e.jpg\";","export default __webpack_public_path__ + \"static/media/pz.a1539724.jpg\";","export default __webpack_public_path__ + \"static/media/nz.0bc769f7.jpg\";","import * as THREE from \"three\";\r\n\r\n\r\nexport class helper_CollisionsItems_v02 {\r\n    constructor () {\r\n        this._arrMeshes = []\r\n\r\n\r\n        this._vecStart = new THREE.Vector3()\r\n        this._vecDir = new THREE.Vector3()\r\n        this._rayCaster = new THREE.Raycaster(this._vecStart, this._vecDir)\r\n    }\r\n\r\n    setItemToCollision (mesh) {\r\n        for (let i = 0; i < this._arrMeshes.length; ++i) {\r\n            if (this._arrMeshes[i] === mesh) {\r\n                return;\r\n            }\r\n        }\r\n        this._arrMeshes.push(mesh)\r\n    }\r\n\r\n\r\n    removeItemFromCollision (mesh) {\r\n        this._arrMeshes = this._arrMeshes.filter(item => item !== mesh)\r\n    }\r\n\r\n\r\n    checkCollisions (objFrom, objTo, dist) {\r\n        objFrom.getWorldPosition(this._vecStart)\r\n        objTo.getWorldPosition(this._vecDir)\r\n\r\n        this._vecDir.sub(this._vecStart)\r\n\r\n        //console.log(this._arrMeshes)\r\n        const intersects = this._rayCaster.intersectObjects(this._arrMeshes)\r\n\r\n        if (intersects[0] && intersects[0].distance < dist) {\r\n            return [ true, intersects[0] ]\r\n        }\r\n        return [ false, null ]\r\n    }\r\n}","import * as THREE from \"three\";\r\nimport { helper_CollisionsItems_v02 } from '../../../_CORE/helpers/helper_CollisionsItems_v02'\r\nimport { createCarCompas } from './CarCompas'\r\n\r\nexport class Car {\r\n    constructor (root) {\r\n        const {\r\n            assets,\r\n            CONSTANTS,\r\n            emitter,\r\n            materials,\r\n            system_Level\r\n        } = root\r\n\r\n        const { position, rotation } = CONSTANTS.CONFIG_FOR_INIT.currentSceneConfig.carProps\r\n\r\n        this._model = assets.car.children[0]\r\n        this._model.material = materials.car\r\n\r\n        this._camera = new THREE.PerspectiveCamera(80, window.innerWidth/window.innerHeight, .5, 100000)\r\n        this._camera.position.y = 28\r\n        this._model.add(this._camera)\r\n\r\n        this._model.position.fromArray(position)\r\n        this._model.rotation.fromArray(rotation)\r\n\r\n        this._collision = assets.carCollision.children[0]\r\n        this._collision.visible = false\r\n\r\n        this._model.add(this._collision)\r\n\r\n        this._frontObj = new THREE.Object3D()\r\n        this._frontObj.position.set(0, 0, -.5)\r\n        this._model.add(this._frontObj)\r\n\r\n        this._backObj = new THREE.Object3D()\r\n        this._backObj.position.set(0, 0, .5)\r\n        this._model.add(this._backObj)\r\n\r\n\r\n        this._compass = null\r\n        setTimeout(() => {\r\n            this._compass = createCarCompas(root)\r\n            this._compass.addToParent(this._model)\r\n            this._compass.setArrowPosition(0, 23, -11.5)\r\n            this.setTargetPosition = (val) => {\r\n                this._compass.setTargetPosition(val)\r\n                this._compass.update()\r\n            }\r\n        }) \r\n\r\n\r\n\r\n\r\n        this._collisionsWalls = new helper_CollisionsItems_v02()\r\n        const checkCollision = (obj, d) => {\r\n            const [is] = this._collisionsWalls.checkCollisions(this._model, obj, d)\r\n            return is;\r\n        }\r\n\r\n\r\n        this.isFreeze = true\r\n\r\n        let keys = {}\r\n\r\n        this._onChangeStateIsStay = () => {}\r\n\r\n\r\n        this._spd = 0\r\n        this._acc = 0.1\r\n        this._deceleration = 0.02\r\n        this._maxSpdFront = -10\r\n        //this._maxSpdBack = 1\r\n        this._maxSpdBack = 10\r\n        this._spdRot = 0.03\r\n\r\n        this._isCarStay = false\r\n\r\n\r\n\r\n        this.update = data => {\r\n            if (this.isFreeze) {\r\n                return;\r\n            }\r\n\r\n            /** move car *************/\r\n            if (this._spd < 0) {\r\n                if (!checkCollision(this._frontObj, 30)) {\r\n                    this._model.translateZ(this._spd * data.count)\r\n                    this._compass.update()\r\n                } else {\r\n                    this._spd = 0\r\n                }\r\n            }\r\n            if (this._spd > 0) {\r\n                if (!checkCollision(this._backObj, 30)) {\r\n                    this._model.translateZ(this._spd * data.count)\r\n                    this._compass.update()\r\n                } else {\r\n                    this._spd = 0\r\n                }\r\n            }\r\n\r\n\r\n            /** acceleration update speed *********/\r\n            if (keys['up']) {\r\n                this._spd -= this._acc\r\n            }\r\n            if (keys['down']) {\r\n                this._spd += this._acc\r\n            }\r\n\r\n\r\n            /** slowdown update speed *********/\r\n            if (Math.abs(this._spd) > 0.001) {\r\n                if (this._spd > 0) {\r\n                    this._spd -= this._deceleration\r\n                    if (this._spd < 0) {\r\n                        this._spd = 0\r\n                    }\r\n                }\r\n                if (this._spd < 0) {\r\n                    this._spd += this._deceleration\r\n                    if (this._spd > 0) {\r\n                        this._spd = 0\r\n                    }\r\n                }\r\n                this._spd = Math.min(this._maxSpdBack, Math.max(this._maxSpdFront, this._spd))\r\n\r\n                /** update car rotation ***********/\r\n                const rotBySpeed = Math.min(1, Math.max(0, Math.abs(this._spd)))\r\n                if (keys['left']) {\r\n                    if (this._spd < 0) {\r\n                        this._model.rotation.y += (this._spdRot * rotBySpeed)\r\n                    }\r\n                    if (this._spd > 0) {\r\n                        this._model.rotation.y -= (this._spdRot * rotBySpeed)\r\n                    }\r\n\r\n                }\r\n                if (keys['right']) {\r\n                    if (this._spd < 0) {\r\n                        this._model.rotation.y -= (this._spdRot * rotBySpeed)\r\n                    }\r\n                    if (this._spd > 0) {\r\n                        this._model.rotation.y += (this._spdRot * rotBySpeed)\r\n                    }\r\n                }\r\n            } else {\r\n                this._spd = 0\r\n            }\r\n\r\n            /** callback change state stay or move *****/\r\n            if (this._isCarStay && this._spd !== 0) {\r\n                this._isCarStay = false\r\n                this._onChangeStateIsStay('carStart')\r\n            }\r\n            if (!this._isCarStay && this._spd === 0) {\r\n                this._isCarStay = true\r\n                this._onChangeStateIsStay('carStop')\r\n            }\r\n        }\r\n        \r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        //emitter.subscribe('frameUpdate')(update)\r\n    }\r\n\r\n    setCollisionForDraw (mesh) {\r\n        this._collisionsWalls.setItemToCollision(mesh)\r\n    }\r\n\r\n    removeCollisionForDraw (mesh) {\r\n        this._collisionsWalls.removeItemFromCollision(mesh)\r\n    }\r\n\r\n    getModel () {\r\n        return this._model\r\n    }\r\n\r\n    getCollision () {\r\n        return this._collision\r\n    }\r\n\r\n    getCamera () {\r\n        return this._camera\r\n    }\r\n\r\n    toggleFreeze (val) {\r\n        console.log('freeze')\r\n        this.isFreeze = val\r\n    }\r\n\r\n    onChangeCarStateMove (fn) {\r\n        this._onChangeStateIsStay = fn\r\n    }\r\n\r\n    getPosition () {\r\n        return this._model.position\r\n    }\r\n\r\n    getQuaternion () {\r\n        return this._model.quaternion\r\n    }\r\n\r\n    subscribeOnMove () {\r\n\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nexport const createCarCompas = root => {\r\n    const {\r\n        assets,\r\n        studio,\r\n    } = root\r\n\r\n    const arrow = root.system_Level._items.arrow\r\n    arrow.material = root.materials.car\r\n\r\n    //const target = new THREE.Object3D()\r\n    const target = new THREE.Mesh(\r\n        new THREE.BoxGeometry(10, 10, 10),\r\n        new THREE.MeshBasicMaterial({ color: 0xff0000 })\r\n    )\r\n    target.position.set(-500, -30, -500)\r\n    studio.addToScene(target)\r\n\r\n    const src = new THREE.Mesh(\r\n        new THREE.BoxGeometry(10, 10, 10),\r\n        new THREE.MeshBasicMaterial({ color: 0xff0000 })\r\n    )\r\n    src.position.set(0, 0, 0)\r\n    studio.addToScene(target)\r\n\r\n    const v = new THREE.Vector3()\r\n\r\n    return {\r\n        addToParent: parent => { \r\n            parent.add(arrow)\r\n        },\r\n        setArrowPosition: (x, y, z) => {\r\n            arrow.position.set(x, y, z)\r\n        },\r\n        setTargetPosition: pos => {\r\n            target.position.copy(pos)\r\n        },\r\n        update: () => {\r\n            src.position.copy(arrow.parent.position)\r\n            src.lookAt(target.position)\r\n            if (arrow.parent.position.z < target.position.z) {\r\n                arrow.rotation.y = -arrow.parent.rotation.y + src.rotation.y\r\n            }\r\n            else {\r\n                arrow.rotation.y = -arrow.parent.rotation.y - src.rotation.y + Math.PI\r\n            }\r\n        }\r\n    }\r\n}","export default __webpack_public_path__ + \"static/media/car.8c016cb9.obj\";","export default __webpack_public_path__ + \"static/media/car_collision.66478aff.obj\";","export default __webpack_public_path__ + \"static/media/body.bb8da675.obj\";","import { helper_CollisionsItems_v02 } from '../../../_CORE/helpers/helper_CollisionsItems_v02'\r\nimport * as THREE from 'three'\r\n\r\n\r\n\r\nexport class system_PlayerMoveOnLevel {\r\n    constructor (root) {\r\n\r\n\r\n        const { \r\n            emitter, \r\n            CONSTANTS,\r\n            player,\r\n            assets,\r\n            studio,\r\n        } = root\r\n\r\n\r\n        //player.mesh.position.fromArray([0, -40, 0])\r\n        player.mesh.position.fromArray([0, 0, 0])\r\n\r\n\r\n        const collisionsWalls = new helper_CollisionsItems_v02()\r\n\r\n        const {\r\n            speed,\r\n            speedDown,\r\n            speedRot,\r\n        } = CONSTANTS.playerConfig\r\n\r\n        let isBlocked = true\r\n        player.toggleBlocked = val => isBlocked = val\r\n\r\n        this.isCanMove = {\r\n            'forward': true,\r\n            'back': true,\r\n        }\r\n        player.toggleCanMove = (dir, val) => this.isCanMove[dir] = val\r\n\r\n\r\n        this.isFreeze = false\r\n        let keys = {}\r\n\r\n        const OFFSET_FROM_PLANES = 17\r\n        const OFFSET_FROM_PLANES_TO_DROP = 17.2\r\n\r\n\r\n\r\n\r\n\r\n\r\n        const checkBottomAndDropDownPlayer = data => {\r\n            const [isCollision, collision] = collisionsWalls.checkCollisions(player.mesh, player.bottomObj, OFFSET_FROM_PLANES_TO_DROP)\r\n\r\n            /** move player to top if on stairs */\r\n            if (isCollision && OFFSET_FROM_PLANES > collision.distance) {\r\n                player.mesh.translateY(OFFSET_FROM_PLANES - collision.distance)\r\n\r\n                return;\r\n            }\r\n\r\n\r\n            /** free down without intercepts */\r\n            if (!isCollision) {\r\n                /** if player not up - rotated to up */\r\n                player.mesh.position.y += (speedDown * data.count)\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const checkAndMoveFront = data => {\r\n            const [isCollision, collision] = collisionsWalls.checkCollisions(player.mesh, player.frontObj, OFFSET_FROM_PLANES)\r\n\r\n            /** update level new area */\r\n            if (isCollision) {\r\n                if (collision.object.userData.type && collision.object.userData.type === 'alert') {\r\n                    emitter.emit('collision')(collision.object.userData.event)\r\n                }\r\n                return;\r\n            }\r\n\r\n            player.mesh.translateZ(-speed * data.count)\r\n            emitter.emit('playerMove')('forward')\r\n        }\r\n        \r\n        \r\n\r\n        const checkAndMoveBack = data => {\r\n            const [isCollision] = collisionsWalls.checkCollisions(player.mesh, player.backObj, OFFSET_FROM_PLANES)\r\n            if (isCollision) return;\r\n                \r\n            player.mesh.translateZ(speed * data.count)\r\n            emitter.emit('playerMove')('back')\r\n        }\r\n\r\n\r\n\r\n        this.update = data => {\r\n            if (this.isFreeze) {\r\n                return;\r\n            }\r\n            //if (isButtonsDisabled) return;\r\n\r\n            keys['left'] && player.mesh.rotateY(speedRot * data.count)\r\n            keys['right'] && player.mesh.rotateY(-speedRot * data.count)\r\n\r\n            if (isBlocked) return;\r\n\r\n            checkBottomAndDropDownPlayer(data)\r\n            keys['up'] && this.isCanMove['forward'] && checkAndMoveFront(data)\r\n            keys['down'] && this.isCanMove['back'] && checkAndMoveBack(data)\r\n            keys['p'] && console.log(`player.mesh.position.fromArray([${player.mesh.position.x}, ${player.mesh.position.y}, ${player.mesh.position.z}])`)\r\n        }\r\n    \r\n\r\n\r\n        emitter.subscribe('keyEvent')(data => keys = data)\r\n        //emitter.subscribe('frameUpdate')(update)\r\n\r\n\r\n        this._collisionsWalls = collisionsWalls\r\n    }\r\n\r\n\r\n    addItemToPlayerCollision (item) {\r\n        this._collisionsWalls.setItemToCollision(item)\r\n    }\r\n\r\n    removeItemFromPlayerCollision (item) {\r\n        this._collisionsWalls.removeItemFromCollision(item)\r\n    }\r\n\r\n    toggleFreeze (val = !this.isFreeze) {\r\n        this.isFreeze = val\r\n    }\r\n}\r\n\r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport class system_PlayerNearLevelItems {\r\n    constructor(root) {\r\n        this._root = root\r\n\r\n        const {\r\n            emitter, player\r\n        } = root\r\n\r\n\r\n        this._itemsToCheck = []\r\n\r\n        emitter.subscribe('playerMove')(() => {\r\n            //console.log('1111', this._itemsToCheck)\r\n            for (let i = 0; i < this._itemsToCheck.length; ++i) {\r\n                const dist = player.mesh.position.distanceTo(this._itemsToCheck[i].position)\r\n                //console.log(dist)\r\n\r\n                if (!this._itemsToCheck[i].userData.nearPlayerIsNearPlayer && dist < this._itemsToCheck[i].userData.nearPlayerItemNear) {\r\n                    this._itemsToCheck[i].userData.nearPlayerIsNearPlayer = true\r\n                    emitter.emit('checkNear')({ item: this._itemsToCheck[i].userData.nearPlayerItemKey, is: true })\r\n                    return;\r\n                }\r\n\r\n                if (this._itemsToCheck[i].userData.nearPlayerIsNearPlayer && dist > this._itemsToCheck[i].userData.nearPlayerItemNear) {\r\n                    this._itemsToCheck[i].userData.nearPlayerIsNearPlayer = false\r\n                    emitter.emit('checkNear')({ item: this._itemsToCheck[i].userData.nearPlayerItemKey, is: false })\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    setItemToCheck (item, itemKey, near, far) {\r\n        for (let i = 0; i < this._itemsToCheck.length; ++i) {\r\n            if (item === this._itemsToCheck[i]) {\r\n                return;\r\n            }\r\n        }\r\n        //console.log(item, itemKey, near, far)\r\n        itemKey && (item.userData.nearPlayerItemKey = itemKey)\r\n        near && (item.userData.nearPlayerItemNear = near)\r\n        far && (item.userData.nearPlayerItemFar = far)\r\n        item.userData.nearPlayerIsNearPlayer = false\r\n\r\n        this._itemsToCheck.push(item)\r\n    }\r\n\r\n    removeItemFromCheck (item) {\r\n        this._itemsToCheck = this._itemsToCheck.filter(itemIn => itemIn !== item)\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// function getCenterPoint (mesh) {\r\n//     // var center = new THREE.Vector3();\r\n//     // mesh.geometry.computeBoundingBox();\r\n//     // mesh.geometry.boundingBox.getCenter(center);\r\n//     // mesh.geometry.center();\r\n//     //mesh.position.copy(center);\r\n//\r\n//     //return center\r\n//     const geometry = mesh.geometry\r\n//     geometry.computeBoundingBox()\r\n//     const center = new THREE.Vector3()\r\n//     geometry.boundingBox.getCenter(center)\r\n//     mesh.localToWorld(center)\r\n//     return center\r\n// }","export const createCheckerChangeLocationKey = (SIZE = 100, x = 0, z = 0) => {\r\n    const keyX = Math.floor(x / SIZE)\r\n    const keyZ = Math.floor(z / SIZE)\r\n\r\n    let oldKey = keyX + '_' + keyZ\r\n\r\n\r\n    let currentEnv = generateEnvByQ(keyX, keyZ)\r\n\r\n    return {\r\n        checkChanged: (x, z) => {\r\n            const keyX = Math.floor(x / SIZE)\r\n            const keyZ = Math.floor(z / SIZE)\r\n\r\n            const newKey = keyX + '_' + keyZ\r\n            if (newKey === oldKey) {\r\n                return false;\r\n            }\r\n\r\n            const saveOldKey = oldKey\r\n            oldKey = newKey\r\n\r\n\r\n            const oldEnv = currentEnv\r\n            currentEnv = generateEnvByQ(keyX, keyZ)\r\n\r\n            const addedQs = getArrNotInFirst(currentEnv, oldEnv)\r\n            const removedQs = getArrNotInFirst(oldEnv, currentEnv)\r\n            // const removedQs = []\r\n            // for (let i = 0; i < oldEnv.length; ++i) {\r\n            //     let isIn = false\r\n            //     for (let j = 0; j < currentEnv.length; ++j) {\r\n            //         if (oldEnv[i] === currentEnv[j]) {\r\n            //             isIn = true\r\n            //         }\r\n            //     }\r\n            //     if (!isIn) {\r\n            //         removedQs.push(oldEnv[i])\r\n            //     }\r\n            // }\r\n            //\r\n            // const addedQs = []\r\n            // for (let i = 0; i < currentEnv.length; ++i) {\r\n            //     let isIn = false\r\n            //     for (let j = 0; j < oldEnv.length; ++j) {\r\n            //         if (oldEnv[i] === currentEnv[j]) {\r\n            //             isIn = true\r\n            //         }\r\n            //     }\r\n            //     if (!isIn) {\r\n            //         addedQs.push(currentEnv[i])\r\n            //     }\r\n            // }\r\n\r\n\r\n            return {\r\n                oldKey: saveOldKey,\r\n                newKey,\r\n                newEnv: currentEnv,\r\n                removedQs,\r\n                addedQs,\r\n            }\r\n        },\r\n        getCurrent: () => ({\r\n            loc: oldKey,\r\n            currentEnv,\r\n        }),\r\n    }\r\n}\r\n\r\n\r\nconst generateEnvByQ = (qX, qZ) => {\r\n    const arr = []\r\n    for (let i = qX - 1; i < qX + 2; ++i) {\r\n        for (let j = qZ - 1; j < qZ + 2; ++j) {\r\n            arr.push(i + '_' + j)\r\n        }\r\n    }\r\n    return arr\r\n}\r\n\r\nconst getArrNotInFirst = (arr1, arr2) => {\r\n    const arr = []\r\n    for (let i = 0; i < arr1.length; ++i) {\r\n        let isIn = false\r\n        for (let j = 0; j < arr2.length; ++j) {\r\n            if (arr1[i] === arr2[j]) {\r\n                isIn = true\r\n            }\r\n        }\r\n        if (!isIn) {\r\n            arr.push(arr1[i])\r\n        }\r\n    }\r\n    return arr\r\n}","/*\r\n * Copyright 2021 GFXFundamentals.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are\r\n * met:\r\n *\r\n *     * Redistributions of source code must retain the above copyright\r\n * notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above\r\n * copyright notice, this list of conditions and the following disclaimer\r\n * in the documentation and/or other materials provided with the\r\n * distribution.\r\n *     * Neither the name of GFXFundamentals. nor the names of his\r\n * contributors may be used to endorse or promote products derived from\r\n * this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n */\r\n\r\n\r\n    /**\r\n     * An array or typed array with 3 values.\r\n     * @typedef {number[]|TypedArray} Vector3\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n    /**\r\n     * An array or typed array with 4 values.\r\n     * @typedef {number[]|TypedArray} Vector4\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n    /**\r\n     * An array or typed array with 16 values.\r\n     * @typedef {number[]|TypedArray} Matrix4\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n\r\n\r\n    let MatType = Float32Array;\r\n\r\n    /**\r\n     * Sets the type this library creates for a Mat4\r\n     * @param {constructor} Ctor the constructor for the type. Either `Float32Array` or `Array`\r\n     * @return {constructor} previous constructor for Mat4\r\n     */\r\n    function setDefaultType(Ctor) {\r\n        const OldType = MatType;\r\n        MatType = Ctor;\r\n        return OldType;\r\n    }\r\n\r\n    /**\r\n     * Takes two 4-by-4 matrices, a and b, and computes the product in the order\r\n     * that pre-composes b with a.  In other words, the matrix returned will\r\n     * transform by b first and then a.  Note this is subtly different from just\r\n     * multiplying the matrices together.  For given a and b, this function returns\r\n     * the same object in both row-major and column-major mode.\r\n     * @param {Matrix4} a A matrix.\r\n     * @param {Matrix4} b A matrix.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     */\r\n    function multiply(a, b, dst) {\r\n        dst = dst || new MatType(16);\r\n        var b00 = b[0 * 4 + 0];\r\n        var b01 = b[0 * 4 + 1];\r\n        var b02 = b[0 * 4 + 2];\r\n        var b03 = b[0 * 4 + 3];\r\n        var b10 = b[1 * 4 + 0];\r\n        var b11 = b[1 * 4 + 1];\r\n        var b12 = b[1 * 4 + 2];\r\n        var b13 = b[1 * 4 + 3];\r\n        var b20 = b[2 * 4 + 0];\r\n        var b21 = b[2 * 4 + 1];\r\n        var b22 = b[2 * 4 + 2];\r\n        var b23 = b[2 * 4 + 3];\r\n        var b30 = b[3 * 4 + 0];\r\n        var b31 = b[3 * 4 + 1];\r\n        var b32 = b[3 * 4 + 2];\r\n        var b33 = b[3 * 4 + 3];\r\n        var a00 = a[0 * 4 + 0];\r\n        var a01 = a[0 * 4 + 1];\r\n        var a02 = a[0 * 4 + 2];\r\n        var a03 = a[0 * 4 + 3];\r\n        var a10 = a[1 * 4 + 0];\r\n        var a11 = a[1 * 4 + 1];\r\n        var a12 = a[1 * 4 + 2];\r\n        var a13 = a[1 * 4 + 3];\r\n        var a20 = a[2 * 4 + 0];\r\n        var a21 = a[2 * 4 + 1];\r\n        var a22 = a[2 * 4 + 2];\r\n        var a23 = a[2 * 4 + 3];\r\n        var a30 = a[3 * 4 + 0];\r\n        var a31 = a[3 * 4 + 1];\r\n        var a32 = a[3 * 4 + 2];\r\n        var a33 = a[3 * 4 + 3];\r\n        dst[ 0] = b00 * a00 + b01 * a10 + b02 * a20 + b03 * a30;\r\n        dst[ 1] = b00 * a01 + b01 * a11 + b02 * a21 + b03 * a31;\r\n        dst[ 2] = b00 * a02 + b01 * a12 + b02 * a22 + b03 * a32;\r\n        dst[ 3] = b00 * a03 + b01 * a13 + b02 * a23 + b03 * a33;\r\n        dst[ 4] = b10 * a00 + b11 * a10 + b12 * a20 + b13 * a30;\r\n        dst[ 5] = b10 * a01 + b11 * a11 + b12 * a21 + b13 * a31;\r\n        dst[ 6] = b10 * a02 + b11 * a12 + b12 * a22 + b13 * a32;\r\n        dst[ 7] = b10 * a03 + b11 * a13 + b12 * a23 + b13 * a33;\r\n        dst[ 8] = b20 * a00 + b21 * a10 + b22 * a20 + b23 * a30;\r\n        dst[ 9] = b20 * a01 + b21 * a11 + b22 * a21 + b23 * a31;\r\n        dst[10] = b20 * a02 + b21 * a12 + b22 * a22 + b23 * a32;\r\n        dst[11] = b20 * a03 + b21 * a13 + b22 * a23 + b23 * a33;\r\n        dst[12] = b30 * a00 + b31 * a10 + b32 * a20 + b33 * a30;\r\n        dst[13] = b30 * a01 + b31 * a11 + b32 * a21 + b33 * a31;\r\n        dst[14] = b30 * a02 + b31 * a12 + b32 * a22 + b33 * a32;\r\n        dst[15] = b30 * a03 + b31 * a13 + b32 * a23 + b33 * a33;\r\n        return dst;\r\n    }\r\n\r\n\r\n    /**\r\n     * adds 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function addVectors(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[0] + b[0];\r\n        dst[1] = a[1] + b[1];\r\n        dst[2] = a[2] + b[2];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * subtracts 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function subtractVectors(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[0] - b[0];\r\n        dst[1] = a[1] - b[1];\r\n        dst[2] = a[2] - b[2];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * scale vectors3\r\n     * @param {Vector3} v vector\r\n     * @param {Number} s scale\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scaleVector(v, s, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = v[0] * s;\r\n        dst[1] = v[1] * s;\r\n        dst[2] = v[2] * s;\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * normalizes a vector.\r\n     * @param {Vector3} v vector to normalize\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function normalize(v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var length = Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\r\n        // make sure we don't divide by 0.\r\n        if (length > 0.00001) {\r\n            dst[0] = v[0] / length;\r\n            dst[1] = v[1] / length;\r\n            dst[2] = v[2] / length;\r\n        }\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes the length of a vector\r\n     * @param {Vector3} v vector to take length of\r\n     * @return {number} length of vector\r\n     */\r\n    function length(v) {\r\n        return Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]);\r\n    }\r\n\r\n    /**\r\n     * Computes the length squared of a vector\r\n     * @param {Vector3} v vector to take length of\r\n     * @return {number} length sqaured of vector\r\n     */\r\n    function lengthSq(v) {\r\n        return v[0] * v[0] + v[1] * v[1] + v[2] * v[2];\r\n    }\r\n\r\n    /**\r\n     * Computes the cross product of 2 vectors3s\r\n     * @param {Vector3} a a\r\n     * @param {Vector3} b b\r\n     * @param {Vector3} dst optional vector3 to store result\r\n     * @return {Vector3} dst or new Vector3 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function cross(a, b, dst) {\r\n        dst = dst || new MatType(3);\r\n        dst[0] = a[1] * b[2] - a[2] * b[1];\r\n        dst[1] = a[2] * b[0] - a[0] * b[2];\r\n        dst[2] = a[0] * b[1] - a[1] * b[0];\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes the dot product of two vectors; assumes both vectors have\r\n     * three entries.\r\n     * @param {Vector3} a Operand vector.\r\n     * @param {Vector3} b Operand vector.\r\n     * @return {number} dot product\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function dot(a, b) {\r\n        return (a[0] * b[0]) + (a[1] * b[1]) + (a[2] * b[2]);\r\n    }\r\n\r\n    /**\r\n     * Computes the distance squared between 2 points\r\n     * @param {Vector3} a\r\n     * @param {Vector3} b\r\n     * @return {number} distance squared between a and b\r\n     */\r\n    function distanceSq(a, b) {\r\n        const dx = a[0] - b[0];\r\n        const dy = a[1] - b[1];\r\n        const dz = a[2] - b[2];\r\n        return dx * dx + dy * dy + dz * dz;\r\n    }\r\n\r\n    /**\r\n     * Computes the distance between 2 points\r\n     * @param {Vector3} a\r\n     * @param {Vector3} b\r\n     * @return {number} distance between a and b\r\n     */\r\n    function distance(a, b) {\r\n        return Math.sqrt(distanceSq(a, b));\r\n    }\r\n\r\n    /**\r\n     * Makes an identity matrix.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function identity(dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Transposes a matrix.\r\n     * @param {Matrix4} m matrix to transpose.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transpose(m, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = m[0];\r\n        dst[ 1] = m[4];\r\n        dst[ 2] = m[8];\r\n        dst[ 3] = m[12];\r\n        dst[ 4] = m[1];\r\n        dst[ 5] = m[5];\r\n        dst[ 6] = m[9];\r\n        dst[ 7] = m[13];\r\n        dst[ 8] = m[2];\r\n        dst[ 9] = m[6];\r\n        dst[10] = m[10];\r\n        dst[11] = m[14];\r\n        dst[12] = m[3];\r\n        dst[13] = m[7];\r\n        dst[14] = m[11];\r\n        dst[15] = m[15];\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Creates a lookAt matrix.\r\n     * This is a world matrix for a camera. In other words it will transform\r\n     * from the origin to a place and orientation in the world. For a view\r\n     * matrix take the inverse of this.\r\n     * @param {Vector3} cameraPosition position of the camera\r\n     * @param {Vector3} target position of the target\r\n     * @param {Vector3} up direction\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function lookAt(cameraPosition, target, up, dst) {\r\n        dst = dst || new MatType(16);\r\n        var zAxis = normalize(\r\n            subtractVectors(cameraPosition, target));\r\n        var xAxis = normalize(cross(up, zAxis));\r\n        var yAxis = normalize(cross(zAxis, xAxis));\r\n\r\n        dst[ 0] = xAxis[0];\r\n        dst[ 1] = xAxis[1];\r\n        dst[ 2] = xAxis[2];\r\n        dst[ 3] = 0;\r\n        dst[ 4] = yAxis[0];\r\n        dst[ 5] = yAxis[1];\r\n        dst[ 6] = yAxis[2];\r\n        dst[ 7] = 0;\r\n        dst[ 8] = zAxis[0];\r\n        dst[ 9] = zAxis[1];\r\n        dst[10] = zAxis[2];\r\n        dst[11] = 0;\r\n        dst[12] = cameraPosition[0];\r\n        dst[13] = cameraPosition[1];\r\n        dst[14] = cameraPosition[2];\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 perspective transformation matrix given the angular height\r\n     * of the frustum, the aspect ratio, and the near and far clipping planes.  The\r\n     * arguments define a frustum extending in the negative z direction.  The given\r\n     * angle is the vertical angle of the frustum, and the horizontal angle is\r\n     * determined to produce the given aspect ratio.  The arguments near and far are\r\n     * the distances to the near and far clipping planes.  Note that near and far\r\n     * are not z coordinates, but rather they are distances along the negative\r\n     * z-axis.  The matrix generated sends the viewing frustum to the unit box.\r\n     * We assume a unit box extending from -1 to 1 in the x and y dimensions and\r\n     * from -1 to 1 in the z dimension.\r\n     * @param {number} fieldOfViewInRadians field of view in y axis.\r\n     * @param {number} aspect aspect of viewport (width / height)\r\n     * @param {number} near near Z clipping plane\r\n     * @param {number} far far Z clipping plane\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function perspective(fieldOfViewInRadians, aspect, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n        var f = Math.tan(Math.PI * 0.5 - 0.5 * fieldOfViewInRadians);\r\n        var rangeInv = 1.0 / (near - far);\r\n\r\n        dst[ 0] = f / aspect;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = f;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = (near + far) * rangeInv;\r\n        dst[11] = -1;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = near * far * rangeInv * 2;\r\n        dst[15] = 0;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 orthographic projection matrix given the coordinates of the\r\n     * planes defining the axis-aligned, box-shaped viewing volume.  The matrix\r\n     * generated sends that box to the unit box.  Note that although left and right\r\n     * are x coordinates and bottom and top are y coordinates, near and far\r\n     * are not z coordinates, but rather they are distances along the negative\r\n     * z-axis.  We assume a unit box extending from -1 to 1 in the x and y\r\n     * dimensions and from -1 to 1 in the z dimension.\r\n     * @param {number} left The x coordinate of the left plane of the box.\r\n     * @param {number} right The x coordinate of the right plane of the box.\r\n     * @param {number} bottom The y coordinate of the bottom plane of the box.\r\n     * @param {number} top The y coordinate of the right plane of the box.\r\n     * @param {number} near The negative z coordinate of the near plane of the box.\r\n     * @param {number} far The negative z coordinate of the far plane of the box.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function orthographic(left, right, bottom, top, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 2 / (right - left);\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 2 / (top - bottom);\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 2 / (near - far);\r\n        dst[11] = 0;\r\n        dst[12] = (left + right) / (left - right);\r\n        dst[13] = (bottom + top) / (bottom - top);\r\n        dst[14] = (near + far) / (near - far);\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Computes a 4-by-4 perspective transformation matrix given the left, right,\r\n     * top, bottom, near and far clipping planes. The arguments define a frustum\r\n     * extending in the negative z direction. The arguments near and far are the\r\n     * distances to the near and far clipping planes. Note that near and far are not\r\n     * z coordinates, but rather they are distances along the negative z-axis. The\r\n     * matrix generated sends the viewing frustum to the unit box. We assume a unit\r\n     * box extending from -1 to 1 in the x and y dimensions and from -1 to 1 in the z\r\n     * dimension.\r\n     * @param {number} left The x coordinate of the left plane of the box.\r\n     * @param {number} right The x coordinate of the right plane of the box.\r\n     * @param {number} bottom The y coordinate of the bottom plane of the box.\r\n     * @param {number} top The y coordinate of the right plane of the box.\r\n     * @param {number} near The negative z coordinate of the near plane of the box.\r\n     * @param {number} far The negative z coordinate of the far plane of the box.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function frustum(left, right, bottom, top, near, far, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        var dx = right - left;\r\n        var dy = top - bottom;\r\n        var dz = far - near;\r\n\r\n        dst[ 0] = 2 * near / dx;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 2 * near / dy;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = (left + right) / dx;\r\n        dst[ 9] = (top + bottom) / dy;\r\n        dst[10] = -(far + near) / dz;\r\n        dst[11] = -1;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = -2 * near * far / dz;\r\n        dst[15] = 0;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes a translation matrix\r\n     * @param {number} tx x translation.\r\n     * @param {number} ty y translation.\r\n     * @param {number} tz z translation.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function translation(tx, ty, tz, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = tx;\r\n        dst[13] = ty;\r\n        dst[14] = tz;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by translation matrix.\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} tx x translation.\r\n     * @param {number} ty y translation.\r\n     * @param {number} tz z translation.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function translate(m, tx, ty, tz, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, translation(tx, ty, tz), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0];\r\n        var m01 = m[1];\r\n        var m02 = m[2];\r\n        var m03 = m[3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n\r\n        if (m !== dst) {\r\n            dst[ 0] = m00;\r\n            dst[ 1] = m01;\r\n            dst[ 2] = m02;\r\n            dst[ 3] = m03;\r\n            dst[ 4] = m10;\r\n            dst[ 5] = m11;\r\n            dst[ 6] = m12;\r\n            dst[ 7] = m13;\r\n            dst[ 8] = m20;\r\n            dst[ 9] = m21;\r\n            dst[10] = m22;\r\n            dst[11] = m23;\r\n        }\r\n\r\n        dst[12] = m00 * tx + m10 * ty + m20 * tz + m30;\r\n        dst[13] = m01 * tx + m11 * ty + m21 * tz + m31;\r\n        dst[14] = m02 * tx + m12 * ty + m22 * tz + m32;\r\n        dst[15] = m03 * tx + m13 * ty + m23 * tz + m33;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an x rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function xRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = 1;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = c;\r\n        dst[ 6] = s;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = -s;\r\n        dst[10] = c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an x rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function xRotate(m, angleInRadians, dst) {\r\n        // this is the optimized version of\r\n        // return multiply(m, xRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m10 = m[4];\r\n        var m11 = m[5];\r\n        var m12 = m[6];\r\n        var m13 = m[7];\r\n        var m20 = m[8];\r\n        var m21 = m[9];\r\n        var m22 = m[10];\r\n        var m23 = m[11];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[4]  = c * m10 + s * m20;\r\n        dst[5]  = c * m11 + s * m21;\r\n        dst[6]  = c * m12 + s * m22;\r\n        dst[7]  = c * m13 + s * m23;\r\n        dst[8]  = c * m20 - s * m10;\r\n        dst[9]  = c * m21 - s * m11;\r\n        dst[10] = c * m22 - s * m12;\r\n        dst[11] = c * m23 - s * m13;\r\n\r\n        if (m !== dst) {\r\n            dst[ 0] = m[ 0];\r\n            dst[ 1] = m[ 1];\r\n            dst[ 2] = m[ 2];\r\n            dst[ 3] = m[ 3];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an y rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function yRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = -s;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = 1;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = s;\r\n        dst[ 9] = 0;\r\n        dst[10] = c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an y rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function yRotate(m, angleInRadians, dst) {\r\n        // this is the optimized version of\r\n        // return multiply(m, yRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c * m00 - s * m20;\r\n        dst[ 1] = c * m01 - s * m21;\r\n        dst[ 2] = c * m02 - s * m22;\r\n        dst[ 3] = c * m03 - s * m23;\r\n        dst[ 8] = c * m20 + s * m00;\r\n        dst[ 9] = c * m21 + s * m01;\r\n        dst[10] = c * m22 + s * m02;\r\n        dst[11] = c * m23 + s * m03;\r\n\r\n        if (m !== dst) {\r\n            dst[ 4] = m[ 4];\r\n            dst[ 5] = m[ 5];\r\n            dst[ 6] = m[ 6];\r\n            dst[ 7] = m[ 7];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an z rotation matrix\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function zRotation(angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c;\r\n        dst[ 1] = s;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = -s;\r\n        dst[ 5] = c;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = 1;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an z rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function zRotate(m, angleInRadians, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, zRotation(angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n\r\n        dst[ 0] = c * m00 + s * m10;\r\n        dst[ 1] = c * m01 + s * m11;\r\n        dst[ 2] = c * m02 + s * m12;\r\n        dst[ 3] = c * m03 + s * m13;\r\n        dst[ 4] = c * m10 - s * m00;\r\n        dst[ 5] = c * m11 - s * m01;\r\n        dst[ 6] = c * m12 - s * m02;\r\n        dst[ 7] = c * m13 - s * m03;\r\n\r\n        if (m !== dst) {\r\n            dst[ 8] = m[ 8];\r\n            dst[ 9] = m[ 9];\r\n            dst[10] = m[10];\r\n            dst[11] = m[11];\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes an rotation matrix around an arbitrary axis\r\n     * @param {Vector3} axis axis to rotate around\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function axisRotation(axis, angleInRadians, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        var x = axis[0];\r\n        var y = axis[1];\r\n        var z = axis[2];\r\n        var n = Math.sqrt(x * x + y * y + z * z);\r\n        x /= n;\r\n        y /= n;\r\n        z /= n;\r\n        var xx = x * x;\r\n        var yy = y * y;\r\n        var zz = z * z;\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n        var oneMinusCosine = 1 - c;\r\n\r\n        dst[ 0] = xx + (1 - xx) * c;\r\n        dst[ 1] = x * y * oneMinusCosine + z * s;\r\n        dst[ 2] = x * z * oneMinusCosine - y * s;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = x * y * oneMinusCosine - z * s;\r\n        dst[ 5] = yy + (1 - yy) * c;\r\n        dst[ 6] = y * z * oneMinusCosine + x * s;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = x * z * oneMinusCosine + y * s;\r\n        dst[ 9] = y * z * oneMinusCosine - x * s;\r\n        dst[10] = zz + (1 - zz) * c;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by an axis rotation matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {Vector3} axis axis to rotate around\r\n     * @param {number} angleInRadians amount to rotate\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function axisRotate(m, axis, angleInRadians, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, axisRotation(axis, angleInRadians), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        var x = axis[0];\r\n        var y = axis[1];\r\n        var z = axis[2];\r\n        var n = Math.sqrt(x * x + y * y + z * z);\r\n        x /= n;\r\n        y /= n;\r\n        z /= n;\r\n        var xx = x * x;\r\n        var yy = y * y;\r\n        var zz = z * z;\r\n        var c = Math.cos(angleInRadians);\r\n        var s = Math.sin(angleInRadians);\r\n        var oneMinusCosine = 1 - c;\r\n\r\n        var r00 = xx + (1 - xx) * c;\r\n        var r01 = x * y * oneMinusCosine + z * s;\r\n        var r02 = x * z * oneMinusCosine - y * s;\r\n        var r10 = x * y * oneMinusCosine - z * s;\r\n        var r11 = yy + (1 - yy) * c;\r\n        var r12 = y * z * oneMinusCosine + x * s;\r\n        var r20 = x * z * oneMinusCosine + y * s;\r\n        var r21 = y * z * oneMinusCosine - x * s;\r\n        var r22 = zz + (1 - zz) * c;\r\n\r\n        var m00 = m[0];\r\n        var m01 = m[1];\r\n        var m02 = m[2];\r\n        var m03 = m[3];\r\n        var m10 = m[4];\r\n        var m11 = m[5];\r\n        var m12 = m[6];\r\n        var m13 = m[7];\r\n        var m20 = m[8];\r\n        var m21 = m[9];\r\n        var m22 = m[10];\r\n        var m23 = m[11];\r\n\r\n        dst[ 0] = r00 * m00 + r01 * m10 + r02 * m20;\r\n        dst[ 1] = r00 * m01 + r01 * m11 + r02 * m21;\r\n        dst[ 2] = r00 * m02 + r01 * m12 + r02 * m22;\r\n        dst[ 3] = r00 * m03 + r01 * m13 + r02 * m23;\r\n        dst[ 4] = r10 * m00 + r11 * m10 + r12 * m20;\r\n        dst[ 5] = r10 * m01 + r11 * m11 + r12 * m21;\r\n        dst[ 6] = r10 * m02 + r11 * m12 + r12 * m22;\r\n        dst[ 7] = r10 * m03 + r11 * m13 + r12 * m23;\r\n        dst[ 8] = r20 * m00 + r21 * m10 + r22 * m20;\r\n        dst[ 9] = r20 * m01 + r21 * m11 + r22 * m21;\r\n        dst[10] = r20 * m02 + r21 * m12 + r22 * m22;\r\n        dst[11] = r20 * m03 + r21 * m13 + r22 * m23;\r\n\r\n        if (m !== dst) {\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Makes a scale matrix\r\n     * @param {number} sx x scale.\r\n     * @param {number} sy y scale.\r\n     * @param {number} sz z scale.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scaling(sx, sy, sz, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = sx;\r\n        dst[ 1] = 0;\r\n        dst[ 2] = 0;\r\n        dst[ 3] = 0;\r\n        dst[ 4] = 0;\r\n        dst[ 5] = sy;\r\n        dst[ 6] = 0;\r\n        dst[ 7] = 0;\r\n        dst[ 8] = 0;\r\n        dst[ 9] = 0;\r\n        dst[10] = sz;\r\n        dst[11] = 0;\r\n        dst[12] = 0;\r\n        dst[13] = 0;\r\n        dst[14] = 0;\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Multiply by a scaling matrix\r\n     * @param {Matrix4} m matrix to multiply\r\n     * @param {number} sx x scale.\r\n     * @param {number} sy y scale.\r\n     * @param {number} sz z scale.\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function scale(m, sx, sy, sz, dst) {\r\n        // This is the optimized version of\r\n        // return multiply(m, scaling(sx, sy, sz), dst);\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = sx * m[0 * 4 + 0];\r\n        dst[ 1] = sx * m[0 * 4 + 1];\r\n        dst[ 2] = sx * m[0 * 4 + 2];\r\n        dst[ 3] = sx * m[0 * 4 + 3];\r\n        dst[ 4] = sy * m[1 * 4 + 0];\r\n        dst[ 5] = sy * m[1 * 4 + 1];\r\n        dst[ 6] = sy * m[1 * 4 + 2];\r\n        dst[ 7] = sy * m[1 * 4 + 3];\r\n        dst[ 8] = sz * m[2 * 4 + 0];\r\n        dst[ 9] = sz * m[2 * 4 + 1];\r\n        dst[10] = sz * m[2 * 4 + 2];\r\n        dst[11] = sz * m[2 * 4 + 3];\r\n\r\n        if (m !== dst) {\r\n            dst[12] = m[12];\r\n            dst[13] = m[13];\r\n            dst[14] = m[14];\r\n            dst[15] = m[15];\r\n        }\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * creates a matrix from translation, quaternion, scale\r\n     * @param {Number[]} translation [x, y, z] translation\r\n     * @param {Number[]} quaternion [x, y, z, z] quaternion rotation\r\n     * @param {Number[]} scale [x, y, z] scale\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     */\r\n    function compose(translation, quaternion, scale, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        const x = quaternion[0];\r\n        const y = quaternion[1];\r\n        const z = quaternion[2];\r\n        const w = quaternion[3];\r\n\r\n        const x2 = x + x;\r\n        const y2 = y + y;\r\n        const z2 = z + z;\r\n\r\n        const xx = x * x2;\r\n        const xy = x * y2;\r\n        const xz = x * z2;\r\n\r\n        const yy = y * y2;\r\n        const yz = y * z2;\r\n        const zz = z * z2;\r\n\r\n        const wx = w * x2;\r\n        const wy = w * y2;\r\n        const wz = w * z2;\r\n\r\n        const sx = scale[0];\r\n        const sy = scale[1];\r\n        const sz = scale[2];\r\n\r\n        dst[0] = (1 - (yy + zz)) * sx;\r\n        dst[1] = (xy + wz) * sx;\r\n        dst[2] = (xz - wy) * sx;\r\n        dst[3] = 0;\r\n\r\n        dst[4] = (xy - wz) * sy;\r\n        dst[5] = (1 - (xx + zz)) * sy;\r\n        dst[6] = (yz + wx) * sy;\r\n        dst[7] = 0;\r\n\r\n        dst[ 8] = (xz + wy) * sz;\r\n        dst[ 9] = (yz - wx) * sz;\r\n        dst[10] = (1 - (xx + yy)) * sz;\r\n        dst[11] = 0;\r\n\r\n        dst[12] = translation[0];\r\n        dst[13] = translation[1];\r\n        dst[14] = translation[2];\r\n        dst[15] = 1;\r\n\r\n        return dst;\r\n    }\r\n\r\n    function quatFromRotationMatrix(m, dst) {\r\n        // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n        // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n        const m11 = m[0];\r\n        const m12 = m[4];\r\n        const m13 = m[8];\r\n        const m21 = m[1];\r\n        const m22 = m[5];\r\n        const m23 = m[9];\r\n        const m31 = m[2];\r\n        const m32 = m[6];\r\n        const m33 = m[10];\r\n\r\n        const trace = m11 + m22 + m33;\r\n\r\n        if (trace > 0) {\r\n            const s = 0.5 / Math.sqrt(trace + 1);\r\n            dst[3] = 0.25 / s;\r\n            dst[0] = (m32 - m23) * s;\r\n            dst[1] = (m13 - m31) * s;\r\n            dst[2] = (m21 - m12) * s;\r\n        } else if (m11 > m22 && m11 > m33) {\r\n            const s = 2 * Math.sqrt(1 + m11 - m22 - m33);\r\n            dst[3] = (m32 - m23) / s;\r\n            dst[0] = 0.25 * s;\r\n            dst[1] = (m12 + m21) / s;\r\n            dst[2] = (m13 + m31) / s;\r\n        } else if (m22 > m33) {\r\n            const s = 2 * Math.sqrt(1 + m22 - m11 - m33);\r\n            dst[3] = (m13 - m31) / s;\r\n            dst[0] = (m12 + m21) / s;\r\n            dst[1] = 0.25 * s;\r\n            dst[2] = (m23 + m32) / s;\r\n        } else {\r\n            const s = 2 * Math.sqrt(1 + m33 - m11 - m22);\r\n            dst[3] = (m21 - m12) / s;\r\n            dst[0] = (m13 + m31) / s;\r\n            dst[1] = (m23 + m32) / s;\r\n            dst[2] = 0.25 * s;\r\n        }\r\n    }\r\n\r\n    function decompose(mat, translation, quaternion, scale) {\r\n        let sx = m4.length(mat.slice(0, 3));\r\n        const sy = m4.length(mat.slice(4, 7));\r\n        const sz = m4.length(mat.slice(8, 11));\r\n\r\n        // if determinate is negative, we need to invert one scale\r\n        const det = determinate(mat);\r\n        if (det < 0) {\r\n            sx = -sx;\r\n        }\r\n\r\n        translation[0] = mat[12];\r\n        translation[1] = mat[13];\r\n        translation[2] = mat[14];\r\n\r\n        // scale the rotation part\r\n        const matrix = m4.copy(mat);\r\n\r\n        const invSX = 1 / sx;\r\n        const invSY = 1 / sy;\r\n        const invSZ = 1 / sz;\r\n\r\n        matrix[0] *= invSX;\r\n        matrix[1] *= invSX;\r\n        matrix[2] *= invSX;\r\n\r\n        matrix[4] *= invSY;\r\n        matrix[5] *= invSY;\r\n        matrix[6] *= invSY;\r\n\r\n        matrix[8] *= invSZ;\r\n        matrix[9] *= invSZ;\r\n        matrix[10] *= invSZ;\r\n\r\n        quatFromRotationMatrix(matrix, quaternion);\r\n\r\n        scale[0] = sx;\r\n        scale[1] = sy;\r\n        scale[2] = sz;\r\n    }\r\n\r\n    function determinate(m) {\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n        var tmp_0  = m22 * m33;\r\n        var tmp_1  = m32 * m23;\r\n        var tmp_2  = m12 * m33;\r\n        var tmp_3  = m32 * m13;\r\n        var tmp_4  = m12 * m23;\r\n        var tmp_5  = m22 * m13;\r\n        var tmp_6  = m02 * m33;\r\n        var tmp_7  = m32 * m03;\r\n        var tmp_8  = m02 * m23;\r\n        var tmp_9  = m22 * m03;\r\n        var tmp_10 = m02 * m13;\r\n        var tmp_11 = m12 * m03;\r\n\r\n        var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) -\r\n            (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n        var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) -\r\n            (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n        var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) -\r\n            (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n        var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) -\r\n            (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n        return 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n    }\r\n\r\n    /**\r\n     * Computes the inverse of a matrix.\r\n     * @param {Matrix4} m matrix to compute inverse of\r\n     * @param {Matrix4} [dst] optional matrix to store result\r\n     * @return {Matrix4} dst or a new matrix if none provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function inverse(m, dst) {\r\n        dst = dst || new MatType(16);\r\n        var m00 = m[0 * 4 + 0];\r\n        var m01 = m[0 * 4 + 1];\r\n        var m02 = m[0 * 4 + 2];\r\n        var m03 = m[0 * 4 + 3];\r\n        var m10 = m[1 * 4 + 0];\r\n        var m11 = m[1 * 4 + 1];\r\n        var m12 = m[1 * 4 + 2];\r\n        var m13 = m[1 * 4 + 3];\r\n        var m20 = m[2 * 4 + 0];\r\n        var m21 = m[2 * 4 + 1];\r\n        var m22 = m[2 * 4 + 2];\r\n        var m23 = m[2 * 4 + 3];\r\n        var m30 = m[3 * 4 + 0];\r\n        var m31 = m[3 * 4 + 1];\r\n        var m32 = m[3 * 4 + 2];\r\n        var m33 = m[3 * 4 + 3];\r\n        var tmp_0  = m22 * m33;\r\n        var tmp_1  = m32 * m23;\r\n        var tmp_2  = m12 * m33;\r\n        var tmp_3  = m32 * m13;\r\n        var tmp_4  = m12 * m23;\r\n        var tmp_5  = m22 * m13;\r\n        var tmp_6  = m02 * m33;\r\n        var tmp_7  = m32 * m03;\r\n        var tmp_8  = m02 * m23;\r\n        var tmp_9  = m22 * m03;\r\n        var tmp_10 = m02 * m13;\r\n        var tmp_11 = m12 * m03;\r\n        var tmp_12 = m20 * m31;\r\n        var tmp_13 = m30 * m21;\r\n        var tmp_14 = m10 * m31;\r\n        var tmp_15 = m30 * m11;\r\n        var tmp_16 = m10 * m21;\r\n        var tmp_17 = m20 * m11;\r\n        var tmp_18 = m00 * m31;\r\n        var tmp_19 = m30 * m01;\r\n        var tmp_20 = m00 * m21;\r\n        var tmp_21 = m20 * m01;\r\n        var tmp_22 = m00 * m11;\r\n        var tmp_23 = m10 * m01;\r\n\r\n        var t0 = (tmp_0 * m11 + tmp_3 * m21 + tmp_4 * m31) -\r\n            (tmp_1 * m11 + tmp_2 * m21 + tmp_5 * m31);\r\n        var t1 = (tmp_1 * m01 + tmp_6 * m21 + tmp_9 * m31) -\r\n            (tmp_0 * m01 + tmp_7 * m21 + tmp_8 * m31);\r\n        var t2 = (tmp_2 * m01 + tmp_7 * m11 + tmp_10 * m31) -\r\n            (tmp_3 * m01 + tmp_6 * m11 + tmp_11 * m31);\r\n        var t3 = (tmp_5 * m01 + tmp_8 * m11 + tmp_11 * m21) -\r\n            (tmp_4 * m01 + tmp_9 * m11 + tmp_10 * m21);\r\n\r\n        var d = 1.0 / (m00 * t0 + m10 * t1 + m20 * t2 + m30 * t3);\r\n\r\n        dst[0] = d * t0;\r\n        dst[1] = d * t1;\r\n        dst[2] = d * t2;\r\n        dst[3] = d * t3;\r\n        dst[4] = d * ((tmp_1 * m10 + tmp_2 * m20 + tmp_5 * m30) -\r\n            (tmp_0 * m10 + tmp_3 * m20 + tmp_4 * m30));\r\n        dst[5] = d * ((tmp_0 * m00 + tmp_7 * m20 + tmp_8 * m30) -\r\n            (tmp_1 * m00 + tmp_6 * m20 + tmp_9 * m30));\r\n        dst[6] = d * ((tmp_3 * m00 + tmp_6 * m10 + tmp_11 * m30) -\r\n            (tmp_2 * m00 + tmp_7 * m10 + tmp_10 * m30));\r\n        dst[7] = d * ((tmp_4 * m00 + tmp_9 * m10 + tmp_10 * m20) -\r\n            (tmp_5 * m00 + tmp_8 * m10 + tmp_11 * m20));\r\n        dst[8] = d * ((tmp_12 * m13 + tmp_15 * m23 + tmp_16 * m33) -\r\n            (tmp_13 * m13 + tmp_14 * m23 + tmp_17 * m33));\r\n        dst[9] = d * ((tmp_13 * m03 + tmp_18 * m23 + tmp_21 * m33) -\r\n            (tmp_12 * m03 + tmp_19 * m23 + tmp_20 * m33));\r\n        dst[10] = d * ((tmp_14 * m03 + tmp_19 * m13 + tmp_22 * m33) -\r\n            (tmp_15 * m03 + tmp_18 * m13 + tmp_23 * m33));\r\n        dst[11] = d * ((tmp_17 * m03 + tmp_20 * m13 + tmp_23 * m23) -\r\n            (tmp_16 * m03 + tmp_21 * m13 + tmp_22 * m23));\r\n        dst[12] = d * ((tmp_14 * m22 + tmp_17 * m32 + tmp_13 * m12) -\r\n            (tmp_16 * m32 + tmp_12 * m12 + tmp_15 * m22));\r\n        dst[13] = d * ((tmp_20 * m32 + tmp_12 * m02 + tmp_19 * m22) -\r\n            (tmp_18 * m22 + tmp_21 * m32 + tmp_13 * m02));\r\n        dst[14] = d * ((tmp_18 * m12 + tmp_23 * m32 + tmp_15 * m02) -\r\n            (tmp_22 * m32 + tmp_14 * m02 + tmp_19 * m12));\r\n        dst[15] = d * ((tmp_22 * m22 + tmp_16 * m02 + tmp_21 * m12) -\r\n            (tmp_20 * m12 + tmp_23 * m22 + tmp_17 * m02));\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a  matrix and a vector with 4 entries, transforms that vector by\r\n     * the matrix, and returns the result as a vector with 4 entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector4} v The point in homogenous coordinates.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformVector(m, v, dst) {\r\n        dst = dst || new MatType(4);\r\n        for (var i = 0; i < 4; ++i) {\r\n            dst[i] = 0.0;\r\n            for (var j = 0; j < 4; ++j) {\r\n                dst[i] += v[j] * m[j * 4 + i];\r\n            }\r\n        }\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix and a vector with 3 entries,\r\n     * interprets the vector as a point, transforms that point by the matrix, and\r\n     * returns the result as a vector with 3 entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The point.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformPoint(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n        var d = v0 * m[0 * 4 + 3] + v1 * m[1 * 4 + 3] + v2 * m[2 * 4 + 3] + m[3 * 4 + 3];\r\n\r\n        dst[0] = (v0 * m[0 * 4 + 0] + v1 * m[1 * 4 + 0] + v2 * m[2 * 4 + 0] + m[3 * 4 + 0]) / d;\r\n        dst[1] = (v0 * m[0 * 4 + 1] + v1 * m[1 * 4 + 1] + v2 * m[2 * 4 + 1] + m[3 * 4 + 1]) / d;\r\n        dst[2] = (v0 * m[0 * 4 + 2] + v1 * m[1 * 4 + 2] + v2 * m[2 * 4 + 2] + m[3 * 4 + 2]) / d;\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix and a vector with 3 entries, interprets the vector as a\r\n     * direction, transforms that direction by the matrix, and returns the result;\r\n     * assumes the transformation of 3-dimensional space represented by the matrix\r\n     * is parallel-preserving, i.e. any combination of rotation, scaling and\r\n     * translation, but not a perspective distortion. Returns a vector with 3\r\n     * entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The direction.\r\n     * @param {Vector4} dst optional vector4 to store result\r\n     * @return {Vector4} dst or new Vector4 if not provided\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformDirection(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n\r\n        dst[0] = v0 * m[0 * 4 + 0] + v1 * m[1 * 4 + 0] + v2 * m[2 * 4 + 0];\r\n        dst[1] = v0 * m[0 * 4 + 1] + v1 * m[1 * 4 + 1] + v2 * m[2 * 4 + 1];\r\n        dst[2] = v0 * m[0 * 4 + 2] + v1 * m[1 * 4 + 2] + v2 * m[2 * 4 + 2];\r\n\r\n        return dst;\r\n    }\r\n\r\n    /**\r\n     * Takes a 4-by-4 matrix m and a vector v with 3 entries, interprets the vector\r\n     * as a normal to a surface, and computes a vector which is normal upon\r\n     * transforming that surface by the matrix. The effect of this function is the\r\n     * same as transforming v (as a direction) by the inverse-transpose of m.  This\r\n     * function assumes the transformation of 3-dimensional space represented by the\r\n     * matrix is parallel-preserving, i.e. any combination of rotation, scaling and\r\n     * translation, but not a perspective distortion.  Returns a vector with 3\r\n     * entries.\r\n     * @param {Matrix4} m The matrix.\r\n     * @param {Vector3} v The normal.\r\n     * @param {Vector3} [dst] The direction.\r\n     * @return {Vector3} The transformed direction.\r\n     * @memberOf module:webgl-3d-math\r\n     */\r\n    function transformNormal(m, v, dst) {\r\n        dst = dst || new MatType(3);\r\n        var mi = inverse(m);\r\n        var v0 = v[0];\r\n        var v1 = v[1];\r\n        var v2 = v[2];\r\n\r\n        dst[0] = v0 * mi[0 * 4 + 0] + v1 * mi[0 * 4 + 1] + v2 * mi[0 * 4 + 2];\r\n        dst[1] = v0 * mi[1 * 4 + 0] + v1 * mi[1 * 4 + 1] + v2 * mi[1 * 4 + 2];\r\n        dst[2] = v0 * mi[2 * 4 + 0] + v1 * mi[2 * 4 + 1] + v2 * mi[2 * 4 + 2];\r\n\r\n        return dst;\r\n    }\r\n\r\n    function copy(src, dst) {\r\n        dst = dst || new MatType(16);\r\n\r\n        dst[ 0] = src[ 0];\r\n        dst[ 1] = src[ 1];\r\n        dst[ 2] = src[ 2];\r\n        dst[ 3] = src[ 3];\r\n        dst[ 4] = src[ 4];\r\n        dst[ 5] = src[ 5];\r\n        dst[ 6] = src[ 6];\r\n        dst[ 7] = src[ 7];\r\n        dst[ 8] = src[ 8];\r\n        dst[ 9] = src[ 9];\r\n        dst[10] = src[10];\r\n        dst[11] = src[11];\r\n        dst[12] = src[12];\r\n        dst[13] = src[13];\r\n        dst[14] = src[14];\r\n        dst[15] = src[15];\r\n\r\n        return dst;\r\n    }\r\n\r\nexport const m4 = {\r\n        copy: copy,\r\n        lookAt: lookAt,\r\n        addVectors: addVectors,\r\n        subtractVectors: subtractVectors,\r\n        scaleVector: scaleVector,\r\n        distance: distance,\r\n        distanceSq: distanceSq,\r\n        normalize: normalize,\r\n        compose: compose,\r\n        cross: cross,\r\n        decompose: decompose,\r\n        dot: dot,\r\n        identity: identity,\r\n        transpose: transpose,\r\n        length: length,\r\n        lengthSq: lengthSq,\r\n        orthographic: orthographic,\r\n        frustum: frustum,\r\n        perspective: perspective,\r\n        translation: translation,\r\n        translate: translate,\r\n        xRotation: xRotation,\r\n        yRotation: yRotation,\r\n        zRotation: zRotation,\r\n        xRotate: xRotate,\r\n        yRotate: yRotate,\r\n        zRotate: zRotate,\r\n        axisRotation: axisRotation,\r\n        axisRotate: axisRotate,\r\n        scaling: scaling,\r\n        scale: scale,\r\n        multiply: multiply,\r\n        inverse: inverse,\r\n        transformVector: transformVector,\r\n        transformPoint: transformPoint,\r\n        transformDirection: transformDirection,\r\n        transformNormal: transformNormal,\r\n        setDefaultType: setDefaultType,\r\n}\r\n\r\n","import { m4 } from '../../helpers/m4'\r\n\r\nconst {\r\n    floor,\r\n    random,\r\n} = Math\r\nconst ranN = (start, end) => start + floor(random() * (end - start))\r\nexport const ran = (start, end) => start + random() * (end - start)\r\n\r\n\r\n\r\nexport const createFace = (v1, v2, v3, v4) => [...v1, ...v2, ...v3, ...v1, ...v3, ...v4]\r\nexport const createUv = (v1, v2, v3, v4) => [...v1, ...v2, ...v3, ...v1, ...v3, ...v4]\r\nexport const fillColorFace = c => [...c, ...c, ...c, ...c, ...c, ...c]\r\n\r\n\r\n\r\nexport const createFaceWithSquare = (v1, v2, v3, v4, color1, color2) => {\r\n    const maxW = v2[0] - v1[0]\r\n    const maxH = v3[1] - v1[1]\r\n\r\n    const innerW = ran(maxW * 0.3, maxW * 0.7)\r\n    const innerH = ran(maxH * 0.3, maxH * 0.7)\r\n\r\n    const x1 = v1[0] + (maxW - innerW) / 2\r\n    const x2 = v2[0] - (maxW - innerW) / 2\r\n    const y1 = v1[1] + (maxH - innerH) / 2\r\n    const y2 = v3[1] - (maxH - innerH) / 2\r\n\r\n    const v1_i = [x1, y1, v1[2]]\r\n    const v2_i = [x2, y1, v1[2]]\r\n    const v3_i = [x2, y2, v1[2]]\r\n    const v4_i = [x1, y2, v1[2]]\r\n\r\n    const vArr = []\r\n    vArr.push(\r\n        ...createFace(v1_i, v2_i, v3_i, v4_i),\r\n        ...createFace(v1, v2, v2_i, v1_i),\r\n        ...createFace(v2_i, v2, v3, v3_i),\r\n        ...createFace(v4_i, v3_i, v3, v4),\r\n        ...createFace(v1, v1_i, v4_i, v4),\r\n    )\r\n\r\n    const cArr = fillColorFaceWithSquare(color1, color2)\r\n\r\n    const uArr = [\r\n        ...createUv(\r\n            [.5, .5],\r\n            [1, .5],\r\n            [1, 1],\r\n            [.5, 1],\r\n        ),\r\n\r\n\r\n        \r\n        ...createUv(\r\n            [0, .5],\r\n            [.5, .5],\r\n            //[.5, 1],\r\n            //[0, 1],\r\n            [.4, .6],\r\n            [.1, .6],\r\n        ),\r\n        ...createUv(\r\n            [.4, .6],\r\n            [.5, .5],\r\n            [.5, 1],\r\n            [.4, .9],\r\n        ),\r\n        ...createUv(\r\n            [.1, .9],\r\n            [.4, .9],\r\n            [.5, 1],\r\n            [0, 1],\r\n        ),\r\n        ...createUv(\r\n            [0, .5],\r\n            [.1, .6],\r\n            [.1, .9],\r\n            [0, 1],\r\n        )\r\n    ]\r\n\r\n\r\n    return { \r\n        vArr,\r\n        cArr,\r\n        uArr,\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const fillColorFaceWithSquare = (c1, c2) => [\r\n    ...fillColorFace(c1),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n    ...fillColorFace(c2),\r\n]\r\n\r\n\r\n\r\nexport const transformArr = (arr, x = 0, y = 0, z = 0, r = 0) => {\r\n    let matrix = m4.yRotation(r);\r\n    matrix = m4.translate(matrix, x, y, z);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\nexport const rotateArr = (arr, angle) => {\r\n    const matrix = m4.yRotation(angle);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}\r\n\r\n\r\nexport const translateArr = (arr, x = 0, y = 0, z = 0) => {\r\n    const matrix = m4.translation(x, y, z);\r\n\r\n    for (let i = 0; i < arr.length; i += 3) {\r\n        const vector = m4.transformPoint(matrix, [arr[i + 0], arr[i + 1], arr[i + 2], 1])\r\n        arr[i + 0] = vector[0]\r\n        arr[i + 1] = vector[1]\r\n        arr[i + 2] = vector[2]\r\n    }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    createFaceWithSquare,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\nimport { ran } from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements' \r\n\r\n\r\n\r\n\r\n\r\n\r\nconst createTrunk = ({\r\n     h = 2,\r\n     h2 = 30,\r\n     r = 10,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n}) => {\r\n    const arrDividers = []\r\n    let leftH = h2 - h\r\n    let currentH = h\r\n    while (leftH > 0) {\r\n        const h01 = ran(0.5, 10)\r\n        const h02 = ran(0.5, 4)\r\n        const h03 = ran(0.5, 4)\r\n        const h04 = ran(0.5, .2, 4)\r\n        const fullH = h01 + h02 + h03 + h04\r\n        leftH -= fullH\r\n        if (leftH > 5) {\r\n            arrDividers.push({\r\n                h0: currentH,\r\n                h01: currentH + h01,\r\n                h02: currentH + h01 + h02,\r\n                h03: currentH + h01 + h02 + h03,\r\n                h04: currentH + h01 + h02 + h03 + h04,\r\n                r: ran(1, 10),\r\n            })\r\n        }\r\n        currentH = currentH + fullH\r\n    }\r\n\r\n\r\n    const vert = []\r\n    const col = []\r\n    const uv = []\r\n\r\n\r\n\r\n    if (arrDividers.length === 0) {\r\n        vert.push(\r\n            ...createFace(\r\n                [-r, h, r],\r\n                [r, h, r],\r\n                [r, h2, r],\r\n                [-r, h2, r],\r\n            )\r\n        )\r\n        col.push(...fillColorFace(color1))\r\n        uv.push(...createUv(\r\n            [0, .5],\r\n            [.5, .5],\r\n            [.5, 1],\r\n            [0, 1],\r\n        ))\r\n    } else {\r\n        for (let i = 0; i < arrDividers.length; ++i) {\r\n            /** column ***/\r\n            const { vArr, cArr, uArr } = createFaceWithSquare(\r\n                [-r, arrDividers[i].h0, r],\r\n                [r, arrDividers[i].h0, r],\r\n                [r, arrDividers[i].h01, r],\r\n                [-r, arrDividers[i].h01, r],\r\n                color2,\r\n                color2,\r\n            )\r\n            vert.push(...vArr)\r\n            col.push(...cArr)\r\n            uv.push(...uArr)\r\n            /** column -> divider */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-r, arrDividers[i].h01, r],\r\n                    [r, arrDividers[i].h01, r],\r\n                    [arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [-arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color2))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n            /** divider */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h02, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [-arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color1))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n            /** divider -> column */\r\n            vert.push(\r\n                ...createFace(\r\n                    [-arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [arrDividers[i].r, arrDividers[i].h03, arrDividers[i].r],\r\n                    [r, arrDividers[i].h04, r],\r\n                    [-r, arrDividers[i].h04, r],\r\n                )\r\n            )\r\n            col.push(...fillColorFace(color2))\r\n            uv.push(...createUv(\r\n                [0, .5],\r\n                [.5, .5],\r\n                [.5, 1],\r\n                [0, 1],\r\n            ))\r\n        }\r\n\r\n        /** last segment */\r\n        const { vArr, cArr, uArr } = createFaceWithSquare(\r\n            [-r, arrDividers[arrDividers.length - 1].h04, r],\r\n            [r, arrDividers[arrDividers.length - 1].h04, r],\r\n            [r, h2, r],\r\n            [-r, h2, r],\r\n            color2,\r\n            color1,\r\n        )\r\n        vert.push(...vArr)\r\n        col.push(...cArr)\r\n        uv.push(...uArr)\r\n    }\r\n\r\n    return { vert, col, uv }\r\n}\r\n\r\n\r\nexport const createDataSideColumn = ({\r\n    h0,\r\n    h1,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n    rBase = 5,\r\n    hBase = 5,\r\n    hBaseToTrunk = 1,\r\n\r\n    hCapital = 2,\r\n    rCapital = 6,\r\n    hTrunkToCapital = 1,\r\n\r\n\r\n    rTrunk = 3,\r\n}) => {\r\n    let _h0 = h0\r\n    let _h1 = h0 + hBase \r\n    /** BASE **************/\r\n    const base = createFace(\r\n        [-rBase, _h0, rBase,],\r\n        [rBase, _h0, rBase],\r\n        [rBase, _h1, rBase],\r\n        [-rBase, _h1, rBase],\r\n    )\r\n    const colorBase = fillColorFace(color1)\r\n    const uv1 = createUv(\r\n        [.5, 0],\r\n        [1, 0],\r\n        [1, .5],\r\n        [.5, .5],\r\n    )\r\n\r\n    const base1 = createFace(\r\n        [rBase + lW, _h0 - lW, rBase + lW],\r\n        [-rBase - lW, _h0 - lW, rBase + lW],\r\n        [-rBase - lW, _h1, rBase + lW],\r\n        [rBase + lW, _h1, rBase + lW],\r\n    )\r\n    const colorBase1 = fillColorFace(lCol)\r\n    const uv1_1 = createUv(\r\n        [0, 1],\r\n        [0, 1],\r\n        [0, 1],\r\n        [0, 1],\r\n    )\r\n\r\n\r\n\r\n\r\n\r\n\r\n    _h0 = _h1\r\n    _h1 = _h0 + hBaseToTrunk\r\n    const baseToTrunk = [...createFace(\r\n        [-rBase, _h0, rBase],\r\n        [rBase, _h0, rBase],\r\n        [rTrunk, _h1, rTrunk],\r\n        [-rTrunk, _h1, rTrunk],\r\n    )]\r\n    const colorBaseToTrunk = [...fillColorFace(color2)]\r\n    const uvBT = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.4, .7],\r\n        [.1, .7],\r\n    )\r\n\r\n\r\n    /** TRUNK ************************/\r\n    \r\n    \r\n    let h = hBase + hBaseToTrunk\r\n\r\n    _h0 = _h1\r\n    _h1 = h1 - hCapital - hTrunkToCapital\r\n\r\n    const { vert, col, uv } = createTrunk({\r\n        color1, color2,\r\n        h: _h0,\r\n        h2: _h1,\r\n        r: rTrunk,\r\n    })\r\n    const uvT = uv\r\n\r\n\r\n    /** CAPITAL **************/\r\n    _h0 = _h1\r\n    _h1 = h1 - hCapital \r\n    const trunkToCapital = [...createFace(\r\n        [-rTrunk, _h0, rTrunk],\r\n        [rTrunk, _h0, rTrunk],\r\n        [rCapital, _h1, rCapital],\r\n        [-rCapital, _h1, rCapital],\r\n    )]\r\n    _h0 = _h1\r\n    _h1 = h1\r\n    const capital = [\r\n        ...createFace(\r\n            [-rCapital, _h0, rCapital],\r\n            [rCapital, _h0, rCapital],\r\n            [rCapital, _h1, rCapital],\r\n            [-rCapital, _h1, rCapital],\r\n        ),\r\n    ]\r\n    const uvC = createUv(\r\n        [.5, .5],\r\n        [1, .5],\r\n        [1, 0],\r\n        [.5, 0],\r\n    )\r\n\r\n\r\n    const frontVert = [\r\n        ...base,\r\n        ...base1,\r\n        ...baseToTrunk,\r\n        ...vert,\r\n        ...trunkToCapital,\r\n        ...capital,\r\n    ]\r\n    const frontColors = [\r\n        ...colorBase,\r\n        ...colorBase1,\r\n        ...colorBaseToTrunk,\r\n        ...col,\r\n        ...colorBaseToTrunk,\r\n        ...colorBase,\r\n    ]\r\n    const frontUV = [\r\n        ...uv1,\r\n        ...uv1_1,\r\n        ...uvBT,\r\n        ...uvT,\r\n        ...uvBT,\r\n        ...uvC,\r\n    ]\r\n\r\n\r\n    return {\r\n        frontVert,\r\n        frontColors,\r\n        frontUV,\r\n    }\r\n}","import { createDataSideColumn } from './dataColumnSide'\r\nimport {\r\n    transformArr,\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements'\r\n\r\n\r\n\r\n\r\nconst color1 = [0, 0, 0]\r\nconst color2 = [0, .7, 0]\r\n\r\n\r\n\r\n\r\nexport const createDataColumn = ({\r\n    h0 = 0,\r\n    h1 = 30,\r\n    rCapital = 6,\r\n    rBase = 5,\r\n    capTop = false,\r\n    capBottom = false\r\n}) => {\r\n\r\n    const {\r\n        frontVert,\r\n        frontColors,\r\n        frontUV,\r\n    } = createDataSideColumn({ h0, h1, color1, color2, rCapital, rBase })\r\n\r\n\r\n    const leftVert = [...frontVert]\r\n    transformArr(leftVert, 0, 0, 0, Math.PI / 2)\r\n\r\n    const rightVert = [...frontVert]\r\n    transformArr(rightVert, 0, 0, 0, -Math.PI / 2)\r\n\r\n    const backVert = [...frontVert]\r\n    transformArr(backVert, 0, 0, 0, Math.PI)\r\n\r\n\r\n    const v = [\r\n        ...frontVert,\r\n        ...leftVert,\r\n        ...rightVert,\r\n        ...backVert,\r\n    ]\r\n    const c = [\r\n        ...frontColors,\r\n        ...frontColors,\r\n        ...frontColors,\r\n        ...frontColors,\r\n    ]\r\n\r\n    const u = [\r\n        ...frontUV,\r\n        ...frontUV,\r\n        ...frontUV,\r\n        ...frontUV,\r\n    ]\r\n\r\n\r\n    const wL = .6\r\n    const collision = [\r\n        ...createFace(\r\n            [-rBase - wL, h0, rBase + wL],\r\n            [rBase + wL, h0, rBase + wL],\r\n            [rBase + wL, h1, rBase + wL],\r\n            [-rBase - wL, h1, rBase + wL],\r\n        ),\r\n        ...createFace(\r\n            [rBase + wL, h0, rBase + wL],\r\n            [rBase + wL, h0, -rBase - wL],\r\n            [rBase + wL, h1, -rBase - wL],\r\n            [rBase + wL, h1, rBase + wL],\r\n        ),\r\n        ...createFace(\r\n            [rBase + wL, h0, -rBase - wL],\r\n            [-rBase - wL, h0, -rBase - wL],\r\n            [-rBase - wL, h1, -rBase - wL],\r\n            [rBase + wL, h1, -rBase - wL],\r\n        ),\r\n        ...createFace(\r\n            [-rBase - wL, h0, -rBase - wL],\r\n            [-rBase - wL, h0, rBase + wL],\r\n            [-rBase - wL, h1, rBase + wL],\r\n            [-rBase - wL, h1, -rBase - wL],\r\n        ),\r\n    ]\r\n\r\n\r\n    if (capBottom) {\r\n        v.push(...createFace(\r\n            [-rBase - lW, h0 - lW, rBase + lW],\r\n            [rBase + lW, h0 - lW, rBase + lW],\r\n            [rBase, h0 - lW, -rBase - lW],\r\n            [-rBase, h0 - lW, -rBase - lW],\r\n        ))\r\n        c.push(...fillColorFace(lCol))\r\n        u.push(...createUv(\r\n            [0, 1],\r\n            [0, 1],\r\n            [0, 1],\r\n            [0, 1],\r\n        ))\r\n    }\r\n\r\n    if (capTop) {\r\n        v.push(...createFace(\r\n            [-rCapital, h1, rCapital],\r\n            [rCapital, h1, rCapital],\r\n            [rCapital, h1, -rCapital],\r\n            [-rCapital, h1, -rCapital],\r\n        ))\r\n        c.push(...fillColorFace(color1))\r\n        u.push(...createUv(\r\n            [.5, 0],\r\n            [1, 0],\r\n            [1, .5],\r\n            [.5, .5],\r\n        ))\r\n    }\r\n\r\n\r\n    return { v, c, u, collision }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\nimport { lCol, lW } from '../../constants/constants_elements' \r\n\r\nconst {\r\n    sin,\r\n    cos,\r\n} = Math\r\n\r\n\r\n\r\n\r\nexport const createTopElem = ({\r\n  isTopElem,\r\n  color1,\r\n  color2,\r\n  h2,\r\n}) => {\r\n\r\n\r\n    if (!isTopElem) {\r\n        return {\r\n            vertTopElem: [],\r\n            colorsTopElem: [],\r\n            uvTopElem: [],\r\n        }\r\n    }\r\n\r\n\r\n    const vertTopElem = []\r\n    const colorsTopElem = []\r\n    const uvTopElem = []\r\n\r\n\r\n    const hl1 = 2 + Math.random() * 12\r\n    const hl2 = 1 + Math.random() * 4\r\n    const hl3 = .2 + Math.random() * 40\r\n    const hl4 = .1 + Math.random() * 10\r\n    const hl5 = .1 + Math.random() * 10\r\n    const hl6 = .1 + Math.random() * 40\r\n\r\n\r\n    const count = 6\r\n    for (let i = 0; i < count; ++i) {\r\n\r\n        let nextI = i + 1\r\n        if (nextI > count) {\r\n            nextI = 0\r\n        }\r\n\r\n\r\n        const angle1 = i / count * Math.PI * 2\r\n        const angle2 = nextI / count * Math.PI * 2\r\n\r\n        let _h1 = h2\r\n        let _h2 = _h1 + hl1\r\n        let _r1 = 6\r\n        let _r2 = 6\r\n        const sA1 = sin(angle1)\r\n        const cA1 = cos(angle1)\r\n        const sA2 = sin(angle2)\r\n        const cA2 = cos(angle2)\r\n\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl2\r\n        _r1 = _r2\r\n        _r2 = 3\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl3\r\n        _r1 = _r2\r\n        _r2 = _r1\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl4\r\n        _r1 = _r2\r\n        _r2 = _r1 + 4\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl5\r\n        _r1 = _r2\r\n        _r2 = _r1\r\n\r\n        /** baraban */\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n        /** baraban stroke */\r\n        let lW3 = lW + .5\r\n        vertTopElem.push(...createFace(\r\n            [sA2 * (_r1 + lW3), _h1, cA2 * (_r1 + lW3)],\r\n            [sA1 * (_r1 + lW3), _h1, cA1 * (_r1 + lW3)],\r\n            [sA1 * (_r2 + lW3), _h2, cA1 * (_r2 + lW3)],\r\n            [sA2 * (_r2 + lW3), _h2, cA2 * (_r2 + lW3)],\r\n        ))\r\n\r\n\r\n\r\n\r\n\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA2 * 2, _h2, cA2 * 2],\r\n            [sin(angle1) * 2, _h2, cA1 * 2],\r\n        ))\r\n\r\n        _h1 = _h2\r\n        _h2 = _h1 + hl6\r\n        _r1 = 2\r\n        _r2 = 7\r\n\r\n        vertTopElem.push(...createFace(\r\n            [sA1 * _r1, _h1, cA1 * _r1],\r\n            [sA2 * _r1, _h1, cA2 * _r1],\r\n            [sA2 * _r2, _h2, cA2 * _r2],\r\n            [sA1 * _r2, _h2, cA1 * _r2],\r\n        ))\r\n\r\n        /** top con */\r\n\r\n        const lW2 = lW\r\n        vertTopElem.push(...createFace(\r\n            [sA2 * (_r1 + lW2), _h1, cA2 * (_r1 + lW2)],\r\n            [sA1 * (_r1 + lW2), _h1, cA1 * (_r1 + lW2)],\r\n            [sA1 * (_r2 + lW2), _h2, cA1 * (_r2 + lW2)],\r\n            [sA2 * (_r2 + lW2), _h2, cA2 * (_r2 + lW2)],\r\n        ))\r\n\r\n\r\n\r\n        _h1 = _h2\r\n        _h2 = _h2 + hl6\r\n        vertTopElem.push(\r\n            sA1 * _r2, _h1, cA1 * _r2,\r\n            sA2 * _r2, _h1, cA2 * _r2,\r\n            0, _h2, 0,\r\n        )\r\n        vertTopElem.push(\r\n            sA2 * (_r2 + .5), _h1, cA2 * (_r2 + .5),\r\n            sA1 * (_r2 + .5), _h1, cA1 * (_r2 + .5),\r\n            0, _h2 + 3, 0,\r\n        )\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        colorsTopElem.push(\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color2),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(lCol),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(color1),\r\n            ...fillColorFace(lCol),\r\n            ...color1,\r\n            ...color1,\r\n            ...color1,\r\n            ...lCol,\r\n            ...lCol,\r\n            ...lCol,\r\n        )\r\n\r\n        uvTopElem.push(\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, 1], [0, 1], [0, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, .5], [.5, .5], [.5, 1], [0, 1],),\r\n            ...createUv([0, 1], [0, 1], [0, 1], [0, 1],),\r\n            ...[0, .5],\r\n            ...[.5, .5],\r\n            ...[.25, 1],\r\n\r\n            ...[0, 1],\r\n            ...[0, 1],\r\n            ...[0, 1],\r\n        )\r\n\r\n    }\r\n\r\n\r\n    return {\r\n        vertTopElem,\r\n        colorsTopElem,\r\n        uvTopElem,\r\n    }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\nexport const createSimpleColumn = ({ isColumn, h1, h2, color1, color2 }) => {\r\n    if (!isColumn) {\r\n        return {\r\n            vertColumn: [],\r\n            colorsColumn: [],\r\n            uvColumn: [],\r\n        }\r\n    }\r\n\r\n    const vertColumn = []\r\n    const colorsColumn = []\r\n    const uvColumn = []\r\n\r\n    const r = 4\r\n    const rC = 6\r\n    const hC = h2 - 5\r\n\r\n    /** front **************/\r\n    vertColumn.push(\r\n        ...createFace(\r\n            [-r, h1, r,],\r\n            [r, h1, r],\r\n            [r, h2, r],\r\n            [-r, h2, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, h1, r],\r\n            [r, h1, -r],\r\n            [r, h2, -r],\r\n            [r, h2, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, h1, -r],\r\n            [-r, h1, -r],\r\n            [-r, h2, -r],\r\n            [r, h2, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, h1, -r],\r\n            [-r, h1, r],\r\n            [-r, h2, r],\r\n            [-r, h2, -r],\r\n        ),\r\n\r\n        // capitel\r\n        ...createFace(\r\n            [-rC, hC, rC],\r\n            [rC, hC, rC],\r\n            [rC, h2, rC],\r\n            [-rC, h2, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [rC, hC, rC],\r\n            [rC, hC, -rC],\r\n            [rC, h2, -rC],\r\n            [rC, h2, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [rC, hC, -rC],\r\n            [-rC, hC, -rC],\r\n            [-rC, h2, -rC],\r\n            [rC, h2, -rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rC, hC, -rC],\r\n            [-rC, hC, rC],\r\n            [-rC, h2, rC],\r\n            [-rC, h2, -rC],\r\n        ),\r\n\r\n        // bottom top\r\n\r\n        ...createFace(\r\n            [-rC, hC, rC],\r\n            [-rC, hC, -rC],\r\n            [rC, hC, -rC],\r\n            [rC, hC, rC],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rC, h2, -rC],\r\n            [-rC, h2, rC],\r\n            [rC, h2, rC],\r\n            [rC, h2, -rC],\r\n        ),\r\n    )\r\n\r\n    colorsColumn.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n        ...fillColorFace(color1),\r\n    )\r\n\r\n\r\n    const uv = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.5, 1],\r\n        [0, 1],\r\n    )\r\n\r\n    uvColumn.push(\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n        ...uv,\r\n    )\r\n\r\n\r\n    return {\r\n        vertColumn,\r\n        colorsColumn,\r\n        uvColumn,\r\n    }\r\n}\r\n","import { createDataColumn } from './dataColumn'\r\nimport { createDataSideArc } from \"./dataArc\";\r\nimport { createTopElem } from \"./dataTopElem\";\r\nimport { createSimpleColumn } from './dataColumnSimple'\r\n\r\n\r\n\r\nconst color1 = [0, 0, 0]\r\nconst color2 = [0, .7, 0]\r\n\r\nexport const createSegmentGallery = ({\r\n                          h0 = 0,\r\n                          h1 = 30,\r\n                          h2 = 60,\r\n                          arc = false,\r\n                          isTopElem = false,\r\n                          isColumn = false\r\n                      }) => {\r\n\r\n    let v = []\r\n    let c = []\r\n    let u = []\r\n\r\n    /** arc */\r\n    if (arc) {\r\n        const arcData = createDataSideArc({ h1, h2, color1, color2, ...arc })\r\n        v.push(...arcData.v)\r\n        c.push(...arcData.c)\r\n        u.push(...arcData.u)\r\n    }\r\n\r\n\r\n    /** column */\r\n    const rCapital = 6\r\n    const rBase = 5\r\n    const columnData = createDataColumn({\r\n        h0,\r\n        h1,\r\n        color1,\r\n        color2,\r\n        rCapital,\r\n        rBase,\r\n        capTop: true,\r\n        capBottom: true\r\n    })\r\n    v.push(...columnData.v)\r\n    c.push(...columnData.c)\r\n    u.push(...columnData.u)\r\n\r\n\r\n    /** top elem */\r\n    const {\r\n        vertTopElem,\r\n        colorsTopElem,\r\n        uvTopElem,\r\n    } = createTopElem({ h2, color1, color2, isTopElem })\r\n    v.push(...vertTopElem)\r\n    c.push(...colorsTopElem)\r\n    u.push(...uvTopElem)\r\n\r\n    /** simple column */\r\n    const {\r\n        vertColumn,\r\n        colorsColumn,\r\n        uvColumn,\r\n    } = createSimpleColumn({ isColumn, h1, h2, color1, color2 })\r\n    v.push(...vertColumn)\r\n    c.push(...colorsColumn)\r\n    u.push(...uvColumn)\r\n\r\n\r\n    return { v, c, u }\r\n}","import {\r\n    createFace,\r\n    createUv,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\n\r\nexport const createDataSideArc = ({\r\n    h1,\r\n    h2,\r\n    color1 = [.2, .1, .1],\r\n    color2 = [1, 1, 1],\r\n    r = 5,\r\n    rCap = 7,\r\n    wCol = 3,\r\n    w = 40,\r\n}) => {\r\n    const lBridge = w - (r * 2)\r\n    const zArc = - r - lBridge\r\n\r\n    const lCapital = Math.min((h2 - h1) * 0.1, 2)\r\n    const hC = h2 - lCapital\r\n\r\n\r\n\r\n    let _h1 = h1\r\n    let _h2 = hC\r\n    /** front **************/\r\n    const columnF = [...createFace(\r\n        [-wCol, _h1, r,],\r\n        [wCol, _h1, r],\r\n        [wCol, _h2, r],\r\n        [-wCol, _h2, r],\r\n    )]\r\n    const colorFill2 = [...fillColorFace(color2)]\r\n    const colorFill1 = [...fillColorFace(color1)]\r\n    const uv1 = createUv(\r\n        [0, .5],\r\n        [.5, .5],\r\n        [.5, 1],\r\n        [0, 1],\r\n    )\r\n\r\n    /** left / right *****************/\r\n    const column = [\r\n        ...createFace(\r\n            [-wCol, _h1, -r,],\r\n            [-wCol, _h1, r],\r\n            [-wCol, _h2, r],\r\n            [-wCol, _h2, -r],\r\n        ),\r\n        ...createFace(\r\n            [wCol, _h1, r,],\r\n            [wCol, _h1, -r],\r\n            [wCol, _h2, -r],\r\n            [wCol, _h2, r],\r\n        )\r\n    ]\r\n    /** back Column *********/\r\n    const columnB = [\r\n        ...createFace(\r\n            [wCol, _h1, -r,],\r\n            [-wCol, _h1, -r],\r\n            [-wCol, _h2, -r],\r\n            [wCol, _h2, -r],\r\n        ),\r\n    ]\r\n\r\n\r\n\r\n\r\n    /** arc ******************/\r\n    const arc = []\r\n    const cA = []\r\n    const uvA = []\r\n    const x = -wCol + 2\r\n    const x2 = wCol - 2\r\n    const resolution = 14\r\n    const step = lBridge / resolution\r\n    const diff = _h2 - _h1\r\n    const offsetArcTop = diff * 0.15\r\n\r\n\r\n    for (let i = 0; i < resolution; ++i) {\r\n        const hI1 = (1 - Math.sin((i + 1) / resolution * Math.PI)) * (diff - offsetArcTop) + offsetArcTop\r\n        const hI2 = (1 - Math.sin(i / resolution * Math.PI)) * (diff - offsetArcTop) + offsetArcTop\r\n        let tZ = -r\r\n        if (i + 1 > resolution / 2) {\r\n            tZ = -r - lBridge\r\n        }\r\n        /** left arc */\r\n        arc.push(\r\n            x,   _h2 - hI1,    -r - ((i + 1) * step),\r\n            x,   _h2 - hI2,    -r - (i * step),\r\n            x,   _h2,          tZ,\r\n        )\r\n        cA.push(\r\n            ...color2,\r\n            ...color2,\r\n            ...color2,\r\n        )\r\n        uvA.push(\r\n            0, 0,\r\n            .3, 0,\r\n            .3, .3,\r\n        )\r\n        /** right arc */\r\n        arc.push(\r\n            x2,   _h2 - hI2,    -r - (i * step),\r\n            x2,   _h2 - hI1,    -r - ((i + 1) * step),\r\n            x2,   _h2,          tZ,\r\n        )\r\n        cA.push(\r\n            ...color2,\r\n            ...color2,\r\n            ...color2,\r\n        )\r\n        uvA.push(\r\n            0, 0,\r\n            .3, 0,\r\n            .3, .3,\r\n        )\r\n        /** bottom arc */\r\n        arc.push(...createFace(\r\n            [x2, _h2 - hI2, -r - (i * step)],\r\n            [x,  _h2 - hI2, -r - (i * step)],\r\n            [x,  _h2 - hI1, -r - ((i + 1) * step)],\r\n            [x2, _h2 - hI1, -r - ((i + 1) * step)],\r\n        ))\r\n        cA.push(...colorFill1)\r\n        uvA.push(...createUv([0, 0], [0, 0], [0, 0], [0, 0]))\r\n\r\n    }\r\n\r\n    arc.push(\r\n        x,   _h2 - offsetArcTop,     -r - step * resolution / 2,\r\n        x,   _h2,                    -r,\r\n        x,   _h2,                    -r - step * resolution,\r\n    )\r\n    cA.push(\r\n        ...color2,\r\n        ...color2,\r\n        ...color2,\r\n    )\r\n    uvA.push(\r\n        .5, .25,\r\n        .25, .3,\r\n        .25, .2,\r\n    )\r\n\r\n    arc.push(\r\n        x2,   _h2 - offsetArcTop,    -r - step * resolution / 2,\r\n        x2,   _h2,                   -r - step * resolution,\r\n        x2,   _h2,                   -r,\r\n    )\r\n    cA.push(\r\n        ...color2,\r\n        ...color2,\r\n        ...color2,\r\n    )\r\n    uvA.push(\r\n        .5, .25,\r\n        .25, .3,\r\n        .25, .2,\r\n    )\r\n\r\n\r\n\r\n    _h1 = _h2\r\n    _h2 = h2\r\n    /** capitel *****************/\r\n    const cap = [\r\n        ...createFace(\r\n            [-rCap, _h1, -rCap,],\r\n            [rCap, _h1, -rCap],\r\n            [rCap, _h1, rCap],\r\n            [-rCap, _h1, rCap],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-rCap, _h1, rCap,],\r\n            [rCap, _h1, rCap],\r\n            [rCap, _h2, rCap],\r\n            [-rCap, _h2, rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap, _h1, -rCap,],\r\n            [-rCap, _h1, rCap],\r\n            [-rCap, _h2, rCap],\r\n            [-rCap, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [rCap, _h1, rCap,],\r\n            [rCap, _h1, -rCap],\r\n            [rCap, _h2, -rCap],\r\n            [rCap, _h2, rCap],\r\n        ),\r\n        ...createFace(\r\n            [rCap, _h1, -rCap,],\r\n            [-rCap, _h1, -rCap],\r\n            [-rCap, _h2, -rCap],\r\n            [rCap, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap, _h2, rCap,],\r\n            [rCap, _h2, rCap],\r\n            [rCap, _h2, -rCap],\r\n            [-rCap, _h2, -rCap],\r\n        ),\r\n        //////\r\n        ...createFace(\r\n            [-rCap + 2, _h1, zArc],\r\n            [rCap - 2, _h1, zArc],\r\n            [rCap - 2, _h1, -rCap],\r\n            [-rCap + 2, _h1, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap + 2, _h1, zArc],\r\n            [-rCap + 2, _h1, -rCap],\r\n            [-rCap + 2, _h2, -rCap],\r\n            [-rCap + 2, _h2, zArc],\r\n        ),\r\n        ...createFace(\r\n            [rCap - 2, _h1, -rCap],\r\n            [rCap - 2, _h1, zArc],\r\n            [rCap - 2, _h2, zArc],\r\n            [rCap - 2, _h2, -rCap],\r\n        ),\r\n        ...createFace(\r\n            [-rCap + 2, _h2, -rCap],\r\n            [rCap - 2, _h2, -rCap],\r\n            [rCap - 2, _h2, zArc],\r\n            [-rCap + 2, _h2, zArc],\r\n        ),\r\n\r\n    ]\r\n\r\n\r\n\r\n    const v = [\r\n        ...columnF,\r\n        ...column,\r\n        ...columnB,\r\n        ...arc,\r\n        ...cap,\r\n    ]\r\n    const c = [\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...colorFill2,\r\n        ...cA,\r\n\r\n\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n        ...colorFill1,\r\n    ]\r\n    const u = [\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uvA,\r\n\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n        ...uv1,\r\n    ]\r\n\r\n    return { v, c, u }\r\n}","import * as THREE from 'three'\r\nimport {\r\n    translateArr,\r\n    rotateArr,\r\n} from './geometry/helpers'\r\nimport { createScheme } from './geometry/schemeGallery'\r\nimport { createSegmentGallery } from './geometry/segmentGallery'\r\n\r\n\r\n\r\nexport const createMeshGallery = (root) => {\r\n    const geometry = new THREE.BufferGeometry();\r\n\r\n\r\n    const arrV = []\r\n    const arrC = []\r\n    const arrUV = []\r\n\r\n    const scheme = createScheme()\r\n\r\n    for (let i = 0; i < scheme.length; ++i) {\r\n        const { id, x, z, angle, h0, h1, h2, arc, isTopElem, isColumn } = scheme[i]\r\n\r\n        let { v, c, u } = createSegmentGallery({ h0, h1, h2, arc, isTopElem, isColumn })\r\n\r\n        rotateArr(v, angle)\r\n        translateArr(v, x, 0, z, angle)\r\n\r\n\r\n        arrV.push(...v)\r\n        arrC.push(...c)\r\n        arrUV.push(...u)\r\n    }\r\n\r\n\r\n    const vertices = new Float32Array(arrV)\r\n    const colors =  new Float32Array(arrC)\r\n    const uv = new Float32Array(arrUV)\r\n\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( colors, 3 ))\r\n    uv && geometry.setAttribute('uv', new THREE.BufferAttribute( uv, 2 ))\r\n    geometry.computeVertexNormals()\r\n\r\n    const mat = root.materials.wallVirtualColor\r\n    const mesh = new THREE.Mesh(geometry, mat)\r\n    return mesh;\r\n}","export const createScheme = () => {\r\n    const arr = []\r\n\r\n    /** add gallery from center*/\r\n    const iterate = ({\r\n        angle,\r\n        offsetStart,\r\n        h0,\r\n        h1,\r\n        h2,\r\n        numFromCenter,\r\n    }) => {\r\n        const d = Math.random() * 120 + 30\r\n        const isAddNext = Math.random() > .5\r\n\r\n\r\n        arr.push({\r\n            id: Math.floor(Math.random() * 1000),\r\n            x: Math.sin(angle) * (offsetStart + d),\r\n            z: Math.cos(angle) * (offsetStart + d),\r\n            angle,\r\n            h0,\r\n            h1,\r\n            h2, \r\n            arc: { w: d },\r\n            isTopElem: !isAddNext,\r\n            numFromCenter,\r\n        })\r\n        if (isAddNext) {\r\n            iterate({\r\n                angle,\r\n                offsetStart: offsetStart + d,\r\n                h0,\r\n                h1,\r\n                h2,\r\n                numFromCenter: ++numFromCenter,\r\n            }) \r\n        }\r\n    }\r\n\r\n\r\n    const num = Math.floor(Math.random() * 20) + 3\r\n    const h0 = 0\r\n    const h2 = Math.random() * 150 + 30\r\n    const h1 = (Math.random() * .4 + .5)  * h2\r\n\r\n    /** center */\r\n    arr.push({\r\n        id: Math.floor(Math.random() * 1000),\r\n        x: 0,\r\n        z: 0,\r\n        angle: 0,\r\n        h0,\r\n        h1,\r\n        h2,\r\n        numFromCenter: 0,\r\n        isTopElem: false,\r\n        isColumn: true,\r\n    })\r\n\r\n\r\n\r\n    for (let i = 0; i < num; ++i) {\r\n        if (Math.random() > 0.3) {\r\n            iterate({\r\n                angle: (i / num) * (Math.PI * 2),\r\n                offsetStart: 0,\r\n                h0,\r\n                h1,\r\n                h2,\r\n                numFromCenter: 1,\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    let savedL = arr.length\r\n    for (let i = 0; i < 3; ++i) {\r\n        const _h0 = arr[arr.length - 1].h2\r\n        const _h2 = _h0 + Math.random() * 150 + 30\r\n        const _h1 = _h0 + (Math.random() * .4 + .5) * (_h2 - _h0)\r\n        for (let j = 0; j < savedL; ++j) {\r\n            if (!arr[j].isTopElem) {\r\n                arr.push({\r\n                    ...arr[j],\r\n                    h0: _h0,\r\n                    h1: _h1,\r\n                    h2: _h2,\r\n                    isTopElem: i === 2,\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return arr\r\n}","import {\r\n    createFace,\r\n    fillColorFace,\r\n} from './helpers'\r\n\r\n\r\nconst {\r\n    PI,\r\n    cos,\r\n} = Math\r\n\r\nconst hPI = PI / 2\r\nconst colorB = [0, 0, 0]\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createDataArcHalf = ({\r\n    hArc = 15,\r\n    arcL = 15,\r\n    color2,\r\n}) => {\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n\r\n    /** arc */\r\n    const arcC = 5\r\n    const arcStep = arcL / arcC\r\n\r\n    for (let i = 0; i < arcC; ++i) {\r\n        const phase0 = cos(i / arcC * (hPI))\r\n        const phase1 = cos((i + 1) / arcC * (hPI))\r\n        const hhArc = 0\r\n        v.push(\r\n            i * arcStep, hhArc + (phase0 * hArc), 0,\r\n            (i + 1) * arcStep, hhArc + (phase1 * hArc), 0,\r\n            arcL,  hArc, 0,\r\n        )\r\n\r\n        v.push(\r\n            i * arcStep, hhArc + (phase0 * hArc), -2,\r\n            arcL, hArc, -2,\r\n            (i + 1) * arcStep, hhArc + (phase1 * hArc), -2,\r\n        )\r\n\r\n        c.push(\r\n            ...color2, ...color2, ...color2,\r\n            ...color2, ...color2, ...color2,\r\n        )\r\n        u.push(\r\n            0, 0, .3, 0, .3, .3,\r\n            0, 0, .3, 0, .3, .3\r\n        )\r\n\r\n\r\n        v.push(...createFace(\r\n            [i * arcStep, hhArc + (phase0 * hArc), 0],\r\n            [i * arcStep, hhArc + (phase0 * hArc), -2],\r\n            [(i + 1) * arcStep, hhArc + (phase1 * hArc), -2],\r\n            [(i + 1) * arcStep, hhArc + (phase1 * hArc), 0],\r\n        ))\r\n\r\n        c.push(...fillColorFace(colorB))\r\n        u.push(\r\n            0, 0, 0, 0, 0, 0,\r\n            0, 0, 0, 0, 0, 0,\r\n        )\r\n    }\r\n\r\n    return { v, c, u }\r\n}","import {\r\n    translateArr,\r\n    rotateArr,\r\n} from './helpers'\r\n\r\n\r\nimport { createDataColumn } from './dataColumn'\r\nimport { createSimpleColumn } from './dataColumnSimple'\r\nimport { createDataArcHalf } from './dataArcHalf'\r\nimport { createTopElem } from './dataTopElem'\r\nimport { createDataStairSimple } from './dataStairSimple'\r\n\r\n\r\nconst colorB = [0, 0, 0]\r\n\r\n\r\n\r\nexport const createSegmentStair = (data, color1, color2,) => {\r\n    const { h, r, x, z, bridgeL, bridgeMinusH, hColumn, rColumn, i } = data\r\n\r\n    const hh = h - 5\r\n    const hCol = hColumn * (Math.random() * 0.35 + 0.1)\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n\r\n\r\n    /** stairs **/\r\n    const stair = createDataStairSimple({ h, hh, colorB, color2, bridgeL, bridgeMinusH, r })\r\n    v.push(...stair.v)\r\n    c.push(...stair.c)\r\n    u.push(...stair.u)\r\n    collision.push(...stair.collision)\r\n\r\n\r\n\r\n    /** bottom part column */\r\n    const column = createDataColumn({\r\n        h0: hh - hColumn - .1,\r\n        h1: hh - hCol,\r\n        capTop: true,\r\n        capBottom: true,\r\n    })\r\n    translateArr(column.v, r, 0, r)\r\n    v.push(...column.v)\r\n    c.push(...column.c)\r\n    u.push(...column.u)\r\n    translateArr(column.collision, r, 0, r)\r\n    collision.push(...column.collision)\r\n\r\n\r\n\r\n    /** top part column */\r\n    const simpleColumn = createSimpleColumn({ isColumn: true, h1: hh - hCol, h2: hh, color1:[0, 0, 0], color2})\r\n    translateArr(simpleColumn.vertColumn, r, 0, r)\r\n    v.push(...simpleColumn.vertColumn)\r\n    c.push(...simpleColumn.colorsColumn)\r\n    u.push(...simpleColumn.uvColumn)\r\n\r\n\r\n\r\n    /** arc */\r\n    const arcL = 40\r\n    const hArc = hCol\r\n    const halfArcData = createDataArcHalf({ hArc, arcL, color2 })\r\n    translateArr(halfArcData.v, r - rColumn - arcL, hh - hCol, r)\r\n    v.push(...halfArcData.v)\r\n    c.push(...halfArcData.c)\r\n    u.push(...halfArcData.u)\r\n\r\n\r\n\r\n    /** top elem **/\r\n    if (data.isTop) {\r\n        const topElemData = createTopElem({\r\n            isTopElem: true,\r\n            color1: [0, 0, 0],\r\n            color2,\r\n            h2: hh,\r\n        })\r\n        translateArr(topElemData.vertTopElem, r, 0, r)\r\n        v.push(...topElemData.vertTopElem)\r\n        c.push(...topElemData.colorsTopElem)\r\n        u.push(...topElemData.uvTopElem)\r\n    }\r\n\r\n\r\n\r\n    rotateArr(v, Math.PI - ((Math.PI / 2) * (i)))\r\n    translateArr(v, x, 0, z)\r\n    rotateArr(collision, Math.PI - ((Math.PI / 2) * (i)))\r\n    translateArr(collision, x, 0, z)\r\n\r\n\r\n\r\n    return { v, c, u, collision }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n} from \"./helpers\";\r\n\r\n\r\nexport const createDataStairSimple = ({\r\n    r,\r\n    h,\r\n    hh,\r\n    bridgeMinusH,\r\n    bridgeL,\r\n    color2,\r\n    colorB\r\n}) => {\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n\r\n    v.push(\r\n        /** place */\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, r],\r\n            [r, hh, r],\r\n            [r, h, r],\r\n            [-r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, -r],\r\n            [-r, hh, r],\r\n            [-r, h, r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, r],\r\n            [r, hh, -r],\r\n            [r, h, -r],\r\n            [r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [-r, hh, -r],\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n        ),\r\n\r\n        // bottom\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [r, hh, r],\r\n            [-r, hh, r],\r\n            [-r, hh, -r],\r\n        ),\r\n\r\n        /** connect */\r\n\r\n        ...createFace(\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh - bridgeMinusH, -r - bridgeL],\r\n            [-r, hh, -r],\r\n            [-r, h, -r],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n\r\n\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, hh - bridgeMinusH, -r - bridgeL],\r\n            [r, hh, -r],\r\n            [-r, hh, -r],\r\n        ),\r\n    )\r\n\r\n\r\n    c.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n    )\r\n\r\n    u.push(\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n    )\r\n\r\n    collision.push(\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n        ...createFace(\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n            [r, h - bridgeMinusH, -r - bridgeL],\r\n            [-r, h - bridgeMinusH, -r - bridgeL],\r\n        ),\r\n    )\r\n\r\n\r\n\r\n    return { v, c , u, collision }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n    translateArr,\r\n    rotateArr,\r\n} from \"./helpers\";\r\n\r\n\r\nexport const createDataZone = ({\r\n    xCenter,\r\n    zCenter,\r\n    r = 70,\r\n    h,\r\n    offset = 50,\r\n    color2 = [0, 1, 0],\r\n    colorB = [1, 0, 1],\r\n}) => {\r\n\r\n\r\n    const hh = h - 3\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n\r\n\r\n    v.push(\r\n        /** place */\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, r],\r\n            [r, hh, r],\r\n            [r, h, r],\r\n            [-r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, -r],\r\n            [-r, hh, r],\r\n            [-r, h, r],\r\n            [-r, h, -r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, r],\r\n            [r, hh, -r],\r\n            [r, h, -r],\r\n            [r, h, r],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [-r, hh, -r],\r\n            [-r, h, -r],\r\n            [r, h, -r],\r\n        ),\r\n\r\n        // bottom\r\n        ...createFace(\r\n            [r, hh, -r],\r\n            [r, hh, r],\r\n            [-r, hh, r],\r\n            [-r, hh, -r],\r\n        ),\r\n\r\n        /** connect */\r\n\r\n        // ...createFace(\r\n        //     [-r, h, -r],\r\n        //     [r, h, -r],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n\r\n        // ...createFace(\r\n        //     [-r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, hh, -r],\r\n        //     [-r, h, -r],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n\r\n\r\n        // ...createFace(\r\n        //     [r, hh, -r],\r\n        //     [r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [r, h, -r],\r\n        // ),\r\n\r\n        // ...createFace(\r\n        //     [-r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, hh, -r],\r\n        //     [-r, hh, -r],\r\n        // ),\r\n    )\r\n\r\n\r\n    c.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        // ...fillColorFace(color2),\r\n        // ...fillColorFace(colorB),\r\n        // ...fillColorFace(colorB),\r\n        // ...fillColorFace(color2),\r\n    )\r\n\r\n    u.push(\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n        // ...uvBr,\r\n        // ...uvCl,\r\n        // ...uvCl,\r\n        // ...uvBr,\r\n    )\r\n\r\n    collision.push(\r\n        ...createFace(\r\n            [-r, h, r],\r\n            [r, h, r],\r\n            [r, h, -r],\r\n            [-r, h, -r],\r\n        ),\r\n        // ...createFace(\r\n        //     [-r, h, -r],\r\n        //     [r, h, -r],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n    )\r\n\r\n\r\n    translateArr(v, xCenter, 0, zCenter)\r\n    translateArr(collision, xCenter, 0, zCenter)\r\n\r\n\r\n\r\n    return { v, c , u, collision }\r\n}","import {\r\n    createUv,\r\n    createFace,\r\n    fillColorFace,\r\n    translateArr,\r\n    rotateArr,\r\n} from \"./helpers\";\r\n\r\nconst color2 = [1, 1, 0]\r\nconst colorB = [1, 1, 1]\r\nconst R = {\r\n    'N': 0,\r\n    'E': -Math.PI * .5,\r\n    'S': Math.PI,\r\n    'W': Math.PI * .5\r\n}\r\n\r\n\r\nexport const createDataBridge = ({\r\n    centerBridgeX, \r\n    centerBridgeZ, \r\n    h, \r\n    dir, \r\n    lenBridge, \r\n    \r\n    \r\n    //xCenter,\r\n    //zCenter,\r\n    //r = 70,\r\n    //h,\r\n    //offset = 50,\r\n    //color2 = [0, 1, 0],\r\n    //colorB = [1, 0, 1],\r\n}) => {\r\n\r\n\r\n    const hh = h - 3\r\n\r\n    const v = []\r\n    const c = []\r\n    const u = []\r\n    const collision = []\r\n\r\n    const r2 = lenBridge / 2\r\n\r\n    const uvBr = createUv([0, .5], [.5, .5], [.5, 1], [0, 1],)\r\n    const uvCl = createUv([0, 0], [0, 0], [0, 0], [0, 0],)\r\n\r\n    const r = 20\r\n\r\n\r\n    v.push(\r\n        /** place */\r\n        ...createFace(\r\n            [-r, h, r2],\r\n            [r, h, r2],\r\n            [r, h, -r2],\r\n            [-r, h, -r2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, r2],\r\n            [r, hh, r2],\r\n            [r, h, r2],\r\n            [-r, h, r2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [-r, hh, -r2],\r\n            [-r, hh, r2],\r\n            [-r, h, r2],\r\n            [-r, h, -r2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, r2],\r\n            [r, hh, -r2],\r\n            [r, h, -r2],\r\n            [r, h, r2],\r\n        ),\r\n\r\n        ...createFace(\r\n            [r, hh, -r2],\r\n            [-r, hh, -r2],\r\n            [-r, h, -r2],\r\n            [r, h, -r2],\r\n        ),\r\n\r\n        // bottom\r\n        ...createFace(\r\n            [r, hh, -r2],\r\n            [r, hh, r2],\r\n            [-r, hh, r2],\r\n            [-r, hh, -r2],\r\n        ),\r\n\r\n        /** connect */\r\n\r\n        // ...createFace(\r\n        //     [-r, h, -r],\r\n        //     [r, h, -r],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n\r\n        // ...createFace(\r\n        //     [-r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, hh, -r],\r\n        //     [-r, h, -r],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n\r\n\r\n        // ...createFace(\r\n        //     [r, hh, -r],\r\n        //     [r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [r, h, -r],\r\n        // ),\r\n\r\n        // ...createFace(\r\n        //     [-r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, hh - bridgeMinusH, -r - bridgeL],\r\n        //     [r, hh, -r],\r\n        //     [-r, hh, -r],\r\n        // ),\r\n    )\r\n\r\n\r\n    c.push(\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(colorB),\r\n        ...fillColorFace(color2),\r\n        ...fillColorFace(color2),\r\n        // ...fillColorFace(color2),\r\n        // ...fillColorFace(colorB),\r\n        // ...fillColorFace(colorB),\r\n        // ...fillColorFace(color2),\r\n    )\r\n\r\n    u.push(\r\n        ...uvBr,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvCl,\r\n        ...uvBr,\r\n        // ...uvBr,\r\n        // ...uvCl,\r\n        // ...uvCl,\r\n        // ...uvBr,\r\n    )\r\n\r\n    collision.push(\r\n        ...createFace(\r\n            [-r, h, r2],\r\n            [r, h, r2],\r\n            [r, h, -r2],\r\n            [-r, h, -r2],\r\n        ),\r\n        // ...createFace(\r\n        //     [-r, h, -r],\r\n        //     [r, h, -r],\r\n        //     [r, h - bridgeMinusH, -r - bridgeL],\r\n        //     [-r, h - bridgeMinusH, -r - bridgeL],\r\n        // ),\r\n    )\r\n    \r\n    translateArr(v, -50, 0, 0)   \r\n    rotateArr(v, R[dir])\r\n    translateArr(v, centerBridgeX, 0, centerBridgeZ)\r\n    \r\n    translateArr(collision, -50, 0, 0)  \r\n    rotateArr(collision, R[dir])\r\n    translateArr(collision, centerBridgeX, 0, centerBridgeZ)\r\n\r\n\r\n\r\n    return { v, c , u, collision }\r\n}","const createSet = ({ xCenter, zCenter, hStart, hEnd, count }) => {\r\n    const r = 20\r\n    const hDiff = hEnd - hStart\r\n    //const count = Math.floor(hDiff / 30)  \r\n    const stepH = hDiff / count\r\n    //const count = 5\r\n\r\n    const tickness = 7\r\n    const hColumn = stepH * 4\r\n    const rColumn = 3\r\n    const offset = 50\r\n\r\n    const lBridge = offset + offset - r - r\r\n\r\n    const scheme = []\r\n    \r\n    /** first */\r\n    for (let i = 0; i < count; ++i) {\r\n        const h = stepH * i + hStart\r\n        const hh = h - tickness + hStart\r\n\r\n        let x = xCenter\r\n        let z = zCenter\r\n\r\n        const p = i % 4\r\n        if (p < 1) {\r\n            x = xCenter - offset\r\n            z = zCenter - offset\r\n        } else if (p < 2) {\r\n            x = xCenter + offset\r\n            z = zCenter - offset\r\n        } else if (p < 3) {\r\n            x = xCenter + offset\r\n            z = zCenter + offset\r\n        } else if (p < 4) {\r\n            x = xCenter - offset\r\n            z = zCenter + offset\r\n        }\r\n\r\n        scheme.push({\r\n            type: 'stairs',\r\n            offset,\r\n            h,\r\n            hh,\r\n            r,\r\n            x,\r\n            z,\r\n            bridgeMinusH: stepH,\r\n            bridgeL: lBridge,\r\n            hColumn,\r\n            rColumn,\r\n            i,\r\n            isTop: count - i < 5,\r\n        })\r\n    }\r\n\r\n    return scheme\r\n}\r\n\r\n\r\nconst D = ['N', 'E', 'S', 'W']\r\nconst C = { 'N': 1, 'E': 2, 'S': 3, 'W': 4}\r\nconst OFFSET = {\r\n    'N': [0, -1],\r\n    'E': [1, 0],\r\n    'S': [0, 1],\r\n    'W': [-1, 0],\r\n}\r\nconst STAIR_WIDTH = 140 \r\n\r\nexport const createSchemeSuper = () => {\r\n    const arr = []\r\n\r\n    let h = 0\r\n    let xCenter = 0\r\n    let zCenter = 0\r\n\r\n    for (let i = 0; i < 5; ++i) {\r\n        const nextDir = D[Math.floor(Math.random() * D.length)]\r\n        const lenBridge = Math.random() * 400 + 30\r\n        const nextXCenter = xCenter + (OFFSET[nextDir][0] * (STAIR_WIDTH + lenBridge))\r\n        const nextZCenter = zCenter + (OFFSET[nextDir][1] * (STAIR_WIDTH + lenBridge))\r\n\r\n        \r\n        /** stair set */\r\n        const count = C[nextDir] + 4 * Math.floor(Math.random() * 2)\r\n        const hEnd = h + count * 30 \r\n        const data = { xCenter, zCenter, hStart: h, hEnd, count }\r\n        arr.push(...createSet(data))\r\n\r\n\r\n        /** next platform */\r\n        if (i !== 0) {\r\n            arr.push({ xCenter, zCenter, h: h - 30, type: 'zone' })\r\n        }\r\n        \r\n\r\n        /** bridge */\r\n        if (i !== 5 - 1) {\r\n            const centerBridgeX = (nextXCenter - xCenter) / 2 + xCenter\r\n            const centerBridgeZ = (nextZCenter - zCenter) / 2 + zCenter\r\n            //const centerBridgeX = xCenter - nextXCenter\r\n            //const centerBridgeZ = zCenter - nextZCenter\r\n\r\n            arr.push({ centerBridgeX, centerBridgeZ, h: hEnd - 30, dir: nextDir, lenBridge, type: 'bridge' })\r\n        }\r\n\r\n        \r\n        /** move center */\r\n        xCenter = nextXCenter\r\n        zCenter = nextZCenter\r\n        h = hEnd\r\n    }\r\n\r\n    return arr\r\n}","import * as THREE from 'three'\r\n\r\nimport { createSegmentStair } from './geometry/segmentStair'\r\nimport { createDataZone } from './geometry/dataZone'\r\nimport { createDataBridge } from './geometry/dataBridge'\r\n//import { createSchemeStairs } from './geometry/schemeStairs'\r\nimport { createSchemeSuper } from './geometry/schemeSuper'\r\n\r\n\r\n\r\n\r\nexport const createMeshSuper = (root) => {\r\n    const scheme = createSchemeSuper()\r\n\r\n    console.log(scheme[scheme.length - 1])\r\n\r\n    const vertP = []\r\n    const colorsP = []\r\n    const uvTopP = []\r\n    const coll = []\r\n\r\n\r\n    for (let i = 0; i < scheme.length; ++i) {\r\n        if (scheme[i].type === 'stairs') {\r\n            const { v, c, u, collision } = createSegmentStair(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            vertP.push(...v)\r\n            colorsP.push(...c)\r\n            uvTopP.push(...u)\r\n            coll.push(...collision)\r\n        }\r\n        if (scheme[i].type === 'zone') {\r\n            const { v, c, u, collision } = createDataZone(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            vertP.push(...v)\r\n            colorsP.push(...c)\r\n            uvTopP.push(...u)\r\n            coll.push(...collision)\r\n        }\r\n        if (scheme[i].type === 'bridge') {\r\n            const { v, c, u, collision } = createDataBridge(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n            vertP.push(...v)\r\n            colorsP.push(...c)\r\n            uvTopP.push(...u)\r\n            coll.push(...collision) \r\n        }\r\n    }\r\n    /** triangle fix bug collision */\r\n    coll.push(-50, 1000, 0, 0, 1000, 0, 0, 1000, -50)\r\n\r\n\r\n\r\n    const vertices = new Float32Array(vertP)\r\n    const colors =  new Float32Array(colorsP)\r\n    const uv = new Float32Array(uvTopP)\r\n    const collision = new Float32Array(coll)\r\n\r\n\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( colors, 3 ))\r\n    uv && geometry.setAttribute('uv', new THREE.BufferAttribute( uv, 2 ))\r\n    geometry.computeVertexNormals()\r\n\r\n\r\n    const mat = root.materials.wallVirtualColor\r\n    const mesh = new THREE.Mesh(geometry, mat)\r\n\r\n\r\n    const collGeom = new THREE.BufferGeometry() \r\n    collGeom.setAttribute('position', new THREE.BufferAttribute(collision, 3))\r\n    const collMat = new THREE.MeshBasicMaterial({ color: 0xFF0000 })\r\n    const meshCollision = new THREE.Mesh(collGeom, collMat)\r\n\r\n\r\n    const meshFinish = new THREE.Mesh(\r\n        new THREE.BoxGeometry(30, 30, 30),\r\n        new THREE.MeshBasicMaterial({ color: 0xFF00FF })\r\n    )\r\n    meshFinish.position.set(\r\n        scheme[scheme.length - 1].x,\r\n        scheme[scheme.length - 1].h,\r\n        scheme[scheme.length - 1].z,  \r\n    )\r\n\r\n\r\n    return { mesh, meshCollision, meshFinish }\r\n}\r\n","import * as THREE from 'three'\r\nimport {\r\n    //START_ENV_CONFIG,\r\n    //START_ENV_CONFIG_2,\r\n    //START_ENV_CONFIG_3,\r\n    LOCATIONS_QUADRANTS,\r\n    SIZE_QUADRANT,\r\n} from '../constants/constants_elements';\r\nimport { createCheckerChangeLocationKey } from '../components/checkerChangeLocationKey'\r\n\r\nimport { createMeshGallery } from '../Entities/meshGallery'\r\nimport { createMeshStairs } from \"../Entities/meshStairs\"\r\nimport { createMeshSuper } from '../Entities/meshSuper'\r\n\r\n\r\nexport class actions {\r\n    constructor (root) {\r\n        this._root = root\r\n\r\n        const {\r\n            emitter,\r\n            car,\r\n            dispatcher,\r\n            frameUpdater,\r\n            studio,\r\n            player,\r\n            system_PlayerMoveOnLevel,\r\n        } = this._root\r\n\r\n        /** prepare ui ******/\r\n        dispatcher.dispatch({\r\n            type: 'CHANGE_INFO_CHAPTER',\r\n            currentChapterIndex: 4,\r\n        })\r\n        dispatcher.dispatch({\r\n            type: 'ENABLE_CONTROL_SOUND',\r\n        })\r\n\r\n\r\n\r\n        /** toggle button in sit car */\r\n        car.onChangeCarStateMove(e => {\r\n            if (e === 'carStart') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: false })\r\n            }\r\n            if (e === 'carStop') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: true })\r\n            }\r\n        })\r\n\r\n\r\n        emitter.subscribe('checkNear')(data => {\r\n            console.log('checkNear', data)\r\n            if (data.item === 'nearStarterDrawCar') {\r\n                root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON_DRAW_CAR', is: data.is })\r\n            }\r\n            if (data.item === 'nearPerson') {\r\n                console.log('checkNear nearPerson !!!!!!', data)\r\n            }\r\n        })\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        const checkerChangeLocation = createCheckerChangeLocationKey(SIZE_QUADRANT, car._model.position.x, car._model.position.z)\r\n        let currentQuadrantKey = checkerChangeLocation.getCurrent()\r\n        \r\n        this._changerLocations = createChangerLocations(this._root)\r\n        this._changerLevelTresh = createManagerLevelTrash(this._root)\r\n        this._changerLevelTresh.createTresh(currentQuadrantKey.currentEnv)\r\n\r\n\r\n\r\n\r\n        /** update every frame ***************/\r\n        frameUpdater.on(data => {\r\n            system_PlayerMoveOnLevel.update(data)\r\n            if (!car.isFreeze) {\r\n                car.update(data)\r\n                const l = checkerChangeLocation.checkChanged(car._model.position.x, car._model.position.z)\r\n                if (l) {\r\n                    console.log('quadrants data', l)\r\n                    /** arr/remove level tresh **********************/\r\n                    this._changerLevelTresh.updateTrash(l.removedQs, l.addedQs)\r\n\r\n                    /** add/remove  locations ************************/\r\n                    if (LOCATIONS_QUADRANTS[l.oldKey]) {\r\n                        //console.log('remove', l.oldKey)\r\n                        this._changerLocations.removeLocationFromScene(LOCATIONS_QUADRANTS[l.oldKey])\r\n                    }\r\n                    if (LOCATIONS_QUADRANTS[l.newKey]) {\r\n                        //console.log('add', l.newKey)\r\n                        const strArr = l.newKey.split('_')\r\n                        const locationX = +strArr[0] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n                        const locationZ = +strArr[1] * SIZE_QUADRANT + SIZE_QUADRANT / 2\r\n                        this._changerLocations.addLocationToScene(LOCATIONS_QUADRANTS[l.newKey], locationX, locationZ)\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n            studio.drawFrame()\r\n        })\r\n\r\n        this._startPlay()\r\n    }\r\n\r\n\r\n    clickMachineDraw () {\r\n        const { studio, system_PlayerMoveOnLevel, car } = this._root\r\n\r\n        system_PlayerMoveOnLevel.toggleFreeze(true)\r\n        car.toggleFreeze(false)\r\n        studio.setCamera(car.getCamera())\r\n    }\r\n\r\n\r\n    clickMachineExit () {\r\n        const { system_PlayerMoveOnLevel, player, studio, car  } = this._root\r\n\r\n        const pos = car.getPosition()\r\n        const q = car.getQuaternion()\r\n\r\n        studio.setCamera(player.getCamera())\r\n        car.toggleFreeze(true)\r\n\r\n        system_PlayerMoveOnLevel.toggleFreeze(false)\r\n\r\n        player.setToPos(pos.x, player.mesh.position.y, pos.z)\r\n        player.mesh.setRotationFromQuaternion(q)\r\n    }\r\n\r\n\r\n    changeTargetLocation ({ key }) {\r\n        let keyXZ = null\r\n        for (let k in LOCATIONS_QUADRANTS) {\r\n            if (LOCATIONS_QUADRANTS[k] === key) {\r\n                keyXZ = k\r\n            }\r\n        }\r\n        if (keyXZ) {\r\n            const p = keyXZ.split('_')\r\n            const x = +p[0] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const z =  +p[1] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const y =  0\r\n            const { car } = this._root\r\n            car.setTargetPosition(new THREE.Vector3(x, y, z))\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _startPlay () {\r\n        const {\r\n            player,\r\n            ui,\r\n            studio,\r\n            car,\r\n            system_Level,\r\n            system_PlayerMoveOnLevel,\r\n            system_PlayerNearLevelItems,\r\n        } = this._root\r\n\r\n\r\n\r\n\r\n\r\n\r\n        /** car ****************************/\r\n        system_PlayerNearLevelItems.setItemToCheck(car.getModel(), 'nearStarterDrawCar', 28)\r\n        studio.addToScene(car.getModel())\r\n        system_PlayerMoveOnLevel.addItemToPlayerCollision(car.getCollision())\r\n\r\n\r\n        setTimeout(() => {\r\n            let i = 0\r\n            let key = null\r\n            for (let k in LOCATIONS_QUADRANTS) {\r\n                if (i === 0) {\r\n                    key = k\r\n                }\r\n                ++i\r\n            }\r\n            const p = key.split('_')\r\n            const x = +p[0] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const z = +p[1] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const y = 0\r\n\r\n            car.setTargetPosition(new THREE.Vector3(x, y, z))\r\n        }, 500)\r\n\r\n\r\n        /** body **************************/\r\n        system_Level._items['body'].position.fromArray([-20, -60, -50])\r\n        system_Level._items['body'].rotation.fromArray([0, 2, 0])\r\n        studio.addToScene(system_Level._items['body'])\r\n\r\n\r\n        ui.showStartButton(() => {\r\n            //studio.changeEnvironment(START_ENV_CONFIG_3, { updateAmb: false, time: 1500 })\r\n            player.toggleBlocked(false)\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\nconst createChangerLocations = root => {\r\n    const {\r\n        studio,\r\n        car,\r\n        system_Level,\r\n        system_PlayerMoveOnLevel,\r\n        system_PlayerNearLevelItems,\r\n    } = root\r\n\r\n    /** TEST *************************/\r\n    // for (let key in LOCATIONS_QUADRANTS) {\r\n    //     const b = new THREE.Mesh(\r\n    //         new THREE.BoxGeometry(55, 1000, 55),\r\n    //         new THREE.MeshBasicMaterial({ color: 0xff0000 })\r\n    //     )\r\n\r\n    //     const p = key.split('_')\r\n    //     b.position.set(\r\n    //         +p[0] * SIZE_QUADRANT + SIZE_QUADRANT / 2,\r\n    //         4100,\r\n    //         +p[1] * SIZE_QUADRANT + SIZE_QUADRANT / 2,\r\n    //     )\r\n    //     studio.addToScene(b)\r\n    // }\r\n\r\n    setTimeout(() => {\r\n        for (let key in LOCATIONS_QUADRANTS) {\r\n            const p = key.split('_')\r\n            const x = +p[0] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const z = +p[1] * SIZE_QUADRANT  + SIZE_QUADRANT / 2\r\n            const y = 0\r\n            system_Level.locations[LOCATIONS_QUADRANTS[key]].mesh.position.set(x, y, z)\r\n            studio.addToScene(system_Level.locations[LOCATIONS_QUADRANTS[key]].mesh)\r\n        }\r\n    }, 500)\r\n\r\n\r\n\r\n    /** add/remove locations by key */\r\n    const addLocationToScene = (keyLocation, x, z) => {\r\n        const { mesh, carCollision, personOffset, personCollision } = system_Level.locations[keyLocation]\r\n\r\n        mesh.position.set(x, 0, z)\r\n        /**\r\n        *studio.addToScene(mesh)\r\n        */\r\n\r\n        system_PlayerMoveOnLevel.addItemToPlayerCollision(mesh)\r\n        carCollision.position.set(x, 0, z)\r\n        studio.addToScene(carCollision)\r\n        car.setCollisionForDraw(carCollision)\r\n\r\n        personCollision.position.set(personOffset[0] + x, personOffset[1], personOffset[2] + z)\r\n        studio.addToScene(personCollision)\r\n        system_PlayerNearLevelItems.setItemToCheck(personCollision, 'nearPerson_' + keyLocation, 28)\r\n    }\r\n\r\n    const removeLocationFromScene = keyLocation => {\r\n        const { mesh, carCollision, personCollision} = system_Level.locations[keyLocation]\r\n\r\n        /**\r\n        * studio.removeFromScene(mesh)\r\n        */\r\n        system_PlayerMoveOnLevel.removeItemFromPlayerCollision(mesh)\r\n\r\n        studio.removeFromScene(carCollision)\r\n        car.removeCollisionForDraw(carCollision)\r\n\r\n        studio.removeFromScene(personCollision)\r\n        system_PlayerNearLevelItems.removeItemFromCheck(personCollision)\r\n    }\r\n\r\n\r\n    return {\r\n        removeLocationFromScene,\r\n        addLocationToScene,\r\n    }\r\n}\r\n\r\n\r\n\r\nconst createManagerLevelTrash = root => {\r\n    const {\r\n        studio,\r\n        car,\r\n        system_PlayerMoveOnLevel,\r\n        materials,\r\n    } = root\r\n\r\n    let arrTrash = []\r\n\r\n    /** test stairs */\r\n    const stairs = createMeshStairs(root)\r\n    stairs.mesh.position.set(400, -42, -1000)\r\n    studio.addToScene(stairs.mesh)\r\n    stairs.meshCollision.visible = false\r\n    stairs.meshCollision.position.copy(stairs.mesh.position)\r\n    studio.addToScene(stairs.meshCollision)\r\n    system_PlayerMoveOnLevel.addItemToPlayerCollision(stairs.meshCollision)\r\n\r\n\r\n    /** super */\r\n    const superP = createMeshSuper(root)\r\n    superP.mesh.position.set(0, -42, 0)\r\n    studio.addToScene(superP.mesh)\r\n    superP.meshCollision.visible = false\r\n    superP.meshCollision.position.copy(superP.mesh.position)\r\n    studio.addToScene(superP.meshCollision)\r\n    system_PlayerMoveOnLevel.addItemToPlayerCollision(superP.meshCollision)\r\n    studio.addToScene(superP.meshFinish)\r\n\r\n\r\n\r\n\r\n    //const trashGeom = new THREE.BoxGeometry(30, 50, 30)\r\n    const trashCollisionGeom = new THREE.BoxGeometry(45, 50, 45)  \r\n    const trashMat = materials.testRed\r\n    const floorGeom = new THREE.PlaneGeometry(SIZE_QUADRANT, SIZE_QUADRANT)\r\n\r\n\r\n    const addItems = arr => {\r\n        for (let i = 0; i < arr.length; ++i) {\r\n            /** add floor */\r\n            const p = arr[i].split('_')\r\n            const x = +p[0] * SIZE_QUADRANT\r\n            const z = +p[1] * SIZE_QUADRANT\r\n            const y = -50\r\n            const floor = new THREE.Mesh(floorGeom, materials.floorMat)\r\n            floor.rotation.x = -Math.PI / 2\r\n            floor.position.set(x, y - 12, z)\r\n            studio.addToScene(floor)\r\n            arrTrash.push({\r\n                mesh: floor,\r\n                keyLocation: arr[i],\r\n                type: 'floor',\r\n            })\r\n            system_PlayerMoveOnLevel.addItemToPlayerCollision(floor)\r\n\r\n\r\n\r\n            /** add trash ******************/\r\n            //const rCount = Math.floor(Math.random() * 10)\r\n            const rCount = Math.floor(Math.random() * 3)\r\n            for (let j = 0; j < rCount; ++j) {\r\n                console.log('!!!!!!!!!!!!!!!!! new tresh')\r\n\r\n                //const mesh = new THREE.Mesh(trashGeom, trashMat,)\r\n                const mesh = createMeshGallery(root)\r\n                mesh.position.set(\r\n                    x + Math.random() * SIZE_QUADRANT,\r\n                    -60,\r\n                    z + Math.random() * SIZE_QUADRANT,\r\n                )\r\n                studio.addToScene(mesh)\r\n                //system_PlayerMoveOnLevel.addItemToPlayerCollision(mesh)\r\n                \r\n                const meshCollision = new THREE.Mesh(trashCollisionGeom, trashMat)\r\n                //meshCollision.visible = false\r\n                meshCollision.position.copy(mesh.position)\r\n                studio.addToScene(meshCollision)\r\n                car.setCollisionForDraw(meshCollision)\r\n                arrTrash.push({ mesh, meshCollision, keyLocation: arr[i], type: 'trash' })\r\n            }\r\n        }\r\n    } \r\n\r\n\r\n    const removeItems = arr => {\r\n        const arrToRemove = []\r\n        for (let i = 0; i < arr.length; ++i) {\r\n            for (let j = 0; j < arrTrash.length; ++j) {\r\n                if (arr[i] === arrTrash[j].keyLocation) {\r\n                    arrToRemove.push(arrTrash[j])\r\n                }\r\n            }\r\n        }\r\n\r\n        arrTrash = arrTrash.filter(item => {\r\n            for (let i = 0; i < arr.length; ++i) {\r\n                if (item.keyLocation === arr[i]) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        })\r\n\r\n        for (let i = 0; i < arrToRemove.length; ++i) {\r\n            const { mesh, meshCollision } = arrToRemove[i]\r\n            studio.removeFromScene(mesh)\r\n            system_PlayerMoveOnLevel.removeItemFromPlayerCollision(mesh)\r\n            if (meshCollision) {\r\n                studio.removeFromScene(meshCollision)\r\n                car.removeCollisionForDraw(meshCollision)\r\n            }\r\n            arrToRemove[i].mesh.geometry.dispose()\r\n            delete arrToRemove[i].mesh\r\n            delete arrToRemove[i].meshCollision\r\n        }\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        updateTrash: (removeArr, addArr) => {\r\n            removeItems(removeArr)\r\n            addItems(addArr)\r\n        },\r\n        createTresh: (arr) => {\r\n            addItems(arr)                \r\n        },\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\nimport { createSegmentStair } from './geometry/segmentStair'\r\nimport { createSchemeStairs } from './geometry/schemeStairs'\r\n\r\n\r\n\r\n\r\nexport const createMeshStairs = (root) => {\r\n    const scheme = createSchemeStairs()\r\n    const vertP = []\r\n    const colorsP = []\r\n    const uvTopP = []\r\n    const coll = []\r\n\r\n\r\n    for (let i = 0; i < scheme.length; ++i) {\r\n        const { v, c, u, collision } = createSegmentStair(scheme[i], [1, 1, 1], [0, .7, 0],)\r\n        vertP.push(...v)\r\n        colorsP.push(...c)\r\n        uvTopP.push(...u)\r\n        coll.push(...collision)\r\n    }\r\n    coll.push(-50, 1000, 0, 0, 1000, 0, 0, 1000, -50)\r\n\r\n\r\n\r\n    const vertices = new Float32Array(vertP)\r\n    const colors =  new Float32Array(colorsP)\r\n    const uv = new Float32Array(uvTopP)\r\n    const collision = new Float32Array(coll)\r\n\r\n\r\n    const geometry = new THREE.BufferGeometry();\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3))\r\n    geometry.setAttribute('color', new THREE.BufferAttribute( colors, 3 ))\r\n    uv && geometry.setAttribute('uv', new THREE.BufferAttribute( uv, 2 ))\r\n    geometry.computeVertexNormals()\r\n\r\n\r\n    const mat = root.materials.wallVirtualColor\r\n    const mesh = new THREE.Mesh(geometry, mat)\r\n\r\n\r\n    const collGeom = new THREE.BufferGeometry() \r\n    collGeom.setAttribute('position', new THREE.BufferAttribute(collision, 3))\r\n    const collMat = new THREE.MeshBasicMaterial({ color: 0xFF0000 })\r\n    const meshCollision = new THREE.Mesh(collGeom, collMat)\r\n\r\n\r\n    return { mesh, meshCollision }\r\n}\r\n","export const createSchemeStairs = () => {\r\n    const r = 20\r\n    const stepH = 30\r\n    const count = 25\r\n    const tickness = 7\r\n    const hColumn = stepH * 4\r\n    const rColumn = 3\r\n    const offset = 50\r\n\r\n    const lBridge = offset + offset - r - r\r\n\r\n\r\n\r\n    const scheme = []\r\n    for (let i = 0; i < count; ++i) {\r\n        const h = stepH * i\r\n        const hh = h - tickness\r\n\r\n        let x = 0\r\n        let z = 0\r\n\r\n        const p = i % 4\r\n        if (p < 1) {\r\n            x = -offset\r\n            z = -offset\r\n        } else if (p < 2) {\r\n            x = offset\r\n            z = -offset\r\n        } else if (p < 3) {\r\n            x = offset\r\n            z = offset\r\n        } else if (p < 4) {\r\n            x = -offset\r\n            z = offset\r\n        }\r\n\r\n        scheme.push({\r\n            offset,\r\n            h,\r\n            hh,\r\n            r,\r\n            x,\r\n            z,\r\n            bridgeMinusH: stepH,\r\n            bridgeL: lBridge,\r\n            hColumn,\r\n            rColumn,\r\n            i,\r\n            isTop: count - i < 5,\r\n        })\r\n    }\r\n\r\n    return scheme\r\n}","export const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'What is this place?': \"Что это за место?\",\r\n        \"It's The Great Way to the surface.\": \"Это великий путь наверх.\",\r\n        'Who are you?': \"Кто ты?\",\r\n        'I help The Creator.': \"Я помогаю создателю.\",\r\n        'What are you doing?': \"Что ты делаешь?\",\r\n        \"Don't distract me, I have to dig the tunnel.\": \"Не отвлекай, мне надо копать туннель.\",\r\n        \"Such enormous dungeons...\": \"Такие большие подземелья...\",\r\n        \"The Creator gave the order to dig.\": \"Создатель приказал копать. \",\r\n        \"How long have you been digging?\": \"Как долго вы копали? \",\r\n        \"Time does not matter, the goal is what's important.\": \"Время не имеет значения, важна цель. \",\r\n        \"What do you do here?\": \"Что ты делаешь?\",\r\n        \"Long ago, the Creator fell under the ground. He created us and gave us an assignment to dig.\":\"Давным-давно Творец провалился под землю. Он создал нас и дал задание копать. \",\r\n        \"But you already dug the way out...\": \"Но вы уже прорыли выход ...\",\r\n        \"When we dug a tunnel, The Creator went through it.\": \"Когда мы прорыли путь, творец прошел по нему.\",\r\n        \"And...\": \"И...\",\r\n        'We are made to dig. And we keep on doing it. We believe that he will return to us.': \"Мы созданы для того, чтобы копать. И мы продолжаем это делать. Мы верим, что он вернется к нам. \",\r\n\r\n\r\n        'open dialog': 'начать диалог',\r\n        'close dialog': 'закончить диалог',\r\n        'To be continued': 'Продолжение следует',\r\n        'chapter': 'глава',\r\n        'open': 'пуск',\r\n        'Author: ': 'Автор: ',\r\n        'link': 'ссылка',\r\n    }\r\n}\r\n\r\n","import { connect } from 'react-redux'\r\n//import { toggleDialog } from '../store/actions'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\nimport * as CORE from \"../../../_CORE\";\r\n\r\nconst t = CORE.createTranslater(TRANSLATE_WORLDS)\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    userReplicies: state.ui.userReplicies,\r\n})\r\n\r\n\r\n\r\n\r\nexport const UserReplicies = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"replicies\">\r\n            {props.userReplicies.map(item => (<button\r\n                    key={Math.floor(Math.random()* 100000)}\r\n                    onClick={() => {\r\n                        props.dispatch({\r\n                            type: 'CLICK_PHRASE',\r\n                            phrase: item,\r\n                        })\r\n                        setTimeout(() => {\r\n                            props.dispatch({\r\n                                type: 'PHRASE_EVENT',\r\n                                phrase: item,\r\n                            })\r\n                \r\n                            //r.levelEvent && emitter && emitter.emit('changeLevelMode')(r.levelEvent)\r\n                        }, 1000)\r\n                        //toggleDialog(props.dispatch).clickPhrase(item)\r\n                    }}>\r\n                    {t(item.q)}\r\n                </button>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { connect } from 'react-redux'\r\nimport { TRANSLATE_WORLDS} from \"../constants/constants_replicies\";\r\nimport { createTranslater } from \"../../../_CORE\";\r\n\r\n\r\n\r\nconst t = createTranslater(TRANSLATE_WORLDS)\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    botAnswers: state.ui.botAnswers,\r\n})\r\n\r\n\r\n\r\n\r\nexport const BotAnswers = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"messages\">\r\n            {props.botAnswers.map(item => (<div key={Math.floor(Math.random() * 100000)}>\r\n                    <div className=\"q\">{t(item.q)}</div>\r\n                    <div className=\"a\">{t(item.a)}</div>\r\n                </div>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import './CustomReactComponent.css'\r\nimport { createTranslater } from '../../../_CORE/helpers/helper_translate'\r\nimport { UserReplicies } from './UserReplicies'\r\nimport { BotAnswers } from './BotAnswers'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\n\r\n\r\nimport { connect } from 'react-redux'\r\n\r\n\r\nconst t = createTranslater(TRANSLATE_WORLDS)\r\n\r\nconst mapStateToProps = state => {\r\n    return ({\r\n        isButtonDialog: state.ui.isButtonDialog,\r\n        isShowFinalMessage: state.ui.isShowFinalMessage,\r\n        isShowPalleteDialog: state.ui.isShowPalleteDialog,\r\n        isShowButtonDrawCar: state.ui.isShowButtonDrawCar,\r\n        valButtonDrawCar: state.ui.valButtonDrawCar,\r\n        //isShowButtonToggleOpenLocationsList: state.ui.isShowButtonToggleOpenLocationsList,\r\n        isShowButtonToggleOpenLocationsList: true,//state.ui.isShowButtonToggleOpenLocationsList,\r\n        isLocationListOpened: state.ui.isLocationListOpened,\r\n        currentLocation: state.ui.currentLocation,\r\n        locationsList: state.ui.locationsList,\r\n    })\r\n}\r\n\r\n\r\n\r\nfunction CustomReactComponent(props) {\r\n\r\n    return (\r\n        <>\r\n            {(!props.isShowFinalMessage && props.isButtonDialog || props.isShowPalleteDialog) && (\r\n                <div className=\"dialog-wrapper\">\r\n                    <div className=\"dialog-content\">\r\n\r\n                        {props.isShowPalleteDialog && <div className='messages-wrapper'>\r\n                            <BotAnswers />\r\n                            <UserReplicies />\r\n                        </div>}\r\n\r\n                        {props.isButtonDialog && <button\r\n                            className=\"dialog-button-toggle\"\r\n                            onClick={() => props.dispatch({ type: 'TOGGLE_DIALOG', isShowPalleteDialog: !props.isShowPalleteDialog })}>\r\n                            {props.isShowPalleteDialog ? t('close dialog') : t('open dialog') }\r\n                        </button>}\r\n                    </div>\r\n                </div>)}\r\n\r\n            {props.isShowButtonDrawCar && (\r\n                <div className=\"dialog-wrapper\">\r\n                    <div className=\"dialog-content\">\r\n                        <button\r\n                            className=\"draw-car-button\"\r\n                            onClick={() => props.dispatch({ type: 'CLICK_DRAW' })}>\r\n                            {t(props.valButtonDrawCar)}\r\n                        </button>\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n            {props.isShowButtonToggleOpenLocationsList && !props.isLocationListOpened && <button\r\n                className=\"open-locations-car-button\"\r\n                onClick={() => props.dispatch({ type: 'OPEN_LOCATIONS_LIST' })}>\r\n                {props.currentLocation}\r\n            </button>}\r\n\r\n\r\n            {props.isLocationListOpened && (\r\n                <div className='list-locations'>\r\n                    {/*<button*/}\r\n                    {/*    onClick={() => props.dispatch({ type: 'CLOSE_LOCATIONS_LIST' })}>*/}\r\n                    {/*    _x_*/}\r\n                    {/*</button>*/}\r\n                    <div>\r\n                        {props.locationsList.map(item =>\r\n                            (<button\r\n                                key={Math.floor(Math.random() * 1000000)}\r\n                                onClick={() => props.dispatch({\r\n                                    type: 'SELECT_LOCATION',\r\n                                    location: item,\r\n                                })}>\r\n                                {item}\r\n                                {props.currentLocation === item && '___v'}\r\n                            </button>))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {props.isShowFinalMessage && (\r\n                    <div className='final-mess'>{t('To be continued')}</div>\r\n                )}\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps)(CustomReactComponent);\r\n\r\n\r\n","//import { START_ENV_CONFIG_4 } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\nexport const uiState = {\r\n    botAnswers: [],\r\n    userReplicies: [],\r\n    isShowControls: true,\r\n    isButtonDialog: false,\r\n    isShowPalleteDialog: false,\r\n    isShowFinalMessage: false,\r\n    isShowButtonDrawCar: false,\r\n    valButtonDrawCar: 'draw car',\r\n\r\n    currentBot: null,\r\n    phraseIndex: 0,\r\n    isDialogComplete: false,\r\n    //phrasesData: DIALOGS_DATA,\r\n    isShowButtonToggleOpenLocationsList: false,\r\n    isLocationListOpened: false,\r\n    currentLocation: 'location01',\r\n    locationsList: [\r\n        'location01',\r\n        'location02',\r\n        'location03',\r\n    ],\r\n}\r\n\r\n\r\nexport const createCustomStore = root => {\r\n    const ui = (state = uiState, action) => {\r\n        if (action.type === 'OPEN_LOCATIONS_LIST') {\r\n            return ({\r\n                ...state,\r\n                isLocationListOpened: true,\r\n            })\r\n        }\r\n\r\n        // if (action.type === 'CLOSE_LOCATIONS_LIST') {\r\n        //     return ({\r\n        //         ...state,\r\n        //         isLocationListOpened: false,\r\n        //     })\r\n        // }\r\n\r\n        if (action.type === 'SELECT_LOCATION') {\r\n            root.actions.changeTargetLocation({ key: action.location })\r\n            return ({\r\n                ...state,\r\n                isLocationListOpened: false,\r\n                currentLocation: action.location,\r\n            })\r\n        }\r\n\r\n\r\n\r\n        if (action.type === 'CLICK_PHRASE') {\r\n            return ({\r\n                ...state,\r\n                botAnswers: [\r\n                    ...state.botAnswers,\r\n                    action.phrase,\r\n                ],\r\n                userReplicies: [],\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'PHRASE_EVENT') {\r\n            const { event, levelEvent } = action.phrase\r\n\r\n            if (event === 'nextReply') {\r\n                const userReplicies = [state.phrasesData[state.currentBot][state.phraseIndex + 1]]\r\n\r\n                return ({\r\n                    ...state,\r\n                    phraseIndex: state.phraseIndex + 1,\r\n                    userReplicies,\r\n                })\r\n\r\n            }\r\n\r\n            if (event === 'close') {\r\n\r\n                if (state.currentBot === 20) {\r\n                    setTimeout(() => {\r\n                        root.dispatcher.dispatch({ type: 'TOGGLE_BUTTON', isButtonDialog: false })\r\n                        root.dispatcher.dispatch({ type: 'TOGGLE_DIALOG', isShowPalleteDialog: false })\r\n                        //root.studio.changeEnvironment(START_ENV_CONFIG_4, { updateAmb: false, time: 1500 }) \r\n                        root.player.toggleBlocked(true)\r\n                        setTimeout(() => {\r\n                            root.dispatcher.dispatch({ type: 'SHOW_FINAL_MESSAGE' })\r\n                        }, 3000)\r\n                    }, 20000)\r\n                    \r\n                }\r\n\r\n                return ({\r\n                    ...state,\r\n                    userReplicies: [],\r\n                    isDialogComplete: true,\r\n                    isButtonDialog: true,\r\n                })\r\n            }\r\n        }\r\n\r\n\r\n\r\n        if (action.type === 'TOGGLE_DIALOG') {\r\n            let userReplicies = []\r\n\r\n            root.player.toggleBlocked(action.isShowPalleteDialog)\r\n\r\n            if (action.isShowPalleteDialog) {\r\n                userReplicies = state.isDialogComplete ? [] : [state.phrasesData[state.currentBot][state.phraseIndex]]\r\n            }\r\n\r\n            return ({\r\n                ...state,\r\n                isShowPalleteDialog: action.isShowPalleteDialog,\r\n                userReplicies,\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'TOGGLE_BUTTON') {\r\n\r\n            let botAnswers = state.botAnswers\r\n            let phraseIndex = state.phraseIndex\r\n            let isDialogComplete = state.isDialogComplete\r\n            if (action.currentBot && action.currentBot !== state.currentBot) {\r\n                botAnswers = []\r\n                phraseIndex = 0\r\n                isDialogComplete = false\r\n            }\r\n\r\n            return ({\r\n                ...state,\r\n                phraseIndex,\r\n                currentBot: action.currentBot || state.currentBot,\r\n                isButtonDialog: action.isButtonDialog,\r\n                isDialogComplete,\r\n                botAnswers,\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'SHOW_FINAL_MESSAGE') {\r\n            return ({\r\n                ...state,\r\n                isShowFinalMessage: true,\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'TOGGLE_BUTTON_DRAW_CAR') {\r\n            return  ({\r\n                ...state,\r\n                isShowButtonDrawCar: action.is\r\n            })\r\n        }\r\n\r\n\r\n        if (action.type === 'CLICK_DRAW') {\r\n            const { valButtonDrawCar } = state\r\n            if (valButtonDrawCar === 'draw car') {\r\n                root.actions.clickMachineDraw()\r\n                return ({\r\n                    ...state,\r\n                    valButtonDrawCar: 'exit car',\r\n                })\r\n            } else {\r\n                root.actions.clickMachineExit()\r\n                return ({\r\n                    ...state,\r\n                    valButtonDrawCar: 'draw car',\r\n                })\r\n            }\r\n        }\r\n\r\n\r\n        return state\r\n    }\r\n\r\n    return { ui }\r\n}\r\n\r\n\r\n\r\n//const DIALOGS_DATA = {\r\n//     '4': [\r\n//         {\r\n//             q: 'What is this place?',\r\n//             a: \"It's The Great Way to the surface.\",\r\n//             event: 'nextReply',\r\n//         }, {\r\n//             q: 'Who are you?',\r\n//             a: 'I help The Creator.',\r\n//             event: 'nextReply',\r\n//         }, {\r\n//             q: 'What are you doing?',\r\n//             a: \"Don't distract me, I have to dig the tunnel.\",\r\n//             event: 'close',\r\n//         },\r\n//     ],\r\n//     '13': [\r\n//         {\r\n//             q: 'Such enormous dungeons...',\r\n//             a: 'The Creator gave the order to dig.',\r\n//             event: 'nextReply',\r\n//         }, {\r\n//             q: 'How long have you been digging?',\r\n//             a: 'Time does not matter, the goal is what\\'s important.',\r\n//             event: 'close',\r\n//         },\r\n//     ],\r\n//     '20': [\r\n//         {\r\n//             q: 'What do you do here?',\r\n//             a: 'Long ago, the Creator fell under the ground. He created us and gave us an assignment to dig.',\r\n//             event: 'nextReply',\r\n//         },\r\n//         {\r\n//             q: \"But you already dug the way out...\",\r\n//             a: 'When we dug a tunnel, The Creator went through it.',\r\n//             event: 'nextReply',\r\n//         },\r\n//         {\r\n//             q: \"And...\",\r\n//             a: 'We are made to dig. And we keep on doing it. We believe that he will return to us.',\r\n//             event: 'close',\r\n//         },\r\n//     ],\r\n// }\r\n\r\n\r\n","import { LoaderAssets } from '../../../_CORE/helpers/helper_LoadAssets'\r\nimport { EventEmitter } from \"../../../_CORE/helpers/helper_Emitter\"\r\nimport { UI } from '../../../_CORE/ui/UI'\r\nimport { DeviceResizer } from \"../../../_CORE/helpers/helper_DeviceResizer\"\r\n//import { FrameUpdater } from \"../../../_CORE/helpers/helper_FrameUpater\"\r\nimport { FrameUpdater } from \"../../../_CORE/helpers/helper_FrameUpdater_02\"\r\nimport { Helper_TweenUpdater } from \"../../../_CORE/helpers/helper_TweenUpdater\"\r\nimport { Studio } from '../../../_CORE/entities/createStudio_02'\r\nimport { KeyBoard } from \"../../../_CORE/helpers/helper_KeyBoard\"\r\nimport { Player } from '../../../_CORE/entities/createPlayer_v02'\r\n\r\n\r\nimport { Helper_MaterialsLib } from '../../../_CORE/helpers/helper_MaterialsLib'\r\n\r\n\r\nimport { Level } from '../systems/system_level'\r\nimport levelRoomsSrc from '../../../assets/chapter05/level.obj'\r\nimport mapFloorOuter from '../../../assets/chapter04/floor_outer_map3.jpg'\r\nimport mapFloorOuter2 from '../../../assets/chapter04/floor_outer_map2.jpg'\r\nimport mapVirt from '../../../assets/chapter05/map01.jpg'\r\nimport mapTop from '../../../assets/floor_outer_map.jpg'\r\nimport mapTxt from '../../../assets/chapter05/txt1.jpg'\r\n\r\nimport pxjpg from '../../../assets/sky4/px.jpg'\r\nimport nxjpg from '../../../assets/sky4/nx.jpg'\r\nimport pyjpg from '../../../assets/sky4/py.jpg'\r\nimport nyjpg from '../../../assets/sky4/ny.jpg'\r\nimport pzjpg from '../../../assets/sky4/pz.jpg'\r\nimport nzjpg from '../../../assets/sky4/nz.jpg'\r\n\r\nimport px2jpg from '../../../assets/sky2/px.jpg'\r\nimport nx2jpg from '../../../assets/sky2/nx.jpg'\r\nimport py2jpg from '../../../assets/sky2/py.jpg'\r\nimport ny2jpg from '../../../assets/sky2/ny.jpg'\r\nimport pz2jpg from '../../../assets/sky2/pz.jpg'\r\nimport nz2jpg from '../../../assets/sky2/nz.jpg'\r\n\r\nimport { Car } from '../Entities/Car'\r\nimport carSrc from '../../../assets/chapter05/car.obj'\r\nimport carCollisionSrc from '../../../assets/chapter05/car_collision.obj'\r\nimport bodySrc from '../../../assets/chapter05/body.obj'\r\n\r\n\r\nimport { system_PlayerMoveOnLevel } from '../systems/system_PlayerMoveOnLevel'\r\nimport { system_PlayerNearLevelItems } from '../systems/system_PlayerNearLevelItems'\r\n\r\n\r\n//import { system_Monsters } from '../systems/system_Monsters'\r\n//import botSrc from '../../../assets/chapter04/botWalk.gltf'\r\n//import monsterSkinSrc from '../../../assets/chapter04/skin.jpg'\r\n\r\nimport { system_Columns } from '../systems/system_Columns'\r\n\r\n//import { system_PrepareDialogs } from '../systems/system_PrepareDialogs'\r\n\r\nimport { actions } from '../actions/actions'\r\nimport { Ui } from \"../ui/Ui\";\r\n\r\n//import { system_Sound } from '../systems/system_Sound'\r\n//import soundAmbientSrc from '../../../assets/sound/ambient.mp3'\r\n\r\n\r\n\r\n\r\nexport const GAME_MODULES = [\r\n    {\r\n        key: 'emitter',\r\n        constr: EventEmitter,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'deviceResizer',\r\n        constr: DeviceResizer,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'loaderAssets',\r\n        constr: LoaderAssets,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n\r\n    /////////////////////////////////////////\r\n\r\n    {\r\n        key: 'frameUpdater',\r\n        constr: FrameUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'tweenUpdater',\r\n        constr: Helper_TweenUpdater,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'studio',\r\n        constr: Studio,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'keyBoard',\r\n        constr: KeyBoard,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'player',\r\n        constr: Player,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'system_PlayerNearLevelItems',\r\n        constr: system_PlayerNearLevelItems,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'materialsLib',\r\n        constr: Helper_MaterialsLib,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    {\r\n        key: 'car',\r\n        constr: Car,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: carSrc, key: 'car' },\r\n            { type: 'obj', path: carCollisionSrc, key: 'carCollision' },\r\n        ],\r\n    },\r\n    {\r\n        key: 'system_Level',\r\n        constr: Level,\r\n        initStateKey: 'beforeStartPlay',\r\n        assetsToLoad: [\r\n            { type: 'obj', path: levelRoomsSrc, key: 'level-rooms' },\r\n            { type: 'obj', path: bodySrc, key: 'body' },\r\n            { type: 'cubeTextures', path: [ pxjpg, nxjpg, pyjpg, nyjpg, pzjpg, nzjpg, ], key: 'skyBox' },\r\n            { type: 'cubeTextures', path: [ px2jpg, nx2jpg, py2jpg, ny2jpg, pz2jpg, nz2jpg, ], key: 'skyBox2' },\r\n            { type: 'img', path: mapFloorOuter, key: 'mapFloorOuter', wrap: true },\r\n            //{ type: 'img', path: mapFloorOuter2, key: 'mapFloorOuter2', wrap: true },\r\n            { type: 'img', path: mapTop, key: 'mapTop', wrap: true },\r\n            { type: 'img', path: mapVirt, key: 'mapVirtual', wrap: true },\r\n            { type: 'img', path: mapTxt, key: 'mapParams' },\r\n        ],\r\n    },\r\n    {\r\n        key: 'system_PlayerMoveOnLevel',\r\n        constr: system_PlayerMoveOnLevel,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n    // {\r\n    //     key: 'system_Columns',\r\n    //     constr: system_Columns,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    // },\r\n    // {\r\n    //     key: 'system_Monsters',\r\n    //     constr: system_Monsters,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    //     assetsToLoad: [\r\n    //         { type: 'glb', path: botSrc, key: 'bot' },\r\n    //         { type: 'img', path: monsterSkinSrc, key: 'skin', wrap: true },\r\n    //     ]\r\n    // },\r\n    // {\r\n    //     key: 'system_PrepareDialogs',\r\n    //     constr: system_PrepareDialogs,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    // },\r\n    // {\r\n    //     key: 'system_Sound',\r\n    //     constr: system_Sound,\r\n    //     initStateKey: 'beforeStartPlay',\r\n    //     assetsToLoad: [\r\n    //         { type: 'soundMp3', path: soundAmbientSrc, key: 'soundAmbient' },\r\n    //     ]\r\n    // },\r\n\r\n    {\r\n        key: 'customUi',\r\n        constr: Ui,\r\n        initStateKey: 'pageLoaded',\r\n    },\r\n    {\r\n        key: 'actions',\r\n        constr: actions,\r\n        initStateKey: 'beforeStartPlay',\r\n    },\r\n]","\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport class DeviceResizer {\r\n    constructor (gameContext) {\r\n        let { emitter, appWrapper } = gameContext\r\n\r\n        !appWrapper && (appWrapper = document.querySelector('.app-wrapper')) \r\n\r\n        emitter.subscribe('mouseDown')(key => {\r\n            if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n        })\r\n\r\n        /** fullscreen */\r\n        const openAppFullScreenIfMobile = () => {\r\n            if (appWrapper.requestFullscreen) {\r\n                appWrapper.requestFullscreen()\r\n            } else if (appWrapper.mozRequestFullScreen) {\r\n                appWrapper.mozRequestFullScreen()\r\n            } else if (appWrapper.webkitRequestFullscreen) {\r\n                appWrapper.webkitRequestFullscreen()\r\n            } else if (appWrapper.msRequestFullscreen) {\r\n                appWrapper.msRequestFullscreen()\r\n            }\r\n        }\r\n\r\n        /** resize */\r\n        const resize = e => {\r\n            appWrapper.style.width = window.innerWidth + 'px'\r\n            appWrapper.style.height = window.innerHeight + 'px'\r\n            appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n            if (!document.fullscreenElement) {\r\n                emitter.emit('screenMode')('exitFullScreen')\r\n            }\r\n\r\n        }\r\n\r\n        window.addEventListener('resize', resize)\r\n        resize()\r\n    }\r\n}\r\n","import * as TWEEN from '@tweenjs/tween.js'\r\n\r\n\r\nexport class Helper_TweenUpdater {\r\n    constructor (gameContext) {\r\n        gameContext['emitter'].subscribe('frameUpdate')(() => TWEEN.update())\r\n    }\r\n}","import { UI } from '../../../_CORE/ui/UI'\r\nimport CustomReactComponent from \"./CustomReactComponent\";\r\nimport { createCustomStore  } from \"./store\";\r\n\r\nexport class Ui {\r\n    constructor(root) {\r\n        root.appWrapper = document.querySelector('.app-wrapper')\r\n        root.CustomReactComponent = CustomReactComponent\r\n        root.customStore = createCustomStore(root)\r\n\r\n        const ui = new UI(root)\r\n        root.ui = ui\r\n    }\r\n}","// https://www.artstation.com/artwork/AqP9Wq\r\n\r\n\r\nimport { pipeLineForInit } from '../../_CORE/pipeLines/initPipeLine'\r\nimport * as CONSTANTS from './constants/constants_elements'\r\nimport { GAME_MODULES } from \"./constants/constants_modules\"\r\n\r\n\r\nwindow.addEventListener('load', () => pipeLineForInit(GAME_MODULES, CONSTANTS ))\r\n"],"sourceRoot":""}